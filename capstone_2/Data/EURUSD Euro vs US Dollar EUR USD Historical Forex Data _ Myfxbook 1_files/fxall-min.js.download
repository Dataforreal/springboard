var SUNDAY=1;var MONDAY=2;var TUESDAY=3;var WEDNESDAY=4;var THURSDAY=5;var FRIDAY=6;var SATURDAY=7;var DST=0;var newYork=new Array();newYork[2014]={start:"March 9",end:"November 2"};newYork[2015]={start:"March 8",end:"November 1"};newYork[2016]={start:"March 13",end:"November 6"};newYork[2017]={start:"March 12",end:"November 5"};newYork[2019]={start:"March 10",end:"November 3"};newYork[2020]={start:"March 8",end:"November 1"};newYork[2021]={start:"March 14",end:"November 7"};newYork[2022]={start:"March 13",end:"November 6"};newYork[2023]={start:"March 12",end:"November 5"};var london=new Array();london[2014]={start:"March 30",end:"October 26"};london[2015]={start:"March 29",end:"October 25"};london[2016]={start:"March 27",end:"October 30"};london[2017]={start:"March 26",end:"October 29"};london[2019]={start:"March 31",end:"October 27"};london[2020]={start:"March 29",end:"October 25"};london[2021]={start:"March 28",end:"October 31"};london[2022]={start:"March 27",end:"October 30"};london[2023]={start:"March 26",end:"October 29"};var sydney=new Array();sydney[2014]={start:"April 6",end:"October 5"};sydney[2015]={start:"April 5",end:"October 4"};sydney[2016]={start:"April 3",end:"October 2"};sydney[2017]={start:"April 2",end:"October 1"};sydney[2019]={start:"April 7",end:"October 6"};sydney[2020]={start:"April 5",end:"October 4"};sydney[2021]={start:"April 4",end:"October 3"};sydney[2022]={start:"April 3",end:"October 2"};sydney[2023]={start:"April 2",end:"October 1"};var markets=[{name:"newYork",open:12,close:21,startDay:MONDAY,dst:newYork},{name:"london",open:7,close:16,startDay:MONDAY,dst:london},{name:"tokyo",open:0,close:9,startDay:MONDAY,dst:""},{name:"sydney",open:21,close:6,startDay:SUNDAY,dst:sydney}];function marketTime(){for(var c=0;c<markets.length;c++){var f=markets[c];var a=checkStatus(f);var d=(f.name=="newYork");if(a.open){$PT(f.name).innerHTML=timeLeft(a,$F("mcil"),d);$PT(markets[c].name+"M").className="on";$PT(markets[c].name+"B").className="marketBon"}else{$PT(f.name).innerHTML=timeLeft(a,$F("moil"),d);$PT(markets[c].name+"M").className="market";$PT(markets[c].name+"B").className="marketBoff"}var b=(f.open+3)/24*230;if(markets[c].name!="sydney"){$PT(markets[c].name+"M").style.right=b+"px"}}setTimeout(function(){marketTime()},1000)}var second=1000,minute=60*second,hour=60*minute,day=24*hour;function checkStatus(f){var a=new Object();var b=checkDst(f);var d=new Date(dt.getFullYear(),dt.getMonth(),dt.getDate(),f.open,0,0);while(d.getDay()+1!=f.startDay){d.setDate(d.getDate()-1)}var c=new Date(d.getFullYear(),d.getMonth(),d.getDate(),f.close,0,0);while(c<d){c.setDate(c.getDate()+1)}if(b){d.setHours(d.getHours()+1);c.setHours(c.getHours()+1)}a.dstMode=b;while(dt>c||(d.getDay()+1)>FRIDAY||d.getDay()+1<f.startDay||((d.getDay()+1)==FRIDAY)&&d.getHours()>=f.close){d.setDate(d.getDate()+1);c.setDate(c.getDate()+1)}if(dt>=d&&dt<c){a.open=true;a.left=c.getTime()-dt.getTime()}else{a.open=false;a.left=d.getTime()-dt.getTime()}return a}function checkDst(d){try{if(d.dst[dt.getFullYear()]!=null){var a=new Date(d.dst[dt.getFullYear()].start+","+dt.getFullYear());var c=new Date(d.dst[dt.getFullYear()].end+","+dt.getFullYear());return(dt<a||dt>c)}else{return false}}catch(b){return false}}function timeLeft(d,h,a){var g=d.left;var m=Math.floor(g/day);g-=m*day;var k=Math.floor(g/hour);g-=k*hour;var c=Math.floor(g/minute);g-=c*minute;var l=Math.floor(g/second);var b=((dt.getHours()*3600+dt.getMinutes()*60+dt.getSeconds()+10800-(d.dstMode?3600:0)));if(b>86400){b=(b-86400)/86400}else{b=b/86400}var f=b*230;$PT("timeWidget").style.display="none";return[(a?"<div id='timeline' style='right:"+f+"px'></div><div>":"")+h+" ",k+(m!=0?m*24:0)+$F("mhp")+", "+c+$F("mmp")+", "+l+$F("msp")+"</div>"].join("")}var marketCurrenciesChecked=0;function changeMarketsCurrencies(b){var a=$J(b.options[b.selectedIndex]).attr("val");if(marketCurrenciesChecked!=a){setCookie("marketTimescale",a,YEAR,false);marketCurrenciesChecked=a;document.location.href="/forex-market/currencies/"+a}}function calendarEventUpdateToSymbolChartAnalysis(g){var o=g.eventData;var l=g.oid;var c=g.date;if(hasText(o)){var b="event"+l;jQuery("#"+b).remove();jQuery("#"+b+"url").remove();jQuery("#chartTooltipEvents").append(o);var f=g.volatility;var k="events"+f;var d=marketObject.getEventMarkerById(k,b);var r=marketObject.getEventMarkersGroupById(k).events;if(r!=null){if(d!=null){var m=r.indexOf(d);if(m>-1){r.splice(m,1);marketObject.removeEventMarker(k,b)}}var q=Number($F("userTimezoneOffset"))*1000*60;var h=new Date(c+(q));var a={date:h,id:b,attributes:{id:b}};r.push(a);marketObject.addEventMarker(k,a);marketObject.commitEventMarkersChanges()}}}var Help={};Help.Methods={getTranslation:function(b,c){b=jsTranslationMap[b];if(typeof c!="undefined"){for(var a=0;a<c.length;a++){b=b.replace(/{.}/,c[a])}}return b},getAttribute:function(b,a){return b.getAttribute(a)},setInnerHTML:function(b,a){$PT(b).innerHTML=a},hideElementFunction:function(b){try{$PT(b).style.display="none"}catch(a){}},showElementFunction:function(b){try{$PT(b).style.display=""}catch(a){}}};try{var $J=jQuery;$J.fn.isExist=function(){return jQuery(this).length>0};$J.fn.update=function(a){setTimeout(function(){runAjaxScripts(a)},50);return jQuery(this).html(removeScriptTags(a))[0]}}catch(e){}Element.prototype.insert=function(a){if(typeof a.after=="string"){$J(a.after).insertAfter($J(this))}else{$J(this).append(a)}};Element.prototype.removeClassName=function(a){$J(this).removeClass(a)};Element.prototype.update=function(a){setTimeout(function(){runAjaxScripts(a)},50);return jQuery(this).html(removeScriptTags(a))[0]};Element.prototype.getCellText=function(a){return jQuery(this).children().eq(a).text()};Element.prototype.hasClassName=function(a){return jQuery(this).hasClass(a)};Element.prototype.addClassName=function(a){jQuery(this).addClass(a)};Element.prototype.setStyle=function(a){if(typeof a=="string"){var b=a.split(":");if(b.size()==2){jQuery(this).css(b[0],b[1])}}else{jQuery(this).css(a)}};Element.prototype.setValue=function(a){jQuery(this).val(a)};Element.prototype.show=function(){if($(this).attr("preventPrototypeShowEvent")===undefined){jQuery(this).show()}};Element.prototype.remove=function(){jQuery(this).remove()};function $PT(b){if(arguments.length>1){for(var a=0,d=[],c=arguments.length;a<c;a++){d.push($PT(arguments[a]))}return d}if(typeof b=="string"){b=document.getElementById(b)}return b}function $F(a){if(typeof a=="string"){return $J("#"+a).val()}else{return $J(a).val()}}function $$PT(a){return $J(a).toArray()}var Effect={};Effect.ScrollTo=function(a){window.scrollTo(0,$J("#"+a).offset().top)};Effect.Pulsate=function(b,a){var c=jQuery("#"+b);var f=a.pulses||1;var d=((a.duration*1000)/((a.pulses)*2));for(i=0;i<f;i++){c.fadeOut(d).fadeIn(d)}};Effect.SlideDown=function(b,a){var c=jQuery($PT(b));var d=a.duration*1000;c.slideDown(d)};(function(a){a.Element=function(c,b){if(typeof b=="undefined"){b={}}if(hasText(b.className)){b["class"]=b.className}return jQuery("<"+c+"/>",b)[0]}})(this);var Draggable=function(b,a){jQuery("#"+b).draggable()};var TextAreaResize=function(a){autosize(jQuery("#"+a))};Array.prototype.each=function(a){this.forEach(a)};Array.prototype.size=function(){return this.length};Array.prototype.clear=function(){this.length=0;return this};Array.max=function(a){return Math.max.apply(Math,a)};Array.min=function(a){return Math.min.apply(Math,a)};if(!Array.prototype.last){Array.prototype.last=function(){return this[this.length-1]}}if(!String.prototype.startsWith){String.prototype.startsWith=function(b,a){a=a||0;return this.substr(a,b.length)===b}}function $A(c){if(!c){return[]}if("toArray" in Object(c)){return c.toArray()}var b=c.length||0,a=new Array(b);while(b--){a[b]=c[b]}return a}var Insertion={Before:function(a,b){return $J(b).insertBefore($J(a))},After:function(a,b){return $J(b).insertAfter($J(a))}};var $T=Help.Methods.getTranslation;var $AT=Help.Methods.getAttribute;var $S=Help.Methods.setInnerHTML;var $SE=Help.Methods.setInnerHTMLElement;var $HDE=Help.Methods.hideElementFunction;var $SHE=Help.Methods.showElementFunction;var busy=false;var cellTypes=["url","yield","absYield","daily","monthly","drawdown","balance","equity","profit","swap","deposits","withdrawals","totalTrades","profitability","pips","bestTradeCurrency","worstTradeCurrency","avgWinPips","avgLossPips","avgWinCurrency","avgLossCurrency","sizing","commissions","longsWon","shortsWon","pipsHighest","pipsLowest","totalTradeTime","profitFactor","deviation","sharpeRatio","zScore","expectancy","ahpr","ghpr","systemType","tradingType","lastUpdateDate"];var commentsName=["comment2","comment3","comment4","comment5"];var floatTheadTables="#spreadMainTable,#forexBrokerSwapTable,#symbolMarketHeatMap,#symbolMarketVolatility,#symbolMarketCorrelation";var fxVars={tags:{},addUpdateAccount:"/secure/addUpdateAccount.xml?",checkMtLogin:"/secure/check-mt-login.xml?id=",tryMtLogin:"/secure/try-mt-login.xml?",switchPublish:"/secure/switchPublish.xml?old=",deleteAccount:"/secure/delete-account.xml?oid=",deleteStrategy:"/secure/delete-strategy.xml?oid=",addPost:"/secure/addPost.html?",editPost:"/secure/editPost.html?",deletePost:"/secure/deletePost.html?oid=",deleteTopic:"/secure/deleteTopic.html?oid=",moveTopic:"/moveTopic.html?",addAccountWatchUrl:"/secure/watch.json?type=1&oid=",autoCompleters:{},changeEmailUrl:"/secure/sendChangeEmail.xml?",changePasswordUrl:"/secure/changePassword.xml?",getUserId:"/getUserId.json?username=",deleteMessageUrl:"/secure/deleteMessage.html?",findUserUrl:"/finduser.json",forgotPasswordUrl:"/forgot.xml?",inboxReply:"/secure/inboxReply.html?",loginUrl:"/login.html?",pagingUrl:"/paging.html",generateOwnerKey:"/secure/generate-owner-key.xml?",removeAccountWatchUrl:"/secure/watch.json?type=0&oid=",regUrl:"/regform.xml?",resendActivationUrl:"/reactivate.xml?",resetPasswordUrl:"/resetpass.html?",userInfo:"/secure/userInfo.xml?",rateEA:"/secure/rateEA.json?",rateSignal:"/secure/rateSignal.json?",rateBroker:"/secure/rateBroker.json?",searchSystems:"/searchSystems.html?",getPostById:"/getPost.html?postId=",reportAbuse:"/secure/abuse.html?postId=",getAccountForm:"/secure/getAccountForm.html?accountId=",topicSubscribe:"/secure/topicSubscribe.html?",topicUnsubscribe:"/secure/topicUnsubscribe.html?",deleteNotification:"/secure/deleteNotification.xml?id=",vote:"/secure/voteSuggestion.json?",reportBug:"/reportBug.xml?",contact:"/contactSend.html?",saveSettings:"/secure/saveSettings.json?",twitterUpdate:"/secure/twitter-update.html?",twitterUrl:"/secure/twitter-url.xml?accountId=",twitterReset:"/secure/twitter-reset.xml?id=",subscriptionDelete:"/secure/subscriptionDelete.html?",updateAdvanced:"/getAdvancedStatistics.json?",updateAdvancedStrategy:"/getStrategyAdvancedStatistics.xml?",accountInvitation:"/secure/account-invitation.xml?",generateInvitation:"/secure/generate-invitation.xml?",commentTrade:"/secure/commentTrade.xml?",commentStrategy:"/secure/comment-strategy.xml?",refreshDashboard:"/secure/refresh-dashboard.xml?newsLastTime=",customStartDate:"/secure/customStart.xml?",customMagics:"/secure/customMagics.xml?",addPortfolio:"/secure/add-portfolio.xml?name=",deletePortfolio:"/secure/delete-portfolio.xml?id=",setAccountPortfolio:"/secure/set-account-portfolio.json?",updatePortfolioName:"/secure/update-portfolio.xml?",saveTranslation:"/secure/save-translation.xml?",editTranslation:"/secure/edit-translation.xml?",getAccountTwitter:"/secure/get-account-twitter.xml?id=",setDefaultTwitter:"/secure/set-default-twitter.xml?id=",voteTranslation:"/secure/vote-translation.xml?id=",contestRegister:"/secure/contest-register.xml?",contestStatus:"/secure/contest-status.xml?id=",contestSubscribe:"/secure/contest-subscribe.xml?",contestActivity:"/contest-activity.xml?",calendarNotification:"/secure/calendarNotification.xml?oid=",saveEmailMinAlert:"/calendarEmailMinAlert.xml?min=",changeLanguage:"/secure/change-language.json?locale=",addStrategy:"/secure/add-strategy.xml?",addStrategyGroup:"/secure/add-strategy-group.xml?",getGroupStrategies:"/secure/get-group-strategies.xml?",removeStrategyGroup:"/secure/remove-strategy-group.xml?",updateStrategy:"/secure/update-strategy.xml?",rateUser:"/secure/rate-user.json?",boardAdd:"/secure/board-add.xml?",groupAdd:"/secure/add-group.xml?",groupRemove:"/secure/remove-group.xml?id",groupRequest:"/secure/group-request.xml?id=",groupRemoveUser:"/secure/remove-group-user.xml?id=",groupUpdateRequest:"/secure/update-group-request.xml?id=",bumpBoard:"/secure/bump-board.xml?id=",groupPost:"/secure/group-post.xml?id=",deleteBoardAd:"/secure/delete-board-ad.xml?id=",calendarClick:"/calendar-click.html?",blockUser:"/secure/block-user.html?",removeUserBlock:"/secure/remove-block-user.html?oid=",forexNews:"/streaming-forex-news.html?",getCompareAccount:"/getCompareAccount.xml?id=",saveCompare:"/secure/save-comparison.xml?ids=",loadComparison:"/load-comparison.xml?id=",removeComparison:"/secure/remove-comparison.xml?id=",addRemoveWatch:"/secure/update-watch.json?type=1&oid=",tradeDiary:"/secure/tradeDiary.xml?",rateTopics:"/secure/rateTopics.xml?",createOrderTag:"/secure/createOrderTag.xml?",addOrderTagMap:"/secure/addOrderTagMap.xml?",deleteOrderTag:"/secure/deleteOrderTag.xml?&oid=",updateOrderTag:"/secure/updateOrderTag.xml?",rateVps:"/secure/rateVps.json?",rateTradingPlatform:"/secure/rateTradingPlatform.json?",rateEap:"/secure/rateEap.json?",updateQuotes:"/secure/updateQuotes.xml?quotes=",searchProfile:"/secure/addSearchProfile.xml?",quotes:"/quotes.xml?symbolId=",spreadsData:"/spreadsData.json?serverId=",updateSpreadMenu:"/updateSpreadMenu.json?",removeProfile:"/secure/removeProfile.xml?profileId=",commentWatch:"/secure/commentWatch.json?",updatePortfolioOverallFilter:"/secure/updatePortfolioOverallFilter.json?filters=",deleteAllNotifications:"/secure/deleteAllNotifications.json?",getGeneralData:"/getToolbarData.json?showSymbolsTop=",showToolbar:"/showToolbar.json?showToolbar=",getWallPosts:"/secure/getWallPosts.json?user=",addWallPost:"/secure/addWallPost.json?",searchTranslate:"/secure/searchTranslate.json?",searchTranslateVote:"/secure/vote-translations.json?",removeWallPosts:"/secure/removeWallPosts.json?id=",editWallPosts:"/secure/editWallPosts.json?",showMoreWallPosts:"/showMoreWallPosts.json?",addOandaAccount:"/secure/add-oanda-account.json?",checkOandaLogin:"/secure/check-oanda-login.json?id=",getSpreadRange:"/getSpreadRange.json?serverId=",getQuotes:"/getQuotes.json?timeScale=",editRemoveGoal:"/secure/editRemoveGoal.json?",addGoal:"/secure/addGoal.json?",getTradeBrowserInfo:"/getTradeBrowserInfo.json?",getTradeConfigInfo:"/getTradeConfigInfo.json?",updatePortfolioSettings:"/secure/updatePortfolioSettings.json?",contestResendMail:"/secure/contest-resend-mail.json?id=",getTradePaging:"/tradePaging.json?",saveChartProfile:"/saveChartProfile.json?",loadChartProfile:"/loadChartProfile.json?oid=",changeTopicLockStatus:"/admin/lock-topic.html?oid=",saveChart:"/saveChart.json?",loadChart:"/loadChart.json?",changeTopicLockStatus:"/admin/lock-topic.html?oid=",saveCharts:"/secure/saveCharts.json?",removeChart:"/secure/removeChart.json?chartId=",updatePublishChart:"/secure/updatePublishChart.json?oid=",rateRebateProgram:"/secure/rateRebateProgram.json?",ratePamm:"/secure/ratePamm.json?",saveChart:"/saveChart.json?",removeChartProfile:"/removeChartProfile.json?profileId=",updatePublicProfile:"/updatePublicProfile.json?oid=",newChart:"/newChart.json?",getPublishCharts:"/getPublishCharts.json?",voteForChart:"/secure/voteForChart.json?chartId=",addTemplate:"/secure/addTemplate.json?",removeTemplate:"/secure/removeTemplate.json?templateId=",getAccountTracking:"/getAccountTracking.json?oid=",updateChartSubscribers:"/secure/updateChartSubscribers.json?subscribe=",updateNotifications:"/secure/updateNotifications.json?",getChartsMenu:"/secure/getChartsMenu.json?",addAccountNotification:"/secure/addAccountNotification.json?",getAccountNotification:"/secure/getAccountNotification.json?",editRemoveAccountNotification:"/secure/editRemoveAccountNotification.json?",getPostComments:"/getPostComments.json?postId=",getWallPosts:"/secure/getWallPosts.json?",getWallPostsBetweenOids:"/secure/getWallPostsBetweenOids.json?",saveChartScreenshot:"/saveChartScreenshot.json?",feedSubscribe:"/secure/feedSubscribe.json?toUid=",feedUnsubscribe:"/secure/feedUnsubscribe.json?toUid=",feedSubscriptionDelete:"/secure/feedSubscriptionDelete.json?oid=",getChartsActivity:"/getChartsActivity.json?lastActivity=",settingsAddAccountSwitch:"/secure/settingsAddAccountSwitch.json?type=",getRecentCharts:"/getRecentCharts.json?date=",getRecentActivity:"/getRecentActivity.json?oid=",getChartQuotes:"/getChartQuotes.json?oid=",getChartVotesOrFollowing:"/getChartVotesOrFollowing.json?chartOid=",getSymbolAnalysisConfig:"/getSymbolAnalysisConfig.json?symbol=",getSymbolAnalysis:"/getSymbolAnalysis.json?timeScale=",updateMarketSymbolMenu:"/updateMarketSymbolMenu.json?",getHistoricalDataByDate:"/getHistoricalDataByDate.json?",updateUserCalendarBubble:"/secure/updateUserCalendarBubble.json?show=",volatilityCharts:"/volatilityCharts.json?",changeInboxSubscribe:"/secure/change-inbox-subscribe.json?",updateCorrelationSymbolMenu:"/updateCorrelationSymbolMenu.json?",getCorrelationConfig:"/getCorrelationConfig.json?rowSymbol=",getSymbolCorrelationByTime:"/getSymbolCorrelationByTime.json?timeScale=",getTopCorrelationByTimeScale:"/getTopCorrelationByTimeScale.json?",getSwapChartBySymbolInfo:"/get-swap-chart-by-symbol.json?",changeBrokerSwapsSymbols:"/change-broker-swaps-symbols.json?",addOrDeleteMasterToSlave:"/secure/addOrDeleteMasterToSlave.json?",updateMultiplier:"/secure/updateMultiplier.json?oid=",saveUserDashboardOrder:"/secure/saveDashboardOrder.json?orderList=",getActivity:"/get-activity.json?lastOid=",updateInboxNotifications:"/secure/updateInboxNotifications.json?",getAutoTradeConfirmData:"/secure/getAutoTradeConfirmData.json?",addPendingAutoTradeProvider:"/secure/addPendingAutoTradeProvider.json?accountOid=",getUserVouchers:"/getUserVouchers.json?uid=",removeSlaveAccount:"/secure/removeSlaveAccount.json?slaveAccountOid=",saveUserPortfolioMenuOrder:"/secure/saveUserPortfolioMenuOrder.json?orderList=",openLiveAccount:"/secure/openLiveAccount.json?accountId=",getAccountRisk:"/secure/getAccountRisk.json?accountOid=",loadOpenTrades:"/loadAccount.json?chartId=",setOpenTrades:"/secure/setAccountToChart.json?accountOid=",closePosition:"/secure/closePosition.json?accountOid=",getCOTConfig:"/get-cot-config.json?symbolOid=",addPaymentSettingsConfirmation:"/secure/addPaymentSettingsConfirmation.json?",addPayment:"/secure/addPayment.json?",getMoreCalendarEvents:"/get-more-calendar-events.json?pageNumber=",saveAutoTradeQuestionnaire:"/saveAutoTradeQuestionnaire.json?accountOid=",getCalendarNextDayEvents:"/get-calendar-next-day-events.json?",updateSignalTraderSettings:"/secure/updateSignalTraderSettings.json?",pauseMasterForSlave:"/secure/pauseMasterForSlave.json?",updateLiveAccountPassword:"/secure/updateLiveAccountPassword.json?accountOid=",checkMtLoginUpdatePass:"/secure/check-mt-login-update-pass.json?accountOid=",signalTraderSettingsExist:"/secure/signalTraderSettingsExist.json?",updateInvestorPassword:"/secure/updateInvestorPassword.json?accountOid=",openDemo:"/secure/openDemo.json?",getContestAnalysisCharts:"/getContestAnalysisCharts.json?contestOid=",tryDukascopyLogin:"/secure/try-dukascopy-login.json?",checkDukascopyLogin:"/secure/check-dukascopy-login.json?login=",getSimulatorChart:"/getSimulatorChart.json",addCtraderAccount:"/secure/add-ctrader-account.json?",checkCtraderLogin:"/secure/check-ctrader-login.json?id=",saveSimulatorUserSettings:"/secure/saveSimulatorUserSettings.json?",deleteSimulatorUserSettings:"/secure/deleteSimulatorUserSettings.json?",setSimulationAsAutoTradePortfolio:"/secure/setSimulationAsAutoTradePortfolio.json?",addContact:"/secure/addContact.json?",approveOrDisapproveContact:"/secure/approveOrDisapproveContact.json?",getChatHistory:"/secure/getChatHistory.json?",updateLastChatVisibleDate:"/secure/updateLastChatVisibleDate.json?",brokerManageSave:"/brokerManageSave.json?",brokerManageSearch:"/brokerManageSearch.json?",updateOutlookSymbolsFilter:"/secure/updateOutlookSymbolsFilter.json?filters=",autoCompleteSearch:"/autoCompleteSearch.json",getUserPositionsSlippage:"/secure/getUserPositionsSlippage.json?",addTradesBlogComment:"/secure/addTradesBlogComment.json?",getAccountMagics:"/secure/get-account-magics.json?oid=",saveSlaveSettings:"/secure/saveSlaveSettings.json?",getOutlookNotification:"/secure/getOutlookNotification.json?",addUpdateOutlookNotification:"/secure/addUpdateOutlookNotification.json?",removeOutlookNotification:"/secure/removeOutlookNotification.json?",refreshDashSystemsTable:"/secure/refreshDashSystemsTable.json?",getStrategiesPerPage:"/secure/getStrategiesPerPage.json?",changeOutlookSymbols:"/changeOutlookSymbols.json?",updateIndicatorsTable:"/updateIndicatorsTable.json?",refreshIndicatorsTable:"/refreshIndicatorsTable.json?",refreshIndicatorSingleTable:"/refreshIndicatorSingleTable.json?",updateSingleIndicatorTable:"/updateSingleIndicatorTable.json?",brokerBackendLogin:"/brokerBackendLogin.html?",updateDashboardWatchedFilter:"/secure/updateDashboardWatchedFilter.json?filters=",declineProvider:"/secure/declineProvider.json?",getMarketNotification:"/secure/getMarketNotification.json?",addUpdateMarketNotification:"/secure/addUpdateMarketNotification.json?",removeMarketNotification:"/secure/removeMarketNotification.json?",newsRedirect:"/news-redirect.json?",calendarMultiNotification:"/calendarMultiNotification.json?",resendOrCancelPaymentSettings:"/secure/resendOrCancelPaymentSettings.json?",addUpdateTechnicalNotification:"/secure/addUpdateTechnicalNotification.json?",getTechnicalNotification:"/secure/getTechnicalNotification.json?",deleteTechnicalNotifications:"/secure/deleteTechnicalNotifications.json?",getTechnicalNotificationSymbolSavedTimeFrames:"/secure/getTechnicalNotificationSymbolSavedTimeFrames.json?",deletePostAttachment:"/secure/deletePostAttachment.json?",rateBinaryBroker:"/secure/rateBinaryBroker.json?",sendTrySignalStart:"/secure/sendTrySignalStart.json?",getSpreadsByType:"/getSpreadsByType.json?",getBrokersPromotionsByType:"/brokersPromotionsByType.json?",saveBrokerPromotion:"/saveBrokerPromotion.json?",deleteBrokerPromotion:"/deleteBrokerPromotion.json?",updateAccountSymbols:"/secure/updateAccountSymbols.json?",getHeatMapData:"/getHeatMapData.json?",realContestRegistration:"/secure/real-contest-registration.json?",updateLimitedSymbolsMessage:"/secure/hideLimitedSymbolsMessage.json?",emailUnsubscribe:"/email-unsubscribe.html",saveNews:"/save-news.json?",switchOutlookIndicatorAccountNumber:"/secure/outlook-indicator-switch-account.json?",recurrentTransaction:"/secure/remove-recurrent-transaction.json?",requestPhoneVerificationCode:"/secure/requestPhoneVerificationCode.json?",submitPhoneVerificationCode:"/secure/submitPhoneVerificationCode.json?",addGdprDataRequest:"/secure/add-gdpr-data-request.json?",downloadGdprUserData:"/secure/download-gdpr-user-data.json?",approveDisapprovePremiumOffers:"/secure/approveDisapprovePremiumOffers.json?",acceptUpdatedPrivacyAndTermsVersion:"/secure/accept-updated-privacy-and-terms-version.json?",contestApiRegister:"/secure/contest-registration.json?",closeUserAccount:"/secure/close-user-account.json?",changeBrokerPromotionPriority:"/changeBrokerPromotionPriority.json?",getBrokersByPlatformOid:"/get-brokers-by-platform-oid.json?",updateSpreadsPromotion:"/secure/update-spreads-promotion.json?",getMagicNumbers:"/getMagicNumbers.json?",portfolioMenuMap:"/secure/portfolioMenuMap.json"};Array.prototype.______array="______array";window.dhtmlHistory={isIE:false,isOpera:false,isSafari:false,isKonquerer:false,isGecko:false,isSupported:false,isFirefox:false,create:function(d){var h=this;var g=navigator.userAgent.toLowerCase();var a=navigator.platform.toLowerCase();var k=navigator.vendor||"";if(k==="KDE"){this.isKonqueror=true;this.isSupported=false}else{if(typeof window.opera!=="undefined"){this.isOpera=true;this.isSupported=true}else{if(typeof document.all!=="undefined"){this.isIE=true;this.isSupported=true}else{if(k.indexOf("Apple Computer, Inc.")>-1){this.isSafari=true;this.isSupported=(a.indexOf("mac")>-1)}else{if(g.indexOf("gecko")!=-1){this.isGecko=true;this.isSupported=true}}}}}if(typeof InstallTrigger!=="undefined"){this.isFirefox=true}window.historyStorage.setup(d);if(this.isSafari){this.createSafari()}else{if(this.isOpera){this.createOpera()}}var b=this.getCurrentLocation();this.currentLocation=b;if(this.isIE){this.createIE(b)}var f=function(){h.firstLoad=null};this.addEventListener(window,"unload",f);if(this.isIE){this.ignoreLocationChange=true}else{if(!historyStorage.hasKey(this.PAGELOADEDSTRING)){this.ignoreLocationChange=true;this.firstLoad=true;historyStorage.put(this.PAGELOADEDSTRING,true)}else{this.ignoreLocationChange=false;this.fireOnNewListener=true}}var c=function(){h.checkLocation()};setInterval(c,100)},initialize:function(){if(this.isIE){if(!historyStorage.hasKey(this.PAGELOADEDSTRING)){this.fireOnNewListener=false;this.firstLoad=true;historyStorage.put(this.PAGELOADEDSTRING,true)}else{this.fireOnNewListener=true;this.firstLoad=false}}},addListener:function(a){this.listener=a;if(this.fireOnNewListener){this.fireHistoryEvent(this.currentLocation);this.fireOnNewListener=false}},addEventListener:function(c,b,a){if(c.addEventListener){c.addEventListener(b,a,false)}else{if(c.attachEvent){c.attachEvent("on"+b,function(){a(window.event)})}}},add:function(c,d){if(this.isSafari){c=this.removeHash(c);historyStorage.put(c,d);this.currentLocation=c;window.location.hash=c;this.putSafariState(c)}else{var b=this;var a=function(){if(b.currentWaitTime>0){b.currentWaitTime=b.currentWaitTime-b.waitTime}c=b.removeHash(c);if(document.getElementById(c)&&b.debugMode){var f="Exception: History locations can not have the same value as _any_ IDs that might be in the document, due to a bug in IE; please ask the developer to choose a history location that does not match any HTML IDs in this document. The following ID is already taken and cannot be a location: "+c;throw new Error(f)}historyStorage.put(c,d);b.ignoreLocationChange=true;b.ieAtomicLocationChange=true;b.currentLocation=c;window.location.hash=c;if(b.isIE){b.iframe.src="/pages/blank.html?"+c}b.ieAtomicLocationChange=false};window.setTimeout(a,this.currentWaitTime);this.currentWaitTime=this.currentWaitTime+this.waitTime}},isFirstLoad:function(){return this.firstLoad},getVersion:function(){return"0.6"},getCurrentLocation:function(){var a=(this.isSafari?this.getSafariHash():this.getCurrentHash());return a},getCurrentHash:function(){var b=window.location.href;var a=b.indexOf("#");return(a>=0?b.substr(a+1):"")},PAGELOADEDSTRING:"DhtmlHistory_pageLoaded",listener:null,waitTime:200,currentWaitTime:0,currentLocation:null,iframe:null,safariHistoryStartPoint:null,safariStack:null,safariLength:null,ignoreLocationChange:null,fireOnNewListener:null,firstLoad:null,ieAtomicLocationChange:null,createIE:function(a){this.waitTime=400;var b=(historyStorage.debugMode?"width: 800px;height:80px;border:1px solid black;":historyStorage.hideStyles);var d="rshHistoryFrame";var c='<iframe frameborder="0" id="'+d+'" style="'+b+'" src="/blank.html?'+a+'"></iframe>';document.write(c);this.iframe=document.getElementById(d)},createOpera:function(){this.waitTime=400;var a='<img src="javascript:location.href=\'javascript:dhtmlHistory.checkLocation();\';" style="'+historyStorage.hideStyles+'" />';document.write(a)},createSafari:function(){var f="rshSafariForm";var d="rshSafariStack";var c="rshSafariLength";var b=historyStorage.debugMode?historyStorage.showStyles:historyStorage.hideStyles;var a=(historyStorage.debugMode?"width:800px;height:20px;border:1px solid black;margin:0;padding:0;":historyStorage.hideStyles);var g='<form id="'+f+'" style="'+b+'"><input type="text" style="'+a+'" id="'+d+'" value="[]"/><input type="text" style="'+a+'" id="'+c+'" value=""/></form>';document.write(g);this.safariStack=document.getElementById(d);this.safariLength=document.getElementById(c);if(!historyStorage.hasKey(this.PAGELOADEDSTRING)){this.safariHistoryStartPoint=history.length;this.safariLength.value=this.safariHistoryStartPoint}else{this.safariHistoryStartPoint=this.safariLength.value}},getSafariStack:function(){var a=this.safariStack.value;return historyStorage.fromJSON(a)},getSafariState:function(){var a=this.getSafariStack();var b=a[history.length-this.safariHistoryStartPoint-1];return b},getSafariHash:function(){var a=window.location.hash;return a.substring(a.indexOf("#")+1,a.length)},putSafariState:function(b){var a=this.getSafariStack();a[history.length-this.safariHistoryStartPoint]=b;this.safariStack.value=historyStorage.toJSON(a)},fireHistoryEvent:function(a){var b=historyStorage.get(a);this.listener.call(null,a,b)},checkLocation:function(){if(!this.isIE&&this.ignoreLocationChange){this.ignoreLocationChange=false;return}if(!this.isIE&&this.ieAtomicLocationChange){return}var a=this.getCurrentLocation();if(a==this.currentLocation){return}this.ieAtomicLocationChange=true;if(this.isIE&&this.getIframeHash()!=a){this.iframe.src="/pages/blank.html?"+a}else{if(this.isIE){return}}this.currentLocation=a;this.ieAtomicLocationChange=false;this.fireHistoryEvent(a)},getIframeHash:function(){var b=this.iframe.contentWindow.document;var a=String(b.location.search);if(a.length==1&&a.charAt(0)=="?"){a=""}else{if(a.length>=2&&a.charAt(0)=="?"){a=a.substring(1)}}return a},removeHash:function(b){var a;if(b===null||b===undefined){a=null}else{if(b===""){a=""}else{if(b.length==1&&b.charAt(0)=="#"){a=""}else{if(b.length>1&&b.charAt(0)=="#"){a=b.substring(1)}else{a=b}}}}return a},iframeLoaded:function(a){if(this.ignoreLocationChange){this.ignoreLocationChange=false;return}var b=String(a.search);if(b.length==1&&b.charAt(0)=="?"){b=""}else{if(b.length>=2&&b.charAt(0)=="?"){b=b.substring(1)}}window.location.hash=b;this.fireHistoryEvent(b)}};var p=dhtmlHistory.getCurrentLocation();if(p.length!=0&&window.location.pathname.indexOf("/settings")==-1&&window.location.pathname.indexOf("/faq")==-1&&window.location.pathname.indexOf("/help")==-1&&window.location.pathname.indexOf("/widgets")==-1&&window.location.pathname.indexOf("/reviews")==-1){if(window.location.pathname.indexOf("/translations/")!=-1||window.location.pathname.indexOf("/board/")!=-1){window.location=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")+1)+gup("p")}else{if(window.location.pathname.indexOf("/forex-charts")!=-1){window.location="/forex-charts/"+p}else{if(window.location.pathname.indexOf("/systems")!=-1){window.location=window.location.pathname+p}else{if(window.location.pathname.indexOf("/forex-brokers")!=-1){window.location=window.location.pathname+p}else{if(p.indexOf("postRow")==-1){window.location=window.location.pathname.substring(0,window.location.pathname.lastIndexOf(",")+1)+gup("p")}}}}}}window.historyStorage={setup:function(b){if(typeof b!=="undefined"){if(b.debugMode){this.debugMode=b.debugMode}if(b.toJSON){this.toJSON=b.toJSON}if(b.fromJSON){this.fromJSON=b.fromJSON}}var d="rshStorageForm";var g="rshStorageField";var a=this.debugMode?historyStorage.showStyles:historyStorage.hideStyles;var f=(historyStorage.debugMode?"width: 800px;height:80px;border:1px solid black;":historyStorage.hideStyles);var c='<form id="'+d+'"><textarea id="'+g+'" style="'+f+'"></textarea></form>';document.write(c);this.storageField=document.getElementById(g);if(typeof window.opera!=="undefined"){this.storageField.focus()}},put:function(a,b){this.assertValidKey(a);if(this.hasKey(a)){this.remove(a)}this.storageHash[a]=b;this.saveHashTable()},get:function(a){this.assertValidKey(a);this.loadHashTable();var b=this.storageHash[a];if(b===undefined){b=null}return b},remove:function(a){this.assertValidKey(a);this.loadHashTable();delete this.storageHash[a];this.saveHashTable()},reset:function(){this.storageField.value="";this.storageHash={}},hasKey:function(a){this.assertValidKey(a);this.loadHashTable();return(typeof this.storageHash[a]!=="undefined")},isValidKey:function(a){return(typeof a==="string")},showStyles:"border:0;margin:0;padding:0;",hideStyles:"left:-1000px;top:-2000px;padding:0;position:absolute;display:block;",debugMode:false,storageHash:{},hashLoaded:false,storageField:null,assertValidKey:function(a){var b=this.isValidKey(a);if(!b&&this.debugMode){throw new Error("Please provide a valid key for window.historyStorage. Invalid key = "+a+".")}},loadHashTable:function(){if(!this.hashLoaded){var a=this.storageField.value;if(a!==""&&a!==null){this.storageHash=this.fromJSON(a);this.hashLoaded=true}}},saveHashTable:function(){this.loadHashTable();var a=this.toJSON(this.storageHash);this.storageField.value=a},toJSON:function(a){return a.toJSONString()},fromJSON:function(a){return a.parseJSON()}};function getCookie(b){if(document.cookie.length>0){var c=document.cookie.indexOf(b+"=");if(c!=-1){c=c+b.length+1;var a=document.cookie.indexOf(";",c);if(a==-1){a=document.cookie.length}return unescape(document.cookie.substring(c,a))}}return""}function getSessionUserName(){var a=getCookie("username");if(a==null||a.length==0){a=""}return a}function $is(a){return typeof a!="undefined"}function $I(b,c,a){b=$PT(b);if(!b){return null}var d=(["input","textarea","option"].include(b.tagName.toLowerCase()))?"value":"innerHTML";return $is(c)?(a)?b[d]+=c:b[d]=c:b[d]}function getSetParam(c,g){var f=location.search.toString();if(!f){return null}f=f.substring(1).split("&");var a,d=false;for(var b=0;b<f.length;b++){a=f[b].split("=");if(c==a[0]){if(typeof g=="undefined"){return a[1]}f[b]=c+"="+g;d=true;break}}if(!d){f.push(c+"="+g)}f="?"+f.join("&");return(typeof g=="undefined")?f:""}function initComposeField(){var a=getSetParam("to");if(!a){return}fxAjax.sendRequest(fxVars.getUserId+a,{contentType:"application/json",params:{username:a},loader:true,callback:"initComposeFieldResponse"})}function initComposeFieldResponse(b,c){if(!b.error){var a=b.user;jQuery("#username-select").empty().append(jQuery("<option/>").val(a.uid).text(a.userName)).val(a.uid).trigger("change")}}function reloadAds(){try{_gaq.push(["_trackPageview",window.location.pathname]);googletag.pubads().refresh([slot1,slot2])}catch(a){}}function setShortcutIcon(){var a=document.createElement("link");a.type="image/x-icon";a.rel="shortcut icon";a.href=staticServerPath+"/images/favicon.ico";document.getElementsByTagName("head")[0].appendChild(a)}function ajaxPaging(a,c,h,g,f,k,b,l){if(g){dhtmlHistory.add(a,"")}if(typeof(l)=="undefined"){l=true}var d=getComboValue("formatSlTpHistory");fxAjax.sendRequest(fxVars.pagingUrl+a,{contentType:"text/xhtml",params:{container:c,runAjaxScripts:f,reloadAds:k,scrollToTop:b,slTpOption:d},loader:l,callback:"ajaxPagingResponse"});return false}function ajaxPagingResponse(a,b){if(b.container=="postsCont"){cleanAutocompleteAll()}$PT(b.container).innerHTML=a;if(b.runAjaxScripts){runAjaxScripts(a)}if(quotePostId!=-1){getPost(quotePostId)}if(b.scrollToTop){Effect.ScrollTo("wrapper")}if(b.reloadAds){reloadAds()}if(b.slTpOption!=undefined){showHideSlTpOptions(b.slTpOption,"")}setShortcutIcon()}function runAjaxScripts(html){try{var temp=html;while(true){var sindex=temp.indexOf("<script");if(sindex<0){break}var eindex=temp.indexOf("<\/script>",sindex);var js=temp.substring(sindex+31,eindex);try{eval(js)}catch(e){}temp=temp.substring(eindex+9)}}catch(e){}}function showLoading(){if($PT("loadingTop")!=null){$PT("loadingTop").style.display=""}}function hideLoading(){if($PT("loadingTop")!=null){$PT("loadingTop").style.display="none"}}var fxAjax={sendRequest:function(url,options){if(!options.method){options.method="GET"}if(!options.contentType){options.contentType="text/xml"}if(!options.returnJson){options.returnJson=false}if(options.loader){showLoading()}var request=jQuery.ajax({type:options.method,url:url,data:((hasText(options.postBody))?options.postBody+"&":"")+"z="+Math.random(),error:function(){if(options.loader){hideLoading()}},complete:function(response){var responseData;var contentType=response.getResponseHeader("Content-Type");if(options.returnJson){response.responseXML=jQuery.parseXML(response.responseText);responseData={};responseData.response=response.responseXML.getElementsByTagName("response")[0];responseData.error=eval(responseData.response.getAttribute("error"));responseData.message=responseData.response.getAttribute("message");responseData.content=getContent(responseData.response)}else{if(contentType.indexOf("text/xml")!=-1){response.responseXML=jQuery.parseXML(response.responseText);responseData=response.responseXML}else{if(contentType.indexOf("json")!=-1){responseData=hasText(response.responseText)?eval("("+response.responseText+")"):""}else{responseData=response.responseText}}}try{var callback=(options.callback)?eval(options.callback):null;if(typeof callback=="function"){callback(responseData,options.params)}}catch(exception){}if(options.loader){hideLoading()}}})}};function addPost(c,b,a){if(validate("text",VALID_TEXT)&&validate("text",VALID_EMOJI)){$PT(a).disabled="disabled";var d=["&typeId=",c,"&topicId=",b,"&text=",encodeParameter($PT("text").value),"&files=",encodeParameter(filesUploaded.join(","))].join("");fxAjax.sendRequest(fxVars.addPost,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:d,method:"post",loader:true,callback:"addPostResponse"})}}function addPostResponse(b){reloadAds();$PT("postsCont").innerHTML=b;cleanAutocompleteAll();runAjaxScripts(b);filesUploaded=[];var a=$PT("currentPageUrl").value;if(getPageNumber()!=gup("p",a)){dhtmlHistory.add(a,null)}}function getPageNumber(){var b=dhtmlHistory.currentLocation;if(b.length!=0){return parseInt(gup("p"))}else{b=window.location.href;var c=b.substring(b.lastIndexOf("/")+1);var a=c.split(",");if(a.size()==1){return 1}return parseInt(a[1])}}function addTopic(a,b){window.location.href="/community/"+a+"/"+b+"/add"}function moveTopic(b,a){var c=$F("forumType"+a);if(c!=0){if(confirm("Move topic ?")){var d=["&typeId=",b,"&topicId=",a,"&newTypeId=",c];fxAjax.sendRequest(fxVars.moveTopic+d.join(""),{contentType:"text/xml",params:{topicId:a,newTypeId:c},loader:true,callback:"moveTopicResponse"})}else{selectOptionByValue($PT("forumType"+a),b)}}}function moveTopicResponse(c,d){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");if(b=="false"){alert("Topic was moved successfully ");$PT("forumType"+d.topicId).onchange=function(){moveTopic(d.newTypeId,d.topicId)};$PT("topicRow"+d.topicId).remove()}else{alert("Error, moving topic failed")}}function reloadCaptcha(){$PT("captchaImg").src="/Captcha.jpg?rand="+Math.random()}function addAccountWatch(a,b){fxAjax.sendRequest(fxVars.addAccountWatchUrl+[a,"&invitation=",b].join(""),{params:{oid:a,invitation:b},loader:true,callback:"addAccountWatchResponse"})}function addAccountWatchResponse(a,h){var b=a.error;var c=a.content.data;var g=a.content.menu;if(!b){$PT("accountsNav").innerHTML=g;runAjaxScripts(g);var f=parseInt($PT("totalTracking").innerHTML);$PT("totalTracking").innerHTML=f+1;$PT("buttAccountWatch").innerHTML="<span class='minus'>"+$F("rfwl")+"</span>";$PT("buttAccountWatch").onclick=function(){removeAccountWatchMessageSystemPage(c,false,h.invitation)};showElement("displayAccountWatchComment");$PT("displayComment").innerHTML=$T("tYourCommentIsEmpty");$PT("addComment").onclick=function(){addCommentWatch(c,"s")};showElement("commentDiv");hideElement("files");if(hasText($PT("tracking").innerHTML)){$PT("tracking").innerHTML=""}}else{var d=a.getAttribute("message");inlineMsg("buttAccountWatch","<b>Error</b><br>"+d,3)}}function removeAccountWatchMessage(b,a,c){inlineAlert($PT("watchRemoveButt"+b),$T("tConfirmWatchDelete"),"removeAccountWatch("+b+","+a+",'"+c+"')")}function removeAccountWatch(b,a,c){if($PT("totalTracking")){var d=parseInt($PT("totalTracking").innerHTML);$PT("totalTracking").innerHTML=d-1;if(hasText($PT("tracking").innerHTML)){$PT("tracking").innerHTML=""}}fxAjax.sendRequest(fxVars.removeAccountWatchUrl+b,{params:{oid:b,personal:a,invitation:c},loader:true,callback:"removeAccountWatchResponse"})}function removeAccountWatchResponse(d,c){var g=d.error;var f=d.content.data;var a=d.content.menu;if(!g){if(c.personal==undefined){hideElement("buttAccountWatch")}else{if(c.personal){var b=$PT("watchRemoveButt"+c.oid);var l=b.parentNode.parentNode.parentNode;var m=b.parentNode.parentNode;var k=$$PT("#watchTable tr[name=watchedCommentTR"+c.oid+"]")[0];l.deleteRow(m.rowIndex);l.deleteRow(k.rowIndex);m.hide();var h=parseInt($PT("watchedTotalSpan").innerHTML);$PT("watchedTotalSpan").innerHTML=h-1;if(l.rows.length==1){$J("#watched").remove();$J("#myWatchedTab").remove();switchTab("tabs7","my",$J("#myAccountsTab")[0])}SortableTable.find()}else{$PT("buttAccountWatch").innerHTML="<span class='plus'>"+$F("atwl")+"</span>";$PT("buttAccountWatch").onclick=function(){addAccountWatch(f,c.invitation)};$PT("files").innerHTML="";$PT("sfiles").innerHTML="";$PT("displayAccountWatchComment").style.display="none";$PT("textAccountWatchComment").style.display="none";$PT("textComment").value="";hideElement("commentDiv")}}$PT("accountsNav").innerHTML=a;runAjaxScripts(a)}}function searchSystemsSort(d,c,k,b){var h=d.parentNode.parentNode.id;var a=d.getAttribute("order");var g=$PT(h).getElementsByTagName("td");if(a=="1"){for(i=0;i<g.length;i++){g[i].className=""}}else{for(i=0;i<g.length;i++){g[i].className=""}}var f=collectSearchParamters();dhtmlHistory.add("#?pt=6&p=1&st="+a+"&sb="+k+"&"+f.join(""),"");fxAjax.sendRequest(fxVars.pagingUrl+"?"+f.join("")+"&pt="+c+"&st="+a+"&sb="+k,{contentType:"text/html",params:b,loader:true,callback:"searchSystemsSortResponse"})}function searchSystemsSortResponse(b,a){$PT(a).innerHTML=b;runAjaxScripts(b)}function sortTableResponse(b,a){replaceTbodyContent(b,a)}function replaceTbodyContent(a,h){var g=$PT(h).innerHTML;var c=g.toLowerCase().indexOf("<tbody>")+8;var b=g.toLowerCase().indexOf("</tbody>");var f=g.substring(0,c);var d=g.substring(b,g.length);$PT(h).innerHTML=f+a+d}function validateContact(){if(validate("name",VALID_NAME)&&validate("email",VALID_EMAIL)&&validate("msgContact",VALID_MESSAGE)){var a=["name=",$PT("name").value,"&email=",$PT("email").value,"&subject=",$PT("subject").value,"&msgContact=",encodeParameter($PT("msgContact").value)];fxAjax.sendRequest(fxVars.contact,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:a.join(""),method:"post",params:{},loader:false,callback:"validateContactResponse"});$PT("contact").style.display="none";$PT("spinnerLoader").style.display=""}}function validateContactResponse(){$PT("spinnerLoader").style.display="none";$PT("contactRes").style.display=""}function validateAddTopic(){var a=false;$PT("title").value=$PT("titleHold").value;$PT("text").value=$PT("textHold").value;$PT("files").value=filesUploaded.join(",");if(validate("titleHold",VALID_EMOJI)&&validate("textHold",VALID_EMOJI)){a=validate("titleHold",VALID_TITLE)&&validate("textHold",VALID_TEXT);if(a){$PT("addTopicButton").disabled="disabled"}}return a}function validateComposeMail(d){if(suspendedPass(d)&&validate("username-select",VALID_COMPOSE_TO)&&validate("subject",VALID_TITLE)&&validate("text",VALID_TEXT)&&validate("text",VALID_EMOJI)&&validate("subject",VALID_EMOJI)){var a=jQuery("#subject").val();var c=jQuery("#text").val();var b=jQuery("#username-select").select2("val");jQuery("#subjectHold").val(a);jQuery("#textHold").val(c);jQuery("#idsHold").val(b);jQuery("#files").val(getLinksTitleByName("orderFiles"));$PT("inboxComposeForm").submit()}}function validateRegister(){if(validate("username",VALID_USER_NAME)&&validate("email",VALID_EMAIL)&&validate("password",VALID_PASSWORD)&&validate("passwordConfirm",VALID_PASSWORD_CONFIRM2)&&validate("captcha",VALID_CAPTHCA)&&validate("agree",VALID_AGREE)){register()}}function register(){$PT("openAccount").disabled="disabled";var a=["username=",$PT("username").value,"&email=",$PT("email").value,"&password=",encodeParameter($PT("password").value),"&captcha=",$PT("captcha").value];fxAjax.sendRequest(fxVars.regUrl,{method:"post",postBody:a.join(""),contentType:"text/xml",params:{registrationRedirect:window.location.href},loader:true,callback:"registerResponse"})}function registerResponse(f,g){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=a.getAttribute("code");var c=a.getAttribute("message");if(b=="false"){$PT("register").innerHTML="<div class='font12 lh18 center' style='margin-top:120px; padding: 0 20px;'>"+c+"</div>";if(getcTraderAuthRedirectUrl(undefined)!=undefined){setCookie("reglr",g.registrationRedirect,YEAR,true);setCookie("rat",1,YEAR,true)}}else{if(d==30){inlineMsg("username","<b>"+$T("tError")+"</b><br>"+c,3)}if(d==7){inlineMsg("captcha","<b>"+$T("tError")+"</b><br>"+c,3);reloadCaptcha();clearField("captcha")}if(d==13){inlineMsg("openAccount","<b>"+$T("tError")+"</b><br>"+c,3)}if(d==8||d==101){inlineMsg("email","<b>"+$T("tError")+"</b><br>"+c,3)}$PT("openAccount").disabled=""}}function disable(b){try{$PT(b).disabled="disabled"}catch(a){}}function enable(b){try{$PT(b).disabled=""}catch(a){}}function login(){if(validate("loginEmail",VALID_EMAIL)&&validate("loginPassword",VALID_PASSWORD)){disable("loginButton");var a=["loginEmail=",$PT("loginEmail").value,"&loginPassword=",encodeParameter($PT("loginPassword").value),"&remember=",$PT("remember").checked];fxAjax.sendRequest(fxVars.loginUrl,{method:"post",postBody:a.join(""),contentType:"text/xml",params:{loginRedirect:getcTraderAuthRedirectUrl(gup("lr"))},loader:true,callback:"loginResponse"})}}function loginResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){if(hasText(f.loginRedirect)&&checkLoginRedirectLink(f.loginRedirect)){window.location=f.loginRedirect}else{window.location=httpServerPath+"/dashboard"}}else{$PT("response").innerHTML=c;enable("loginButton")}}function checkLoginRedirectLink(c){var a=/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n?]+)/img;var b=new RegExp(a);var d=c.match(b);try{return typeof d==="object"&&(Object.values(d).indexOf(serverPath)>-1||Object.values(d).indexOf(httpServerPath)>-1)}catch(f){console.error("checkLoginRedirectLink - "+f);return false}}function resendActivation(){if(validate("emailActivation",VALID_EMAIL)){var a=["email=",$PT("emailActivation").value];fxAjax.sendRequest(fxVars.resendActivationUrl+a.join(""),{contentType:"text/xml",params:{},loader:false,callback:"resendActivationResponse"});$PT("activationCont").style.display="none";$PT("spinner").style.display=""}}function resendActivationResponse(d){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");$PT("spinner").style.display="none";$PT("activationResponse").style.display="";if(b=="false"){$PT("activationResponse").innerHTML=$T("tActivationEmailResent")}else{$PT("activationResponse").innerHTML=c}}function forgotPassword(){if(validate("emailForgot",VALID_EMAIL)){var a=["email=",$PT("emailForgot").value];$PT("forgotCont").style.display="none";$PT("spinner").style.display="";fxAjax.sendRequest(fxVars.forgotPasswordUrl,{method:"post",postBody:a.join(""),contentType:"text/xml",params:{},loader:false,callback:"forgotPasswordResponse"})}}function forgotPasswordResponse(d){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");$PT("spinner").style.display="none";$PT("forgotResponse").style.display="";$PT("forgotResponse").innerHTML=c;$PT("forgotClose").style.display=""}function resetPassword(){if(validate("password",VALID_PASSWORD)&&validate("passwordConfirm",VALID_PASSWORD_CONFIRM2)){var a=["code=",$PT("forgotCode").value,"&id=",$PT("forgotId").value,"&password1=",encodeParameter($PT("password").value),"&password2=",encodeParameter($PT("passwordConfirm").value)];fxAjax.sendRequest(fxVars.resetPasswordUrl+a.join(""),{contentType:"text/xml",params:{},loader:true,callback:"resetPasswordResponse"})}}function resetPasswordResponse(d){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");$PT("resetResponse").innerHTML=c;$PT("resetResponse").style.display=""}function changePassword(){if(validate("oldPassword",VALID_PASSWORD)&&validate("password1",VALID_PASSWORD)&&validate("password2",VALID_PASSWORD)&&validate("password1",VALID_PASSWORD_CONFIRM)){var a=["oldPassword=",encodeParameter($PT("oldPassword").value),"&password1=",encodeParameter($PT("password1").value),"&password2=",encodeParameter($PT("password2").value)];fxAjax.sendRequest(fxVars.changePasswordUrl,{method:"post",postBody:a.join(""),contentType:"text/xml",params:{},loader:true,callback:"changePasswordResponse"})}}function changePasswordResponse(data){var response=data.getElementsByTagName("response")[0];var error=eval(response.getAttribute("error"));$PT("responsePass").innerHTML=response.getAttribute("message");$PT("responsePass").style.display="";if(!error){$PT("oldPassword").value="";$PT("password1").value="";$PT("password2").value=""}}function changeEmail(){if(validate("password",VALID_PASSWORD)&&validate("email",VALID_EMAIL)){var a=["password=",encodeParameter($PT("password").value),"&email=",$PT("email").value];fxAjax.sendRequest(fxVars.changeEmailUrl,{method:"post",postBody:a.join(""),contentType:"text/xml",params:{},loader:true,callback:"changeEmailResponse"})}}function changeEmailResponse(c){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");$PT("responseEmail").innerHTML=a.getAttribute("message");$PT("responseEmail").style.display="";if(!b){$PT("paswword").value="";$PT("email").value=""}}var INBOX=1;var SENT=2;var READ_INBOX=3;var READ_SENT=4;function deleteSelected(f,d){var c=[];var a;if(d==INBOX){a=document.getElementsByName("messagesInbox")}else{a=document.getElementsByName("messagesSent")}for(var b=0;b<a.length;b++){if(a[b].checked){c.push(a[b].value)}}if(c.length!=0){var g=["deleteMessage(","'",c.join("-"),"'",",",d,")"];inlineAlert(f,$T("tConfirmMessageDelete"),g.join(""))}}function deleteMessageVerify(b,d,a){var c=["deleteMessage(","'",d,"'",",",a,")"];inlineAlert(b.id,$T("tConfirmMessageDelete"),c.join(""))}var SELECT_NONE=0;var SELECT_READ=1;var SELECT_UNREAD=2;var SELECT_ALL=3;function selectMessages(el,from){var cb=document.getElementsByName("messages"+from);for(var i=0;i<cb.length;i++){switch(eval(el.value)){case SELECT_NONE:cb[i].checked=false;break;case SELECT_READ:cb[i].checked=cb[i].parentNode.parentNode.className.indexOf("old")!=-1;break;case SELECT_UNREAD:cb[i].checked=cb[i].parentNode.parentNode.className.indexOf("new")!=-1;break;case SELECT_ALL:cb[i].checked=true;break}}}function deleteMessage(c,a){var b=["&type=",a,"&id=",c].join("");switch(a){case INBOX:fxAjax.sendRequest(fxVars.deleteMessageUrl+b,{contentType:"text/xhtml",params:{cont:"inboxCont",id:c},loader:true,callback:"deleteResponse"});break;case SENT:fxAjax.sendRequest(fxVars.deleteMessageUrl+b,{contentType:"text/xhtml",params:{cont:"sentCont"},loader:true,callback:"deleteResponse"});break;case READ_INBOX:case READ_SENT:fxAjax.sendRequest(fxVars.deleteMessageUrl+b,{contentType:"text/xhtml",loader:true,callback:"returnToInbox"});break}}function deleteResponse(g,k){var a=g.getElementsByTagName("response")[0];var b=a.getAttribute("error");var f=a.getAttribute("message");var d=getContent(g.getElementsByTagName("data")[0]);var c=parseInt(getContent(g.getElementsByTagName("inboxCount")[0]));if(b=="false"){$PT(k.cont).innerHTML=d;if(c==0){$PT("newInboxNotification").innerHTML=0;$PT("newInboxNotification").className="countRed grayBG"}else{$PT("newInboxNotification").innerHTML=c}var h=$PT("aConOid"+k.id);if(h!=undefined){h.remove()}runAjaxScripts(d)}}function returnToInbox(){window.location="/inbox"}function encodeParameter(a){return(encodeURI(a).replace(/&/g,"%26").replace(/=/g,"%3D").replace(/\+/g,"%2B").replace(/#/g,"%23").replace(/\?/g,"%3F").replace(/\:/g,"%3A"))}function reply(c){if(validate("message",VALID_TEXT)&&validate("message",VALID_EMOJI)){$PT("replyButton").disabled="disabled";var b=["&id=",c,"&message=",encodeParameter($PT("message").value)];var a=getLinksTitleByName("orderFiles"+c);if(hasText(a)){b.push("&files=");b.push(a)}fxAjax.sendRequest(fxVars.inboxReply,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:b.join(""),loader:true,callback:"replyResponse"})}}function getContent(a){try{return typeof a.textContent!="undefined"?a.textContent:a.childNodes[0].nodeValue}catch(b){return""}}function replyResponse(d){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");var d=getContent(a);if(b=="false"){$PT("messageCont").innerHTML=d;runAjaxScripts(d)}else{inlineMsg("message",c,3)}$PT("replyButton").disabled="";Tipped.hideAll()}function editAccount(a){$PT("oldAccountId").value=a;$PT("oldPassword").value=$PT("password"+a).innerHTML;$PT("oldServerId").value=$PT("server"+a).getAttribute("serverId");$PT("accountId").value=a;$PT("password").value=$PT("password"+a).innerHTML;$PT("serverId").selectedIndex=$PT("server"+a).getAttribute("serverId");if($PT("public"+a).getAttribute("value")=="true"){$PT("public").checked="checked"}else{$PT("public").checked=""}if($PT("historyPublic"+a).getAttribute("value")=="true"){$PT("historyPublic").checked="checked"}else{$PT("historyPublic").checked=""}}function borderChange(a){$PT(a).style.border="1px solid #FFA962"}function borderReturn(a){$PT(a).style.border="1px solid #e2e1e1"}function rateBroker(a){if(isRated()){var b=["brokerId="+a,"&platform=",$PT("platform").value,"&spreads=",$PT("spreads").value,"&service=",$PT("service").value,"&features=",$PT("features").value].join("");fxAjax.sendRequest(fxVars.rateBroker+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function rateEA(a){if(isRated()){var b=["eaId="+a,"&profitability=",$PT("profitability").value,"&pricing=",$PT("pricing").value,"&service=",$PT("service").value,"&use=",$PT("use").value].join("");fxAjax.sendRequest(fxVars.rateEA+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function rateSignal(a){if(isRated()){var b=["signalId="+a,"&profit=",$PT("profit").value,"&pricing=",$PT("pricing").value,"&service=",$PT("service").value,"&platform=",$PT("platform").value].join("");fxAjax.sendRequest(fxVars.rateSignal+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function voteSuggestion(b,a){var c=["topicId="+b,"&vote=",a].join("");fxAjax.sendRequest(fxVars.vote+c,{contentType:"text/xml",params:"suggestCont",loader:true,callback:"voteSuggestionResponse"})}function voteSuggestionResponse(b,a){if(!b.error){$PT(a).innerHTML=b.content.data;runAjaxScripts(b.content.data);drawBasicChart("chartdiv",b.content.updatedChartData)}}function userInfo(){var c=$PT("dstOn").checked;var a=$PT("timezoneoffset").value;var b=$PT("timeAutoOn");if(b!=null&&b.checked){c=false;a=getTimezoneOffset()}fxAjax.sendRequest(fxVars.userInfo,{callback:"userInfoResponse",contentType:"text/xml",loader:true,method:"POST",params:{timeZone:a,dst:c},postBody:["countryId=",$PT("countryId").value,"&bio=",encodeParameter($PT("bio").value),"&experience=",$PT("experience").value,"&tradingStyle=",encodeParameter($PT("tradingStyle").value),"&motto=",encodeParameter($PT("motto").value),"&name=",encodeParameter($PT("name").value),"&timezone=",a,"&dst=",c,"&timeFormat=",$F("timeFormat"),"&timeAuto=",$PT("timeAutoOn").checked].join("")})}function userInfoResponse(c,f){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");$PT("profileMessage").innerHTML=a.getAttribute("message");$PT("profileMessage").style.display="";try{$PT("avatarChange").style.display="none";uploadPic()}catch(d){}setTimeZoneCookie(f.timeZone);setCookie("dst",f.dst?"1":"0",YEAR,false);cookieCache={}}function uploadPic(){if($PT("file").value.length>4){$PT("profilePic").submit()}}function updateProfilePic(b,c,a){$PT("profileImg").src=a;try{$J("#profilePic #profileImg").attr("src",a)}catch(d){}}function validateAddAccount(){var b=$PT("serverId").value;var a=$PT("platformId").value;var c=true;if(a==0&&!$PT("platformId").disabled){inlineMsg("platformId",$T("tChoosePlatform"),3);c=false}else{if(b==0&&!$PT("serverId").disabled){inlineMsg("serverId",$T("tChooseBroker"),3);c=false}else{if(!validate("systemName",VALID_SYSTEM_NAME)){c=false}else{if(a==PLATFORM_OANDA&&!validate("url",VALID_ACCOUNT_HISTORY_URL)){c=false}else{if(c){addUpdateAccount()}}}}}}function isValidUrl(b){var c=/^(https?:\/\/)?([\da-z\.-]+)\.(com|ru|net|de)((\?|\/)([\/\w \.-]*))*/i;var a=b.replace(/\s/g,"");return c.test(a)}function addUpdateAccount(){$PT("save").disabled="disabled";var b=$PT("accountOid").value;var a=$PT("systemName").value;var d=($PT("accountId"))?$F("accountId"):"";var c=["&accountId=",d,"&accountOid=",b,"&serverId=",$PT("serverId").value,"&platformId=",$PT("platformId").value,"&url=",encodeParameter($PT("url").value),"&systemName=",encodeParameter(a),"&systemDescription=",encodeParameter($PT("systemDescription").value),"&systemType=",$PT("systemType").value,"&tradingType=",$PT("tradingType").value,"&type=",$PT("type").value,"&leverage=",$PT("leverage").value];if($$PT("[name=accountPublic]").size()>0){c.push("&accountPublic="+getRadioGroupValue("accountPublic"))}c.push("&accountNumberPublic="+getRadioGroupValue("accountNumberPublic"));c.push("&balancePublic="+getRadioGroupValue("balancePublic"));c.push("&historyPublic="+getRadioGroupValue("historyPublic"));c.push("&ordersPublic="+getRadioGroupValue("ordersPublic"));c.push("&tradesPublic="+getRadioGroupValue("tradesPublic"));c.push("&commentsPublic="+getRadioGroupValue("commentsPublic"));c.push("&sizingPublic="+getRadioGroupValue("sizingPublic"));c.push("&magicNumberPublic="+getRadioGroupValue("magicNumberPublic"));c.push("&accountTagPublic="+getRadioGroupValue("accountTagPublic"));c.push("&goalsPublic="+getRadioGroupValue("goalsPublic"));c.push("&slTpPublic="+getRadioGroupValue("slTpPublic"));if($PT("mt4ServerId")!=null){c.push("&mt4ServerId="+$PT("mt4ServerId").value)}if($PT("investorPassword")!=null){c.push("&investorPassword="+encodeParameter($PT("investorPassword").value))}if($PT("updateIntervalBox")!=null){c.push("&updateInterval=",$F("updateIntervalBox"))}c.push(collectMagicNames());fxAjax.sendRequest(fxVars.addUpdateAccount,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:c.join(""),params:{cont:"myAccounts",name:a,oid:b},loader:true,callback:"addUpdateAccountResponse"})}function addUpdateAccountResponse(g,d){try{$PT("save").disabled="";var f=g.getElementsByTagName("response")[0];var c=g.getElementsByTagName("accounts")[0];var b=g.getElementsByTagName("menu")[0];var k=g.getElementsByTagName("twitterAccountsCombo")[0];var l=f.getAttribute("error");var m=f.getAttribute("message");var a=f.getAttribute("code");if(l=="false"){$PT("accountsDiv").innerHTML=getContent(c);$PT("accountsNav").innerHTML=getContent(b);$PT("twitterAccountComboCont").innerHTML=getContent(k);runAjaxScripts(getContent(c));runAjaxScripts(getContent(b))}else{if(a!=43){$PT("accountResponse").innerHTML=m}else{inlineMsg("url",m)}}reloadAds()}catch(h){}}function collectMagicNames(){var elements=document.getElementsByName("magicNumbers");var colorElements=document.getElementsByName("magicColors");var originalElements=document.getElementsByName("originalMagicNumbers");var originalColorElements=document.getElementsByName("originalMagicColors");var magicHideElement=document.getElementsByName("magicShowBox");var str=[];for(var i=0;i<elements.length;i++){var name=$PT(elements[i].id).value;var originalShowBox=$PT(magicHideElement[i]).value;var originalName=$PT(originalElements[i].id).value;var color=colorElements[i].getAttribute("hex");var originalColor=originalColorElements[i].value;var showMagic=magicHideElement[i].checked;if(name!=originalName||color!=originalColor||eval(originalShowBox)!=showMagic){str.push("&magicOids=");str.push(elements[i].id.substr(5));str.push("&magicNames=");str.push(encodeParameter(name));str.push("&magicColors=");str.push(color);str.push("&magicShow=");str.push(showMagic)}}return str.join("")}function deleteAccountVerify(g,c,f){var b=$J("#settingsAccount"+g).attr("portfolioOid");var a=$J("#settingsAccount"+g).attr("portfolioAccountOid");var h="";if(f){h=$T("tDeleteAutoTradeParticipates")+"<br/><br/>"}var d=["deleteAccount('",g,"','",b,"','",a,"')"];inlineAlert(c,h+$T("tConfirmAccountDelete")+"<br/><br/><div class='center'><span class='exclamation'>"+$T("tCannotUndo")+"</span></div>",d.join(""))}function deleteAccount(c,b,a){fxAjax.sendRequest(fxVars.deleteAccount+c+"&portfolioAccountOid="+a+"&portfolioOid="+b,{contentType:"text/xml",params:{oid:c,portfolioOid:b},loader:true,callback:"deleteAccountResponse"})}function deleteAccountResponse(h,f){var g=h.getElementsByTagName("response")[0];var k=g.getAttribute("error");var l=g.getAttribute("message");var b=g.getAttribute("code");var d=h.getElementsByTagName("accounts")[0];var c=h.getElementsByTagName("menu")[0];var a=getContent(h.getElementsByTagName("slaveDeleted")[0]);if(k=="false"){$PT("accountsDiv").innerHTML=getContent(d);$PT("accountsNav").innerHTML=getContent(c);runAjaxScripts(getContent(d));runAjaxScripts(getContent(c));if(a=="true"){removeElement("autoTradeMenu"+f.oid)}}}function getRadioGroupValue(c){var a=false;var b=document.getElementsByName(c);if(b.length!=0){if(b[1].checked){a=true}}return a}function getRadioValue(c){var b=document.getElementsByName(c);for(var a=0;a<b.length;a++){if(b[a].checked){return b[a].value}}}function setSettingsActiveTab(){var a=window.location.hash;if(a.length!=0){var d=a.substring(1,a.length);var f=getSettingsActiveTab(d+"Div");var c=$PT("settingsTab").getElementsByTagName("li");for(var b=1;b<c.length;b++){if(f==b){c[b].className="on"}else{c[b].className="off"}}for(var b=0;b<tabs6.length;b++){if(tabs6[b]==(d+"Div")){$PT(tabs6[b]).style.display=""}else{$PT(tabs6[b]).style.display="none"}}}else{window.location.hash="accounts"}}function getSettingsActiveTab(a){if(a=="accountsDiv"){return 1}else{if(a=="privacyDiv"){return 2}else{if(a=="profileDiv"){return 3}else{if(a=="loginDetailsDiv"){return 4}else{if(a=="subscriptionsDiv"){return 5}else{if(a=="twitterDiv"){return 6}else{if(a=="invitationsDiv"){return 7}else{if(a=="blockDiv"){return 8}}}}}}}}}function switchButton(a){var c=a.parentNode;var b=c.getElementsByTagName("li");for(i=0;i<b.length;i++){if(a==b[i]){b[i].className="active"}else{b[i].className=""}}}function switchMode(b){var a=document.getElementsByClassName("control");for(i=0;i<a.length;i++){if(b==0){a[i].disabled=true;if(i%2==0){a[i].checked=true}}else{if(b==1){a[i].disabled=false}}}}var VALID_USER_NAME=1;var VALID_EMAIL=2;var VALID_PASSWORD=3;var VALID_NAME=4;var VALID_MESSAGE=5;var VALID_TITLE=6;var VALID_TEXT=7;var VALID_URL=8;var VALID_ACCOUNT_PASSWORD=9;var VALID_SYSTEM_NAME=10;var VALID_SERVER=11;var VALID_PASSWORD_CONFIRM=12;var VALID_AGREE=13;var VALID_COMPOSE_TO=14;var VALID_PLATFORM=15;var VALID_PASSWORD_CONFIRM2=16;var VALID_CAPTHCA=17;var VALID_SEARCH=18;var VALID_PORTFOLIO_NAME=19;var VALID_INTEGER=20;var VALID_COUNTRY=21;var VALID_AGREE_CONTEST=22;var VALID_PHONE_CONTEST=23;var VALID_NAME_1_CHAR=24;var VALID_ACCOUNT=25;var VALID_DOUBLE=26;var VALID_INTEGER_OR_EMPTY=27;var VALID_DOUBLE_POSITIVE=28;var VALID_PROFILE=29;var VALID_NUMBER=30;var VALID_ABSOLUTE_NUMBER=31;var VALID_EN_NAME=32;var VALID_MASTER_PASSWORD=33;var VALID_MASTER_IDENCTICAL_INVESTOR_PASSWORD_CONFIRM=34;var VALID_PERCENT=35;var VALID_DOUBLE_POSITIVE_WITHOUT_ZERO=36;var VALID_INTEGER_POSITIVE_WITHOUT_ZERO=37;var VALID_PERCENT_WITHOUT_ZERO=38;var VALID_ACCOUNT_TYPE=39;var VALID_YEAR=40;var VALID_INTER_PHONE=41;var VALID_CHECKBOXES=42;var VALID_DROPDOWN=43;var VALID_ADDRESS=44;var VALID_ACCOUNT_HISTORY_URL=45;var VALID_INTERNATIONAL_OFFICES=46;var VALID_PASSWORD_CONFIRM3=47;var VALID_PERCENT_NON_SIGN=48;var VALID_NUMBER_NON_SIGN=49;var VALID_DOUBLE_POSITIVE_MORE_THAN=50;var VALID_PERCENT_WITH_SIGN=51;var VALID_DOUBLE_POSITIVE_LESS_THAN=52;var VALID_DATE=53;var VALID_EMOJI=54;var DEFAULT_LEVERAGE=100;var VALID_AGREE_EMAIL_CONTEST=55;var MAX_VALUE_TO_WITHDRAW=56;function validate(b,q,f){var g=true;var d,r;try{d=$PT(b).value}catch(o){}switch(q){case VALID_USER_NAME:r=/^[a-zA-Z0-9_]{4,16}$/;if(d==""){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br />"+$T("tChooseUserName"),3);g=false}else{if(!d.match(r)){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br />"+$T("tInvalidUserName")+"<br/>"+$T("tUseOnlyDigits"),4);g=false}}break;case VALID_EMAIL:r=/^[\w-\.]+@([\w-]+\.)+[\w-]{2,}$/;if(d==""){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br />"+$T("tMustEnterEmail"),3);g=false}else{if(!d.match(r)){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br />"+$T("tInvalidEmail"),3);g=false}}break;case VALID_PASSWORD:r=/^.{4,20}$/;if(d==""){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br />"+$T("tMustEnterPassword"),3);g=false}else{if(!d.match(r)){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br />"+$T("tInvalidPassword"),3);g=false}}break;case VALID_NAME:if(d==""){inlineMsg(b,$T("tEnterName"),3);g=false}break;case VALID_EN_NAME:r=/^[a-zA-Z ]+$/;try{d=d.trim()}catch(o){}if(d==""){inlineMsg(b,$T("tEnterName"),3);g=false}else{if(!d.match(r)){inlineMsg(b,$T("tEnterEnglishOnly"),3);g=false}}break;case VALID_MESSAGE:if(d==""){inlineMsg(b,$T("tEnterMessage"),3);g=false}break;case VALID_TITLE:r=/^.{3,}$/;if(!(d.replace(/^\s\s*/,"").replace(/\s\s*$/,"")).match(r)){inlineMsg(b,$T("tEnterTitleName"),3);g=false}break;case VALID_TEXT:if(d.trim()==""){inlineMsg(b,$T("tOops")+"<br>"+$T("tNoTextEntered"),3);g=false}break;case VALID_ACCOUNT_HISTORY_URL:if(d==""){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br />"+$T("tMustEnterAccountHistory"),3);g=false}break;case VALID_ACCOUNT_PASSWORD:if(d==""){inlineMsg(b,$T("tEnterReadOnlyPassword"),3);g=false}break;case VALID_SYSTEM_NAME:r=/^.{3,}$/;var s=!(d.replace(/^\s\s*/,"").replace(/\s\s*$/,"")).match(r);var u=isValidUrl(d);var k=d.length>45;if(s||u||k){g=false;if(s){inlineMsg(b,$T("tEnterNameForYourSystem"),3)}else{if(u){inlineMsg(b,$T("tEnterValidName"),3)}else{if(k){inlineMsg(b,$T("tSystemNameTooLong"),3)}}}}break;case VALID_PORTFOLIO_NAME:r=/^.{3,}$/;if(!(d.replace(/^\s\s*/,"").replace(/\s\s*$/,"")).match(r)){inlineMsg(b,$T("tEnterNameAtLeast3Char"),3);g=false}break;case VALID_SERVER:if(d==-1){inlineMsg(b,$T("tChooseBroker"),3);g=false}break;case VALID_PASSWORD_CONFIRM:var m=$PT("oldPassword").value;var l=$PT("password2").value;if(d==m){inlineMsg("password1","<strong>"+$T("tError")+"</strong><br/>"+$T("tCantUseCurrentPassword"),3);g=false}else{if(d!=l){inlineMsg("password2","<strong>"+$T("tError")+"</strong><br/>"+$T("tPasswordNoMatch"),3);g=false}}break;case VALID_PASSWORD_CONFIRM2:var m=$PT("password").value;if(d!=m){inlineMsg("passwordConfirm","<strong>"+$T("tError")+"</strong><br/>"+$T("tPasswordNoMatch"),3);g=false}break;case VALID_PASSWORD_CONFIRM3:var m=$PT("registrationDialogPassword").value;if(d!=m){inlineMsg("registrationDialogConfirmPassword","<strong>"+$T("tError")+"</strong><br/>"+$T("tPasswordNoMatch"),3);g=false}break;case VALID_AGREE:if(!$PT(b).checked){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br/>"+$T("tMustAgreeToTerms"),3);g=false}break;case VALID_COMPOSE_TO:var c=$PT(b).getElementsByTagName("li").length;if(c==1){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br/>"+$T("tMustChooseRecipient"),3);g=false}else{if(c>11){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br/>"+$T("tAllowedToChoose"),3);g=false}}break;case VALID_PLATFORM:if(d==0){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br/>"+$T("tMustSelectYourPlatform"),3);g=false}break;case VALID_CAPTHCA:if(d==""){inlineMsg(b,$T("tPleasEnterCode"),3);g=false}break;case VALID_SEARCH:if(!hasText(d)||d.trim().length<3){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br/>"+$T("tSearchPhraseMustContain3Char"),3);g=false}break;case VALID_INTEGER:r=/^[0-9]+$/;if(!d.match(r)){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br/>"+$T("tPleaseUseNumberOnly"),3);g=false}break;case VALID_COUNTRY:if(d==0){inlineMsg(b,$T("tPleaseSelectYourCountry"),3);g=false}break;case VALID_AGREE_CONTEST:if(!$PT(b).checked){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br/>"+$T("tMustAgreeToContestRules"),3);g=false}break;case VALID_PHONE_CONTEST:var h=$("#"+b);if(h.val().indexOf(phoneVerification.bulletCharacter)>-1){return true}if(h.length==0||!h.intlTelInput("isValidNumber")){inlineMsg(b,$T("tPleaseEnterValidPhone"),3);g=false}break;case VALID_NAME_1_CHAR:r=/^.{1,}$/;if(!(d.replace(/^\s\s*/,"").replace(/\s\s*$/,"")).match(r)){inlineMsg(b,$T("tPleaseEnterName"),3);g=false}break;case VALID_ACCOUNT:r=/^[0-9]+$/;if(!d.match(r)){inlineMsg(b,$T("tPleaseEnterYourAccountNumber"),3);g=false}break;case VALID_DOUBLE:r=/^[-+]?\d+(\.\d+)?$/;if(!d.match(r)&&d!=""){beforeRunFunc(f);inlineMsg(b,$T("tYouMustEnterValidNumber"),3);g=false}break;case VALID_INTEGER_OR_EMPTY:r=/^[0-9]+$/;if(!d.match(r)&&d!=""){beforeRunFunc(f);inlineMsg(b,"<strong>"+$T("tError")+"</strong><br/>"+$T("tYouMustEnterValidNumber"),3);g=false}break;case VALID_DOUBLE_POSITIVE:r=/^[+]?\d+(\.\d+)?$/;if(!d.match(r)&&d!=""){beforeRunFunc(f);inlineMsg(b,$T("tYouMustEnterValidNumber"),3);g=false}break;case VALID_PROFILE:if(d==""){inlineMsg(b,$T("tPleaseEnterName"),3);g=false}break;case VALID_NUMBER:r=/^[+]?\d+(\.\d+)?$/;if(!d.match(r)||d==""){inlineMsg(b,$T("tYouMustEnterValidNumber"),3);g=false}break;case VALID_NUMBER_NON_SIGN:r=/^\d+(\.\d+)?$/;if(!d.match(r)||d==""){inlineMsg(b,$T("tYouMustEnterValidNumber"),3);g=false}break;case VALID_ABSOLUTE_NUMBER:r=/^[+-]?\d+(\.\d+)?$/;if(!d.match(r)||d==""){inlineMsg(b,$T("tYouMustEnterValidNumber"),3);g=false}break;case VALID_MASTER_PASSWORD:if(d==""){inlineMsg(b,$T("tMustEnterMasterPassword"),3);g=false}break;case VALID_MASTER_IDENCTICAL_INVESTOR_PASSWORD_CONFIRM:var m=$PT("accountInvestorPassword").value;if(d==m){inlineMsg(b,$T("tPasswordsCannotBeIdentical"),3);g=false}break;case VALID_PERCENT:r=/^[+]?\d+(\.\d+)?$/;if(!d.match(r)||d==""||d<0||d>100){inlineMsg(b,$T("tPleaseEnterNumberBetween",[0,100]),3);g=false}break;case VALID_DOUBLE_POSITIVE_WITHOUT_ZERO:r=/^[+]?\d+(\.\d+)?$/;if(d==0||!d.match(r)&&d!=""){beforeRunFunc(f);inlineMsg(b,$T("tYouMustEnterValidNumber"),3);g=false}break;case VALID_INTEGER_POSITIVE_WITHOUT_ZERO:r=/^[0-9]+$/;if(d==0||!d.match(r)){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br/>"+$T("tPleaseUseNumberOnly"),3);g=false}break;case VALID_PERCENT_WITHOUT_ZERO:r=/^[+]?\d+(\.\d+)?$/;if(!d.match(r)||d==""||d<1||d>100){inlineMsg(b,$T("tPleaseEnterNumberBetween",[1,100]),3);g=false}break;case VALID_PERCENT_NON_SIGN:r=/^\d+(\.\d+)?$/;if(!d.match(r)||d==""||d<0||d>100){inlineMsg(b,$T("tPleaseEnterNumberBetween",[1,100]),3);g=false}break;case VALID_ACCOUNT_TYPE:if(d==0){inlineMsg(b,$T("tChooseAccountType"),2);g=false}break;case VALID_YEAR:r=/^(19[5-9]\d|20[0-4]\d|2050)$/;if(!hasText(d)||!d.match(r)){inlineMsg(b,$T("tPleaseEnterYearBetween",[1950,2050]),3);g=false}break;case VALID_INTER_PHONE:r=/^\+?([0-9]{2})\)?[-. ]?([0-9]{4})[-. ]?([0-9]{4})$/;if(!hasText(d)||!d.match(r)){inlineMsg(b,$T("tPleaseEnterValidPhone"),3);g=false}break;case VALID_CHECKBOXES:if($J("input[name='"+b+"']:checked").size()==0){inlineMsg($J("input[name='"+b+"']")[0].id,$T("tAtLeastOneOption"),3);g=false}break;case VALID_DROPDOWN:if(d==0){inlineMsg(b,$T("tPleaseSelect"),3);g=false}break;case VALID_ADDRESS:if(d.trim()==""){inlineMsg(b,$T("tEnterAddress"),3);g=false}break;case VALID_URL:if(d.trim()==""){inlineMsg(b,$T("tEnterUrl"),3);g=false}break;case VALID_INTERNATIONAL_OFFICES:if(d==0&&$J("input[name='officeCountry']").size()==0){inlineMsg(b,$T("tPleaseSelect"),3);g=false}else{if($J("input[name='officeCountry']:checked").size()==0){inlineMsg($J("input[name='officeCountry']")[0].id,$T("tAtLeastOneOption"),3);g=false}}break;case VALID_DOUBLE_POSITIVE_MORE_THAN:r=/^[+]?\d+(\.\d+)?$/;if(d<Number($PT(b).getAttribute("minValue"))||!d.match(r)&&d!=""){beforeRunFunc(f);inlineMsg(b,$T("tYouMustEnterValidNumber"),3);g=false}break;case VALID_PERCENT_WITH_SIGN:r=/^[-+]?\d+(\.\d+)?$/;if(!d.match(r)||d==""||d<-100||d>100){inlineMsg(b,$T("tPleaseEnterNumberBetween",[-100,100]),3);g=false}break;case VALID_DOUBLE_POSITIVE_LESS_THAN:case MAX_VALUE_TO_WITHDRAW:r=/^[+]?\d+(\.\d+)?$/;var t=$T("tYouMustEnterValidNumber");if(d>Number($PT(b).getAttribute("maxValue"))||!d.match(r)&&d!=""){beforeRunFunc(f);if(q==MAX_VALUE_TO_WITHDRAW){t=$T("tMaxBalanceToWithdrawIs",[Number($PT(b).getAttribute("maxValue"))])}inlineMsg(b,t,3);g=false}break;case VALID_DATE:if(d.trim()==""){inlineMsg(b,$T("tOops")+"<br>"+$T("tPleaseEnterValidDate"),3);g=false}break;case VALID_EMOJI:var a=["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]"];if(d.match(a.join("|"))){inlineMsg(b,$T("tOops")+"<br>"+$T("tTextContainsInvalidChar"),3);g=false}break;case VALID_AGREE_EMAIL_CONTEST:if(!$PT(b).checked){inlineMsg(b,"<strong>"+$T("tError")+"</strong><br/>You must agree contact be email or phone",3);g=false}break}return g}var MSGTIMER=0;var MSGSPEED=100;var MSGOFFSET=3;var MSGHIDE=3;function inlineMsg(l,k,g){var c;var m;if(!$PT("alert")){c=document.createElement("div");c.id="alert";m=document.createElement("div");m.id="alertcontent";document.body.appendChild(c);c.appendChild(m);c.style.filter="alpha(opacity=0)";c.style.opacity=0;c.alpha=0}else{c=$PT("alert");m=$PT("alertcontent")}m.innerHTML=k;c.style.display="block";var d=c.offsetHeight;var f=c.offsetWidth;var b=$PT(l);b.focus();var h=b.offsetHeight;var q=b.offsetWidth;var a=topPosition(b)-((d-h)/2);var o;if((leftPosition(b)-leftPosition($PT("content")))<(1000-(leftPosition(b)+q-leftPosition($PT("content"))))){$PT("alert").className="alertRight";o=leftPosition(b)+q+MSGOFFSET}else{$PT("alert").className="alertLeft";o=leftPosition(b)-MSGOFFSET-f}c.style.top=a+"px";c.style.left=o+"px";clearInterval(c.timer);c.timer=setInterval("fadeMsg(1)",MSGTIMER);if(!g){g=MSGHIDE}window.setTimeout("hideMsg()",(g*1000))}function inlineAlert(target,string,func){var msg;var msgcontent;if(!$PT("alert")){msg=document.createElement("div");msg.id="alert";msgcontent=document.createElement("div");msgcontent.id="alertcontent";document.body.appendChild(msg);msg.appendChild(msgcontent);msg.style.filter="alpha(opacity=0)";msg.style.opacity=0;msg.alpha=0}else{msg=$PT("alert");msgcontent=$PT("alertcontent")}msgcontent.innerHTML=string+"<br/><br/>";msg.style.display="block";var buttons;buttons=document.createElement("div");buttons.id="buttons";var cancelButt=document.createElement("input");cancelButt.type="button";cancelButt.className="popupButton";cancelButt.value="  No  ";cancelButt.onclick=function(){hideMsg(this)};var okButt=document.createElement("input");okButt.type="button";okButt.className="popupButton";okButt.value="  Yes  ";okButt.onclick=function(){hideMsg(this);eval(func)};buttons.appendChild(okButt);buttons.appendChild(cancelButt);msgcontent.appendChild(buttons);var msgheight=msg.offsetHeight;var msgWidth=msg.offsetWidth;var targetdiv=$PT(target);targetdiv.focus();var targetheight=targetdiv.offsetHeight;var targetwidth=targetdiv.offsetWidth;var topposition=topPosition(targetdiv)-((msgheight-targetheight)/2);if((leftPosition(targetdiv)-leftPosition($PT("content")))<(1000-(leftPosition(targetdiv)+targetwidth-leftPosition($PT("content"))))){$PT("alert").className="alertRight";leftposition=leftPosition(targetdiv)+targetwidth+MSGOFFSET}else{$PT("alert").className="alertLeft";leftposition=leftPosition(targetdiv)-MSGOFFSET-msgWidth}msg.style.top=topposition+"px";msg.style.left=leftposition+"px";clearInterval(msg.timer);msg.timer=setInterval("fadeMsg(1)",MSGTIMER)}function hideMsg(a){var a=$PT("alert");if(!a.timer){a.timer=setInterval("fadeMsg(0)",MSGTIMER)}}function fadeMsg(a){if(a==null){a=1}var c=$PT("alert");var b;if(a==1){b=c.alpha+MSGSPEED}else{b=c.alpha-MSGSPEED}c.alpha=b;c.style.opacity=(b/100);c.style.filter="alpha(opacity="+b+")";if(b>=99){clearInterval(c.timer);c.timer=null}else{if(b<=1){c.style.display="none";clearInterval(c.timer)}}}function leftPosition(b){var a=0;if(b.offsetParent){while(1){a+=b.offsetLeft;if(!b.offsetParent){break}b=b.offsetParent}}else{if(b.x){a+=b.x}}return a}function topPosition(b){try{return b.getBoundingClientRect().top+getScrollTop()}catch(a){return 0}}if(document.images){arrow=new Image(7,80);arrow.src=staticServerPath+"/images/msg_arrowRight.gif"}var ONE_DAY=0;var ONE_WEEK=1;var ONE_MONTH=2;var ONE_YEAR=3;var RESULTS_10=0;var RESULTS_20=1;var RESULTS_30=2;function collectSearchParamters(){var a=[];a.push("profitType=",$PT("profitSelect").options[$PT("profitSelect").selectedIndex].value,"&profitValue=",$F("profitVal"),"&ageType=",$PT("ageType").value,"&ageValue=",$PT("ageSelect").options[$PT("ageSelect").selectedIndex].value);a.push("&drawType=",$PT("drawdownSelect").selectedIndex,"&drawValue=",$F("drawdownVal"),"&systemType=",$PT("systemTypeSelect").value,"&tradingType=",$PT("tradingTypeSelect").value,"&accountType=",$PT("accountTypeSelect").selectedIndex,"&lastTraded=",$F("lastTradedSelect"));a.push("&profitabilityType=",$PT("profitabilitySelect").selectedIndex,"&profitabilityValue=",$F("profitabilityVal"));a.push("&size=",$PT("sizeVal").options[$PT("sizeVal").selectedIndex].value,"&tradesType=",$F("tradesType"));a.push("&serverOid=",$PT("serverOid").options[$PT("serverOid").selectedIndex].value,"&regulationType=",$PT("regulationTypeSelect").selectedIndex);a.push("&platformOid=",$PT("platformOid").options[$PT("platformOid").selectedIndex].value);if($PT("currSelect").options[$PT("currSelect").selectedIndex].index!=0){a.push("&symbols=",$PT("currSelect").options[$PT("currSelect").selectedIndex].value)}return a}function searchSystems(c){if(validate("profitVal",VALID_ABSOLUTE_NUMBER)&&validate("drawdownVal",VALID_ABSOLUTE_NUMBER)&&validate("profitabilityVal",VALID_ABSOLUTE_NUMBER)){var b=collectSearchParamters();var a=[];if($PT("systemsSearchSortBy")!=null&&$PT("systemsSearchSortType")!=null&&$PT("systemsSearchSortBy").value.length!=0&&$PT("systemsSearchSortType").value.length!=0){a.push("&sb=",$PT("systemsSearchSortBy").value,"&st=",$PT("systemsSearchSortType").value)}else{a.push("&sb=19&st=2")}if($PT("autoTradeSystemsSearchSortBy")!=null&&$PT("autoTradeSystemsSearchSortType")!=null&&$PT("autoTradeSystemsSearchSortBy").value.length!=0&&$PT("autoTradeSystemsSearchSortType").value.length!=0){a.push("&autoTradeSortBy=",$PT("autoTradeSystemsSearchSortBy").value,"&autoTradeSortType=",$PT("autoTradeSystemsSearchSortType").value)}else{a.push("&sb=19&st=2")}if($PT("signalStartSystemsSearchSortBy")!=null&&$PT("signalStartSystemsSearchSortType")!=null&&$PT("signalStartSystemsSearchSortBy").value.length!=0&&$PT("signalStartSystemsSearchSortType").value.length!=0){a.push("&signalStartSortBy=",$PT("signalStartSystemsSearchSortBy").value,"&signalStartSortType=",$PT("signalStartSystemsSearchSortType").value)}else{a.push("&sb=19&st=2")}dhtmlHistory.add("#?pt=6&p=1&"+b.join("")+a.join(""));fxAjax.sendRequest(fxVars.searchSystems+b.join("")+a.join(""),{contentType:"text/xhtml",params:{cont:"allSystemsCont",session:c},loader:true,callback:"searchSystemsResponse"})}}function searchSystemsResponse(a,b){$PT(b.cont).innerHTML=a;runAjaxScripts(a);if(b.session!="true"){loadWatchCookie()}reloadAds()}function submitEnter(b){var a;if(window.event){a=window.event.keyCode}else{if(b){a=b.which}else{return true}}if(a==13){login()}}var quotePostId=-1;function quote(c,f,b,d,g){if($PT("suspended")==undefined){quotePostId=c;if(d){getPost(c);Effect.ScrollTo("text")}else{var h=f.indexOf("&p=")+3;var a=f.substring(0,h)+g+f.substring(f.indexOf("&o="));ajaxPaging(a,b,undefined,undefined,true)}}}function getPost(a){fxAjax.sendRequest(fxVars.getPostById+a,{contentType:"text/xhtml",params:"",loader:true,callback:"getPostResponse"})}function editPost(c,b,a){var d=$PT("post"+c+"Edit");if(b){d.style.display="";new TextAreaResize(d.id);$PT("post"+c).style.display="none";$PT("postOptions"+c).style.display="none";$PT("editButton"+c).style.display="none";refreshAutocompleteAndAdd("post"+c+"Edit");if(!a){$PT("smileyButton"+c).style.display="";$PT("attachFilesButton"+c).style.display="";$J("#post"+c+"Edit").focusEnd()}}else{d.style.display="none";$PT("post"+c).style.display="";$PT("postOptions"+c).style.display="";$PT("editButton"+c).style.display="";refreshAutocompleteAndDelete("post"+c+"Edit");if(!a){$PT("smileyButton"+c).style.display="none";$PT("attachFilesButton"+c).style.display="none";$PT("editSmileys"+c).style.display="none";$PT("editUpload"+c).style.display="none"}}}function editPostSave(a){if(validate("post"+a+"Edit",VALID_TEXT)){var c=$PT("post"+a+"Edit").value;var b=["oid=",a,"&text=",encodeParameter(c),"&files=",encodeParameter(filesUploaded.join(","))].join("");fxAjax.sendRequest(fxVars.editPost,{contentType:"application/x-www-form-urlencoded; charset=utf-8",params:{oid:a},postBody:b,method:"post",loader:true,callback:"editPostSaveResponse"})}}function deletePost(a){if(confirm("Are you sure?")){fxAjax.sendRequest(fxVars.deletePost+a,{contentType:"text/xhtml",params:{oid:a},loader:true,callback:"deletePostResponse"})}}function deletePostResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){$PT("postRow"+f.oid).remove()}}function deleteTopic(a){if(confirm("Are you sure?")){fxAjax.sendRequest(fxVars.deleteTopic+a,{contentType:"text/xhtml",params:{oid:a},loader:true,callback:"deleteTopicResponse"})}}function deleteTopicResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){if($PT("topicRow"+f.oid)!=null){$PT("topicRow"+f.oid).remove();alert("Topic was deleted")}}else{alert("problem deleting topic")}}function editPostSaveResponse(a,h){var b=a.error;var d=a.message;if(!b){var c=a.content.data;var g=a.content.pending;$PT("edit"+h.oid).style.display="none";$PT("post"+h.oid+"Edit").style.display="none";$PT("post"+h.oid).style.display="";$PT("post"+h.oid).innerHTML=c;$PT("smileyButton"+h.oid).style.display="none";$PT("attachFilesButton"+h.oid).style.display="none";if(!g){$PT("postOptions"+h.oid).style.display="";$PT("editButton"+h.oid).style.display=""}var f=a.content.attachmentsData;if(hasText(f)&&filesUploaded.length>0){$J("#postAttachments"+h.oid).html(f);$PT("smileyButton"+h.oid).style.display="none";$PT("attachFilesButton"+h.oid).style.display="none";$PT("editSmileys"+h.oid).style.display="none";$PT("editUpload"+h.oid).style.display="none";filesUploaded=[]}Jlinker.createLinker(linkerList,"post"+h.oid)}else{inlineMsg("saveEditPostButt"+h.oid,d,3)}refreshAutocompleteAndDelete("post"+h.oid+"Edit")}function reportAbuseVerify(f,c,a,d){var b=["fadeMsg(0);reportAbuse('",f,"',",c,",",a,",",d,");"];inlineAlert($PT(f),"<div class='center'><b>"+$T("tReportAbuse")+"</b><br/><br/><span class='exclamation'>"+$T("tAbusiveContent")+"</span></div>",b.join(""))}function reportAbuse(d,b,a,c){fxAjax.sendRequest(fxVars.reportAbuse+b+"&conversationOid="+a+"&pageNum="+c,{contentType:"text/xhtml",loader:true});inlineMsg($PT(d),$T("tPostReported"),3)}function getPostResponse(a){$PT("text").value=a;Effect.ScrollTo("text");quotePostId=-1;$PT("text").focus()}var filesUploaded=[];function navigateTo(a){document.location.href=a}function navigateToWhitelabel(a){navigateTo(serverPath+"/loginWithToken.html?redirectUrl="+encodeParameter(a))}function searchSite(b){var a;if(window.event){a=window.event.keyCode}else{if(b){a=b.which}}if(a==13){searchSiteFunc()}return false}function searchSiteFunc(){if(validate("search",VALID_SEARCH)){var a=encodeParameter($PT("search").value);window.location="/search/"+a}}function getAccountForm(b,a){if(typeof(b)=="undefined"){b=0}if(typeof a=="undefined"){a=true}fxAjax.sendRequest(fxVars.getAccountForm+b+"&os="+a,{contentType:"text/xhtml",params:{newAccount:(b==0)},loader:true,callback:"getAccountFormResponse"})}function getAccountFormResponse(c,d){hideElement("portfolioManageDiv");hideElement("accountsListDiv");showElement("currentAccount");$PT("currentAccount").innerHTML=c;runAjaxScripts(c);var b=document.getElementsByName("magicColors");attachColorPicker(b);if(!d.newAccount){if($PT("isMt4Servers").value=="true"){getMt4Servers()}var a=$PT("selectedServerId").value;if(a.length!=0&&a!=1){$PT("levergeHolder").style.display=""}}reloadAds()}function attachColorPicker(c){for(var b=0;b<c.length;b++){var a=new jscolor.color(c[b],{required:false});if(c[b].value.length!=0){a.fromString(c[b].value)}}}function closeCurrentAccount(){hideElement("currentAccount");showElement("accountsListDiv");reloadAds()}function getMetaContent(a){var c=document.getElementsByTagName("meta");for(var b=0;b<c.length;b++){if(c[b].name==a){return c[b].content}}}var SYSTEM_TIMESTAMP;var mmToMonth=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var dayStr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var dt=new Date(getMetaContent("server-time"));var cookieCache={};var initTimezone=null;function updateTime(){var a=new Date(dt);var h;var g;if(cookieCache.timezone!=undefined){h=cookieCache.timezone}else{h=getCookie("timezone");cookieCache.timezone=h}if(cookieCache.dst!=undefined){g=cookieCache.dst}else{g=getCookie("dst");cookieCache.dst=g}var c=" GMT";if(h!=null&&h.length!=0){a.setTime(a.getTime()+h*HOUR);c=""}if(hasText(g)&&g=="1"){a.setTime(a.getTime()+HOUR)}var f=mmToMonth[a.getMonth()];var b=dayStr[a.getDay()];$PT("time").innerHTML=b+", "+f+" "+a.getDate()+", "+format2Digits(a.getHours())+":"+format2Digits(a.getMinutes())+":"+format2Digits(a.getSeconds())+c;a.setTime(a.getTime()+1000);if(initTimezone==null){initTimezone=dt.getTime()-getUTCTime().getTime();dt.setTime(dt.getTime()+1000)}else{var d=(getUTCTime()).getTime()+initTimezone;dt=new Date(d)}setTimeout("updateTime()",1000)}function getUTCTime(){var a=new Date();return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds())}var SECOND=1000;var MINUTE=60*SECOND;var HOUR=60*MINUTE;var DAY=24*HOUR;var WEEK=7*DAY;var YEAR=360*DAY;var isTimeOut=0;function updateCalendarTime(page){var isDone=false;var currDate=dt.getTime();currDate+=MINUTE*dt.getTimezoneOffset()*-1;var elements=document.getElementsByName("calendarLeft");for(var i=0;i<elements.length;i++){var timestamp=eval(elements[i].getAttribute("time"));var delta=timestamp-currDate;var text;var color=elements[i].parentNode.parentNode.style.backgroundColor;var isPassed=parseInt(elements[i].getAttribute("isPassed"));var last=elements.length;if(i==(last-1)&&isPassed==0&&isTimeOut==1){isTimeOut=0}if(delta<0){if(isPassed==0){elements[i].parentNode.parentNode.style.backgroundColor=""}$J(elements[i]).hide().parent().children("#event-ended").show();elements[i].setAttribute("isPassed","1");isDone=true;if(i<=elements.length-1&&i>0&&isPassed==0){$$PT("#"+elements[i].parentNode.parentNode.id+" td").each(function(element){element.style.borderTop=""});if(i<elements.length-1){$$PT("#"+elements[i+1].parentNode.parentNode.id+" td").each(function(element){element.style.borderTop="3px solid #e4e4e4"})}}if(i==(last-1)&&isPassed==1&&isTimeOut!=1){isTimeOut=1;setTimeout("movePage()",300000)}continue}var importance=parseInt(elements[i].getAttribute("importance"));var setColor;if(importance==0){setColor="#ededed"}else{if(importance==1){setColor="#e2fee3"}else{if(importance==2){setColor="#fdefd3"}else{if(importance==3){setColor="#fedbdb"}}}}if(delta<=MINUTE){text=$T("tTimeLeftSeconds",[Math.floor(delta/SECOND)]);elements[i].parentNode.parentNode.style.backgroundColor=(new RGBColor(color).toHex()==setColor?"white":setColor)}else{if(delta>=MINUTE&&delta<=HOUR){text=$T("tTimeLeftMin",[Math.floor(delta/MINUTE)])}else{if(delta>=HOUR&&delta<=DAY){text=$T("tTimeLeftHMin",[Math.floor(delta/HOUR),Math.floor((delta%HOUR)/MINUTE)])}else{if(delta>=DAY){var day=Math.floor(delta/DAY);text=day<=1?$T("tTimeLeftDay",[day]):$T("tTimeLeftDays",[day])}}}}elements[i].value=text}if(isDone&&page=="c"){var nextEventElements=$J('td [isPassed="0"]');if(nextEventElements!=undefined&&nextEventElements.length>0){var nextEventTime=nextEventElements[0].attributes.time.value;for(var j=0;j<nextEventElements.length;j++){var deltaNextEvent=nextEventTime-currDate;if(nextEventElements[j].attributes.time.value==nextEventTime&&deltaNextEvent>=MINUTE){var nextEventImportance=parseInt(nextEventElements[j].attributes.importance.value);var nextEventElColor=elements[j].parentNode.parentNode.style.backgroundColor;var nextEventColor;if(nextEventImportance==0){nextEventColor="#ededed"}else{if(nextEventImportance==1){nextEventColor="#e2fee3"}else{if(nextEventImportance==2){nextEventColor="#fdefd3"}else{if(nextEventImportance==3){nextEventColor="#fedbdb"}}}}nextEventElements[j].parentNode.parentNode.style.backgroundColor=nextEventColor}}}}setTimeout('updateCalendarTime("'+page+'")',1000)}var AUTO_CAL_PAGING="1";function movePage(){var c=parseInt($F("calLivePage"));if($F("autoCalPaging")==AUTO_CAL_PAGING){c+=1}var a=$F("calLastP");var b=$F("calP");if(isTimeOut==1&&b!=a){ajaxPaging("?pt=7&p="+c+"&calRefreshed=1&o=&t=","calendarCont",1,false,true,false,false,false);setTimeout("movePageFinish()",1000)}}function movePageFinish(){if($F("calRefreshed")=="0"){setTimeout("movePageFinish()",1000)}else{isTimeOut=0}}function RGBColor(h){this.ok=false;if(h.charAt(0)=="#"){h=h.substr(1,6)}h=h.replace(/ /g,"");h=h.toLowerCase();var a={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var c in a){if(h==c){h=a[c]}}var k=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}];for(var b=0;b<k.length;b++){var f=k[b].re;var d=k[b].process;var g=f.exec(h);if(g){channels=d(g);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b);this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHex=function(){var o=this.r.toString(16);var m=this.g.toString(16);var l=this.b.toString(16);if(o.length==1){o="0"+o}if(m.length==1){m="0"+m}if(l.length==1){l="0"+l}return"#"+o+m+l};this.getHelpXML=function(){var o=[];for(var r=0;r<k.length;r++){var m=k[r].example;for(var q=0;q<m.length;q++){o[o.length]=m[q]}}for(var w in a){o[o.length]=w}var s=document.createElement("ul");s.setAttribute("id","rgbcolor-examples");for(var r=0;r<o.length;r++){try{var t=document.createElement("li");var v=new RGBColor(o[r]);var x=document.createElement("div");x.style.cssText="margin: 3px; border: 1px solid black; background:"+v.toHex()+"; color:"+v.toHex();x.appendChild(document.createTextNode("test"));var l=document.createTextNode(" "+o[r]+" -> "+v.toRGB()+" -> "+v.toHex());t.appendChild(x);t.appendChild(l);s.appendChild(t)}catch(u){}}return s}}function format2Digits(a){if(a<10){return"0"+a}else{return a}}function getToday(){var a=new Date();return format2Digits(a.getMonth()+1)+"/"+format2Digits(a.getDate())+"/"+a.getFullYear()+" "+format2Digits(a.getHours())+":"+format2Digits(a.getMinutes())}var checkboxHeight="25";var radioHeight="25";var selectWidth="90";document.write('<style type="text/css">input.styled { display: none; } select.styled { position: relative; width: '+selectWidth+"px; opacity: 0; filter: alpha(opacity=0); z-index: 5; }</style>");if(typeof(SETTINGS)=="undefined"){window.dhtmlHistory.create({toJSON:function(a){return JSON.stringify(a)},fromJSON:function(a){return JSON.parse(a)}})}function initialize(){dhtmlHistory.initialize();dhtmlHistory.addListener(handleHistoryChange);var a=dhtmlHistory.getCurrentLocation();if(dhtmlHistory.isFirstLoad()&&typeof(initPage)!="undefined"){}}function handleHistoryChange(b,c){if(b.length==0){var a=historyStorage.get(window.location.pathname);if(a!=null&&a.length!=0&&container!=null&&$PT(container)!=null){$PT(container).innerHTML=a}return}updateUI(b,c)}function updateUI(a,b){if(typeof(container)!="undefined"){ajaxPaging(a,container,1,true,true)}}var PLATFORM_OANDA=1;var PLATFORM_MT4=2;var PLATFORM_FXCM=3;var PLATFORM_MT5=5;var OTHER_MT5_SERVER_OID=1464;function setAccountForm(a){setAccountForm(a,undefined)}function setAccountForm(platformOid,serverOid){try{if(eval(id)==0){$PT("mt4MissingServerHelp").style.display="none"}if(eval(id)==PLATFORM_OANDA){$PT("serverId").style.display="";$PT("typeSelect").style.display="none";$PT("levergeHolder").style.display="none";$PT("sizingLabel").innerHTML="Units";$PT("verificationRow").style.display="none";$PT("type").style.display="none";$PT("mt4MissingServerHelp").style.display="none"}else{if(eval(id)==PLATFORM_MT4){showVerificationSettings()}else{if(eval(id)==PLATFORM_MT5){if(serverOid!=undefined&&eval(serverOid)==OTHER_MT5_SERVER_OID){showVerificationSettings()}else{$PT("f").style.display="none";$PT("brokerIs").style.display="none";$PT("mt5Text").style.display="";$PT("save").style.display="none";$PT("required").style.display="none";$PT("platformId").disabled="disabled";window.location.href="http://www.myfxbook.com/pages/EaInstallerMT5.exe"}}}}}catch(e){}}function showVerificationSettings(){showElement("typeSelect");showElement("levergeHolder");if($PT("sizingLabel")){$PT("sizingLabel").innerHTML="Lots"}showElement("verificationRow");showElement("type");showElement("mt4MissingServerHelp")}function topicSubscribe(a){var b=["topicId=",a];fxAjax.sendRequest(fxVars.topicSubscribe+b.join(""),{contentType:"text/xhtml",params:{container:"subscribe",topicId:a},loader:true,callback:"topicSubscribeResponse"})}function topicSubscribeResponse(d,f){var b=d.getElementsByTagName("response")[0];$PT("response").innerHTML=b.getAttribute("message");$PT("response").style.display="";var a=$$PT("td[name=subscribe]");for(var c=0;c<a.length;c++){a[c].innerHTML="<a href='javascript:void(0);' onclick='topicUnsubscribe("+f.topicId+")' class='unsubscribe gray'>"+$T("tTopicUnsucscribe")+"</a>"}}function topicUnsubscribe(a){var b=["topicId=",a];fxAjax.sendRequest(fxVars.topicUnsubscribe+b.join(""),{contentType:"text/xhtml",params:{container:"subscribe",topicId:a},loader:true,callback:"topicUnsubscribeResponse"})}function topicUnsubscribeResponse(d,f){var b=d.getElementsByTagName("response")[0];$PT("response").innerHTML=b.getAttribute("message");$PT("response").style.display="";var a=$$PT("td[name=subscribe]");for(var c=0;c<a.length;c++){a[c].innerHTML="<a href='javascript:void(0);' onclick='topicSubscribe("+f.topicId+")' class='subscribe gray'>"+$T("tTopicSubscribe")+"</a>"}}function subscriptionDelete(b,a){var c=["oid=",a];fxAjax.sendRequest(fxVars.subscriptionDelete+c.join(""),{contentType:"text/xhtml",params:{container:"subscriptions"},loader:true,callback:"subscriptionDeleteResponse"})}function subscriptionDeleteResponse(a,b){$PT("subscriptionsCont").innerHTML=a}function deleteNotifications(a){fxAjax.sendRequest(fxVars.deleteNotification+a,{contentType:"text/xml",params:{id:a},loader:true,callback:"deleteNotificationsResponse"})}function deleteNotificationsResponse(f,g){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=a.getAttribute("message");var c=$PT("notification"+g.id);if(b=="false"){if(c){c.remove()}}else{inlineMsg(c,d,3)}}function deleteAllNotifications(){fxAjax.sendRequest(fxVars.deleteAllNotifications,{loader:true,callback:"deleteAllNotificationsResponse"})}function deleteAllNotificationsResponse(a){if(a.error){inlineMsg($PT("notifyTb"),a.message,3)}else{$PT("notificationsTB").innerHTML=""}}function setAnchorTab(a){window.location.hash=a}function reportBug(){if(validate("bugDescription",VALID_MESSAGE)){var a=[];jQuery("#reportBugForm [name=reportFiles]").each(function(){a.push(this.title)});var b=["text=",encodeParameter($PT("bugDescription").value),"&browser=",encodeParameter($PT("browserType").value),"&url=",encodeParameter($PT("currentUrl").value),"&userIdentity=",$PT("userIdentity").value,"&files=",encodeParameter(a.join(","))];fxAjax.sendRequest(fxVars.reportBug,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:b.join(""),method:"post",params:{},loader:false,callback:"reportBugResponse"})}}function initBugForm(){$PT("currentUrl").value=window.location.href;$PT("browserType").value=navigator.userAgent}function reportBugResponse(c,d){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");$PT("bugFormContent").style.display="none";$PT("bugSent").style.display="block";$PT("bugDescription").value="";$PT("userIdentity").value="";jQuery("#reportBugForm [name=bugReportFileRemove]").each(function(){this.click()});setTimeout(function(){$JD.close("#reportBugForm")},1000)}var currentChartDate="";var changeCharts=["chartRatios","chartCurrency","chartHold"];function changeChartMonth(d){var a=d.split(",");var c=a[0];var l=a[1];var h=a.length>2?a[2]:"";if(currentChartDate.length==0||currentChartDate!=c){var k=(l*15)<250?250:l*15;if(isNaN(k)){k=250}var b=new Chart(342,k,"riskRatios",3);b.renderChart("/charts.json?chartType=4&accountOid="+accountOid+"&startDateForChart="+c+"&invitation="+h+buildAdvancedStatisticsUrl(false,false)+"&r="+Math.random());var f=new Chart(480,250,"currencies",4);f.renderChart("/charts.json?chartType=6&accountOid="+accountOid+"&startDateForChart="+c+"&invitation="+h+buildAdvancedStatisticsUrl(false,false)+"&r="+Math.random());var g=new Chart(342,k,"holdPeriod",1);g.renderChart("/charts.json?chartType=5&accountOid="+accountOid+"&startDateForChart="+c+"&invitation="+h+buildAdvancedStatisticsUrl(false,false)+"&r="+Math.random());currentChartDate=c}}var currentStrategyChartDate="";function changeStrategyChartMonth(f){var h=f.split(",");var b=h[0];var c=h[1];var g=h.length>2?h[2]:"";if(currentStrategyChartDate.length==0||currentStrategyChartDate!=b){var a=new Chart(342,120,"riskRatios",3);a.renderChart("/strategy-chart.json?chartType=4&id="+$F("stid")+"&startDate="+b+"&invitation="+g+"&r="+Math.random());var d=new Chart(342,120,"holdPeriod",1);d.renderChart("/strategy-chart.json?chartType=5&id="+$F("stid")+"&startDate="+b+"&invitation="+g+"&r="+Math.random());currentStrategyChartDate=b}}var monthlyCharts=["chartMonthly","chartRatios","chartCurrency","chartHold"];function changeChartYear(c,h,m,d){if(m==null){m=""}if(monthType==null){monthType=0}var f=new Date(userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat")));var o=new Date("01/01/"+c);if(o<f){c=getDbDateFormat(f)}else{c=c+"-01-01"}if(h!="on"){currentChartDate="";var a=new Chart(480,250,"monthlyCont",3);a.renderChart("/charts.json?chartType=3&monthType="+monthType+"&accountOid="+accountOid+"&startDate="+c+"&endDate="+getDbDateFormat(new Date((userFormatToDefaultFormat($F("endDate"),$F("userTimeFormat")))))+"&r="+Math.random()+"&l="+d+buildAdvancedStatisticsUrl(true,false)+"&startDateYear="+getDbDateFormat(f));var b=new Chart(342,250,"riskRatios",3,$F("psaml"));var g=new Chart(480,250,"currencies",4,$F("psaml"));var k=new Chart(342,250,"holdPeriod",1,$F("psaml"))}}function changeStrategyChartYear(c,d,k){if(k==null){k=""}var h=new Date(userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat")));var g=new Date("01/01/"+c);if(g<h){c=getDbDateFormat(h)}else{c=c+"-01-01"}if(d!="on"){disposeCharts(monthlyCharts);currentChartDate="";var b=new Chart(480,250,"monthlyCont",3);b.renderChart("/strategy-chart.json?chartType=3&id="+$F("stid")+"&startDate="+c+"&endDate="+getDbDateFormat(new Date($PT("endDate").value))+"&invitation="+k+"&r="+Math.random());var a=new Chart(342,120,"riskRatios",3,$F("psaml"));var f=new Chart(342,120,"holdPeriod",1,$F("psaml"))}}function suspendedPass(b){if(typeof(suspended)=="undefined"||!suspended){return true}else{var a=jQuery("#username-select").val();if(a.length>1||!isContains(b,a[0])){inlineMsg("username-select","<strong>"+$T("tError")+"</strong><br />"+$T("tInboxSuspended"),3);return false}else{return true}}}if(!window.SI){var SI={}}SI.Files={htmlClass:"SI-FILES-STYLIZED",fileClass:"file",wrapClass:"cabinet",fini:false,able:false,init:function(){this.fini=true;var b=0;if(window.opera||(b&&b<5.5)||!document.getElementsByTagName){return}this.able=true;var a=document.getElementsByTagName("html")[0];a.className+=(a.className!=""?" ":"")+this.htmlClass},stylize:function(a){if(!this.fini){this.init()}if(!this.able){return}a.parentNode.file=a;a.parentNode.onmousemove=function(k){if(typeof k=="undefined"){k=window.event}if(typeof k.pageY=="undefined"&&typeof k.clientX=="number"&&document.documentElement){k.pageX=k.clientX+document.documentElement.scrollLeft;k.pageY=k.clientY+document.documentElement.scrollTop}var d=oy=0;var g=this;if(g.offsetParent){d=g.offsetLeft;oy=g.offsetTop;while(g=g.offsetParent){d+=g.offsetLeft;oy+=g.offsetTop}}var b=k.pageX-d;var l=k.pageY-oy;var c=this.file.offsetWidth;var f=this.file.offsetHeight;this.file.style.top=l-(f/2)+"px";this.file.style.left=b-(c-30)+"px"}},stylizeById:function(a){this.stylize(document.getElementById(a))},stylizeAll:function(){if(!this.fini){this.init()}if(!this.able){return}var a=document.getElementsByTagName("input");for(var c=0;c<a.length;c++){var b=a[c];if(b.type=="file"&&b.className.indexOf(this.fileClass)!=-1&&b.parentNode.className.indexOf(this.wrapClass)!=-1){this.stylize(b)}}}};function insertAtCursor(d,c){if(document.selection){d.focus();sel=document.selection.createRange();sel.text=c}else{if(d.selectionStart||d.selectionStart=="0"){var b=d.selectionStart;var a=d.selectionEnd;d.value=d.value.substring(0,b)+c+d.value.substring(a,d.value.length)}else{d.value+=c}}}function showHide(b,c,f){var d=parseInt($J("#wrapper").css("z-index"));var a=$J(floatTheadTables);if(f==1||$PT(c).style.display=="none"){d++;$PT(c).style.display="";$PT(b).onclick=function(){if(a.length>0){$J(floatTheadTables).floatThead("reflow")}showHide(b,c,2);return false};if(a.length>0){$J(floatTheadTables).floatThead("reflow")}}else{if(f==2||$PT(c).style.display==""){d--;$PT(c).style.display="none";$PT(b).onclick=function(){showHide(b,c,1);return false}}}$J("#wrapper").css("z-index",d)}function showHideSwitch(button,elem,func){if($PT(elem).style.display=="none"){$PT(elem).style.display="";$PT(button).onclick=function(){showHideSwitch(button,elem,func);eval(func);return false}}else{$PT(elem).style.display="none";$PT(button).onclick=function(){showHideSwitch(button,elem,func);eval(func);return false}}}var carpemouseover=false;var carpeDefaultSliderLength=80;var carpeSliderDefaultOrientation="horizontal";var carpeSliderClassName="carpe_slider";var carpeSliderDisplayClassName="carpe_slider_display";var carpesliders=[];var carpedisplays=[];var carpeslider={};var carpedisplay={};function carpeAddLoadEvent(a){var b=window.onload;if(typeof window.onload!="function"){window.onload=a}else{window.onload=function(){b();a()}}}function carpeGetElementsByClass(f){var g=[];var d=document.getElementsByTagName("*");var a=d.length;var h=new RegExp("\\b"+f+"\\b");for(var c=0,b=0;c<a;c++){if(h.test(d[c].className)){g[b]=d[c];b++}}return g}function carpeLeft(a,b){if(!(a=document.getElementById(a))){return 0}if(a.style&&(typeof(a.style.left)=="string")){if(typeof(b)=="number"){a.style.left=b+"px"}else{b=parseInt(a.style.left);if(isNaN(b)){b=0}}}else{if(a.style&&a.style.pixelLeft){if(typeof(b)=="number"){a.style.pixelLeft=b}else{b=a.style.pixelLeft}}}return b}function carpeTop(a,b){if(!(a=document.getElementById(a))){return 0}if(a.style&&(typeof(a.style.top)=="string")){if(typeof(b)=="number"){a.style.top=b+"px"}else{b=parseInt(a.style.top);if(isNaN(b)){b=0}}}else{if(a.style&&a.style.pixelTop){if(typeof(b)=="number"){a.style.pixelTop=b}else{b=a.style.pixelTop}}}return b}function moveSlider(d){var d=(!d)?window.event:d;if(carpemouseover){carpeslider.x=carpeslider.startOffsetX+d.screenX;carpeslider.y=carpeslider.startOffsetY+d.screenY;if(carpeslider.x>carpeslider.xMax){carpeslider.x=carpeslider.xMax}if(carpeslider.x<0){carpeslider.x=0}if(carpeslider.y>carpeslider.yMax){carpeslider.y=carpeslider.yMax}if(carpeslider.y<0){carpeslider.y=0}carpeLeft(carpeslider.id,carpeslider.x);carpeTop(carpeslider.id,carpeslider.y);var b=carpeslider.x+carpeslider.y;var c=(carpeslider.distance/carpedisplay.valuecount)*Math.round(carpedisplay.valuecount*b/carpeslider.distance);var a=Math.round((c*carpeslider.scale+carpeslider.from)*Math.pow(10,carpedisplay.decimals))/Math.pow(10,carpedisplay.decimals);carpedisplay.value=a;return false}}function slide(l){if(!l){l=window.event}carpeslider=(l.target)?l.target:l.srcElement;var f=parseInt(carpeslider.getAttribute("distance"));carpeslider.distance=f?f:carpeDefaultSliderLength;var k=carpeslider.getAttribute("orientation");var b=((k=="horizontal")||(k=="vertical"))?k:carpeSliderDefaultOrientation;var a=carpeslider.getAttribute("display");carpedisplay=document.getElementById(a);carpedisplay.sliderId=carpeslider.id;var d=parseInt(carpedisplay.getAttribute("decimals"));carpedisplay.decimals=d?d:0;var c=parseInt(carpedisplay.getAttribute("valuecount"));carpedisplay.valuecount=c?c:carpeslider.distance+1;var h=parseFloat(carpedisplay.getAttribute("from"));h=h?h:0;var g=parseFloat(carpedisplay.getAttribute("to"));g=g?g:carpeslider.distance;carpeslider.scale=(g-h)/carpeslider.distance;if(b=="vertical"){carpeslider.from=g;carpeslider.xMax=0;carpeslider.yMax=carpeslider.distance;carpeslider.scale=-carpeslider.scale}else{carpeslider.from=h;carpeslider.xMax=carpeslider.distance;carpeslider.yMax=0}carpeslider.startOffsetX=carpeLeft(carpeslider.id)-l.screenX;carpeslider.startOffsetY=carpeTop(carpeslider.id)-l.screenY;carpemouseover=true;document.onmousemove=moveSlider;document.onmouseup=sliderMouseUp;return false}function sliderMouseUp(){if(carpemouseover){var a=(carpedisplay.value)?carpedisplay.value:0;var b=(a-carpeslider.from)/(carpeslider.scale);if(carpeslider.yMax==0){b=(b>carpeslider.xMax)?carpeslider.xMax:b;b=(b<0)?0:b;carpeLeft(carpeslider.id,b)}if(carpeslider.xMax==0){b=(b>carpeslider.yMax)?carpeslider.yMax:b;b=(b<0)?0:b;carpeTop(carpeslider.id,b)}if(document.removeEventListener){document.removeEventListener("mousemove",moveSlider,false);document.removeEventListener("mouseup",sliderMouseUp,false)}else{if(document.detachEvent){document.detachEvent("onmousemove",moveSlider);document.detachEvent("onmouseup",sliderMouseUp);document.releaseCapture()}}}carpemouseover=false}function focusDisplay(c){if(!c){c=window.event}var a=(c.target)?c.target:c.srcElement;var b=a.getAttribute("typelock");if(b=="on"){a.blur()}}function carpeInit(){carpesliders=carpeGetElementsByClass(carpeSliderClassName);for(var a=0;a<carpesliders.length;a++){carpesliders[a].onmousedown=slide}carpedisplays=carpeGetElementsByClass(carpeSliderDisplayClassName);for(var a=0;a<carpedisplays.length;a++){carpedisplays[a].value=carpedisplays[a].defaultValue;carpedisplays[a].onfocus=focusDisplay}}carpeAddLoadEvent(carpeInit);function addEvent(d,c,a){if(d.addEventListener){d.addEventListener(c,a,false);return true}else{if(d.attachEvent){var b=d.attachEvent("on"+c,a);return b}else{return false}}}function removeEvent(f,d,b,a){if(f.removeEventListener){f.removeEventListener(d,b,a);return true}else{if(f.detachEvent){var c=f.detachEvent("on"+d,b);return c}else{alert("Handler could not be removed")}}}function getViewportHeight(){if(window.innerHeight!=window.undefined){return window.innerHeight}if(document.compatMode=="CSS1Compat"){return document.documentElement.clientHeight}if(document.body){return document.body.clientHeight}return window.undefined}function getViewportWidth(){var b=17;var a=null;if(window.innerWidth!=window.undefined){return window.innerWidth}if(document.compatMode=="CSS1Compat"){return document.documentElement.clientWidth}}function getScrollTop(){if(self.pageYOffset){return self.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollTop}else{if(document.body){return document.body.scrollTop}}}}function getScrollLeft(){if(self.pageXOffset){return self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollLeft){return document.documentElement.scrollLeft}else{if(document.body){return document.body.scrollLeft}}}}function alertRow(c,d){var b=document.getElementsByClassName("publisherAlertOption"+d);for(var a=0;a<b.length;a++){b[a].disabled=!c}}function saveSettings(){var a=[];var c=document.getElementsByName("accountDownAlert");try{for(var b=0;b<c.length;b++){var g=c[b].id;a.push(g+"="+c[b].value+"_"+$PT("publisherAlertActive"+g).checked+";"+$F("monitorDayStart"+g)+"_"+$F("monitorTimeStart"+g)+";"+$F("monitorDayEnd"+g)+"_"+$F("monitorTimeEnd"+g))}}catch(f){}var d="";$("input:checkbox.email-settings").each(function(){d+=this.id+"="+this.checked+"&"});d+="accountAlerts="+encodeParameter(a.join(","));d+="&emailFrequency="+$F("emailFrequency");d+="&tradePositionOpenEmailNotification="+$F("emailFrequency");fxAjax.sendRequest(fxVars.saveSettings,{contentType:"application/x-www-form-urlencoded; charset=utf-8",params:{},postBody:d,method:"post",loader:true,callback:"saveSettingsResponse"})}function saveSettingsResponse(c,d){if(!c.error){var a=c.message;var b=c.content.notificationSound;if(hasText(b)&&b){loadSoundNotification()}else{notificationSound=null}$PT("messagesResponse").innerHTML=a;$PT("messagesResponse").style.display=""}}function saveTwitter(b){$PT("twitterResponse").style.display="none";if(validate("twitterEvery",VALID_NUMBER)&&validate("twitterHourLimit",VALID_NUMBER)){var a=["&accountId="+b,"&lots=",$PT("lots").checked,"&twitterTradesOpen=",$PT("twitterTradesOpen").checked,"&twitterTradesClose=",$PT("twitterTradesClose").checked,"&twitterOrdersOpen=",$PT("twitterOrdersOpen").checked,"&twitterOrdersClose=",$PT("twitterOrdersClose").checked,"&twitterSL=",$PT("twitterSL").checked,"&twitterTP=",$PT("twitterTP").checked,"&twitterPrev=",encodeParameter($PT("twitterPrev").value),"&twitterPost=",encodeParameter($PT("twitterPost").value),"&twitterHourLimit=",$F("twitterHourLimit"),"&twitterEvery=",$F("twitterEvery")];fxAjax.sendRequest(fxVars.twitterUpdate+a.join(""),{contentType:"text/xhtml",params:{},loader:true,callback:"saveTwitterResponse"})}}function saveTwitterResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");$PT("twitterResponse").innerHTML=c;$PT("twitterResponse").style.display=""}function createTwitterUrl(){var a=$PT("twitterAccountSelect").item($PT("twitterAccountSelect").selectedIndex).id;if(a!=0){$PT("twitterStatus").style.display="none";fxAjax.sendRequest(fxVars.twitterUrl+a,{contentType:"text/xhtml",params:{},loader:true,callback:"createTwitterUrlResponse"})}}function createTwitterUrlResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){window.location=getContent(a)}else{$PT("twitterStatus").innerHTML=c;$PT("twitterStatus").style.display=""}}var noArray=[""];var tabs1=["watched","mysystems"];var tabs2=["inboxCont","sentCont"];var tabs3=["growth","balance","profit","drawdown"];var tabs4=["avgHolding","avgTpSl"];var tabs5=["openOrders","openTrades","history","exposures"];var tabs6=["accountsDiv","privacyDiv","profileDiv","loginDetailsDiv","subscriptionsDiv","twitterDiv","invitationsDiv","blockDiv"];var tabs7=["my","watched"];var tabs8=["users","accountsCont","communityCont","strategiesCont","reviewCont"];var tabs9=["stats","gen"];var tabs10=["tradesSummaryDiv","trades","hourly","daily","riskOfRuin","duration","maeMfe"];var tabs11=["style1","style2","style3"];var tabs12=["style1","style2","style3"];var tabs13=["json","xml","apiGeneral"];var tabs14=["cra","posts1"];var tabs15=["newAd","myAds"];var tabs16=["all","byCountry"];var tabs17=["searchSettings","watchCont"];var tabs18=["magicList","currenciesList","timingList","tradeList","analyzeTags","profileTab"];var tabs19=["periods","goals","tradeBrowser","autoTradeMastersStats"];var tabs20=["similarCharts"];var tabs21=["chartContainer","tempChart"];var tabs22=["available","subscribedSystems"];var tabs23=["openTradesDiv","openOrdersDiv"];var tabs24=["growth","balance"];var tabs25=["simulationSettingsTab","simulatorRecentTab"];var tabs26=["simulatorSubscribedSystemsTab","availableSystemsTab"];var tabs27=["generalTab","passwordTab","symbolsFeed"];var tabs28=["posts1","generalDiscussion"];var tabs29=["listing","promotion"];function switchTab(tabArray,id,el){var contId=el.parentNode;var elements=contId.getElementsByTagName("li");var i;if(id!=el){for(i=0;i<elements.length;i++){if((elements[i].className=="on")||(elements[i].className=="off")){if(el==elements[i]){elements[i].className="on"}else{elements[i].className="off"}}}if(eval(tabArray)[0].length>0){for(i=0;i<eval(tabArray).length;i++){if($PT(eval(tabArray)[i])&&eval(tabArray)[i]==id){$PT(eval(tabArray)[i]).style.display=""}else{if($PT(eval(tabArray)[i])){$PT(eval(tabArray)[i]).style.display="none"}}}}}}function handleEnter(d,b){var c=b.keyCode?b.keyCode:b.which?b.which:b.charCode;if(c==13){var a;for(a=0;a<d.form.elements.length;a++){if(d==d.form.elements[a]){break}}a=(a+1)%d.form.elements.length;d.form.elements[a].focus();return false}else{return true}}function setCookie(b,d,a,c){var f=new Date();f.setTime(f.getTime()+a);document.cookie=b+"="+(c!=null&&c?escape(d):d)+";path=/ ; domain="+document.domain.replace("www","")+((a==null)?"":";expires="+f.toGMTString()+";max-age="+(a/1000)+";")}function setTimeZoneCookie(a){var b=getCookie("timezone");if(b==null||b.length==0||b!=a){setCookie("timezone",a,YEAR)}}addDOMLoadEvent=(function(){var load_events=[],load_timer,script,done,exec,old_onload,init=function(){done=true;clearInterval(load_timer);while(exec=load_events.shift()){exec()}if(script){script.onreadystatechange=""}};return function(func){if(done){return func()}if(!load_events[0]){if(document.addEventListener){document.addEventListener("DOMContentLoaded",init,false);
/*@cc_on @*/
/*@if (@_win32)
             document.write("<script id=__ie_onload defer src=//0><\/scr"+"ipt>");
             script = document.getElementById("__ie_onload");
             script.onreadystatechange = function() {
             if (this.readyState == "complete")
             init(); // call the onload handler
             };
             /*@end @*/
}if(/WebKit/i.test(navigator.userAgent)){load_timer=setInterval(function(){if(/loaded|complete/.test(document.readyState)){init()}},10)}old_onload=window.onload;window.onload=function(){init();if(old_onload){old_onload()}}}load_events.push(func)}})();addDOMLoadEvent(function(){if(typeof(SETTINGS)=="undefined"){initialize()}});function timedRefresh(a){setTimeout("location.reload(true);",a)}function analyze(c,g,k,f){if(!isValidDate(userFormatToDefaultFormat($F("startDate"),k))){$PT("startDate").value=$PT("startDate").defaultValue}if(!isValidDate(userFormatToDefaultFormat($F("endDate"),k))){$PT("endDate").value=$PT("endDate").defaultValue}var h=userFormatToDefaultFormat($F("startDate"),k);var b=userFormatToDefaultFormat($F("endDate"),k);var a=new Date(h);var d=new Date(b);if(a>d){inlineMsg("startDate",$T("tStartBeforeEnd"),3)}else{updateAdvanced(h,b,c,g,f);reloadAds()}}function analyzeStrategy(f,b,c){var a=new Date(f);var d=new Date(b);if(a>d){inlineMsg("startDate",$T("tStartBeforeEnd"),3)}else{updateAdvancedStrategy(f,b,c);reloadAds()}}function getCheckBoxesValues(b){var a=document.getElementsByName(b);var d=[];for(var c=0;c<a.length;c++){if(a[c].checked){d.push(a[c].value)}}return d.join(",")}function getCheckBoxValue(a){return $PT(a)!=null&&$PT(a).checked}function updateAdvanced(a,f,o,d,r){var h=["tabs18","tradeList",$PT("analyzeTradeTab"),"showActualGrowth"];var q=new SwitchToTradeTab(h);if(validate("yieldStart",VALID_DOUBLE,q)&&validate("yieldEnd",VALID_DOUBLE,q)&&validate("netProfitStart",VALID_DOUBLE,q)&&validate("netProfitEnd",VALID_DOUBLE,q)&&validate("durationStart",VALID_INTEGER_OR_EMPTY,q)&&validate("durationEnd",VALID_INTEGER_OR_EMPTY,q)&&validate("pipsStart",VALID_DOUBLE,q)&&validate("pipsEnd",VALID_DOUBLE,q)&&validate("takeProfitStart",VALID_DOUBLE_POSITIVE,q)&&validate("takeProfitEnd",VALID_DOUBLE_POSITIVE,q)&&validate("stopLoss",VALID_DOUBLE_POSITIVE,q)&&validate("stopLossEnd",VALID_DOUBLE_POSITIVE,q)&&validate("sizingStart",VALID_DOUBLE_POSITIVE,q)&&validate("sizingEnd",VALID_DOUBLE_POSITIVE,q)&&validate("customDeposit",VALID_DOUBLE_POSITIVE)){var m;var b;var s;mainStrategyChartStatus=1;mainChartStatus=1;if(hasText($F("durationStart"))){b=parseInt($F("durationStart"))*parseInt($F("selectedDuration"))}if(hasText($F("durationEnd"))){s=parseInt($F("durationEnd"))*parseInt($F("selectedDuration"))}var g=getCommentsOptions("commentOption");var c=getAnalyzedMagicsNumbers();var k=["start=",getDbTimeFormat(a),"&end=",getDbTimeFormat(f),"&accountOid=",o,"&l=",d,"&invitation=",r,"&magicNumbers=",c,"&symbols=",getCheckBoxesValues("accountSymbol"),"&orderTags=",getCheckBoxesValues("accountTag"),"&days=",getCheckBoxesValues("days"),"&hours=",getCheckBoxesValues("hours"),getCommentBoxesValues(),"&buySell=",getCheckBoxesValues("buySell"),"&yieldStart=",$F("yieldStart"),"&yieldEnd=",$F("yieldEnd"),"&netProfitStart=",$F("netProfitStart"),"&netProfitEnd=",$F("netProfitEnd"),"&durationStart=",b,"&durationEnd=",s,"&takeProfitStart=",$F("takeProfitStart"),"&takeProfitEnd=",$F("takeProfitEnd"),"&stopLoss=",$F("stopLoss"),"&stopLossEnd=",$F("stopLossEnd"),"&sizingStart=",$F("sizingStart"),"&sizingEnd=",$F("sizingEnd"),"&selectedTime=",getCheckBoxesValues("selectedTime"),"&pipsStart=",$F("pipsStart"),"&pipsEnd=",$F("pipsEnd"),g,"&customDeposit=",$F("customDeposit")];fxAjax.sendRequest(fxVars.updateAdvanced,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:k.join(""),params:{start:a,end:f,accountOid:o,invitation:r,l:d,magicNumbers:c,symbols:getCheckBoxesValues("accountSymbol"),orderTags:getCheckBoxesValues("accountTag"),days:getCheckBoxesValues("days"),hours:getCheckBoxesValues("hours"),comment:getCommentBoxesValues(),buySell:getCheckBoxesValues("buySell"),yieldStart:$F("yieldStart"),yieldEnd:$F("yieldEnd"),netProfitStart:$F("netProfitStart"),netProfitEnd:$F("netProfitEnd"),durationStart:b,durationEnd:s,takeProfitStart:$F("takeProfitStart"),takeProfitEnd:$F("takeProfitEnd"),stopLoss:$F("stopLoss"),stopLossEnd:$F("stopLossEnd"),sizingStart:$F("sizingStart"),sizingEnd:$F("sizingEnd"),selectedTime:getCheckBoxesValues("selectedTime"),pipsStart:$F("pipsStart"),pipsEnd:$F("pipsEnd"),commentOption:g},loader:true,callback:"updateAdvancedResponse"})}}var charts=["chartGrowth","chartBalance","chartProfit","chartDrawdown","chartMonthly","chartRatios","chartCurrency","chartHold","chartHourly","chartDaily","chartDuration","chartSymbol","chartMaeMfe"];function updateAdvancedResponse(q,C){if(!q.error){currentChartDate="";selectTimeframeHide($PT("customAnalysisButt"));var z=$PT("tradingContDiv").innerHTML;$PT("analyzeCont").innerHTML=q.content.data;var f=$PT("periods").innerHTML;$PT("tradingContDiv").innerHTML=z;$PT("periods").innerHTML=f;runAjaxScripts(q.content.data);var w=q.content.slaveMastersStats;if(w!=undefined&&$PT("autoTradeMastersStats")!=undefined){$PT("autoTradeMastersStats").innerHTML=w}if($PT("chart1")!=null){var u=new Chart(630,314,"chart1",0);u.renderChart("/charts.json?chartType=1&period=6&accountOid="+C.accountOid+"&l="+C.l+buildAdvancedStatisticsUrl(false,false))}try{if($PT("chart2")!=null){var b=new Chart(630,314,"chart2",0);b.renderChart("/charts.json?chartType=2&period=6&accountOid="+C.accountOid+"&l="+C.l+buildAdvancedStatisticsUrl(false,false))}if($PT("chart3")!=null){var h=new Chart(630,314,"chart3",0);h.renderChart("/charts.json?chartType=13&period=6&accountOid="+C.accountOid+"&l="+C.l+buildAdvancedStatisticsUrl(false,false))}if($PT("chart4")!=null){var g=new Chart(630,314,"chart4",0);g.renderChart("/charts.json?chartType=15&type=1&period=6&l=p&accountOid="+C.accountOid+"&drawdownShowType="+getRadioIndex("drawdownOptions")+buildAdvancedStatisticsUrl(false,false))}tagsColors=document.getElementsByName("tagsColors");for(var y=0;y<tagsColors.length;y++){var D=new jscolor.color(tagsColors[y],{required:false});if(tagsColors[y].value.length!=0){D.fromString(tagsColors[y].value)}}}catch(A){}try{var r=getAttributeByRadioChecked("hourlyOptions","hourlyType");var c=[];c.push(r);if(r==4||r==3){var x=getAttributeByRadioChecked("hourlySecondOptions","hourlySecondType");c.push(x)}var B=new Chart(840,319,"hourlyChart",1);B.renderChart("/charts.json?chartType=11&l=p&type="+c+"&accountOid="+C.accountOid+buildAdvancedStatisticsUrl(false,false));var m=new Chart(840,319,"dailyChart",1);m.renderChart("/charts.json?chartType=12&l=p&type="+c+"&accountOid="+C.accountOid+buildAdvancedStatisticsUrl(false,false));var a=new Chart(856,319,"scatterChart",2);a.renderChart("/charts.json?chartType=14&l=p&type="+getAttributeByRadioChecked("durationOptions","durationType")+"&accountOid="+C.accountOid+buildAdvancedStatisticsUrl(false,true))}catch(A){}if(accountVerified){var c=[];c.push(getAttributeByRadioChecked("maeMfeOptions","maeMfeType"));c.push(getAttributeByRadioChecked("maeMfeSecondOptions","maeMfeSecondType"));var l=new Chart(856,319,"scatterChartMaeMfe",2);l.renderChart("/charts.json?chartType=16&l=p&type="+c+"&accountOid="+C.accountOid+buildAdvancedStatisticsUrl(false,true))}if($PT("monthlyCont")!=null){var E=new Chart(480,250,"monthlyCont",3);E.renderChart("/charts.json?chartType=3&accountOid="+C.accountOid+"&monthType="+monthType+"&l="+C.l+"&startDate="+getDbDateFormat(C.end).substring(0,4)+"-01-01&endDate="+getDbDateFormat(C.end)+"&startDateYear="+getDbDateFormat(C.start)+buildAdvancedStatisticsUrl(true,false))}if($PT("riskRatios")!=null){var t=new Chart(342,250,"riskRatios",3,$F("psaml"))}if($PT("currencies")!=null){var k=new Chart(480,250,"currencies",4,$F("psaml"))}if($PT("holdPeriod")!=null){var s=new Chart(342,250,"holdPeriod",1,$F("psaml"))}var v=["?start=",encodeParameter(getDbTimeFormat(C.start)),"&end=",encodeParameter(getDbTimeFormat(C.end)),"&magicNumbers=",C.magicNumbers,"&symbols=",C.symbols,"&orderTags=",C.orderTags,"&days=",C.days,"&hours=",C.hours,C.comment,"&buySell=",C.buySell,"&yieldStart=",C.yieldStart,"&yieldEnd=",C.yieldEnd,"&netProfitStart=",C.netProfitStart,"&netProfitEnd=",C.netProfitEnd,"&durationStart=",C.durationStart,"&durationEnd=",C.durationEnd,"&takeProfitStart=",C.takeProfitStart,"&takeProfitEnd=",C.takeProfitEnd,"&stopLoss=",C.stopLoss,"&stopLossEnd=",C.stopLossEnd,"&sizingStart=",C.sizingStart,"&sizingEnd=",C.sizingEnd,"&selectedTime=",C.selectedTime,"&pipsStart=",C.pipsStart,"&pipsEnd=",C.pipsEnd,C.commentOption].join("");var d;var o=["pdf","csv","html"];for(var y=0;y<o.length;y++){d=$PT(o[y]+"Statement").href;if($is(d)){$PT(o[y]+"Statement").href=d.substring(0,d.indexOf("?")!=-1?d.indexOf("?"):d.length)+v}}SortableTable.find();rowIndex={}}else{if(q.content.negativeBalance!=undefined&&q.content.negativeBalance){inlineMsg("customDeposit",$T("tNegativeBalanceReached"),3)}else{inlineMsg("analyzeButton",q.message,3)}}tradeChart.write("chartContainer");if($PT("tradeBrowserElement").className=="on"){getTradeConfig(C.accountOid,$F("tradeSymbols"),true,"","","",null,C.l)}new Draggable("tradeBrowserWindow",{ghosting:true})}function updateAdvancedStrategy(k,b,f){var d=["tabs18","tradeList",$PT("analyzeTradeTab")];var h=new SwitchToTradeTab(d);if(validate("yieldStart",VALID_DOUBLE,h)&&validate("yieldEnd",VALID_DOUBLE,h)&&validate("netProfitStart",VALID_DOUBLE,h)&&validate("netProfitEnd",VALID_DOUBLE,h)&&validate("durationStart",VALID_INTEGER_OR_EMPTY,h)&&validate("durationEnd",VALID_INTEGER_OR_EMPTY,h)&&validate("takeProfitStart",VALID_DOUBLE_POSITIVE,h)&&validate("takeProfitEnd",VALID_DOUBLE_POSITIVE,h)&&validate("stopLoss",VALID_DOUBLE_POSITIVE,h)&&validate("stopLossEnd",VALID_DOUBLE_POSITIVE,h)&&validate("sizingStart",VALID_DOUBLE_POSITIVE,h)&&validate("sizingEnd",VALID_DOUBLE_POSITIVE,h)&&validate("pipsStart",VALID_DOUBLE,h)&&validate("pipsEnd",VALID_DOUBLE,h)){var a="";var c="";mainStrategyChartStatus=1;if(hasText($F("durationStart"))){a=parseInt($F("durationStart"))*parseInt($F("selectedDuration"))}if(hasText($F("durationEnd"))){c=parseInt($F("durationEnd"))*parseInt($F("selectedDuration"))}var g=["&start=",getDbTimeFormat(k),"&end=",getDbTimeFormat(b),"&oid=",f,"&magicNumbers=",getCheckBoxesValues("accountMagic"),"&days=",getCheckBoxesValues("days"),"&hours=",getCheckBoxesValues("hours"),"&buySell=",getCheckBoxesValues("buySell"),"&yieldStart=",$F("yieldStart"),"&yieldEnd=",$F("yieldEnd"),"&netProfitStart=",$F("netProfitStart"),"&netProfitEnd=",$F("netProfitEnd"),"&durationStart=",a,"&durationEnd=",c,"&takeProfitStart=",$F("takeProfitStart"),"&takeProfitEnd=",$F("takeProfitEnd"),"&stopLoss=",$F("stopLoss"),"&stopLossEnd=",$F("stopLossEnd"),"&sizingStart=",$F("sizingStart"),"&sizingEnd=",$F("sizingEnd"),"&selectedTime=",getCheckBoxesValues("selectedTime"),"&pipsStart=",$F("pipsStart"),"&pipsEnd=",$F("pipsEnd")];fxAjax.sendRequest(fxVars.updateAdvancedStrategy+g.join(""),{returnJson:true,params:{start:k,end:b,oid:f},loader:true,callback:"updateAdvancedStrategyResponse"})}}function updateAdvancedStrategyResponse(v,k){if(!v.error){selectTimeframeHide($PT("customAnalysisButt"));$PT("analyzeCont").innerHTML=v.content;runAjaxScripts(v.content);disposeCharts(charts);if($PT("chart1")!=null){var t=new Chart(630,319,"chart1");t.renderChart("/strategy-chart.json?chartType=1&period=6&id="+k.oid+buildChartUrl())}try{if($PT("chart2")!=null){var g=new Chart(630,319,"chart2");g.renderChart("/strategy-chart.json?chartType=2&period=6&id="+k.oid+buildChartUrl())}if($PT("chart3")!=null){var b=new Chart(630,319,"chart3");b.renderChart("/strategy-chart.json?chartType=13&period=6&id="+k.oid+buildChartUrl())}}catch(m){}var d=$F("chartSymbol1");var q=new Chart(840,319,"symbolChart1");q.renderChart("/strategy-chart.json?chartType=10&id="+k.oid+buildSymbolChartUrl(d));var r=new Chart(840,319,"hourlyChart",1);r.renderChart("/strategy-chart.json?chartType=11&l=p&type=1&id="+k.oid+buildAdvancedStatisticsUrl(false,false));var u=new Chart(840,319,"dailyChart",1);u.renderChart("/strategy-chart.json?chartType=12&l=p&type=1&id="+k.oid+buildAdvancedStatisticsUrl(false,false));var h=new Chart(856,319,"scatterChart",2);h.renderChart("/strategy-chart.json?chartType=14&l=p&type=3&id="+k.oid+buildAdvancedStatisticsUrl(false,true));if($PT("monthlyCont")!=null){var c=new Chart(480,250,"monthlyCont",3);c.renderChart("/strategy-chart.json?chartType=3&id="+k.oid+"&startDate="+getDbDateFormat(k.end).substring(0,4)+"-01-01&endDate="+getDbDateFormat(k.end))}if($PT("riskRatios")!=null){var f=new Chart(342,120,"riskRatios",3,$F("psaml"))}if($PT("holdPeriod")!=null){var s=new Chart(342,120,"holdPeriod",1,$F("psaml"))}var o=["?start=",encodeParameter(getDbTimeFormat(k.start)),"&end=",encodeParameter(getDbTimeFormat(k.end)),"&days=",k.days,"&hours=",k.hours,"&buySell=",k.buySell,"&yieldStart=",k.yieldStart,"&yieldEnd=",k.yieldEnd,"&netProfitStart=",k.netProfitStart,"&netProfitEnd=",k.netProfitEnd,"&durationStart=",k.durationStart,"&durationEnd=",k.durationEnd,"&takeProfitStart=",k.takeProfitStart,"&takeProfitEnd=",k.takeProfitEnd,"&stopLoss=",k.stopLoss,"&stopLossEnd=",k.stopLossEnd,"&sizingStart=",k.sizingStart,"&sizingEnd=",k.sizingEnd,"&selectedTime=",k.selectedTime,"&pipsStart=",k.pipsStart,"&pipsEnd=",k.pipsEnd].join("");var a;var l="csv";a=$PT(l+"Statement").href;if($is(a)){$PT(l+"Statement").href=a.substring(0,a.indexOf("?")!=-1?a.indexOf("?"):a.length)+o}SortableTable.find()}else{inlineMsg("analyzeButton",v.message,3)}}function getDbDateFormat(a){var a=new Date(a);return a.getFullYear()+"-"+format2Digits(a.getMonth()+1)+"-"+format2Digits(a.getDate())}function getDbTimeFormat(a){var a=new Date(a);return a.getFullYear()+"-"+format2Digits(a.getMonth()+1)+"-"+format2Digits(a.getDate())+" "+format2Digits(a.getHours())+":"+format2Digits(a.getMinutes())}function escapeFlash(a){return a.replace(":","_")}function getMonthlyStart(){var c=new Date(userFormatToDefaultFormat($F("endDate"),$F("userTimeFormat")));var a=new Date(userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat")));var b=new Date("01/01/"+getContent($PT("chartYearsUl").children[$PT("chartYearsUl").children.length-1]));return b<a?getDbDateFormat(a):getDbDateFormat(b)}function updateTwitterCharacter(b,a){$PT(a+"1").innerHTML=b;$PT(a+"2").innerHTML=b}function accountInvitation(c){hideElement("errorMsg");var d=document.getElementsByClassName("invitationSettings");for(var b=0;b<d.length;b++){d[b].style.display="none"}var a=(c.item(c.selectedIndex)).attributes.invitationBlocked.value;if(a==="true"){showElement("errorMsg")}else{var f=(c.item(c.selectedIndex)).value;$PT("invitation"+f).style.display="";new Tip("#reTip"+f,$F("itt"))}}function saveAccountInvitation(){var c=$PT("accountInvitationsCombo");var a=c[c.selectedIndex].value;var b=["oid=",a];b.push("&balancePublic="+getRadioGroupValue("balancePublic"+a));b.push("&accountNumberPublic="+getRadioGroupValue("accountNumberPublic"+a));b.push("&historyPublic="+getRadioGroupValue("historyPublic"+a));b.push("&sizingPublic="+getRadioGroupValue("sizingPublic"+a));b.push("&ordersPublic="+getRadioGroupValue("ordersPublic"+a));b.push("&tradesPublic="+getRadioGroupValue("tradesPublic"+a));b.push("&commentsPublic="+getRadioGroupValue("commentsPublic"+a));b.push("&magicNumberPublic="+getRadioGroupValue("magicNumberPublic"+a));b.push("&accountTagPublic="+getRadioGroupValue("accountTagPublic"+a));b.push("&goalsPublic="+getRadioGroupValue("goalsPublic"+a));b.push("&slTpPublic="+getRadioGroupValue("slTpPublic"+a));b.push("&active="+$PT("invitationActive"+a).checked);fxAjax.sendRequest(fxVars.accountInvitation+b.join(""),{contentType:"text/xml",params:{oid:a},loader:true,callback:"saveAccountInvitationResponse"})}function saveAccountInvitationResponse(f,g){var a=f.getElementsByTagName("response")[0];var c=a.getAttribute("error");var d=a.getAttribute("message");if(c=="false"){var b=getContent(a);if(b.length!=0){$PT("invitationUrl"+g.oid).value=b}}$PT("accountInvitationResponse"+g.oid).innerHTML=d;$PT("accountInvitationResponse"+g.oid).style.display=""}function generateAccountInvitation(a){var b=["oid=",a];fxAjax.sendRequest(fxVars.generateInvitation+b.join(""),{contentType:"text/xml",params:{oid:a},loader:true,callback:"generateAccountInvitationResponse"})}function generateAccountInvitationVerify(a){var c=$PT("accountInvitationsCombo");var b=c[c.selectedIndex].value;if($PT("invitationActive"+b).checked){inlineAlert(a,"<span class=''></span>"+$T("tRegenerateUrl")+"<br/><br/><div class='center'><span class='exclamation'>"+$T("tOldUrlBlocked")+"</span></div>","generateAccountInvitation("+b+")")}else{inlineMsg("invitationActive"+b,$T("tEnableUrl"),3)}}function generateAccountInvitationResponse(f,g){var a=f.getElementsByTagName("response")[0];var c=a.getAttribute("error");var d=a.getAttribute("message");if(c=="false"){var b=getContent(a);if(b.length!=0){$PT("invitationUrl"+g.oid).value=b}}else{$PT("accountInvitationResponse"+g.oid).innerHTML=d;$PT("accountInvitationResponse"+g.oid).style.display=""}}function setActiveInvitation(){var b=$PT("accountInvitationsCombo");var a=b[b.selectedIndex].value;if(a!=0){$PT("invitation"+a).style.display="";new Tip("#reTip"+a,$F("itt"))}}function generateCommentDeleteVerify(d,f,b,a,c){inlineAlert(d,"<span class=''></span>"+$T("tConfirmCommentDelete")+"<br/>","addTradeComment("+f+","+b+","+a+",'"+c+"')")}function addTradeComment(f,b,a,c){if(validate(c+"text"+f,VALID_TEXT)){var g=["oid=",f,"&comment=",encodeParameter($PT(c+"text"+f).value),"&accountOid=",b,"&delete=",a,"&type="+c];var d=getLinksTitleByName(c+"orderFiles"+f);if(hasText(d)){g.push("&files=");g.push(encodeParameter(d))}fxAjax.sendRequest(fxVars.commentTrade,{contentType:"application/x-www-form-urlencoded; charset=utf-8",params:{oid:f,deleteComment:a,type:c},postBody:g.join(""),method:"post",loader:true,callback:"addTradeCommentResponse"})}}function hasText(a){try{if(a!=null){a=String(a);a=a.trim();return a.length!=0}}catch(b){}return false}function isImage(b){var a=b.substring(b.lastIndexOf(".")+1).toLowerCase();return(a=="jpg"||a=="jpeg"||a=="png"||a=="gif"||a=="bmp")}function selectTimeframeShow(a){$PT("timeframe").style.display="";$PT(a).onclick=function(){selectTimeframeHide(a)}}function selectTimeframeHide(a){if(calendarObjForForm.isVisible()){calendarObjForForm.hide()}$PT("timeframe").style.display="none";$PT(a).onclick=function(){selectTimeframeShow(a)}}var TIME_FORMAT_CUSTOM=1;function userFormatToDefaultFormat(b,d){if(d==TIME_FORMAT_CUSTOM){var c=b.split("/");var a=c[1]+"/"+c[0]+"/"+c[2];return a}return b}function updatePeriods(k,g,b,h,f){if(k==0){$PT("startDate").value=g}else{var c=new Date(userFormatToDefaultFormat(b,h));if(k==1||k==7){c.setDate(c.getDate()-k)}if(k==30||k==90||k==180){c.setMonth(c.getMonth()-k/30)}if(k==365){c.setFullYear(c.getFullYear()-1)}if(f===undefined||!f){c.setDate(c.getDate()-1)}var a=b.indexOf(":")!=-1;if(h==TIME_FORMAT_CUSTOM){$PT("startDate").value=format2Digits(c.getDate())+"/"+format2Digits(c.getMonth()+1)+"/"+c.getFullYear()}else{$PT("startDate").value=format2Digits(c.getMonth()+1)+"/"+format2Digits(c.getDate())+"/"+c.getFullYear()}if(a){$PT("startDate").value+=" "+format2Digits(c.getHours())+":"+format2Digits(c.getMinutes())}}$PT("endDate").value=b}function addTradeCommentResponse(m,k){var l=m.getElementsByTagName("response")[0];var s=l.getAttribute("error");var t=l.getAttribute("message");var o=getContent(l);var r=k.type;var g=k.oid;if(s=="false"){if(k.deleteComment){var q=$PT(r+"ballon"+g);q.onmouseover="";q.onmouseout="";Tipped.remove(q);q.onclick=function(){commentTrade(g,r)};q.className="pencilSmall pointer";q.id=r+"pencil"+g;$PT(r+"commentDeleteButt"+g).style.display="none";$PT(r+"text"+g).value="";$PT(r+"orderFiles"+g).innerHTML=""}else{var b=getLinksTitleByName(r+"orderFiles"+g);var h=hasText(b);attachFiles(g,b,r);var d=$PT(r+"pencil"+g);var f=h?o+"<br/><br/>"+$T("tAttachments")+":<br/><div>"+$PT(r+"files"+g).innerHTML:o+"</div>";if(d!=null){d.className="ballonSmall pointer";d.id=r+"ballon"+g;buildOrderTip(d.id,f,h);d.onclick=function(){commentTrade(g,r)}}else{var q=$PT(r+"ballon"+g);buildOrderTip(q.id,f,h);q.onclick=function(){commentTrade(g,r)}}$PT(r+"commentDeleteButt"+g).style.display="";var a=htmlDecode(o.replace(/<br\/>/g,"\n"));$PT(r+"originalComment"+g).value=a}$PT(r+"history"+g).style.display="none";var c=$PT(r+"pencil"+g);if(c==null){c=$PT(r+"ballon"+g)}boldTD(c)}}function removeOrderFile(b,a){$PT(a+"orderFileLink"+b).remove();$PT(a+"orderFileRemove"+b).remove();$PT(a+"orderFileBr"+b).remove();if($PT(a+"insert"+b)){$PT(a+"insert"+b).remove()}}function buildOrderTip(c,b,a){if(a){new Tip("#"+c,b,{hideOthers:true,maxWidth:500,hook:{target:"rightmiddle",tooltip:"leftmiddle"}})}else{new Tip("#"+c,b,{hideOthers:true,maxWidth:500,hook:{target:"rightmiddle",tooltip:"leftmiddle"}})}}function getLinksTitleByName(d){var a=[];var c=document.getElementsByName(d);for(var b=0;b<c.length;b++){a.push(c[b].title)}return a.join(",")}function attachFiles(b,g,k){var d=$F("sessionUsername");$PT(k+"files"+b).innerHTML="";try{var a=g.split(",");a=orderFiles(a);for(var f=0;f<a.length;f++){var c=removeSpace(a[f]);var l=encodeParameter(c);if(isImage(c)){var m="img"+getRandomInt();$PT(k+"files"+b).innerHTML+="<a id="+m+' target="_blank" href="/files/'+d+"/"+l+'" style="color:white;text-align:center"></a>&nbsp;';$PT(m).insert(new Element("img",{src:"/files/"+d+"/"+l,style:"margin-bottom:2px; border:2px solid #5F5F5F;max-width:220px; max-height:220px"}))}else{$PT(k+"files"+b).innerHTML+='<a style="color:white" target="_blank" href="/files/'+d+"/"+l+'">'+c+"</a><br/>"}}}catch(h){}}function orderFiles(c){var d=[];for(var b=0;b<c.length;b++){var g=c[b];var a=g.substring(g.lastIndexOf(".")+1).toLowerCase();var f=(a=="jpg"||a=="jpeg"||a=="png"||a=="gif"||a=="bmp");if(f){d.push(g)}else{d.reverse();d.push(g);d.reverse()}}return d}function removeSpace(a){return a.replace(/\n/g,"").trim()}function closeAddTradeComment(d,c){$PT(c+"history"+d).style.display="none";var a=$PT(c+"originalComment"+d);if(a!=null){$PT(c+"text"+d).value=$PT(c+"originalComment"+d).value}var b=$PT(c+"pencil"+d);if(b==null){b=$PT(c+"ballon"+d)}b.onclick=function(){commentTrade(d,c)};boldTD(b)}function boldTD(b){var d=$PT(b).parentNode;if(d.tagName.toLocaleLowerCase()=="td"){d=d.parentNode}var c=d.getElementsByTagName("td");for(var a=0;a<c.length;a++){if($PT(c[a]).style.fontWeight!="bold"){$PT(c[a]).style.fontWeight="bold"}else{$PT(c[a]).style.fontWeight="normal"}}}function commentTrade(c,b){if(isShown("tagMenu"+b+c)){showHideTags(b+"history"+c)}if(isShown("tagMenu"+b+lastRowId)){showHideTags(b+"history"+lastRowId)}if(!isShown(b+"history"+c)){Tipped.hideAll()}var a=($PT(b+"pencil"+c)==null?$PT(b+"ballon"+c):$PT(b+"pencil"+c));if(!isShown(b+"history"+c)){$PT(b+"history"+c).style.display="";boldTD(a);a.onclick=function(){commentTrade(c,b)}}else{$PT(b+"history"+c).style.display="none";boldTD(a);a.onclick=function(){commentTrade(c,b)}}}var refresh=1;function refreshDashboardData(b){var d=0;if(!busy){busy=true;var c=getRecentTopicFromPage();var a=$("[name=timeNews]").first();if(a.length==0){d=0}else{d=a.attr("time")}fxAjax.sendRequest(fxVars.refreshDashboard+d,{contentType:"text/xml",params:{oldItems:c},loader:false,callback:"refreshDashboardDataResponse"})}}function refreshDashboardDataResponse(m,f){var g=m.getElementsByTagName("response")[0];var r=g.getAttribute("error");var v=g.getAttribute("message");var t=m.getElementsByTagName("news")[0];var h=m.getElementsByTagName("systems")[0];var l=m.getElementsByTagName("calendar")[0];var c=m.getElementsByTagName("topics")[0];if(r=="false"){try{if(hasText(getContent(t))){$PT("scrollbar_content").innerHTML="<div id='newCont"+(refresh)+"' style='display:none'>"+getContent(t)+"</div>"+$PT("scrollbar_content").innerHTML;Effect.SlideDown($PT("newCont"+refresh),{duration:0.5});refresh++}$PT("recentTopicsCont").innerHTML=getContent(c);var u=getRecentTopicFromPage();setLastPostsEffect(f.oldItems,u);if(!isShown("watched")&&$("#accountNotification").hasClass("in")!=true){$PT("systemsCont").innerHTML=getContent(h);runAjaxScripts(getContent(h))}}catch(o){}cleanTopNews();busy=false;if(typeof(saveNewsQueue)!=="undefined"&&saveNewsQueue.length>0){var s=saveNewsQueue.shift();s()}}var a=document.getElementsByName("timeNews");for(var k=0;k<a.length;k++){var q=a[k].attributes.time.value;var b=dateToString(q);if(b!="false"){a[k].innerHTML="&nbsp; "+b}}}function tableSort(f,o,t,b,l,m,c,g,s,q){var d=f.getAttribute("order");var a=f.parentNode.getElementsByTagName("th");if(d=="1"){for(i=0;i<a.length;i++){a[i].className=""}}else{for(i=0;i<a.length;i++){a[i].className=""}}if(m.length>0){m="&l="+m}var k=["?pt=",o,"&st=",d,"&sb=",t,"&id=",l,m,"&ts=",q,"&p=1"];if(c.length!=0&&g.length!=0){k.push("&start=",c,"&end=",g)}if(s!=null){k.push("&invitation=",s)}var h=$J("#formatSlTpHistory ,#formatSlTp").children(":selected").attr("id");var r=getComboValue("timeSwitcher");fxAjax.sendRequest(fxVars.pagingUrl+k.join(""),{contentType:"text/html",params:{cont:b,slTpOption:h,showInBrokerTime:r},loader:true,callback:"tableSortResponse"})}function tableSortResponse(a,b){$PT(b.cont).innerHTML=a;runAjaxScripts(a);if(b.slTpOption!=undefined){showHideSlTpOptions(b.slTpOption,"")}if(b.showInBrokerTime!=undefined){tradingActivityTimeSwitcher(b.showInBrokerTime,"")}}function gup(c,b){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+c+"=([^&#]*)";var f=new RegExp(a);var d;if(b==null){d=f.exec(window.location.href)}else{d=f.exec(b)}if(d==null){return""}else{return d[1]}}function initSearchForm(){try{$PT("profitSelect").value=setComboValue("profitSelect",parseInt(gup("profitType")));$PT("profitVal").value=setComboValue("profitVal",parseInt(gup("profitValue")));$PT("drawdownSelect").value=setComboValue("drawdownSelect",parseInt(gup("drawType")));$PT("drawdownVal").value=setComboValue("drawdownVal",parseInt(gup("drawValue")));$PT("ageType").value=setComboValue("ageType",parseInt(gup("ageType")));$PT("ageSelect").value=setComboValue("ageSelect",parseInt(gup("ageValue")));$PT("tradingTypeSelect").value=setComboValue("tradingTypeSelect",parseInt(gup("tradingType")));$PT("systemTypeSelect").value=setComboValue("systemTypeSelect",parseInt(gup("systemType")));$PT("currSelect").value=setComboValue("currSelect",parseInt(gup("symbols")));$PT("accountTypeSelect").value=setComboValue("accountTypeSelect",parseInt(gup("accountType")));$PT("regulationTypeSelect").value=setComboValue("regulationTypeSelect",parseInt(gup("regulationType")))}catch(a){}}function setComboValue(f,d){var c=$PT(f);var a=c.options.length;for(var b=0;b<a;b++){if(c.options[b].value==d){c.options[b].selected="selected"}else{c.options[b].selected=""}}}var mainChartStatus=1;function updateMainChart(c,h){if(h==null){h=""}var a;var b=document.getElementsByName("growthOptions");for(var d=0;d<b.length;d++){if(b[d].checked){a=d;break}}if(mainChartStatus!=a){disposeCharts(["chartGrowth","chartBalance"]);mainChartStatus=a;var g=new Chart(630,314,"chart1",0);g.renderChart("/charts.json?chartType=1&period=6&accountOid="+c+"&size=0"+buildAdvancedStatisticsUrl(false,false));var f=new Chart(630,314,"chart2",0);f.renderChart("/charts.json?chartType=2&period=6&accountOid="+c+"&size=0"+buildAdvancedStatisticsUrl(false,false))}}var mainStrategyChartStatus=1;function updateMainStrategyChart(g){var a;var b=document.getElementsByName("growthOptions");for(var c=0;c<b.length;c++){if(b[c].checked){a=c;break}}if(mainStrategyChartStatus!=a){mainStrategyChartStatus=a;var f=new Chart(630,319,"chart1");f.renderChart("/strategy-chart.json?chartType=1&period=6&id="+g+"&size=0"+buildChartUrl());var d=new Chart(630,319,"chart2");d.renderChart("/strategy-chart.json?chartType=2&period=6&id="+g+"&size=0"+buildChartUrl())}}function buildSymbolChartUrl(b){var a=[];a.push("&symbol=");a.push(encodeParameter(b));a.push(buildAdvancedStatisticsUrl(false,false));return a.join("")}function buildAdvancedStatisticsUrl(c,o){var b=[];var d="";var m="";var a=$PT("showMain");if(hasText($F("durationStart"))){d=parseInt($F("durationStart"))*parseInt($F("selectedDuration"))}if(hasText($F("durationEnd"))){m=parseInt($F("durationEnd"))*parseInt($F("selectedDuration"))}if(!c){b.push("&startDate=");b.push(escapeFlash(getDbTimeFormat((userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat"))))));b.push("&endDate=");b.push(escapeFlash(getDbTimeFormat((userFormatToDefaultFormat($F("endDate"),$F("userTimeFormat"))))))}b.push("&magicNumbers=");b.push(getAnalyzedMagicsNumbers());b.push("&symbols=");b.push(getCheckBoxesValues("accountSymbol"));b.push("&tags=");b.push(getCheckBoxesValues("accountTag"));b.push("&days=");b.push(getCheckBoxesValues("days"));b.push("&hours=");b.push(getCheckBoxesValues("hours"));b.push(getCommentBoxesValues());b.push("&buySell=");b.push(getCheckBoxesValues("buySell"));b.push("&yieldStart=");b.push($F("yieldStart"));b.push("&yieldEnd=");b.push($F("yieldEnd"));b.push("&netProfitStart=");b.push($F("netProfitStart"));b.push("&netProfitEnd=");b.push($F("netProfitEnd"));b.push("&durationStart=");b.push(d);b.push("&durationEnd=");b.push(m);b.push("&takeProfitStart=");b.push($F("takeProfitStart"));b.push("&takeProfitEnd=");b.push($F("takeProfitEnd"));b.push("&stopLoss=");b.push($F("stopLoss"));b.push("&stopLossEnd=");b.push($F("stopLossEnd"));b.push("&sizingStart=");b.push($F("sizingStart"));b.push("&sizingEnd=");b.push($F("sizingEnd"));b.push("&selectedTime=");b.push(getCheckBoxesValues("selectedTime"));b.push("&pipsStart=");b.push($F("pipsStart"));b.push("&pipsEnd=");b.push($F("pipsEnd"));var l=$PT("invitation");var g=$PT("showSizingCheck").checked;if(g!=null){b.push("&showLots=");b.push(g)}var f=$PT("showPipsCheck").checked;if(f!=null){b.push("&showPips=");b.push(f)}var k=$PT("showChangeCheck").checked;if(f!=null){b.push("&showChange=");b.push(k)}if($PT("showSymbolPipsCheck")!=undefined){var h=$PT("showSymbolPipsCheck").checked;if(h!=null){b.push("&showSymbolPips=");b.push(h)}}if(l!=null){b.push("&invitation=");b.push(l.value)}if(a!=null){b.push("&showMain=");b.push(a.checked)}else{b.push("&showMain=true")}b.push(getCommentsOptions("commentOption"));if($PT("customDeposit")!=undefined&&$F("customDeposit")!=0){b.push("&customDeposit=");b.push($F("customDeposit"))}return b.join("")}function buildChartUrl(){var b=[];var h=$PT("invitation");var c=(userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat")));var g=(userFormatToDefaultFormat($F("endDate"),$F("userTimeFormat")));var f=$PT("showSizingCheck").checked;var d=$PT("showPipsCheck").checked;var k=$PT("showChangeCheck").checked;var l=$PT("showSimulated");var a=$PT("showMain");if(h!=null){b.push("&invitation=");b.push(h.value)}b.push("&startDate=");b.push(getDbDateFormat(c));b.push("&endDate=");b.push(getDbDateFormat(g));b.push("&showLots=");b.push(f);b.push("&showPips=");b.push(d);b.push("&showChange=");b.push(k);b.push("&magicNumbers=");b.push(getCheckBoxesValues("accountMagic"));b.push("&symbols=");b.push(getCheckBoxesValues("accountSymbol"));b.push("&tags=");b.push(getCheckBoxesValues("accountTag"));b.push("&days=");b.push(getCheckBoxesValues("days"));if(a!=null){b.push("&showMain=");b.push(a.checked)}else{b.push("&showMain=true")}if(l!=null){b.push("&showSimulated=");b.push(l.checked)}return b.join("")}function getMt4Servers(){var selectedId=$PT("serverId").value;var mt4Combo=$PT("mt4ServerId");var selectedMt4ServerId=$PT("selectedMt4ServerId");if(mt4Combo==null){return}var servers=eval($PT("mt4Servers")!=null?$PT("mt4Servers").value:[]);clearCombo("mt4ServerId");for(var i in servers){var serverInput=servers[i];if(serverInput.parentServer!=null&&serverInput.parentServer.oid==selectedId){var newOption=new Option(serverInput.name,serverInput.oid);mt4Combo.options.add(newOption);if(typeof(selectedId)!="undefined"&&selectedMt4ServerId!=undefined){if(parseInt(selectedMt4ServerId.value)==serverInput.oid){mt4Combo.options[mt4Combo.options.length-1].selected="selected"}}}}if(mt4Combo.options.length==0){var newOption=new Option("No servers",0);mt4Combo.options.add(newOption);showHideConnectBtn(false)}else{showHideConnectBtn(true)}}function clearCombo(b){var a=$PT(b);while(a!=null&&a.options.length!=0){a.remove(0)}}function generatOwnerKey(a){var b=["accountOid=",a];fxAjax.sendRequest(fxVars.generateOwnerKey+b.join(""),{contentType:"text/xml",params:{cont:"ownerValidationKey"},loader:true,callback:"generatOwnerKeyResponse"})}function generatOwnerKeyResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){$PT(f.cont).value=getContent(a)}}function resetTwitter(a){inlineAlert(a,$T("tConfirmTwitterRemove"),"executeDeleteTwitter()")}function setDefaultTwitterAlert(a,b){inlineAlert(a,$T("tUseTwitterForAll")+"<br/>"+$T("tTwitterOverwritten"),"setDefaultTwitter("+b+")")}function getComboValue(b){try{return $PT(b).item($PT(b).selectedIndex).id}catch(a){return undefined}}function executeDeleteTwitter(){var a=getComboValue("twitterAccountSelect");fxAjax.sendRequest(fxVars.twitterReset+a,{contentType:"text/xml",params:{cont:"twitterStatusOk"},loader:true,callback:"executeDeleteTwitterResponse"})}function executeDeleteTwitterResponse(f,g){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=a.getAttribute("message");if(b=="false"){var c=$PT(g.cont);c.innerHTML=$T("tNoTwitterActive");c.className="responseRed marginT5";c.style.width="400px";$PT("createTwitterUrlRow").style.display="";$PT("resetTwitter").style.display="none"}}var savingCustomStart=false;function saveCustomStart(b,d){if(!savingCustomStart){savingCustomStart=true;var a=getDbTimeFormat((userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat"))));var c=["accountOid=",b,"&start=",a,"&custom=",d];fxAjax.sendRequest(fxVars.customStartDate+c.join(""),{contentType:"text/xml",params:{custom:d,accountOid:b,start:a},loader:true,callback:"saveCustomStartResponse"})}}function saveCustomStartResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){setDefaultDateButton(f.accountOid,f.custom);if(f.custom){$PT("customStartDate").innerHTML=$T("tCustomStartSet",[$PT("startDate").value])}else{$PT("customStartDate").innerHTML=""}defaultDate=f.start}else{inlineMsg("pinBg",c,3)}savingCustomStart=false}function setDefaultDateButton(a,b){if(b){$PT("pinBg").className="active";$PT("pinButt").className="pin"}else{$PT("pinBg").className="";$PT("pinButt").className="pinOff"}$PT("pinBg").onclick=function(){saveCustomStart(a,!b)}}function setFontWeight(b,a){if(b!=null){b.style.fontWeight=a}}function saveCustomMagics(a,h){var g=document.getElementsByName("accountMagic");var c="";for(var b=0;b<g.length;b++){var d=g[b];if(d.checked){if(h){c=c+d.value+","}}}if($PT("showMain")!=null&&$PT("showMain").checked){c=c+"a,"}if($PT("magic")!=null&&$PT("magic").checked){c=c+"m,"}c=c.substring(0,c.length-1);var f=["accountOid=",a,"&magics=",c,"&custom=",h];fxAjax.sendRequest(fxVars.customMagics+f.join(""),{contentType:"text/xml",params:{custom:h,accountOid:a},loader:true,callback:"saveCustomMagicsResponse"})}function saveCustomMagicsResponse(data,params){var response=data.getElementsByTagName("response")[0];var error=response.getAttribute("error");var message=response.getAttribute("message");if(error=="false"){setMagicButton(params.accountOid,!params.custom);var elements=document.getElementsByName("accountMagic");for(var i=0;i<elements.length;i++){var el=elements[i];console.debug(el);if(el.checked){if(params.custom){setFontWeight($PT("label"+el.value),"bold");defaultMagics=eval("["+getContent(response)+"]")}else{setFontWeight($PT("label"+el.value),"")}}else{setFontWeight($PT("label"+el.value),"")}setFontWeight($PT("labelShowMain"),params.custom&&$PT("showMain").checked?"bold":"");if($PT("magic")!=null){setFontWeight($PT("labelShowManual"),params.custom&&$PT("magic").checked?"bold":"")}}}}function setMagicButton(a,b){if(b){$PT("magicsPinBg").className="";$PT("magicsPinButt").className="pinOff"}else{$PT("magicsPinBg").className="active";$PT("magicsPinButt").className="pin"}$PT("magicsPinBg").onclick=function(){saveCustomMagics(a,b)}}function inArray(d,c){var b=false;for(var a=0;a<d.length;a++){if(d[a]==c){b=true;break}}return b}function checkDefaultMagics(b){var a=false;var g=document.getElementsByName("accountMagic");var f=0;for(var c=0;c<g.length;c++){var d=g[c];if(d.checked){if(!inArray(defaultMagics,d.value)){a=true;break}f++}}if($PT("showMain")!=null&&$PT("showMain").checked){f++}if($PT("magic")!=null&&$PT("magic").checked){f++}if(f!=defaultMagics.length){a=true}setMagicButton(b,a)}function scroll(a){Effect.ScrollTo(a);return false}AIM={frame:function(g){var f="f"+getRandomInt();var b=document.createElement("DIV");b.innerHTML='<iframe style="display:none" src="about:blank" id="'+f+'" name="'+f+'" onload="AIM.loaded(\''+f+"')\"></iframe>";document.body.appendChild(b);var a=document.getElementById(f);if(g&&typeof(g.onComplete)=="function"){a.onComplete=g.onComplete}return f},form:function(b,a){b.setAttribute("target",a)},submit:function(a,d,b){if(typeof b!="undefined"){this.p=b}AIM.form(a,AIM.frame(d));if(d&&typeof(d.onStart)=="function"){return d.onStart()}else{return true}},loaded:function(c){var a=document.getElementById(c);if(a.contentDocument){var b=a.contentDocument}else{if(a.contentWindow){var b=a.contentWindow.document}else{var b=window.frames[c].document}}if(b.location.href=="about:blank"){return}if(typeof(a.onComplete)=="function"){a.onComplete(JSON.parse(b.body.innerHTML),this.p)}}};function getRandomInt(){return Math.floor(Math.random()*99999)}function hideElement(b){try{$PT(b).style.display="none"}catch(a){}}function showElement(b){try{$PT(b).style.display=""}catch(a){}}function clearElement(b){try{$PT(b).value=""}catch(a){}}function isVisible(b){try{return $PT(b).style.display==""}catch(a){return false}}function managePortfolios(){showElement("portfolioManageDiv");hideElement("accountsListDiv")}function addPortfolio(){if(validate("newPortfolioName",VALID_PORTFOLIO_NAME)){fxAjax.sendRequest(fxVars.addPortfolio+encodeParameter($PT("newPortfolioName").value),{contentType:"text/xml",params:{},loader:true,callback:"addPortfolioResponse"})}}function addPortfolioResponse(f,h){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=a.getAttribute("message");var c=f.getElementsByTagName("accounts")[0];var g=f.getElementsByTagName("menu")[0];if(b=="false"){$PT("accountsDiv").innerHTML=getContent(c);$PT("accountsNav").innerHTML=getContent(g);runAjaxScripts(getContent(c));runAjaxScripts(getContent(g))}}function deletePortfolio(a){fxAjax.sendRequest(fxVars.deletePortfolio+a,{contentType:"text/xml",params:{},loader:true,callback:"addPortfolioResponse"})}function setAccountPortfolio(b,a){var c=["accountOid=",b,"&portfolioOid=",a];fxAjax.sendRequest(fxVars.setAccountPortfolio+c.join(""),{params:{accountOid:b,portfolioOid:a},loader:true,callback:"setAccountPortfolioResponse"})}function setAccountPortfolioResponse(data,params){if(!data.error){$PT("accountsNav").innerHTML=data.content.data;runAjaxScripts(data.content.data);if($PT("portfoliosMessage").style.display=="none"){$PT("portfoliosMessage").innerHTML=data.message;showElement("portfoliosMessage");window.setTimeout(function(){$J("#portfoliosMessage").fadeOut()},(1000))}var changedAccount=$J("#settingsAccount"+params.accountOid);var portfolio=$J("#portfolioTitle"+params.portfolioOid);var oldPortfolioOid=changedAccount.attr("portfolioOid");changedAccount.attr("class","");$J("#settingsAccountSelectField"+params.accountOid).attr("style","border: 1px solid rgb(226, 225, 225);");changedAccount.attr("portfolioOid",params.portfolioOid);changedAccount.attr("portfolioAccountOid",data.content.newPortfolioAccountOid);changedAccount.fadeOut(600,function(){portfolio.after(changedAccount);if(eval(portfolio.attr("isOpen"))){changedAccount.fadeIn(600)}});updateSettingsPortfolioAccountsSize(params.portfolioOid,oldPortfolioOid)}}function exitManagePortfolios(){hideElement("portfolioManageDiv");showElement("accountsListDiv")}function updatePortfolios(){var c=[];var b=document.getElementsByName("portfolios");if(b.length>0){for(var a=0;a<b.length;a++){c.push("&ids=");c.push(b[a].id.substring(9));c.push("&names=");c.push(encodeParameter(b[a].value))}fxAjax.sendRequest(fxVars.updatePortfolioName+c.join(""),{contentType:"text/xml",params:{},loader:true,callback:"updatePortfolioResponse"})}}function updatePortfolioResponse(f,h){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=a.getAttribute("message");var c=f.getElementsByTagName("accounts")[0];var g=f.getElementsByTagName("menu")[0];if(b=="false"){$PT("accountsDiv").innerHTML=getContent(c);$PT("accountsNav").innerHTML=getContent(g);runAjaxScripts(getContent(c));if($PT("portfoliosChangedMessage").style.display=="none"){$PT("portfoliosChangedMessage").innerHTML=d;showElement("portfoliosChangedMessage");window.setTimeout(function(){$J("#portfoliosChangedMessage").fadeOut()},(1000))}}}function changeLanguageFooter(a){if(a!=0){if(hasText($F("sessionUsername"))){fxAjax.sendRequest(fxVars.changeLanguage+a,{contentType:"text/xml",params:{val:a},loader:false,callback:"changeLanguageResponse"})}else{setCookie("locale",a,YEAR);window.location.reload()}}return false}function changeLanguageResponse(a,b){if(!a.error){setCookie("locale",b.val,YEAR);window.location.reload()}}var translationCookie="translation";function getTextToTranslate(){var a=$F("languageSelect");if(a!=0){setCookie(translationCookie,a,YEAR);if(window.location.pathname.match("/translations")){window.location="/translations/translate/1"}else{window.location.reload()}}}function saveTranslation(b){if(tokensUsed(b)){$PT("saveButton"+b).disabled="disabled";var a=["id=",b,"&text=",encodeParameter($F("translation"+b))];fxAjax.sendRequest(fxVars.saveTranslation+a.join(""),{contentType:"text/xml",params:{id:b,text:$F("translation"+b)},loader:true,callback:"saveTranslationResponse"})}}function saveTranslationResponse(data,params){var response=data.getElementsByTagName("response")[0];var error=response.getAttribute("error");var message=response.getAttribute("message");var saveButton=$PT("saveButton"+params.id);if(error=="false"){translateArea(params.id);if(eval(getContent(response))){$PT("userTranslationCount").innerHTML=parseInt($PT("userTranslationCount").innerHTML)+1}$PT("translationPreview"+params.id).innerHTML=params.text}else{inlineMsg("saveButton"+params.id,message,3)}saveButton.disabled=""}function editTranslation(b){if(tokensUsed(b)){$PT("saveButton"+b).disabled="disabled";var a=["id=",b,"&text=",encodeParameter($F("translation"+b))];fxAjax.sendRequest(fxVars.editTranslation+a.join(""),{contentType:"text/xml",params:{id:b,text:$F("translation"+b)},loader:true,callback:"editTranslationResponse"})}}function editTranslationResponse(c,d){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");if(b=="false"){hideElement("translateArea"+d.id);$PT("myTranslation"+d.id).innerHTML=d.text;showElement("myTranslation"+d.id)}$PT("saveButton"+d.id).disabled=""}function translationDir(){if($PT("translation").dir=="ltr"){$PT("translation").dir="rtl"}else{$PT("translation").dir="ltr"}$PT("translation").focus()}function getAccountTwitter(){var a=getComboValue("twitterAccountSelect");if(a!=0){fxAjax.sendRequest(fxVars.getAccountTwitter+a,{contentType:"text/xml",params:{},loader:true,callback:"getAccountTwitterResponse"})}}function getAccountTwitterResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){$PT("twitterAccountDiv").innerHTML=getContent(a);prevTwitts();updateTwitterCharacter($PT("twitterPrev").value,"twitterPrev");updateTwitterCharacter($PT("twitterPost").value,"twitterPost")}}function setDefaultTwitter(a){fxAjax.sendRequest(fxVars.setDefaultTwitter+a,{contentType:"text/xml",params:{},loader:true,callback:"saveTwitterResponse"})}function translateArea(a){if($PT("translateArea"+a).style.display=="none"){showElement("translateArea"+a);$PT("translation"+a).focus();$PT("translation"+a).value=$PT("translationPreview"+a).innerHTML;setFontWeight($PT("textToTranslate"+a),"bold")}else{hideElement("translateArea"+a);setFontWeight($PT("textToTranslate"+a),"")}}function editTranslate(a){if($PT("translateArea"+a).style.display=="none"){showElement("translateArea"+a);$PT("translation"+a).focus()}else{hideElement("translateArea"+a)}}function insertToken(a,b){$PT("translation"+b).value+=getContent(a);hideElement(a)}function checkTokens(f){var c=$PT("tokensDiv"+f).children;var d=$F("translation"+f);var a=0;for(var b=0;b<c.length;b++){if(d.indexOf(getContent(c[b]),a)==-1){showElement(c[b])}else{hideElement(c[b]);a=d.indexOf(getContent(c[b]),a)+getContent(c[b]).length}}}function tokensUsed(d){var c=$PT("tokensDiv"+d).children;var b=0;for(var a=0;a<c.length;a++){if(c[a].style.display=="none"){b++}else{$J(c[a]).effect("highlight",{color:"#FF7F84"},2000)}}return b==c.length}function voteTranslation(b,a){fxAjax.sendRequest(fxVars.voteTranslation+b+"&vote="+a,{contentType:"text/xml",params:{id:b,vote:a},loader:true,callback:"voteTranslationResponse"})}function voteTranslationResponse(f,g){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");if(b=="false"){var d=parseInt(getContent(a));$PT("userVotesCount").innerHTML=parseInt($PT("userVotesCount").innerHTML)+d;if(d!=0){$PT("voteCount"+g.id).innerHTML=parseInt($PT("voteCount"+g.id).innerHTML)+g.vote;if($PT("voteDownIco"+g.id).className=="thumbDownOn pointer"){$PT("voteDownIco"+g.id).className="thumbDown pointer"}else{if($PT("voteUpIco"+g.id).className=="thumbUpOn pointer"){$PT("voteUpIco"+g.id).className="thumbUp pointer";$PT("voteDownIco"+g.id).className="thumbDown pointer"}else{var c=g.vote<0?"Down":"Up";$PT("vote"+c+"Ico"+g.id).className="thumb"+c+"On pointer"}}}}}var symbolChartStatus=1;function updateSymbolsChart(c){var a;var f=document.getElementsByName("symbolOptions");for(var d=0;d<f.length;d++){if(f[d].checked){a=d;break}}if(symbolChartStatus!=a){symbolChartStatus=a;for(var d=1;d<=$F("tradesSummarySize");d++){if(rowIndex[d]){var h="chartSymbol"+d;var g=new Chart(840,319,"symbolChart"+d);var b=$PT("rowNum"+d).getAttribute("symbol");g.renderChart("/charts.json?chartType=10&l=p&accountOid="+c+buildSymbolChartUrl(b))}}}}function updateSymbolsChartStrategies(c){var a;var f=document.getElementsByName("symbolOptions");for(var d=0;d<f.length;d++){if(f[d].checked){a=d;break}}if(symbolChartStatus!=a){symbolChartStatus=a}for(var d=1;d<=$F("tradesSummarySize");d++){var g=new Chart(840,319,"symbolChart"+d);var b=$F("chartSymbol"+d);g.renderChart("/strategy-chart.json?chartType=10&id="+c+buildSymbolChartUrl(b))}}function updateDurationChart(a,c){var b=new Chart(856,319,"scatterChart",2);b.renderChart("/charts.json?chartType=14&l=p&type="+c+"&accountOid="+a+buildAdvancedStatisticsUrl(false,true))}function updateDurationChartStrategy(a,c){var b=new Chart(856,319,"scatterChart",2);b.renderChart("/strategy-chart.json?chartType=14&l=p&type="+c+"&id="+a+buildAdvancedStatisticsUrl(false,true))}function openAllSymbols(b){for(var a=1;a<=$F("tradesSummarySize");a++){showHide($PT("symbolChartMode"+a),"chartSymbolRow"+a,b)}$PT("allSymbolsButt").onclick=function(){openAllSymbols(b==1?2:1)}}function contestRegister(g){var c="countryId";var b=$J("#addressTr").is(":visible");if(!busy&&validate("firstName",VALID_EN_NAME)&&validate("lastName",VALID_EN_NAME)&&validate(c,VALID_COUNTRY)&&validate("phone",VALID_PHONE_CONTEST)&&(b?validate("address",VALID_TEXT):true)&&validate("agree",VALID_AGREE_CONTEST)){$PT("contestReg").style.display="none";$PT("contestLoad").style.display="";busy=true;var d=["id=",g,"&firstName=",encodeParameter($F("firstName")),"&lastName=",encodeParameter($F("lastName")),"&countryId=",$F("countryId"),"&phone=",encodeParameter($("#phone").intlTelInput("getNumber"))];if(b){var a=$J("#address").val();d.push("&address="+encodeParameter(a))}var f={};f.isVerifiedPhoneNumber=phoneVerification.verifiedPhoneNumber!==null?true:false;fxAjax.sendRequest(fxVars.contestRegister+d.join(""),{contentType:"text/xml",params:f,loader:false,callback:"contestRegisterResponse"})}}function contestRegisterFixiMarket(c){if(!busy&&validate("firstName",VALID_EN_NAME)&&validate("lastName",VALID_EN_NAME)&&validate("phone",VALID_PHONE_CONTEST)&&validate("contestEmail",VALID_EMAIL)&&validate("agree",VALID_AGREE_CONTEST)&&validate("authorizedAgents",VALID_AGREE_EMAIL_CONTEST)){$("#contestReg").hide();$("#contestLoad").show();busy=true;var a=["id=",c,"&firstName=",encodeParameter($F("firstName")),"&lastName=",encodeParameter($F("lastName")),"&countryId=",$F("countryId"),"&phone=",encodeParameter($("#phone").intlTelInput("getNumber"))];var b={};b.isVerifiedPhoneNumber=phoneVerification.verifiedPhoneNumber!==null?true:false;a.push("&email="+$("#contestEmail").val());a.push("&language="+$("#contestLanguage").val());fxAjax.sendRequest(fxVars.contestApiRegister+a.join(""),{contentType:"text/xml",params:b,loader:false,callback:"contestApiRegisterResponse"})}}function contestStatus(a){fxAjax.sendRequest(fxVars.contestStatus+a,{contentType:"text/xml",params:{},loader:false,callback:"contestRegisterResponse"})}function contestApiRegisterResponse(a,b){if(!a.error){if(a.content.contest){$("#contestLoad").html(a.content.contest)}}else{if(a.content&&a.content.tryAgainWithEmailCont){$("#contestLoad").hide();$("#contestReg").show();inlineMsg("contestEmail","Emailaddress isalready registered, please use a different Email",5)}else{if(a.message){$("#contestLoad").text(a.message)}else{$("#contestLoad").text("General Error")}}}busy=false}function contestRegisterResponse(g,k){var b=g.getElementsByTagName("response")[0];var c=b.getAttribute("error");var f=b.getAttribute("message");var h=g.getElementsByTagName("menu")[0];var d=g.getElementsByTagName("contest")[0];hideElement("contestLoad");if(c=="false"){hideElement("contestReg");showElement("yhsm");$PT("yhsm").innerHTML=getContent(d);$PT("accountsNav").innerHTML=getContent(h);runAjaxScripts(getContent(h));var a=parseInt($PT("competitorsTotal").innerHTML);$PT("competitorsTotal").innerHTML=a+1}else{showElement("contestReg");inlineMsg("scbutt","<b>"+$T("tError")+"</b><br>"+f,3)}if(k.isVerifiedPhoneNumber){maskAndDisableVerifiedPhoneNumberInput("phone",phoneVerification.verifiedPhoneNumber.verifiedCountryCode,phoneVerification.verifiedPhoneNumber.verifiedMaskedPhoneNumber)}busy=false}var updateAccount=1;function contestActivity(c,b,d,a,f){fxAjax.sendRequest(fxVars.contestActivity+["lastTradeOid=",b,"&lastPostOid=",d,"&topicOid=",a,"&lastGeneralPostOid=",f,"&contestId=",c].join(""),{contentType:"text/xml",params:{contestId:c,topicOid:a},loader:false,callback:"contestActivityResponse"})}function contestActivityResponse(f,b){var c=f.getElementsByTagName("response")[0];var h=c.getAttribute("error");var l=f.getElementsByTagName("trades")[0];var a=f.getElementsByTagName("generalContestPosts")[0];var m=f.getElementsByTagName("posts")[0];var d=l.getAttribute("lastTradeOid");var k=m.getAttribute("lastPostOid");var g=a.getAttribute("lastGeneralPostOid");if(h=="false"){if(hasText(removeSpace(getContent(l)))){$PT("cra").innerHTML="<div id='newCont"+(updateAccount)+"' style='display:none'><div>"+getContent(l)+"</div></div>"+$PT("cra").innerHTML;Effect.SlideDown("newCont"+updateAccount,{duration:0.5});updateAccount++}if(hasText(removeSpace(getContent(m)))){hideElement("emptyPostList");$PT("posts1").innerHTML="<div id='newCont"+(updateAccount)+"' style='display:none'><div>"+getContent(m)+"</div></div>"+$PT("posts1").innerHTML;Effect.SlideDown("newCont"+updateAccount,{duration:0.5});updateAccount++}if(hasText(removeSpace(getContent(a)))){hideElement("emptyGenerealPostList");$PT("generalDiscussion").innerHTML="<div id='newCont"+(updateAccount)+"' style='display:none'><div>"+getContent(a)+"</div></div>"+$PT("generalDiscussion").innerHTML;Effect.SlideDown("newCont"+updateAccount,{duration:0.5});updateAccount++}}window.setTimeout(function(){contestActivity(b.contestId,d,k,b.topicOid,g)},10000)}var calRequests={};function calendarEmailAlert(c,a,b){if(calRequests[a]!=true){calRequests[a]=true;fxAjax.sendRequest(fxVars.calendarNotification+[a,"&add=",b].join(""),{contentType:"text/xml",params:{oid:a,add:b,e:c},loader:true,callback:"calendarEmailAlertResponse"});c.cancelBubble=true;if(c.stopPropagation){c.stopPropagation()}}}function calendarEmailAlertResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){if(f.add){$PT("calendarAlert"+f.oid).onclick=function(g){calendarEmailAlert(g?g:window.event,f.oid,false)};$PT("calendarAlert"+f.oid).className="notifyOn"}else{$PT("calendarAlert"+f.oid).onclick=function(g){calendarEmailAlert(g?g:window.event,f.oid,true)};$PT("calendarAlert"+f.oid).className="notifyOff"}}else{inlineMsg("calendarAlert"+f.oid,"<b>Error</b><br>"+c,3)}calRequests[f.oid]=false}function saveEmailMinAlert(l,o,d){var h="";var c=[];h=collectionCalendarFilter();var m=getCheckBoxValue("calendarBubble");var q=1;if(l=="cal"){var g=0;if(!isValidDate(userFormatToDefaultFormat($F("startDate"),o))){$PT("startDate").value=$PT("startDate").defaultValue}if(!isValidDate(userFormatToDefaultFormat($F("endDate"),o))){$PT("endDate").value=$PT("endDate").defaultValue}q=$PT("calPeriod").value;var a=userFormatToDefaultFormat($F("startDate"),o);var f=userFormatToDefaultFormat($F("endDate"),o);var b=new Date(a);var k=new Date(f);c=["&start=",getDbTimeFormat(b),"&end=",getDbTimeFormat(k)]}if($PT("notifyTimeM").checked){if($PT("mCalendarTime").value<10){inlineMsg($PT("mCalendarTime"),"<strong>"+$T("tError")+"</strong><br/>"+$T("tMinimalAlert"),3);return false}if(validate("mCalendarTime",VALID_INTEGER)){g=$PT("mCalendarTime").value;fxAjax.sendRequest(fxVars.saveEmailMinAlert+g+"&filter="+h+"&type="+l+"&bubble="+m+"&token="+d+"&calPeriod="+q+c.join(""),{contentType:"text/xml",params:{},loader:true,callback:"saveEmailMinAlertResponse"})}}else{if($PT("notifyTimeH").checked){if(validate("hCalendarTime",VALID_INTEGER)){g=$PT("hCalendarTime").value*60;fxAjax.sendRequest(fxVars.saveEmailMinAlert+g+"&filter="+h+"&type="+l+"&bubble="+m+"&token="+d+"&calPeriod="+q+c.join(""),{contentType:"text/xml",params:{},loader:true,callback:"saveEmailMinAlertResponse"})}}}}function saveEmailMinAlertEvent(b,a){fxWebsocket.getTokenForsaveEmailMinAlert(b,a)}function saveEmailMinAlertResponse(c,f){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=getContent(a);if(b=="false"){$PT("chartOptions").style.display="none";if(hasText(d)){$PT("calendarCont").innerHTML=d;runAjaxScripts(d)}}}function collectionCalendarFilter(){var b=[];var d=document.getElementsByName("eventsSymbol");for(var c=0;c<d.length;c++){if(d[c].checked){b.push(d[c].id.toUpperCase())}}var a=[];var f=[];if(getCheckBoxValue("eventsNone")){a.push(0)}if(getCheckBoxValue("eventsLow")){a.push(1)}if(getCheckBoxValue("eventsMedium")){a.push(2)}if(getCheckBoxValue("eventsHigh")){a.push(3)}f.push(a.join("-"));f.push("_");if(b.length>0){f.push(b.join("-"))}return f.join("")}function sort(c,a,d,h,k,b,g){if(!hasText(g)){g=""}var f=["?pt=",c,"&p=1&ts=",d,"&ps=",h,"&sb=",k,"&st=",b,"&",g];fxAjax.sendRequest(fxVars.pagingUrl+f.join(""),{contentType:"text/xml",params:{container:a},loader:true,callback:"sortResponse"})}function sortResponse(a,b){$PT(b.container).innerHTML=a;runAjaxScripts(a)}function filterHistory(c,b){var d=[c,"&types=",getCheckBoxesValues("filterOption"),"&updateFilter=update"];if($PT("tabHistory")!=null&&$PT("tabHistory").className=="off"){d.push("&displayHistory=false")}var a=getComboValue("formatSlTpHistory");fxAjax.sendRequest(fxVars.pagingUrl+d.join(""),{contentType:"text/xhtml",params:{container:b,slTpOption:a},loader:true,callback:"filterHistoryResponse"})}function filterHistoryResponse(a,b){$PT(b.container).innerHTML=a;runAjaxScripts(a);$PT("historyTotalSpan").innerHTML="("+$F("historySize")+")";if(b.slTpOption!=undefined){showHideSlTpOptions(b.slTpOption,"")}}function addStrategy(a,f){var c;if($PT("fileLink"+a)==null){inlineMsg("fileHolder"+a,"</strong><br />"+$T("tChooseStrategy"),3)}else{if(validate("strategyName",VALID_NAME_1_CHAR)){if(!uploading){c=strategyFileName;var d=["strategyFile=",encodeParameter(c),"&name=",encodeParameter($F("strategyName")),"&accountOid=",$F("account"),"&privacy=",$F("SelectedStrategyPrivacy"),"&comment=",encodeParameter($F("strategyComment")),"&serverId=",$F("serverSelect")];var b=getLinksTitleByName("scriptfile"+f);if(hasText(b)){d.push("&files=");d.push(b)}fxAjax.sendRequest(fxVars.addStrategy+d.join(""),{returnJson:true,loader:true,callback:"addStrategyResponse"})}else{inlineMsg("addStrategyButton",$T("tWaitUpload"),3)}}}}function addStrategyResponse(a,b){if(!a.error){$PT("strategyGroupCont").innerHTML=a.content;runAjaxScripts(a.content);filesUploaded=[]}else{inlineMsg("addStrategyButton",a.message,4)}}function strategyCommentDelete(b,c,a,d){inlineAlert(b,"<span class=''></span>"+$T("tConfirmCommentDelete")+"<br/>","addStrategyComment("+c+","+a+","+d+")")}function addStrategyComment(b,a,d){var f="";if(!a&&validate("text"+b,VALID_TEXT)){f=encodeParameter($PT("text"+b).value)}var c=["oid=",b,"&comment=",f,"&delete=",a,"&page=",d];fxAjax.sendRequest(fxVars.commentStrategy+c.join(""),{returnJson:true,params:{oid:b,deleteComment:a},loader:true,callback:"addStrategyCommentResponse"})}function addStrategyCommentResponse(a,b){if(!a.error){$PT("myStrategies").innerHTML=a.content;runAjaxScripts(a.content)}}function addStrategyGroup(){var a=["name=",encodeParameter($F("groupName"))];fxAjax.sendRequest(fxVars.addStrategyGroup+a.join(""),{returnJson:true,loader:true,callback:"addStrategyGroupResponse"})}function addStrategyGroupResponse(a,b){if(!a.error){$PT("strategyGroupCont").innerHTML=a.content;runAjaxScripts(a.content)}else{inlineMsg("addStrategyGroupButt",a.message,3)}}function getGroupStrategies(a){var b=["groupOid=",a];fxAjax.sendRequest(fxVars.getGroupStrategies+b.join(""),{returnJson:true,loader:true,callback:"getGroupStrategiesResponse"})}function getGroupStrategiesResponse(a,b){if(!a.error){$PT("myStrategiesTable").innerHTML=a.content;runAjaxScripts(a.content)}}function removeStrategyGroupVerify(c,a){var b=["removeStrategyGroup(","'",c,"'",")"];inlineAlert(a,$T("tConfirmStrategyDelete")+"<br/><br/><div class='center'><span class='information'>"+$T("tStrategyGroupNotDeleted")+"</span></div>",b.join(""))}function removeStrategyGroup(a){fxAjax.sendRequest(fxVars.removeStrategyGroup+"oid="+a,{returnJson:true,loader:true,callback:"removeStrategyGroupResponse"})}function removeStrategyGroupResponse(a,b){if(!a.error){$PT("strategyGroupCont").innerHTML=a.content;runAjaxScripts(a.content)}else{inlineMsg("account"+b.id,a.message,4)}}function updateStrategy(f,c){if(validate("strategyName"+f,VALID_NAME_1_CHAR)){var d="";if($PT("fileLink"+f)!=null){d=$PT("fileLink"+f).innerHTML}var b=["oid=",f,"&name=",encodeParameter($F("strategyName"+f)),"&groupOid=",$F("strategyGroupCombo"+f),"&privacy=",$F("strategyPrivacy"+f),"&accountOid=",$F("account"+f),"&serverId="+$F("serverSelect"+f),"&page=",c];var a=getLinksTitleByName("scriptfile"+f);if(hasText(a)){b.push("&files=");b.push(a)}fxAjax.sendRequest(fxVars.updateStrategy+b.join(""),{params:{id:f},returnJson:true,loader:true,callback:"removeStrategyGroupResponse"})}}function deleteStrategyVerify(c,a){var b=["deleteStrategy(","'",c,"'",")"];inlineAlert(a,$T("tConfirmStrategyGroupDelete")+"<br/><br/><div class='center'><span class='exclamation'>"+$T("tCannotUndo")+"</span></div>",b.join(""))}function deleteStrategy(a){fxAjax.sendRequest(fxVars.deleteStrategy+a,{returnJson:true,loader:true,callback:"deleteStrategyResponse"})}function deleteStrategyResponse(a,b){if(!a.error){$PT("myStrategies").innerHTML=a.content;runAjaxScripts(a.content)}}function updateHourly(h,c){var b=getAttributeByRadioChecked("hourlyOptions","hourlyType");var d=[];d.push(b);if(b==4||b==3){var a=getAttributeByRadioChecked("hourlySecondOptions","hourlySecondType");d.push(a);$J("input[name='hourlySecondOptions']").prop("disabled",false)}else{$J("input[name='hourlySecondOptions']").prop("disabled",true)}var f=new Chart(840,319,"hourlyChart",1);f.renderChart("/charts.json?chartType="+11+"&l="+c+"&accountOid="+h+"&type="+d+buildAdvancedStatisticsUrl(false,false));var g=new Chart(840,319,"dailyChart",1);g.renderChart("/charts.json?chartType="+12+"&l="+c+"&accountOid="+h+"&type="+d+buildAdvancedStatisticsUrl(false,false))}function updateStrategyHourly(d,c){var b=getAttributeByRadioChecked("hourlyOptions","hourlyType");var f=[];f.push(b);if(b==4||b==3){var a=getAttributeByRadioChecked("hourlySecondOptions","hourlySecondType");$J("input[name='hourlySecondOptions']").prop("disabled",false);f.push(a)}else{$J("input[name='hourlySecondOptions']").prop("disabled",true)}var g=new Chart(856,319,"hourlyChart",1);g.renderChart("/strategy-chart.json?chartType="+11+"&l="+c+"&id="+d+"&type="+f+buildAdvancedStatisticsUrl(false,false));var h=new Chart(856,319,"dailyChart",1);h.renderChart("/strategy-chart.json?chartType="+12+"&l="+c+"&id="+d+"&type="+f+buildAdvancedStatisticsUrl(false,false))}function vouchUnVouchUser(f,d,b,a){var c=["to=",d,"&returnData=",b,"&vouch=",a];fxAjax.sendRequest(fxVars.rateUser+c.join(""),{params:{id:f,uid:d,returnData:b,vouch:a},loader:true,callback:"vouchUserResponse"})}function vouchUserResponse(o,b){if(!o.error){var a=parseInt(o.content.total);var g=a;var m=60;if(a>20){g=20}var c=document.getElementsByClassName("rateBar"+b.uid);var k="<div class='floatLeft' style='background:#00dd4e;width:"+Math.round(g/20*m)+"px;height:7px;'</div>";var l;for(var d=0;d<c.length;d++){c[d].innerHTML=k;l=c[d].title;try{var f=b.vouch?1:-1;c[d].title=parseInt(l.substring(0,l.indexOf(" ")))+f+l.substring(l.indexOf(" "),l.length)}catch(h){}}hideShowElementsByName("vouchSwitch"+b.uid,!b.vouch);hideShowElementsByName("unVouchSwitch"+b.uid,b.vouch);if(b.vouch){hideElement("vouchUser"+b.id)}if(b.returnData){$PT("vouchers").innerHTML=o.content.data;$PT("vouches").innerHTML=a;if(isShown("vouchers")){showElement("vouchers")}else{hideElement("vouchers")}}}}function boardAdd(){var a=["description=",encodeParameter($F("description")),"&price=",$F("price"),"&type=",$F("boardType"),"&phone=",$F("phone"),"&contact=",$F("contact"),"&site=",encodeParameter($F("site")),"&file=",encodeParameter(filesUploaded.join(",")),"&countryId=",$F("countryId")];fxAjax.sendRequest(fxVars.boardAdd+a.join(""),{params:{},returnJson:true,loader:true,callback:"boardAddResponse"})}function boardAddResponse(a,b){if(!a.error){alert("ok")}}function addGroup(){var a=["description=",$F("description"),"&name=",$F("name"),"&file=",encodeParameter(filesUploaded.join(","))];fxAjax.sendRequest(fxVars.groupAdd+a.join(""),{params:{},returnJson:true,loader:true,callback:"addGroupResponse"})}function addGroupResponse(a,b){if(!a.error){alert("ok")}}function removeGroup(a){fxAjax.sendRequest(fxVars.groupRemove+a,{params:{},returnJson:true,loader:true,callback:"removeGroupResponse"})}function removeGroupResponse(a,b){if(!a.error){alert("ok")}}function requestGroup(a){fxAjax.sendRequest(fxVars.groupRequest+a,{params:{},returnJson:true,loader:true,callback:"requestGroupResponse"})}function requestGroupResponse(a,b){if(!a.error){alert("ok")}}function removeGroupUser(b,a){fxAjax.sendRequest(fxVars.groupRemoveUser+b+"&uid="+a,{params:{},returnJson:true,loader:true,callback:"removeGroupUserResponse"})}function removeGroupUserResponse(a,b){if(!a.error){alert("ok")}}function updateGroupRequest(b,a){fxAjax.sendRequest(fxVars.groupUpdateRequest+b+"&approved="+a,{params:{},returnJson:true,loader:true,callback:"updateGroupRequestResponse"})}function updateGroupRequestResponse(a,b){if(!a.error){alert("ok")}}var BOARD_CLASSIFIEDS=1;var BOARD_PRODUCTS=2;var BOARD_SERVICES=3;function bumpBoard(b,a){fxAjax.sendRequest(fxVars.bumpBoard+b+"&type="+a,{params:{},returnJson:true,loader:true,callback:"bumpBoardResponse"})}function bumpBoardResponse(a,b){if(!a.error){alert("ok")}}function addGroupPost(a){fxAjax.sendRequest(fxVars.groupPost+a+"&text="+encodeParameter($F("post")),{params:{},returnJson:true,loader:true,callback:"addGroupPostResponse"})}function addGroupPostResponse(a,b){if(!a.error){$PT("groupPosts").innerHTML=a.content}}function deleteBoardAdVerify(c,a){var b=["deleteBoardAd(","'",c,"'",")"];inlineAlert(a,$F("dbaq")+"<br/><br/><div class='center'><span class='exclamation'>"+$F("ycuts")+"</span></div>",b.join(""))}function deleteBoardAd(a){fxAjax.sendRequest(fxVars.deleteBoardAd+a,{contentType:"text/xml",params:{oid:a},returnJson:true,loader:true,callback:"deleteBoardAdResponse"})}function deleteBoardAdResponse(a,b){if(!a.error){$PT("adRow"+b.oid).remove()}}function closeAccount(){var a=jQuery("#userPassword").val();var b=["password=",a];fxAjax.sendRequest(fxVars.closeAccount,{contentType:"application/x-www-form-urlencoded",method:"post",postBody:b.join(""),returnJson:true,params:{password:a},loader:true,callback:"closeAccountResponse"})}function closeAccountResponse(a,b){if(!a.error){jQuery("#deleteUserAccount").modal("hide");$("#accountDeletedModalBody").html("Account successfully closed. Sorry to see you go!");$("#accountDeleted").modal("show")}else{jQuery("#errorMessage").html(a.message);jQuery("#errorMessageRow").show()}}function isValidDate(a){return(isNaN(Date.parse(a))==false)}var THREE_MONTHS_IN_SECONDS=7890000;function filterCalendar(l,m){if(!isValidDate(userFormatToDefaultFormat($F("startDate"),l))){$PT("startDate").value=$PT("startDate").defaultValue}if(!isValidDate(userFormatToDefaultFormat($F("endDate"),l))){$PT("endDate").value=$PT("endDate").defaultValue}var b=collectionCalendarFilter();var a=userFormatToDefaultFormat($F("startDate"),l);var d=userFormatToDefaultFormat($F("endDate"),l);var c=new Date(a);var h=new Date(d);var k=getCheckBoxValue("calendarBubble");var g=["&start=",getDbTimeFormat(c),"&end=",getDbTimeFormat(h),"&filter=",b,"&show=show","&type=cal","&bubble=",k,"&calPeriod=",m];$PT("calPeriod").value=m;var f=true;if(m==-1){if(c>h){inlineMsg("startDate",$T("tStartBeforeEnd"),3);f=false}else{if(((h.getTime()-c.getTime())/1000)>THREE_MONTHS_IN_SECONDS){inlineMsg("startDate",$T("tStartEndInRange3Months"),3);f=false}}}if(f){fxAjax.sendRequest(fxVars.saveEmailMinAlert+g.join(""),{contentType:"text/html",loader:true,callback:"filterCalendarResponse"})}}function filterCalendarResponse(c){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=getContent(a);if(b=="false"){$PT("calendarCont").innerHTML=d;runAjaxScripts(d)}}function logInAlert(b,a){inlineMsg(a,"<b>"+$T("tError")+"</b><br>"+$T("tPleaseLoginToUseFeature"),1);b.cancelBubble=true;if(b.stopPropagation){b.stopPropagation()}}function loadjscssfile(a){if(a.indexOf(".js")!=-1){var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src",a)}else{if(a.indexOf(".css")){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a)}}if(typeof b!="undefined"){document.getElementsByTagName("head")[0].appendChild(b)}}function outlookMap(a){var b=new SWFObject("/flash/ammap/ammap.swf","ammap","856","600","8","#fcfcfc");b.addVariable("path","/flash/ammap/");b.addVariable("settings_file",escape("/ammap_settings.xml?type="+$F("mapType")+"&r="+getRandomInt()));b.addVariable("data_file",escape("/ammap_data.xml?symbolOid="+a+"&type="+$F("mapType")+"&r=")+getRandomInt());b.addVariable("preloader_color","#999999");b.write("flashcontent")}function calClick(a){if($PT("calAdif"+a)){$PT("calAdif"+a).src="/calendar-ad.html"}fxAjax.sendRequest(fxVars.calendarClick,{contentType:"text/html",loader:false})}function trackLinkClick(b,a){var c=["link=",encodeParameter(b),"&type=",a].join("");window.open("/link-track-redirect.html?"+c)}function blockUser(a,c){var b=["&uid=",a,"&block=",c].join("");fxAjax.sendRequest(fxVars.blockUser+b,{contentType:"text/html",params:{block:c,uid:a},returnJson:true,loader:true,callback:"blockUserResponse"})}function removeBlockUserFromList(a){fxAjax.sendRequest(fxVars.removeUserBlock+a,{contentType:"text/html",returnJson:true,loader:true,callback:"removeBlockUserFromListResponse"})}function removeBlockUserFromListResponse(a){if(!a.error){$PT("blockDiv").innerHTML=a.content}}function blockUserResponse(a,b){if(!a.error){$PT("blockButton").onclick=function(){blockUser(b.uid,!b.block)};if(b.block){$PT("blockButton").innerHTML=$T("tUnblockUser")}else{$PT("blockButton").innerHTML=$T("tBlockUser")}}}function selectAllCB(el,name){var cb=document.getElementsByName(name);var checked=eval(el.getAttribute("allChecked"));el.setAttribute("allChecked",!checked);el.innerHTML=checked?labelAll:labelNone;for(var i=0;i<cb.length;i++){if(cb[i].className.indexOf("skipCheckAll")==-1){cb[i].checked=checked?"":"checked"}}}function newsClick(a){$PT("newsTitle"+a).style.color="#a7a4a4";$PT("box"+a).style.color="#a7a4a4";window.open("/news-redirect.html?id="+a,"Myfxbook");return false}var monthsArray=[];function boldColumn(a){var c=$PT("riskOfRuin").getElementsByClassName("col"+a);for(var b=0;b<c.length;b++){if(c[b].style.fontWeight=="bold"){c[b].style.fontWeight=""}else{c[b].style.fontWeight="bold"}}}function buildSentence(a){var b=$PT("riskOfRuin").getElementsByClassName("col"+a);$PT("sen").className="center padd10 font12";$PT("sen").innerHTML=$T("tChanceLosingAccount",["<span class='red bold'>"+b[1].innerHTML+"</span>","<span class='red bold'>"+b[0].innerHTML+"</span>","<span class='red bold'>"+b[2].innerHTML+" </span>"])}function cleanSentence(){$PT("sen").className="center padd10 font12 gray";$PT("sen").innerHTML=$T("tHoverOverTheDesired")}function removeFromArray(c,b){for(var a=0;a<=c.length-1;a++){if(c[a]==b){c[a]="";return c}}}function changeColor(b,c,a,d){if(d==1){$PT(c).style.backgorund=a;$PT(b).onclick=function(){changeColor(b,c,a,2);return false}}else{if(d==2){$PT(c).style.backgorund="";$PT(b).onclick=function(){changeColor(b,c,a,1);return false}}}}var WATCH_SYSTEMS_PAGE=1;var WATCH_SYSTEM_PAGE=2;var WATCH_DASHBOARD=3;function addRemoveWatch(k,a,b,f,d){if(!busy){busy=true;if(!hasText(b)){b=""}if(f=="true"){fxAjax.sendRequest(fxVars.addRemoveWatch+k+"&watchOid="+b,{params:{id:k,watchOid:b,watchType:a,session:f,add:d},loader:true,callback:"addRemoveWatchResponse"})}else{finishWatchAdd(k,a,"",f,d);if(d){hideElement("comparePromo");var h=getCookie("aWatch");if(h.indexOf("|"+k)==-1){setCookie("aWatch",h+"|"+k,YEAR,false);$PT("watchRow"+0).insert({after:'<tr id="watchRow'+k+'"><td class="paddlr10">'+$PT("systemLink"+k).innerHTML+'</td><td width="25" align="center"><a class="remove" onclick="addRemoveWatch('+k+","+WATCH_SYSTEMS_PAGE+",'');\"></a></td></tr>"})}}else{var h=getCookie("aWatch");h=h.replace("|"+k,"");setCookie("aWatch",h,YEAR,false);var g=$PT("watchRow"+k);if(g!=null){g.remove()}var c=$$PT("#watchTable tr").length;if(c<3){showElement("comparePromo")}}busy=false}}}function addRemoveWatchResponse(b,g){var c=b.error;var d=b.content.watchOid;var a=b.content.data;var f=b.content.menu;if(!c){$PT("watchCont").innerHTML=a;finishWatchAdd(g.id,g.watchType,d,g.session,g.add);$PT("accountsNav").innerHTML=f;runAjaxScripts(f)}busy=false}function finishWatchAdd(f,a,b,d,c){switch(a){case WATCH_SYSTEMS_PAGE:$$PT("[num="+f+"]").each(function(g){g.className=c?"starOn":"starOff";g.onclick=function(){addRemoveWatch(f,a,b,d,!c)}});break}}function loadWatchCookie(){try{var c=getCookie("aWatch");if(hasText(c)){hideElement("comparePromo");var l=c.split("|");for(var g=0;g<l.length;g++){var a=l[g];if(!hasText(a)){continue}var b=$PT("star"+a);if(b!=null){b.className="starOn";var h=new WatchF(a,WATCH_SYSTEMS_PAGE,"","",false);b.onclick=h.runFunc.bind(h)}var m=$PT("systemLink"+a);if(m!=null&&$PT("watchRow"+a)==null){$PT("watchRow"+0).insert({after:'<tr id="watchRow'+a+'"><td class="paddlr10">'+m.innerHTML+'</td><td width="25" align="center"><a class="remove" onclick="addRemoveWatch('+a+","+WATCH_SYSTEMS_PAGE+",'');\"></a></td></tr>"})}}}var d=document.getElementsByName("starLink");for(var g=0;g<d.length;g++){var b=d[g];if(b.className=="starOn"){continue}var a=b.getAttribute("num");var h=new WatchF(a,WATCH_SYSTEMS_PAGE,"","",true);b.onclick=h.runFunc.bind(h)}}catch(k){}}function WatchF(f,a,b,d,c){this.id=f;this.watchType=a;this.watchOid=b;this.session=d;this.add=c;this.runFunc=function(){addRemoveWatch(this.id,this.watchType,this.watchOid,this.session,this.add)}}var MAX_COMPARISON_ACCOUNTS=5;function getCompareAccount(a,b){closeCompareCharts();var f=$F(a);if(f!=0){fxAjax.sendRequest(fxVars.getCompareAccount+f,{contentType:"text/xml",params:{id:f,num:b},returnJson:false,loader:true,callback:"getCompareAccountResponse"})}else{for(var c=0;c<cellTypes.length;c++){var d=$PT(cellTypes[c]+b+"td");if(d!=null){d.innerHTML=""}}createComparePerma()}}function getCompareAccountResponse(d,f){var b=d.getElementsByTagName("response")[0];var c=b.getAttribute("error");var a=(typeof b.children!="undefined"&&b.children.length!=0)?b.children:b.childNodes;refillCompareTable(a,f.num)}function refillCompareTable(a,d){for(var b=0;b<a.length;b++){var c=$PT(a[b].nodeName+d+"td");if(c!=null){c.innerHTML=getContent(a[b])}}colorCompareTable()}var compareCharts=["gain","balance","equity","profit"];function closeCompareCharts(){for(var a=0;a<compareCharts.length;a++){var b=$PT(compareCharts[a]+"Chart");if(b!=null){if(b.style.display==""){b.style.display="none"}}}}function createComparePerma(){var a=document.getElementsByName("compareCombo");var f=[];var c=[];for(var b=0;b<a.length;b++){var d=a[b];if(d.selectedIndex!=0){c.push($F(a[b]));f.push(d.options[d.selectedIndex].id)}}if(c.length!=0){$PT("comparePermaLink").value=serverPath+"/compare-systems/"+f.join("-vs-")+"/"+c.join(",")}else{$PT("comparePermaLink").value=""}}function colorCompareTable(){for(var b=0;b<cellTypes.length;b++){var d=document.getElementsByClassName(cellTypes[b]+"Cell");var h={};var a={};var k;var g=0;for(var f=0;f<d.length;++f){d[f].style.color="black";if(!hasText(d[f].innerHTML)){continue}else{g++}k=parseFloat(getNumber(d[f].innerHTML));if(isNaN(k)){continue}var c=d[f].getAttribute("high");if(c!=null&&c=="none"){continue}if(c==null){if(typeof h.td=="undefined"||k>h.val){if(k>h.val&&typeof a.td=="undefined"){a.td=h.td;a.val=h.val}h.td=d[f];h.val=k}else{if((typeof a.td=="undefined"||k<a.val)&&k!=h.val){a.td=d[f];a.val=k}}}else{if(c=="min"){if(typeof h.td=="undefined"||k<h.val){if(k<h.val&&typeof a.td=="undefined"){a.td=h.td;a.val=h.val}h.td=d[f];h.val=k}else{if((typeof a.td=="undefined"||k>a.val)&&k!=h.val){a.td=d[f];a.val=k}}}else{if(c=="zero"){if(typeof h.td=="undefined"||Math.abs(k)<h.val){if(k<h.val&&typeof a.td=="undefined"){a.td=h.td;a.val=h.val}h.td=d[f];h.val=k}else{if((typeof a.td=="undefined"||Math.abs(k)>a.val)&&k!=h.val){a.td=d[f];a.val=k}}}}}}if(g>1&&typeof h.td!="undefined"&&typeof a.td!="undefined"){h.td.style.color="green";a.td.style.color="red"}}createComparePerma()}function rebuildCompareCharts(){}function compareChart(g,f){if(isVisible(g)){hideElement(g)}else{var d=document.getElementsByName("compareCombo");var c=[];for(var a=0;a<d.length;a++){var h=$F(d[a]);if(h!=0){c.push(h)}}if(c.length!=0){showElement(g);var b=new Chart(820,314,"chart"+f);b.renderChart("/compare-chart.json?ids="+c.join(",")+"&type="+f+"&r="+Math.random())}}}function saveComparison(){if(validate("compareName",VALID_NAME_1_CHAR)){if(!busy){var c=document.getElementsByName("compareCombo");var b=[];for(var a=0;a<c.length;a++){if($F(c[a])!=0){b.push($F(c[a]))}}if(b.length!=0){fxAjax.sendRequest(fxVars.saveCompare+b.join(",")+"&name="+encodeParameter($F("compareName")),{contentType:"text/xml",params:{},loader:true,callback:"saveComparisonResponse"})}else{inlineMsg($PT("saveCompareLink"),$T("tSelect1System"),true)}}}}function saveComparisonResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");if(b=="false"){var c=new Option(getContent(d.getElementsByTagName("name")[0]),getContent(d.getElementsByTagName("id")[0]),true);$PT("savedComparison").options.add(c);$PT("savedComparison").options[$PT("savedComparison").options.length-1].selected="1";showElement("saveSearch");hideElement("saveComp");showElement("remove");clearElement("compareName")}busy=false}function selectOptionByValue(a,d){var b=a.options;for(var c=0;c<b.length;c++){if(b[c].value==d){a.selectedIndex=c}}}function loadComparison(b){closeCompareCharts();var a=$PT("savedComparison")!=null?$F("savedComparison"):0;if(b&&a==0){clearCompare(0);clearElement("comparePermaLink");hideElement("remove")}else{fxAjax.sendRequest(fxVars.loadComparison+a,{contentType:"text/xml",params:{fill:b},returnJson:false,loader:true,callback:"loadComparisonResponse"})}}function loadComparisonResponse(k,d){var f=k.getElementsByTagName("response")[0];var q=f.getAttribute("error");var c=k.getElementsByTagName("account");if(q=="false"){showElement("remove");var s=document.getElementsByName("compareCombo");var g={};for(var o=0;o<s[0].options.length;o++){g[s[0].options[o].value]=true}for(var r=0;r<s.length;r++){for(var h=0;h<c.length;h++){var b=getContent(c[h].getElementsByTagName("id")[0]);var a=c[h].getElementsByTagName("name")[0];var m=a.getAttribute("clean");var l=new Option(getContent(a),b);l.id=m;if(!(b in g)){s[r].options.add(l)}}}if(d.fill){for(var h=0;h<c.length&&h<MAX_COMPARISON_ACCOUNTS;h++){selectOptionByValue(s[h],getContent(c[h].getElementsByTagName("id")[0]));refillCompareTable(typeof c[h].children!="undefined"?c[h].children:c[h].childNodes,h+1)}clearCompare(c.length)}}}function clearCompare(c){var b=document.getElementsByName("compareCombo");for(var d=MAX_COMPARISON_ACCOUNTS;d>c;d--){b[d-1].selectedIndex=0;for(var a=0;a<cellTypes.length;a++){var f=$PT(cellTypes[a]+d+"td");if(f!=null){f.innerHTML=""}}}}function removeComparison(){if(!busy){busy=true;fxAjax.sendRequest(fxVars.removeComparison+$F("savedComparison"),{contentType:"text/xml",params:{selectedIndex:$PT("savedComparison").selectedIndex},returnJson:true,loader:true,callback:"removeComparisonResponse"})}}function removeComparisonResponse(a,b){if(!a.error){$PT("savedComparison").options[b.selectedIndex].remove();hideElement("remove");clearCompare(0);clearElement("comparePermaLink")}busy=false}function getNumber(a){return a.replace(/[^0-9.-]/g,"")}function addTradeDiary(f,b,a,c){if(validate(c+"text"+f,VALID_TEXT)){var g=["oid=",f,"&comment=",encodeParameter($PT(c+"text"+f).value),"&accountOid=",b,"&delete=",a,"&type="+c];var d=getLinksTitleByName(c+"orderFiles"+f);if(hasText(d)){g.push("&files=");g.push(d)}fxAjax.sendRequest(fxVars.tradeDiary+g.join(""),{contentType:"text/xml",params:{oid:f,deleteComment:a,type:c},loader:true,callback:"addTradeDiaryResponse"})}}function addTradeDiaryResponse(g,h){var a=g.getElementsByTagName("response")[0];var b=a.getAttribute("error");var f=a.getAttribute("message");var k=getContent(a);var c=h.type;var d=h.oid;if(b=="false"){if(h.deleteComment){}}}var templateMap={};function addTimerTemplate(c,b,a){templateMap[c]={template:b,func:a};countDownTimer(c)}function countDownTimer(a){var k=templateMap[a].template;var f=parseInt($PT(a).getAttribute("time"));var d=f;var l=Math.floor(d/day);d-=l*day;var g=Math.floor(d/hour);d-=g*hour;var c=Math.floor(d/minute);d-=c*minute;var h=Math.floor(d/second);k=k.replace("{0}",l);k=k.replace("{1}",g);k=k.replace("{2}",c);k=k.replace("{3}",h);$PT(a).innerHTML=k;var b=f-1000;if(b<=0){templateMap[a].func()}else{$PT(a).setAttribute("time",b);setTimeout('countDownTimer("'+a+'")',1000)}}function rateTopics(a,b){disable("rateButton");var c=["&topicOid=",a,"&rating=",getRadioValue("rate")];fxAjax.sendRequest(fxVars.rateTopics+c.join(""),{contentType:"text/xml",params:{ratingVotes:b},loader:true,callback:"rateTopicsResponse"})}function rateTopicsResponse(f,g){var a=f.getElementsByTagName("response")[0];var c=a.getAttribute("error");if(c=="false"){$PT("rateResponse").innerHTML=$T("tThankYou");var d=getContent(a);var b="";for(i=0;i<Math.round(d);i++){b=b+"<img src='"+staticServerPath+"/images/star-small.png' alt='' style='margin-right:-4px' alt='Full Star' title='"+$T("tVotesAverageRating",[g.ratingVotes+1,d])+"'/>"}for(i=0;i<5-Math.round(d);i++){b=b+"<img src='"+staticServerPath+"/images/star-small-empty.png' alt='' style='margin-right:-4px' alt='Empty Star' title='"+$T("tVotesAverageRating",[g.ratingVotes+1,d])+"'/>"}$PT("starRating").innerHTML=b;enable("rateButton");hideElement("rateTopic")}else{}}function dashAccountsHide(){var d=document.getElementsByName("portfolioAccount");var a=[];for(var c=0;c<d.length;c++){var b=d[c].value;if(!d[c].checked){a.push(b)}}setCookie("hpc",a.join("~"),YEAR,false);refreshDashSystemsTable()}function checkMtLogin(c,b,a){fxAjax.sendRequest(fxVars.checkMtLogin+c+"&lastStatus="+b,{contentType:"text/xml",params:{id:c,newAccount:a},loader:false,callback:"checkMtLoginResponse"})}var STATUS_LOGIN_ACCOUNT_EXIST=-2;var STATUS_LOGIN_PENDING=0;var STATUS_LOGIN_PASS=1;var STATUS_LOGIN_FAILED=2;var STATUS_CREATING_ACCOUNT=3;var STATUS_CALCULATING=4;var STATUS_CALC_COMPLETE=5;var STATUS_SERVER_DOWN=6;var STATUS_ERROR=7;var STATUS_OWNER_VERIFICATION_DONE=8;var STATUS_OWNER_VERIFICATION_FAILED=9;var STATUS_MASTER_PASSWORD_ERROR=11;var STATUS_MULTIPLE_ATTEMPTS_TO_CONNECT=12;var STATUS_LIMIT_SETTINGS_TERMINAL_CONNECT=13;var STATUS_ACCOUNT_DOES_NOT_ALLOW_HEDGING=14;function checkMtLoginResponse(data,params){var response=data.getElementsByTagName("response")[0];var accountUrl=getContent(data.getElementsByTagName("accountUrl")[0]);var accountOid=getContent(data.getElementsByTagName("accountOid")[0]);var owner=eval(getContent(data.getElementsByTagName("ownerVerified")[0]));var info=getContent(data.getElementsByTagName("info")[0]);var error=response.getAttribute("error");var message=response.getAttribute("message");var code=response.getAttribute("code");var status=parseInt(response.getAttribute("newAccountStatus"));var hideLoader=true;if(error=="false"&&status!=STATUS_ERROR){if(params.newAccount){$PT("loginResponse").innerHTML=message+info;if(status==STATUS_LOGIN_PENDING||status==STATUS_LOGIN_PASS||status==STATUS_CREATING_ACCOUNT||status==STATUS_CALCULATING){checkMtLogin(params.id,status,true);hideLoader=false}else{if(status==STATUS_LOGIN_FAILED||status==STATUS_CALC_COMPLETE||status==STATUS_SERVER_DOWN){if(status==STATUS_CALC_COMPLETE){hideElement("settings");hideElement("broker");showElement("connection");$PT("takeMe").href=accountUrl;$PT("setPrivacy").onclick=function(){getAccountForm(parseInt(accountOid))}}}}}else{showElement("loginResponse");if(status==STATUS_LOGIN_PENDING||status==STATUS_LOGIN_PASS||status==STATUS_CALCULATING){$PT("loginResponse").innerHTML=message;checkMtLogin(params.id,status);hideLoader=false}else{if(status==STATUS_LOGIN_FAILED||status==STATUS_OWNER_VERIFICATION_FAILED||status==STATUS_MULTIPLE_ATTEMPTS_TO_CONNECT||status==STATUS_LIMIT_SETTINGS_TERMINAL_CONNECT){showElement("testButton");$PT("loginResponse").innerHTML=message}else{if(status==STATUS_CALC_COMPLETE){if(owner){if($PT("ov")){$PT("ov").value=true}hideElement("testButton");hideElement("ownerValidationKey");showElement("validPass")}else{showElement("testButton")}$PT("loginResponse").innerHTML=message;if($PT("wd")){$PT("wd").value=true}}else{if(status==STATUS_SERVER_DOWN){$PT("loginResponse").innerHTML=message}else{if(status==STATUS_OWNER_VERIFICATION_DONE){if(owner){if($PT("ov")){$PT("ov").value=true}hideElement("testButton");hideElement("loginResponse");hideElement("ownerValidationKey");showElement("validPass")}}}}}}}}else{$PT("loginResponse").innerHTML=message;if(params.newAccount){$PT("loginResponse").innerHTML+=getContent(response)}else{}}if(hideLoader){hideElement("loginLoad");hideElement("overlay")}}function returnToAddAccount(){showElement("settings");hideElement("connection");showElement("broker");$PT("status1").src="/../images/circle1.gif";$PT("status2").src="/../images/circle1.gif";$PT("status3").src="/../images/circle1.gif"}function tryMtLogin(a,f){hideElement("loginResponse");var c=true;var d=["&newAccount=",a,"&id=",f];if(a){var b=$PT("serverId").value;if(validate("systemName",VALID_SYSTEM_NAME)){if(b==0&&!$PT("serverId").disabled){inlineMsg("serverId",$T("tChooseBroker"),3);c=false}if(c&&validate("accountId",VALID_ACCOUNT)&&validate("investorPassword",VALID_ACCOUNT_PASSWORD)){showElement("overlay");showElement("loginResponse");$PT("loginResponse").innerHTML="Connecting to your account <img src='../../../images/circle1.gif' alt=''";showElement("loginLoad");d.push("&accountId=",$F("accountId"),"&serverId=",$PT("serverId").value,"&platformId=",$PT("platformId").value,"&name=",encodeParameter($F("systemName")));d.push("&mt4ServerId=",$PT("mt4ServerId").value,"&investorPassword=",encodeParameter($F("investorPassword")))}else{c=false}}else{c=false}}else{showElement("loginResponse");showElement("loginLoad");$PT("loginResponse").innerHTML="Connecting to your account";d.push("&mt4ServerId=",$F("mt4ServerId"),"&investorPassword=",$F("investorPassword"))}if(c){fxAjax.sendRequest(fxVars.tryMtLogin,{method:"post",postBody:d.join(""),contentType:"text/xml",params:{id:f,newAccount:a},loader:false,callback:"checkMtLoginResponse"})}}function monthsArrayGetMonth(a){if(monthsArray.length==0){monthsArray=[$T("tJanuary"),$T("tFebruary"),$T("tMarch"),$T("tApril"),$T("tMay"),$T("tJune"),$T("tJuly"),$T("tAugust"),$T("tSeptember"),$T("tOctober"),$T("tNovember"),$T("tDecember")]}return monthsArray[a]}function switchPublish(a,b,c){if(!busy){busy=true;fxAjax.sendRequest(fxVars.switchPublish+a+"&accountOid="+b,{contentType:"text/xml",params:{old:a,accountOid:b,isValidatedOnFirstTime:c},loader:true,returnJson:true,callback:"switchPublishResponse"})}}function switchPublishResponse(a,b){if(!a.error){if(b.old){if(b.isValidatedOnFirstTime){$PT("switchButton").innerHTML='<span class="underline">Use the login credentials to update my account</span> <span class="red">(Beta)</span>';$PT("switchButton").onclick=function(){switchPublish(false,b.accountOid,b.isValidatedOnFirstTime)};showElement("switchButton")}else{hideElement("switchButton")}hideElement("testButton");hideElement("loginTitle");hideElement("loginField")}else{$PT("switchButton").innerHTML='<span class="underline">Use the publisher/EA to update my account</span>';$PT("switchButton").onclick=function(){switchPublish(true,b.accountOid,b.isValidatedOnFirstTime)};if($F("wd")=="false"&&$F("ov")=="false"){showElement("testButton")}showElement("accountId");showElement("loginTitle");showElement("loginField");showElement("switchButton")}}else{showElement("loginResponse");$PT("loginResponse").innerHTML=a.message}busy=false}var MRC_COOKIE="mrc";function masterSlaveSwitch(){var a=$F("mrcSelect");if(a==MRC_COOKIE){setCookie(MRC_COOKIE,'""',YEAR)}else{setCookie(MRC_COOKIE,'""',0)}location.reload(true)}function switchAccountAddForm(a){showElement("f");switch(parseInt(a)){case 0:hideElement("settings");hideElement("fxcmText");hideElement("f");hideElement("oanda");hideElement("dukascopy");break;case 2:hideElement("fxcmText");showElement("settings");setAccountForm(a);hideElement("oanda");break;case 3:hideElement("oanda");showElement("fxcmText");hideElement("settings");window.location.href=$F("tradingStationLink");break;case 4:hideElement("settings");hideElement("fxcmText");hideElement("f");showElement("oanda")}}function addOrderTagMap(a,d,k,c,g,l){if(l=="h"){tabId=0}if(l=="o"){tabId=2}if(l=="t"){tabId=1}var f=$F("originalTagColor"+d);var b=$F("originalTags"+d);var h=["orderId=",a,"&tagId=",d,"&accountOid=",k,"&selected=",g,"&oid=",c,"&type=",tabId];fxAjax.sendRequest(fxVars.addOrderTagMap+h.join(""),{returnJson:true,params:{orderid:a,tagId:d,accountOid:k,oid:c,color:f,name:b,selected:g,type:l,tabid:tabId},loader:false,callback:"addOrderTagResponse"})}function addOrderTagResponse(a,h){if(!a.error){var f=getContent(a.response);var g;var c=escapeHtml(h.name);if(h.selected){g="allOrderTags"+h.type+h.orderid;$PT("tagWindow"+h.type+h.orderid).appendChild(new Element("div",{style:"width:6px;height:6px;background:#"+h.color,id:"tagColor"+h.type+h.orderid+""+h.tagId,name:c,className:"floatLeft"}))}else{g="addTags"+h.type+h.orderid;$PT("tagColor"+h.type+h.orderid+""+h.tagId).remove()}$PT(h.type+""+h.orderid+""+h.tagId).remove();var b=new Element("div",{id:h.type+""+h.orderid+""+h.tagId,className:"tagBG"});var k=new Element("div",{className:"tagBlock",id:"c"+h.type+""+h.orderid+""+h.tagId+"",style:"background:#"+h.color});var d=new Element("a",{href:"javascript:void(0);",style:"text-decoration:none",id:"v"+h.type+""+h.orderid+""+h.tagId+"",className:"underline allTagsList"+h.type});b.onclick=function(){addOrderTagMap(h.orderid,h.tagId,h.accountOid,f,!h.selected,h.type,h.tabid)};d.update(c);b.appendChild(k);b.appendChild(d);$PT(g).appendChild(b);if($$PT("#allOrderTags"+h.type+h.orderid+" div.tagBG").length>0){hideElement("pointer"+h.type+h.orderid);hideElement("noTagsAttached"+h.type+h.orderid)}else{$PT("pointer"+h.type+h.orderid).style.display="";showElement("noTagsAttached"+h.type+h.orderid)}if($$PT("#addTags"+h.type+h.orderid+" div.tagBG").length>0){hideElement("noTags"+h.type+h.orderid)}else{showElement("noTags"+h.type+h.orderid)}}else{inlineMsg("addButton",a.message,3)}updateTagTip("tagTd"+h.type+h.orderid)}function deleteOrderTagMessage(a){inlineAlert($PT("remove"+a),$T("tConfirmTagDelete")+"<br/><br/><div class='center'><span class='exclamation'>"+$T("tCannotUndo")+"</span></div>","deleteOrderTag("+a+")")}function deleteOrderTag(a){fxAjax.sendRequest(fxVars.deleteOrderTag+a,{returnJson:true,params:{oid:a,name:$PT("checkedOrder"+a).value},loader:true,callback:"deleteTagResponse"})}function deleteTagResponse(a,h){var g;var b;var f;if(!a.error){$PT("tagColor"+h.oid).remove();$PT("originalTagColor"+h.oid).remove();$PT("checkedOrder"+h.oid).remove();$PT("originalTags"+h.oid).remove();$PT("remove"+h.oid).remove();$PT("orderTag"+h.oid).remove();var d=document.getElementsByName("recordId");for(var c=0;c<d.length;c++){b=$PT(d[c]).getAttribute("recordId");f=$PT(d[c]).getAttribute("tagType");if($PT(f+""+b+""+h.oid)!=null){$PT(f+""+b+""+h.oid).remove()}if($PT("tagColor"+f+""+b+h.oid)!=null){$PT("tagColor"+f+""+b+h.oid).remove()}if($PT("saveButton"+h.oid)){$PT("saveButton"+h.oid).remove()}if($PT("cancel"+h.oid)){$PT("cancel"+h.oid).remove()}if($$PT("#allOrderTags"+f+b+" div.tagBG").length>0){hideElement("pointer"+f+b);hideElement("noTagsAttached"+f+b)}else{$PT("pointer"+f+b).style.display="";showElement("noTagsAttached"+f+b)}if($$PT("#addTags"+f+b+" div.tagBG").length>0){hideElement("noTags"+f+b)}else{showElement("noTags"+f+b)}}if(document.getElementsByName("accountTag").length==0){hideElement("allTagsCheck");showElement("noTagsDiv")}}else{inlineMsg("addButton",a.message,3)}updateAllTagsTips()}function updateOrderTag(f){var g=[];var c=$F("checkedOrder"+f);var b=$F("originalTags"+f);var a=$PT("tagColor"+f).getAttribute("hex");var d=$F("originalTagColor"+f);if((c!=b&&validate($PT("checkedOrder"+f),VALID_NAME))||a!=d){g.push("&tagOid=");g.push(f);if(c!=b){g.push("&tagName=");g.push(encodeParameter(c))}g.push("&tagColor=");g.push(a)}fxAjax.sendRequest(fxVars.updateOrderTag+g.join(""),{returnJson:true,params:{tagOid:f},loader:true,callback:"updateTagResponse"})}function updateTagResponse(a,h){if(!a.error){var c;var f;var b;var g;f=document.getElementsByName("recordId");c=$PT("tagColor"+h.tagOid).getAttribute("hex");$PT("originalTags"+h.tagOid).value=$F("checkedOrder"+h.tagOid);$PT("originalTagColor"+h.tagOid).value=c;for(var d=0;d<f.length;d++){b=$PT(f[d]).getAttribute("recordId");g=$PT(f[d]).getAttribute("tagType");if($PT("tagColor"+g+""+b+""+h.tagOid)!=null){$PT("tagColor"+g+""+b+""+h.tagOid).style.backgroundColor="#"+c}$PT("c"+g+""+b+""+h.tagOid).style.backgroundColor="#"+c;$PT("v"+g+""+b+""+h.tagOid).innerHTML=$F("checkedOrder"+h.tagOid)}$PT("labelOrderTag"+h.tagOid).innerHTML=$F("checkedOrder"+h.tagOid);$PT("color"+h.tagOid).style.background="#"+c;hideElement("cancel"+h.tagOid);hideElement("saveButton"+h.tagOid)}else{inlineMsg("addButton",a.message,3)}updateAllTagsTips()}function createOrderTag(b){if(validate($PT("checkedOrder"),VALID_NAME)){var a=$PT("addTagColor").getAttribute("hex");var c=["&name=",encodeParameter($F("checkedOrder")),"&tagColor=",a];fxAjax.sendRequest(fxVars.createOrderTag+c.join(""),{returnJson:true,params:{name:escapeHtml($F("checkedOrder")),accountOid:b,color:a},loader:true,callback:"createTagResponse"})}}function TagF(g,d,a,f,c,b){this.orderid=g;this.tagId=d;this.accountOid=a;this.oid=f;this.selected=c;this.type=b;this.runFunc=function(){addOrderTagMap(this.orderid,this.tagId,this.accountOid,this.oid,this.selected,this.type)}}function createTagResponse(s,A){if(!s.error){var u;var o;var a=getContent(s.response);var t;var v;var h;var d,m;var f;var r=5;$PT("checkedOrder").value="";var g=new Element("div",{id:"orderTagInfo"+a,className:"marginB5"});g.innerHTML+="<INPUT type='text' class='field3 color' hex='"+A.color+"' name='tagsColors' value='' style='width:16px'  id='tagColor"+a+"' onchange='tagChanged("+a+")'/>";g.innerHTML+="<INPUT type='text' name='originalTagsColors' value='"+A.color+"' style='display:none' id='originalTagColor"+a+"'>";g.innerHTML+="<INPUT type='text' name='tagsNumbers' tagId='"+a+"' value='"+A.name+"' id='checkedOrder"+a+"' class='field1' onkeypress='tagChanged("+a+")'/>";g.innerHTML+="<INPUT type='text' name='originalTagsNumbers' style='display:none' value='"+A.name+"' id='originalTags"+a+"'>";var b=new Element("input",{id:"saveButton"+a,type:"button",value:"Save",style:"display:none;",className:"miniOff"});b.onclick=function(){updateOrderTag(a)};var k=new Element("input",{id:"cancel"+a,type:"button",value:"Cancel",style:"display:none;",className:"miniOff"});k.onclick=function(){cancel(a)};var c=new Element("input",{id:"remove"+a,type:"button",value:"Delete",style:"display:",className:"miniOff"});c.onclick=function(){deleteOrderTagMessage(a)};g.appendChild(c);g.appendChild(b);g.appendChild(k);$PT("orderTagCont").appendChild(g);t=document.getElementsByName("tagsColors");for(var x=0;x<t.length;x++){var B=new jscolor.color(t[x],{required:false});if(t[x].value.length!=0){B.fromString(t[x].value)}}u=document.getElementsByName("recordId");v=$PT("tagColor"+a).getAttribute("hex");for(var x=0;x<u.length;x++){o=$PT(u[x]).getAttribute("recordId");h=$PT(u[x]).getAttribute("tagType");var z=new Element("div",{id:h+""+o+""+a,className:"tagBG"});var D=new Element("div",{className:"tagBlock",id:"c"+h+""+o+""+a,style:"background:#"+v});var q=new TagF(o,a,A.accountOid,0,true,h);var l=new Element("a",{href:"javascript:void(0);",style:"text-decoration:none",id:"v"+h+""+o+""+a,className:"underline allTagsList"+h});z.onclick=q.runFunc.bind(q);l.update(A.name);z.appendChild(D);z.appendChild(l);$PT("addTags"+h+o).appendChild((z));hideElement("noTags"+h+o)}var C=new Element("div",{id:"orderTag"+a,className:"filterTag paddL10"});C.innerHTML+="<input class='floatLeft' type='checkbox' name='accountTag' id='analyseTag"+a+"' value='"+a+"'>";C.innerHTML+="<div class='floatLeft' id='color"+a+"' style='margin:4px 4px 0 4px;width:8px;height:8px;background:#"+v+"'>";C.innerHTML+="<label  for='analyseTag"+a+"'  id='labelOrderTag"+a+"'>"+A.name+"";showElement("analyzeTags");var w=$$PT("#analyzeTable tr").last();var y=$$PT("#analyzeTable td").last();f=$$PT("#analyzeTable td").length;if(f%r==0){d=new Element("tr",{});m=new Element("td",{});m.appendChild(C);d.appendChild(m);w.insert({after:d})}else{m=new Element("td",{});m.appendChild(C);y.insert({after:m})}if(f==0){showElement("allTagsCheck");hideElement("noTagsDiv")}}else{inlineMsg("addButton",s.message,3)}jQuery(".addTagsWindow").each(function(){var E=jQuery(".addTagsWindow");var F=jQuery(this);F.append(F.find(".tagBG").get().sort(function(H,G){var J=jQuery(H).find("a").text();var I=jQuery(G).find("a").text();if(J>I){return 1}if(J<I){return -1}return 0}))});jQuery("#orderTagCont").each(function(){var E=jQuery(this);E.append(E.find("div.marginB5").get().sort(function(G,F){var I=jQuery(G).find('[name="tagsNumbers"]').val();var H=jQuery(F).find('[name="tagsNumbers"]').val();if(I>H){return 1}if(I<H){return -1}return 0}))});switchTab("tabs18","analyzeTags",$PT("orderTagTab"))}function isShown(a){return $PT(a)!=null&&$PT(a).style.display==""}var lastRowId=undefined;function showHideTags(b,a){var c=$PT(b);if(c){if(isShown(c.getAttribute("commentWindowId"))){boldTD(c.getAttribute("tagIconId"))}if(isShown(c.getAttribute("tagWindowId"))){hideElement(c.getAttribute("tagWindowId"));boldTD(c.getAttribute("tagIconId"));lastRowId=undefined}else{boldTD(c.getAttribute("tagIconId"));if(a==null&&lastRowId!=undefined){showHideTags(lastRowId,true)}showElement(c.getAttribute("tagWindowId"));lastRowId=b}}}function tagChanged(a){showElement("saveButton"+a);showElement("cancel"+a)}function cancel(b){$PT("checkedOrder"+b).value=$PT("originalTags"+b).value;$PT("tagColor"+b).setAttribute("hex",$PT("originalTagColor"+b).value);var a=new jscolor.color($PT("tagColor"+b),{required:false});if($PT("tagColor"+b).value.length!=0){a.fromString($PT("tagColor"+b).value)}hideElement("cancel"+b);hideElement("saveButton"+b)}function hideLastWindow(){if(lastRowId){hideElement("orderMenu");hideElement($PT(lastRowId).getAttribute("tagWindowId"));boldTD($PT(lastRowId).getAttribute("tagIconId"));lastRowId=undefined}}function updateQuotes(){var a=collectQuotesParamters();fxAjax.sendRequest(fxVars.updateQuotes+a.join(","),{contentType:"text/html",returnJson:true,loader:true,callback:"updateQuotesResponse"})}function updateQuotesResponse(a){if(!a.error){$PT("liveRatesDiv").innerHTML=a.content;runAjaxScripts(a.content)}}function collectQuotesParamters(){var a=[];a.push($PT("quotes1").options[$PT("quotes1").selectedIndex].value);a.push($PT("quotes2").options[$PT("quotes2").selectedIndex].value);a.push($PT("quotes3").options[$PT("quotes3").selectedIndex].value);a.push($PT("quotes4").options[$PT("quotes4").selectedIndex].value);a.push($PT("quotes5").options[$PT("quotes5").selectedIndex].value);return a}function getFileLink(b){var a=$PT(b);if(a.type=="image"){return"<a href='"+a.href+"' target='_blank'><img src='"+a.href+"'/></a>"}else{return"<a href='"+a.href+"' target='_blank'>"+a.title+"</a>"}}function dateToString(c){var b=dt.getTime();b+=MINUTE*dt.getTimezoneOffset()*-1;var f=b-c;if((f/HOUR)<1){var d=Math.floor(f/MINUTE);if(d<=0){if((Math.floor(f/SECOND))==0){return $T("tAmomentAgo")}if((Math.floor(f/SECOND))<0){return $T("tAsecondAgo")}else{return $T("tSecondsAgo",[Math.floor(f/SECOND)])}}else{if(d==1){return $T("tOneMinuteAgo")}else{return $T("tMinutesAgo",[d])}}}if((f/DAY)<1){var a=Math.floor(f/HOUR);if(a<=1){return $T("tOneHourAgo")}else{return $T("tHoursAgo",[a])}}if((f/DAY)>1){return"false"}}function rateVps(a){if(isRated()){var b=["vpsId=",a,"&features=",$PT("features").value,"&pricing=",$PT("pricing").value,"&service=",$PT("service").value,"&easeOfUse=",$PT("easeOfUse").value].join("");fxAjax.sendRequest(fxVars.rateVps+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function rateReviewResponse(b,a){if(!b.error){$PT(a).innerHTML=b.content.data;runAjaxScripts(b.content.data);drawBasicChart("chartdiv",b.content.updatedChartData)}else{if(b.content.suspended){inlineMsg("rateButton","<strong>"+$T("tError")+"</strong><br/>"+$T("tAccountSuspended"))}else{inlineMsg("rateButton","<strong>"+$T("tError")+"</strong><br/>"+$T("tInOrderToSubmitAReview"))}}}function rateEap(a){if(isRated()){var b=["eapId=",a,"&quality=",$PT("quality").value,"&pricing=",$PT("pricing").value,"&service=",$PT("service").value,"&completion=",$PT("completion").value].join("");fxAjax.sendRequest(fxVars.rateEap+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function currentProfile(){var tempElement={};var list=[];var allElements=carpeGetElementsByClass("profileAnalyze");for(var i=0;i<allElements.length;i++){if(allElements[i].type&&allElements[i].type=="checkbox"&&allElements[i].checked){list=tempElement[$AT(allElements[i],"name")];if($AT(allElements[i],"checkboxType")=="boolean"){list=eval(allElements[i].checked)}else{if(list==null){list=allElements[i].value}else{list+=","+allElements[i].value}}tempElement[$AT(allElements[i],"name")]=list}if(allElements[i].nodeName=="OPTION"&&allElements[i].selected){if(allElements[i].getAttribute("optionId")){tempElement[$AT(allElements[i],"optionId")]=allElements[i].value}else{tempElement[$AT(allElements[i],"itemOption")]=allElements[i].value}}else{if(allElements[i].type&&allElements[i].type=="text"){list=tempElement[$AT(allElements[i],"name")];if(list==null){list=allElements[i].value}else{list+=","+allElements[i].value}tempElement[$AT(allElements[i],"name")]=list}}}tempElement.oid="temp";return tempElement}function SwitchToTradeTab(a){this.params=a;this.runFunc=function(){switchTab(this.params[0],this.params[1],this.params[2]);showElement(this.params[3])}}function addSearchProfile(g){if($PT("showMain")){var d=$PT("showMain").checked}if($PT("magic")){var b=$PT("magic").checked}var a=["tabs18","tradeList",$PT("analyzeTradeTab"),"showActualGrowth"];var f=new SwitchToTradeTab(a);if(validate("profileName",VALID_PROFILE)&&validate("yieldStart",VALID_DOUBLE,f)&&validate("yieldEnd",VALID_DOUBLE,f)&&validate("netProfitStart",VALID_DOUBLE,f)&&validate("netProfitEnd",VALID_DOUBLE,f)&&validate("durationStart",VALID_INTEGER_OR_EMPTY,f)&&validate("durationEnd",VALID_INTEGER_OR_EMPTY,f)&&validate("pipsStart",VALID_DOUBLE,f)&&validate("pipsEnd",VALID_DOUBLE,f)&&validate("takeProfitStart",VALID_DOUBLE_POSITIVE,f)&&validate("takeProfitEnd",VALID_DOUBLE_POSITIVE,f)&&validate("stopLoss",VALID_DOUBLE_POSITIVE,f)&&validate("stopLossEnd",VALID_DOUBLE_POSITIVE,f)&&validate("sizingStart",VALID_DOUBLE_POSITIVE,f)&&validate("sizingEnd",VALID_DOUBLE_POSITIVE,f)){var c=["&accountOid=",g,"&profileName=",encodeParameter($F("profileName")),"&showGrowth=",d,"&showTrades=",b,"&accountMagic=",getCheckBoxesValues("accountMagic"),"&accountSymbol=",getCheckBoxesValues("accountSymbol"),"&orderTags=",getCheckBoxesValues("accountTag"),"&days=",getCheckBoxesValues("days"),"&hours=",getCheckBoxesValues("hours"),getCommentBoxesValues(),"&buySell=",getCheckBoxesValues("buySell"),"&yieldStart=",$F("yieldStart"),"&yieldEnd=",$F("yieldEnd"),"&netProfitStart=",$F("netProfitStart"),"&netProfitEnd=",$F("netProfitEnd"),"&durationStart=",$F("durationStart"),"&durationEnd=",$F("durationEnd"),"&durationTime=",$F("selectedDuration"),"&takeProfitStart=",$F("takeProfitStart"),"&takeProfitEnd=",$F("takeProfitEnd"),"&stopLoss=",$F("stopLoss"),"&stopLossEnd=",$F("stopLossEnd"),"&sizingStart=",$F("sizingStart"),"&sizingEnd=",$F("sizingEnd"),"&selectedTime=",getCheckBoxesValues("selectedTime"),"&pipsStart=",$F("pipsStart"),"&pipsEnd=",$F("pipsEnd"),getCommentsOptions("commentOption")];fxAjax.sendRequest(fxVars.searchProfile+c.join(""),{contentType:"text/xml",loader:true,params:{name:$F("profileName")},callback:"addSearchProfileResponse"})}}function addSearchProfileResponse(result,params){var tr;var td;var numOfColumns=5;var searchProfileError=result.getElementById("searchProfileError");if(searchProfileError){return showTip(searchProfileError.innerHTML)}var response=result.getElementsByTagName("response")[0];if(!result.error){var elements=eval("("+getContent(response)+")");for(var i=0;i<elements.list.length;i++){var id=elements.list[i].oid;if(!$PT("profile"+id)){var div=new Element("div",{id:"profile"+id,className:"tagBG"});var profileName=new Element("span",{name:"profiles",profileId:id});profileName.update(elements.list[i].name+"&nbsp;&nbsp;");profileName.onclick=function(){loadProfile(id,params.name)};profileName.onmouseover=function(){addSaveProfileTip(id,"profile"+id)};var remove=new Element("a",{href:"javascript:void(0);",id:"removeProfile"+id,className:"remove"});remove.onclick=function(){removeProfileMessage(id)};div.appendChild(profileName);div.appendChild(remove);$PT("profilesList").appendChild(div);createProfileTip("profile"+id)}}$PT("profileName").value="";$PT("profileList").value=JSON.stringify(elements)}}function showTip(a){console.debug(a);if($PT("profileChangedMessage").style.display=="none"){$PT("profileChangedMessage").innerHTML=a;showElement("profileChangedMessage");window.setTimeout(function(){$J("#profileChangedMessage").fadeOut()},(3000))}}function isContains(b,a){for(var c=0;c<b.length;c++){if(b[c]==a){return true}}return false}function clearProfile(b){for(var a=0;a<b.length;a++){if(b[a].type=="checkbox"){if(b[a].checked){b[a].checked=false}}else{if(b[a].type=="text"){b[a].value=""}else{if(b[a].nodeName=="OPTION"){b[a].selected=false}}}}}function loadProfile(profileOid,profileMessage){try{var profileList=eval("("+$F("profileList")+")");var i=profileList.list.length-1;for(i;i>-1;i--){if(profileOid==profileList.list[i].oid&&accountOid==profileList.list[i].createdOnAccount){return getMoreMagics(accountOid,0,"sp",null,profileOid,profileMessage)}}setProfileInfo(profileOid,profileMessage);$("#clearSearchSettings").show()}catch(ignored){}}function resetSearchProfile(a){$("#magicList").css("pointer-events","none");setProfileInfo(-1);getMoreMagics(a,0,"p",null,-1)}function setProfileInfo(profileOid,profileMessage){var allElements;for(var i=0;i<commentsName.length;i++){var commentElement=$PT(commentsName[i]);if(commentElement!=null){removeElement(commentElement)}}var profileList=eval("("+$F("profileList")+")");var elementInfo;for(var j=0;j<profileList.list.length;j++){if(profileList.list[j].oid==profileOid){if(profileList.list[j].comment2!=null){createCommentBox()}if(profileList.list[j].comment3!=null){createCommentBox()}if(profileList.list[j].comment4!=null){createCommentBox()}if(profileList.list[j].comment5!=null){createCommentBox()}allElements=carpeGetElementsByClass("profileAnalyze");clearProfile(allElements);for(var i=0;i<allElements.length;i++){if(allElements[i].type=="checkbox"){if(profileList.list[j][allElements[i].name]!=null){if(typeof(profileList.list[j][allElements[i].name])=="boolean"){allElements[i].checked=profileList.list[j][allElements[i].name]}else{elementInfo=profileList.list[j][allElements[i].name].split(",");allElements[i].checked=isContains(elementInfo,allElements[i].value)}}}if(allElements[i].type=="text"){if(profileList.list[j][allElements[i].name]!=null){allElements[i].value=profileList.list[j][allElements[i].name]}}if(allElements[i].nodeName=="OPTION"){if(allElements[i].getAttribute("optionId")){elementInfo=profileList.list[j][allElements[i].getAttribute("optionId")];if(elementInfo==null){elementInfo="1"}}else{elementInfo=profileList.list[j][allElements[i].getAttribute("itemOption")]}if(elementInfo==allElements[i].value){allElements[i].selected=true}}}}}if(profileMessage!=null){if($PT("profileChangedMessage").style.display=="none"){$PT("profileChangedMessage").innerHTML=$T("tSearchProfileLoaded",[[profileMessage]]);showElement("profileChangedMessage");window.setTimeout(function(){$J("#profileChangedMessage").fadeOut()},(1000))}}showInputTip(profileOid)}function removeElement(a){try{if($PT(a)){$PT(a).remove()}}catch(b){}}function removeProfileMessage(a){inlineAlert($PT("profile"+a),$T("tConfirmProfileDelete")+"<br/><br/><div class='center'><span class='exclamation'>"+$T("tCannotUndo")+"</span></div>","removeProfile("+a+")")}function removeProfile(a){fxAjax.sendRequest(fxVars.removeProfile+a,{contentType:"text/xml",loader:true,params:{profileId:a},callback:"removeProfileResponse"})}function removeProfileResponse(a,b){if(!a.error){removeElement("profile"+b.profileId);removeElement("removeProfile"+b.profileId);Tipped.remove("profile"+b.profileId)}}function sortComparator(d,c){return $AT(c,"sortId")-$AT(d,"sortId")}function getMagicNamesByProfile(profileOid){if(profileOid==null||profileOid=="temp"||profileOid==-1){return null}try{var profileList=eval("("+$F("profileList")+")");var profileJson,j=0,l=profileList.list.length;for(j;j<l;j++){if(profileList.list[j].oid==profileOid){profileJson=profileList.list[j];break}}return profileJson.accountMagicNames?profileJson.accountMagicNames.trim().split(","):null}catch(e){return null}}function buildProfileText(x){var t={};var m={};var h=[];var u;var y="";var q="";var d=true;var f=getMagicNamesByProfile(x);var g=carpeGetElementsByClass("profileAnalyze");g.sort(sortComparator);for(var s=0;s<g.length;s++){m=t[$AT(g[s],"menuId")];if(m==null){m={}}if($AT(g[s],"mainName")!=null){u=m[$AT(g[s],"mainName")]}if(u==null){u={}}if($PT(g[s].type=="checkbox")&&$PT($AT(g[s],"labelId"))&&g[s].checked){u.type=$AT(g[s],"option");if(u.size==null){u.size=1}else{if(u!=""){u.size=u.size+1}}if($AT(g[s],"checkboxType")=="boolean"){u[$AT(g[s],"mainName")]=""}else{if($AT(g[s],"mainName")==="accountMagic"){if(f==null){u[$PT($AT(g[s],"labelId")).innerHTML]=$PT($AT(g[s],"labelId")).innerHTML}}else{u[$PT($AT(g[s],"labelId")).innerHTML]=$PT($AT(g[s],"labelId")).innerHTML}}m[$AT(g[s],"mainName")]=u}else{if(g[s].nodeName=="OPTION"){if(g[s].selected){if(g[s].getAttribute("optionId")){u[g[s].getAttribute("optionId")]=g[s].innerHTML}else{u[g[s].getAttribute("itemOption")]=g[s].innerHTML}m[$AT(g[s],"mainName")]=u}}else{if(g[s].type&&g[s].type=="text"){u[$AT(g[s],"range")]=escapeHtml(g[s].value);if(u.size==null&&g[s].value!=""){u.size=1}else{if(g[s].value!=""||g[s].getAttribute("commentId")){u.size=u.size+1}}if($AT(g[s],"scale")){u.scale=$AT(g[s],"scale")}u.type=$AT(g[s],"option");if($AT(g[s],"mainName")){m[$AT(g[s],"mainName")]=u}else{m[$AT(g[s],"mainName")]=u}}}}t[$AT(g[s],"menuId")]=m}if(f!=null){try{if(!t[localizedMagicMenuId].accountMagic){t[localizedMagicMenuId].accountMagic=Object.create(null)}var r=0,o=f.length;for(r;r<o;r++){t[localizedMagicMenuId].accountMagic[f[r]+"\n"]=f[r]+"\n"}t[localizedMagicMenuId].accountMagic.size=o}catch(w){console.warn(w)}}h.push("<table>");for(var c in t){if(c!=null){m=t[c];if(c!="global"&&!profileIsEmpty(m)){h.push("<tr><td><b>"+c+" </b></td>")}else{h.push("<tr><td></td>")}if(!profileIsEmpty(m)){d=false;for(var b in m){u=m[b];if(u.size){h.push("<td>");if(b=="accountMagic"||u.type=="notDisplay"||(u.start==""&&u.end=="")||u.comment==""){h.push("")}else{h.push(b+" ");if(m[b].commentOption1){h.push(":");h.push("</br>");u.size=u.size*2;for(var k=1;k<=u.size;k++){if(hasText(u["comment"+k])){h.push(u["commentOption"+k]);h.push(" ");h.push("'"+u["comment"+k]+"'");h.push("<br/>")}}}}if(u.type=="range"){if(u.scale=="$"){y="$"}else{if(u.scale!=null){q=u.scale}}if(u.start!=""&&u.end!=""&&u.start!=u.end){h.push(""+$T("tBetween",[y+u.start+q,y+u.end+q]))}if(u.start!=""&&u.end!=""&&u.start==u.end){h.push(""+$T("tEqual",[y+u.start+q]))}if(u.start!=""&&u.end==""){h.push($T("tMorethan")+" "+y+u.start+q)}if(u.start==""&&u.end!=""){h.push($T("tLessthan")+" "+y+u.end)}if(b=="Duration"&&(u.start!=""||u.end!="")){h.push(" "+u.durationTime+" ")}if(u.scale&&(u.start!=""||u.end!="")){y=""}q=""}else{for(var r in u){var a=r.startsWith("comment");if(u[r]!=null&&r!="type"&&u[r]!=""&&r!="size"){if(!a){h.push(u[r]);u.size=u.size-1;if(u.size>0&&!a){h.push(",")}}}}}h.push(" ");h.push("</td></tr><tr><td></td>")}}}h.push("</tr>")}}h.push("</table>");if(d){return $T("tNoDataToDisplay")}return h.join("")}function addSaveProfileTip(profileId,showProfileId){var profile=currentProfile();var profileList=eval("("+$F("profileList")+")");profileList.list.push(profile);var size=profileList.list.length-1;$PT("profileList").value=JSON.stringify(profileList);setProfileInfo(profileId);createProfileTip(profileId,showProfileId);setProfileInfo("temp");profileList.list.splice(size,1);$PT("profileList").value=JSON.stringify(profileList)}function createProfileTip(b,a){new Tip("#"+a,buildProfileText(b),{title:$T("tCurrentSearchSettings"),maxWidth:500})}function profileIsEmpty(b){var f=["durationTime","type","size","scale"];var a=["Show actual growth","Show Manual trades"];for(var d in b){if(b.hasOwnProperty(d)){for(var c in b[d]){if((f.indexOf(c)==-1&&b[d][c]!="")||a.indexOf(c)!=-1){return false}}}}return true}function showInputTip(a){new Tip("#profileName",buildProfileText(a),{title:$T("tCurrentSearchSettings"),maxWidth:500,showOn:"click",hideOn:{element:"target",event:"blur"}});hideElement("showActualGrowth")}var monthType=0;function monthChart(h,m,d,r){disposeCharts(["chartMonthly"]);var k=document.getElementById("chartYearsUl").getElementsByTagName("li");var o;for(var g=0;g<k.length;g++){if(k[g].className=="on"){o=k[g].getAttribute("year")}}var f=new Date(userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat")));var q=new Date("01/01/"+o);var c;if(q<f){c=getDbDateFormat(f)}else{c=o+"-01-01"}monthType=m;var a=new Chart(480,250,"monthlyCont",3);if(d!="st"){var b="&startDate="+c+"&endDate="+getDbDateFormat(userFormatToDefaultFormat($F("endDate"),$F("userTimeFormat")))+"&l="+d+"&startDateYear="+getDbDateFormat(f);a.renderChart("/charts.xml?chartType=3&accountOid="+h+"&monthType="+monthType+b+buildAdvancedStatisticsUrl(true,false))}else{var b="&startDate="+c+"&endDate="+getDbDateFormat(userFormatToDefaultFormat($F("endDate"),$F("userTimeFormat")))+"&l="+d+"&startDateYear="+getDbDateFormat(f);a.renderChart("/strategy-chart.json?chartType=3&monthType="+monthType+"&id="+h+b)}}function showCommentWatchDashboard(b){if(!isShown("watched"+b)){Tipped.hideAll()}var a=($PT("pencil"+b)==null?$PT("ballon"+b):$PT("pencil"+b));if(!isShown("watched"+b)){var c=jQuery("#watched"+b).remove().clone();jQuery("#"+b).after(c);$PT("watched"+b).style.display="";boldTD(a);a.onclick=function(){showCommentWatchDashboard(b)}}else{$PT("watched"+b).style.display="none";boldTD(a);a.onclick=function(){showCommentWatchDashboard(b)}}}function addCommentWatch(c,a){var d;var b;if(a=="d"){d=["oid=",c,"&comment=",encodeParameter($F("text"+c))];b=getLinksTitleByName(a+"files"+c)}else{if(a=="s"){d=["oid=",c,"&comment=",encodeParameter($F("textComment"))];b=getLinksTitleByName(a+"files")}}if(hasText(b)){d.push("&files=");d.push(b)}fxAjax.sendRequest(fxVars.commentWatch,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:d.join(""),params:{oid:c,type:a},loader:true,callback:"addWatchCommentResponse"})}function addWatchCommentResponse(k,g){var l=k.content.comment;var f=g.oid;if(g.type=="d"){if(!k.error){var a=getLinksTitleByName(g.type+"files"+f);var h=hasText(a);attachFiles(f,a,"");var c=$PT("pencil"+f);var d=k.content.commentEscape;if(h){d+="<br/><br/>"+$T("tAttachments")+":<br/><div>"+$PT("files"+f).innerHTML}else{d+="</div>"}var m;if(c!=null){c.className="ballonSmall pointer";c.id="ballon"+f;buildOrderTip(c.id,d,h);c.onclick=function(){showCommentWatchDashboard(f)}}else{if(c!=null&&h){m=$PT("ballon"+f);buildOrderTip(m.id,d,h);m.onclick=function(){showCommentWatchDashboard(f)}}else{if(c==null&&!h&&l.length==0){m=$PT("ballon"+f);m.className="pencilSmall pointer";m.id="pencil"+f;Tipped.remove(m);m.onclick=function(){showCommentWatchDashboard(f)}}else{m=$PT("ballon"+f);buildOrderTip(m.id,d,h);m.onclick=function(){showCommentWatchDashboard(f)}}}}$PT("originalComment"+f).value=k.content.commentEscape}hideElement("watched"+f);var b=$PT("pencil"+f);if(b==null){b=$PT("ballon"+f)}boldTD(b)}else{if(g.type=="s"){if(!k.error){$PT("textComment").value=l;$PT("displayComment").innerHTML=k.content.commentEscape;if(k.content.commentEscape.trim()==""){$PT("displayComment").innerHTML="<span class='gray'>"+$T("tYourCommentIsEmpty")+"</span>"}attachFilesFunction("",getLinksTitleByName("sfiles"),$F("sessionUsername"));if($F("filesSize")=="0"){hideElement("files")}else{showElement("files")}}else{$PT("textComment").value=$F("originalComment");$PT("displayComment").innerHTML=$F("originalComment")}hideElement("textAccountWatchComment");showElement("displayAccountWatchComment")}}}function closeAddWatchComment(c){hideElement("watched"+c);var a=$PT("originalComment"+c);if(a!=null){$PT("text"+c).value=$PT("originalComment"+c).value}var b=$PT("pencil"+c);if(b==null){b=$PT("ballon"+c)}b.onclick=function(){showCommentWatchDashboard(c)};boldTD(b)}function openEditCommentWatch(a){if(a=="open"){showElement("textAccountWatchComment");hideElement("displayAccountWatchComment");$PT("originalCommentText").value=$PT("textComment").value;$PT("textComment").focus();hideElement("files")}else{if($F("filesSize")=="0"){hideElement("files")}else{showElement("files")}hideElement("textAccountWatchComment");showElement("displayAccountWatchComment");$PT("textComment").value=$PT("originalCommentText").value}}function attachFilesFunction(k,b,a){$PT("files").innerHTML="";try{var g=b.split(",");g=orderFiles(g);if(g==""){$PT("filesSize").value="0"}else{$PT("filesSize").value=g.length}for(var d=0;d<g.length;d++){var c=removeSpace(g[d]);if(isImage(c)){var f="img"+getRandomInt();$PT("files").innerHTML+="<a id="+f+' target="_blank" href="/files/'+a+"/"+encodeParameter(c)+'" style="color:white;text-align:center"></a>&nbsp;';$PT(f).insert(new Element("img",{src:"/files/"+a+"/"+c,style:"margin-bottom:2px; border:2px solid #5F5F5F;max-width:220px; max-height:220px"}))}else{$PT("files").innerHTML+='<a style="color:black" target="_blank" href="/files/'+a+"/"+c+'">'+c+"</a><br/>"}}}catch(h){}}function removeAccountWatchMessageSystemPage(b,a,c){inlineAlert($PT("buttAccountWatch"),$T("tConfirmWatchDelete"),"removeAccountWatch("+b+","+a+",'"+c+"')")}function sumOfCheckBoxElements(b){var f=0;var d=document.getElementsByName(b);var a=d.length;for(var c=0;c<a;c++){if(d[c].checked){f++}}return f}function showHideElementByClass(className,columns,tableName,button,func){var columnLimit=14;if(tableName=="portfolioOverallTable"||tableName=="dashboardSystemsTable"){columnLimit=10}if(tableName=="watchTable"){columnLimit=9}if($PT(className)!=undefined){var checkStatus=$F(className)}if(checkStatus=="off"||sumOfCheckBoxElements(columns)<(columnLimit+1)){var table=document.getElementById(tableName);if(table!=undefined){var rows=table.getElementsByTagName("tr");var cels;var pattern=new RegExp("\\b"+className+"\\b");for(var row=0;row<rows.length;row++){if(rows[row].firstElementChild.tagName=="TH"){cels=rows[row].getElementsByTagName("th")}else{cels=rows[row].getElementsByTagName("td")}for(var i=0;i<cels.length;i++){if(pattern.test(cels[i].className)){if(isShown(cels[i])){hideElement(cels[i])}else{showElement(cels[i])}}}}if(tableName=="watchTable"){$J(".dynamicColspan").attr("colspan",sumOfCheckBoxElements(columns)+2)}}eval(func)}else{if(tableName=="tradingOpenOrdersTable"){$PT(className+"OpenOrders").checked=false}else{if(tableName=="tradingOpenTradesTable"){$PT(className+"OpenTrades").checked=false}else{if(tableName=="tradingHistoryTable"){$PT(className+"History").checked=false}else{$PT(className).checked=false}}}inlineMsg($PT(button),$T("tMaxNumberOfColumns",[columnLimit]),3)}}function updatePortfolioOverallFilter(){fxAjax.sendRequest(fxVars.updatePortfolioOverallFilter+getCheckBoxesIds("moreColumnName"),{loader:false,id:{id:"portfolioOverallMore"}})}function completeCallbackFunction(a,d){var f;if(a.error=="false"){if(a.id==null){f=""}else{f=a.id}var b=Math.floor(Math.random()*99999);var c="<a target='_blank' href='/files/"+d.username+"/"+a.file+"' title='"+a.file+"' name='"+a.type+"files"+a.id+"' id='"+a.type+"fileLink"+b+"'>"+a.file+"</a> &nbsp;<a href='javascript:void(0)' class='font10 underline' id='"+a.type+"fileRemove"+b+"' onclick='removeFileLink("+b+',"'+a.type+"\")'>Remove</a><br id='"+a.type+"fileBr"+b+"'/>";$PT(a.type+"files"+f).innerHTML+=c}else{inlineMsg("cabinetLabel",a.message,3)}}function removeFileLink(b,a){$PT(a+"fileLink"+b).remove();$PT(a+"fileRemove"+b).remove();$PT(a+"fileBr"+b).remove();if($PT(a+"insert"+b)){$PT(a+"insert"+b).remove()}}function showHideTableRows(d,g,k,c){var b=document.getElementById(d);var f=b.getElementsByTagName("tr");for(var h=g;h<f.length;h++){if(isShown(f[h])){hideElement(f[h])}else{showElement(f[h])}}var a=document.getElementById(c);if(k=="show"){a.onclick=function(){showHideTableRows(d,g,"hide",c)};a.innerHTML=$T("tHideAll")}else{a.onclick=function(){showHideTableRows(d,g,"show",c)};a.innerHTML=$T("tShowAll")}}function selectSpreadsBestBroker(el){var elements=$$PT("#bestBrokerTable tr");var checked=eval(el.getAttribute("allSelected"));for(var i=0;i<elements.length;i++){if(checked){$PT(elements[i]).style.display=""}else{if(i>5){$PT(elements[i]).style.display="none"}}}el.setAttribute("allSelected",!checked);el.innerHTML=checked?$T("tLess"):$T("tMore")}function navigateToNewWindow(a){window.open(a,"_blank","")}function searchTranslate(){if($F("searchTranslate").trim().length>0){fxAjax.sendRequest(fxVars.searchTranslate+"search="+encodeParameter($F("searchTranslate")),{loader:true,callback:"searchTranslateResponse"})}}function searchTranslateResponse(a){if(!a.error){$PT("translateCont").innerHTML=a.content.translationList}}function searchTranslateVote(){if($F("searchTranslate").trim().length>0){fxAjax.sendRequest(fxVars.searchTranslateVote+"search="+encodeParameter($F("searchTranslate")),{loader:true,callback:"searchTranslateVoteResponse"})}}function searchTranslateVoteResponse(a){if(!a.error){$PT("translateCont").innerHTML=a.content.translationList;$PT("pagingSize").innerHTML=a.content.pagingSize}}function authorizeOanda(real,oandaApiNewMode){if(eval(real)){window.location.href=oandaApiNewMode?"https://api-fxtrade.oanda.com/v1/oauth2/authorize?client_id=07pKoY0k3sdSDeB2&redirect_uri=https://www.myfxbook.com/?back=settings&state=1&response_type=code&scope=read":"https://fxtrade.oanda.com/account/tpa/authorize?client_id=myfxbook&response_type=code&redirect_uri=https://www.myfxbook.com/?back=settings&state=1&scope=can_view_transaction_history"}else{window.location.href=oandaApiNewMode?"https://api-fxpractice.oanda.com/v1/oauth2/authorize?client_id=7yK9j9jJTBb14qXz&redirect_uri=https://www.myfxbook.com/?back=settings&state=0&response_type=code&scope=read":"https://fxtrade.oanda.com/account/demo/tpa/authorize?client_id=myfxbook&response_type=code&redirect_uri=https://www.myfxbook.com/?back=settings&state=0&scope=can_view_transaction_history"}}function autoResize(a){var c=a.cols;var b=0;$A(a.value.split("\n")).each(function(d){b+=1+Math.floor(d.length/c)});a.rows=b}function autoResize(b,a){var d=b.cols;var c=0;$A(b.value.split("\n")).each(function(f){c+=1+Math.floor(f.length/d)});if(c<a){c=a}b.rows=c}function styleFigure(d,c,a,f,b,h){var g=d.toFixed(h);if(d>=0){return f?"<span class='green'>"+(b?"+":"")+c+g+a+"</span>":(b?"+":"")+c+g+a}else{return f?"<span class='red'>-"+c+Math.abs(g)+a+"</span>":"-"+(c)+Math.abs(g)+a}}function getProfit(c,b){var a="";if(c>=0){a=(b=="%")?c+b:b+c}else{a=(b=="%")?Math.abs(c)+b:b+Math.abs(c);a="-"+a}return a}function tryOandaLogin(g,f,c,a){if(validate("accountName"+g,VALID_SYSTEM_NAME)){hideElement("accountConnButton"+g);hideElement("loginResponse"+g);showElement("loginResponse"+g);showElement("loginLoad"+g);hideElement("testButton");$PT("loginResponse"+g).innerHTML=" &nbsp;&nbsp;Connecting to your account";var b=$F("accountName"+g);var d="accountId="+g+"&accountName="+b+"&oauthToken="+f+"&isAccountReal="+c;fxAjax.sendRequest(fxVars.addOandaAccount+d,{params:{id:g,newAccount:a},loader:false,callback:"checkOandaLoginResponse"})}}function checkOandaLogin(c,b,a){fxAjax.sendRequest(fxVars.checkOandaLogin+c+"&lastStatus="+b,{params:{id:c,newAccount:a},loader:false,callback:"checkOandaLoginResponse"})}function checkOandaLoginResponse(g,d){var b=g.content.menu;var c=g.content.accountUrl;var h=d.id;var k=g.error;var l=g.message;var a=g.content.code;var f=g.content.newAccountStatus;if(!k&&f!=STATUS_ERROR){if(d.newAccount){$PT("loginResponse"+h).innerHTML=" &nbsp;&nbsp;"+l;if(f==STATUS_LOGIN_PENDING||f==STATUS_LOGIN_PASS||f==STATUS_CREATING_ACCOUNT||f==STATUS_CALCULATING){checkOandaLogin(d.id,f,true)}else{if(f==STATUS_LOGIN_FAILED||f==STATUS_CALC_COMPLETE||f==STATUS_SERVER_DOWN){hideElement("loginLoad"+h);if(f==STATUS_CALC_COMPLETE){showElement("connection"+h);$PT("takeMe"+h).href=c;$PT("accountsNav").innerHTML=b;runAjaxScripts(getContent(b))}}}}}else{$PT("loginResponse"+h).innerHTML=l;hideElement("loginLoad"+h);if(d.newAccount){if(hasText(g.content.data)){$PT("loginResponse"+h).innerHTML+=g.content.data}hideElement("accountName"+h);hideElement("accountConnButton"+h)}else{}}}function stop(a){if(!a){var a=window.event}a.cancelBubble=true;if(a.stopPropagation){a.stopPropagation()}}function closeSystemAlertWindow(){hideElement("systemAlertMsg");setCookie("systemAlertWindow","0",MINUTE*60*24*30)}function editRemoveGoal(oid,edit){var data;var error=false;if(edit){if(validate("goalsEditTargetInput"+oid,30)){var selectFieldType=$PT("goalsEditTypeSelect"+oid);var isPercent=eval($AT(selectFieldType.options[selectFieldType.selectedIndex],"isPercent"));var target=$F("goalsEditTargetInput"+oid);if(isPercent&&(target<0||target>100)){inlineMsg("goalsEditTargetInput"+oid,"<strong>"+$T("tError")+"</strong><br />"+$T("tPleaseEnterNumberBetween",[0,100]),3);error=true}data=["oid=",oid,"&edit=","true","&target=",target]}else{error=true}}else{data=["oid=",oid,"&edit=","false"]}if(!error){fxAjax.sendRequest(fxVars.editRemoveGoal+data.join(""),{loader:false,params:{oid:oid,edit:edit},callback:"editRemoveGoalResponse"})}}function editRemoveGoalResponse(a,b){if(!a.error){$PT(a.content.goalPeriod+"Goals").innerHTML=a.content.data;$PT(a.content.goalPeriod+"DateScroll").innerHTML=a.content.scroll;if(!b.edit){removeElement("goalsEditRow"+b.oid)}else{hideElement("goalSave"+b.oid);hideElement("goalCancel"+b.oid)}}else{inlineMsg("goalsEditTargetInput"+b.oid,a.message,3)}}function showHideElement(a){if(isShown(a)){hideElement(a)}else{showElement(a)}}function addGoal(goalPeriod,accountOid){if(validate("goalsTargetInputNew"+goalPeriod,30)){var target=$F("goalsTargetInputNew"+goalPeriod);var selectFieldType=$PT("goalsTypeSelectNew"+goalPeriod);var selectType=selectFieldType.selectedIndex;var isPercent=eval($AT(selectFieldType.options[selectType],"isPercent"));if(isPercent&&(target<0||target>100)){inlineMsg("goalsTargetInputNew"+goalPeriod,"<strong>"+$T("tError")+"</strong><br />"+$T("tPleaseEnterNumberBetween",[0,100]),3)}else{showElement("add"+goalPeriod);var relation=$F("goalsRelationSelectNew"+goalPeriod);var data=["accountOid=",accountOid,"&period=",goalPeriod,"&type=",selectType,"&relation=",relation,"&target=",target];fxAjax.sendRequest(fxVars.addGoal+data.join(""),{loader:false,callback:"addGoalResponse"})}}}function addGoalResponse(a,b){if(!a.error){$PT(a.content.goalPeriod+"Goals").innerHTML=a.content.data;$PT(a.content.goalPeriod+"GoalsEdit").innerHTML=a.content.edit;$PT(a.content.goalPeriod+"DateScroll").innerHTML=a.content.scroll;showElement(a.content.goalPeriod+"GoalsEdit")}else{inlineMsg("goalsEditTargetInput"+b.oid,a.message,3)}}function switchGoalsEditWindows(c){var a=convertGoalPeriod(c)+"GoalsEdit";for(var b=0;b<allPeriodGoalsEdit.length;b++){if(a==allPeriodGoalsEdit[b]){showElement(allPeriodGoalsEdit[b])}else{hideElement(allPeriodGoalsEdit[b]);cancelAddGoal(c)}}}function changeGoalDate(b,g,a,f,d){showElement("Load"+g);var c=["accountOid=",b,"&goalsPeriod=",g,"&curDate=",a,"&action=",f,"&page=",d];fxAjax.sendRequest("/changeGoalDate.json?"+c.join(""),{loader:false,callback:"changeGoalDateResponse"})}function changeGoalDateResponse(a,b){if(!a.error){$PT(a.content.goalPeriod+"Goals").innerHTML=a.content.data;$PT(a.content.goalPeriod+"DateScroll").innerHTML=a.content.scroll}else{}}function cancelGoal(a){hideElement("goalSave"+a);hideElement("goalCancel"+a);$PT("goalsEditTargetInput"+a).value=$F("originalGoalValue"+a)}function deleteGoalMessage(a){inlineAlert($PT("goalRemove"+a),$T("tConfirmDeleteIt"),"editRemoveGoal("+a+",false)")}function onClickDivMarkingCheckBox(a){$PT(a).checked=!$PT(a).checked}function goalsRelationSwitch(d){var a=$PT("goalsRelationSelectNew"+d);var c=$PT("goalsTypeSelectNew"+d);var b=$AT(c.options[c.selectedIndex],"permissions");a.selectedIndex=(b=="all"||b=="positive")?0:1;a.disabled=(b=="all")?"":"true"}function convertGoalPeriod(a){switch(a){case 0:return"daily";case 1:return"weekly";case 2:return"monthly";case 3:return"yearly";default:return""}}function cancelAddGoal(a){hideElement(convertGoalPeriod(a)+"GoalsAdd");showElement("add"+a);$PT("goalsRelationSelectNew"+a).selectedIndex=0;$PT("goalsRelationSelectNew"+a).disabled="true";$PT("goalsTypeSelectNew"+a).selectedIndex=0;$PT("goalsTargetInputNew"+a).value=""}function clearField(a){$PT(a).value=""}function updatePortfolioSettings(){fxAjax.sendRequest(fxVars.updatePortfolioSettings+collectPortfolioSettings(),{})}function collectPortfolioSettings(){var a=[];a.push("tradingColumnsHistory="+getCheckBoxesAttribute("tradingColumnsHistory","field"));a.push("&tradingColumnsOpenTrades="+getCheckBoxesAttribute("tradingColumnsOpenTrades","field"));a.push("&tradingColumnsOpenOrders="+getCheckBoxesAttribute("tradingColumnsOpenOrders","field"));a.push("&growthChart=",getAttributeByRadioChecked("growthOptions","field"));a.push("&monthChart=",getAttributeByRadioChecked("growthMonthOptions","field"));a.push("&drawDownChart=",getAttributeByRadioChecked("drawdownOptions","field"));a.push("&advancedStatisticsSummary=",getAttributeByRadioChecked("symbolOptions","field"));a.push("&advancedStatisticsDuration=",getAttributeByRadioChecked("durationOptions","field"));a.push("&advancedStatisticsHourly=",getAttributeByRadioChecked("hourlyOptions","field"));a.push("&advancedStatisticsHourlyType=",getAttributeByRadioChecked("hourlySecondOptions","field"));a.push("&filterHistory=",getCheckBoxesValues("filterOption"));a.push("&slTpFormat="+getComboValue("formatSlTp"));a.push("&showBrokerTime="+getComboValue("timeSwitcher"));return a.join("")}function getCheckBoxesIds(b){var f=[];var d=getElemsByInputName(b);var a=d.length;for(var c=0;c<a;c++){if(d[c].checked){f.push(d[c].id)}}return f.join(",")}function getCheckBoxesValuesByNameAndAttr(b,a){var c=[];$J("input[name='"+b+"']:checked").each(function(){c.push($J(this).attr(a))});return c.join(",")}function getNumSign(a){if(a>0){return"+"+a}else{return a}}function getCheckBoxesAttribute(a,c){var f=getElemsByInputName(a);var d=[];for(var b=0;b<f.length;b++){if(f[b].checked){d.push(f[b].getAttribute(c))}}return d.join(",")}function countGroupChecked(d){var c=getElemsByInputName(d);var b=0;for(var a=0;a<c.length;a++){if(c[a].checked){b++}}return b}function countCheckboxes(a){return getElemsByInputName(a).length}function getElemsByInputName(a){return $$PT("input[name="+a+"]")}function contestResendEmail(a){fxAjax.sendRequest(fxVars.contestResendMail+a,{params:{},loader:false,callback:"contestResendEmailResponse"})}function contestResendEmailResponse(c){var a=c.error;var b=c.message;if(!a){hideElement("contestReg");hideElement("resendMail");showElement("resendEmailResponse")}else{inlineMsg("resendMail","<b>"+$T("tError")+"</b><br>"+b,3)}}function convertObjectToJson(a){return JSON.stringify(a)}var drawdownChartStatus=0;function updateDrawdownChart(c,a){var b;var g=document.getElementsByName("drawdownOptions");for(var d=0;d<g.length;d++){if(g[d].checked){b=d;break}}if(drawdownChartStatus!=b){drawdownChartStatus=b;var f=new Chart(630,314,"chart4",0);f.renderChart("/charts.json?chartType=15&type=1&period=6&l=p&accountOid="+c+"&drawdownShowType="+a+buildAdvancedStatisticsUrl(false,false))}}function createCommentBox(){var b=$PT("commentTradeTable");var k=$$PT("#commentTradeTable tr").length;var m=b.insertRow(b.rows.length);m.id=commentsName[k-3];var h=new Element("select",{id:m.id+"Option",name:"commentOption",className:"font10 padd3 field1",style:"width: 80px"});var c=new Element("option",{"for":m.id+"Option",optionId:"commentOption"+(k-1),itemOption:"commentOption",sortId:"2",menuId:$T("tTrade"),mainName:$T("tCommentContains"),name:$T("tIncludeComment"),id:"includeComment"+(k-1),value:"1",className:"profileAnalyze"}).update($T("tIncludeComment"));var l=new Element("option",{"for":m.id+"Option",optionId:"commentOption"+(k-1),itemOption:"commentOption",sortId:"2",menuId:$T("tTrade"),mainName:$T("tCommentContains"),name:$T("tExcludeComment"),id:"excludeComment"+(k-1),value:"0",className:"profileAnalyze"}).update($T("tExcludeComment"));var o=new Element("input",{commentId:"1",mainName:$T("tCommentContains"),menuId:$T("tTrade"),sortId:"2",range:"comment"+(k-1),name:m.id,type:"text",className:"padd3 field1 profileAnalyze",onfocus:"borderChange(this);",onblur:"borderReturn(this);"});var g=new Element("a",{style:"display:",className:"underline paddlr5 profileAnalyze",trId:m.id,href:"javascript:void(0);"}).update($T("tRemove"));var f=m.insertCell(m.cells.length);f.appendChild(h);h.appendChild(c);h.appendChild(l);var d=m.insertCell(m.cells.length);d.appendChild(o);var a=m.insertCell(m.cells.length);a.appendChild(g);if(k==6){hideElement("addMoreComments")}else{showElement("addMoreComments")}g.onclick=function(){$PT(this.getAttribute("trId")).remove();showElement("addMoreComments")}}function getCommentBoxesValues(){var a=[];$$PT("input[commentId=1]").map($F).each(function(b){if(hasText(b)){b=b.trim();a.push("&comment=");a.push(encodeParameter(b))}});return a.join("")}function updateTagTip(f){var c=$$PT("#"+f+" div[name]");var a=new Element("div",{});var b="";Tipped.remove(f);if(c.length>0){for(var d=0;d<c.length;d++){b+='<span style="'+c[d].style.cssText+'" class="inlineBlock"></span>  '+escapeHtml(c[d].getAttribute("name"))+" &nbsp;<br/>"}new Tip("#"+f,b,{title:"Trade Tags"})}}var tagsTables=["tradingHistoryTable","tradingOpenTradesTable","tradingOpenOrdersTable"];function updateAllTagsTips(){for(var b=0;b<tagsTables.length;b++){var a=$$PT("#"+tagsTables[b]+" [name=tagWindow]");for(var c=0;c<a.length;c++){updateTagTip(a[c].id)}}}function clearTable(b){var a=$PT(b);while(a.rows.length>0){a.deleteRow(0)}$PT("attachmentsSpan").innerHTML="";$PT("tradeComment").innerHTML=""}function lockUnlockTopic(b,a){var c="";if(a){c=prompt("Enter reason:");if(c&&hasText(c)){fxAjax.sendRequest(fxVars.changeTopicLockStatus+b+"&locked="+a+"&lockReason="+c,{contentType:"text/xml",params:{oid:b,locked:a,lockReason:c},loader:true,callback:"lockUnlockTopicResponse"})}}else{fxAjax.sendRequest(fxVars.changeTopicLockStatus+b+"&locked="+a+"&lockReason="+c,{contentType:"text/xml",params:{oid:b,locked:a,lockReason:c},loader:true,callback:"lockUnlockTopicResponse"})}}function lockUnlockTopicResponse(b){var a=b.error;if(!a){window.location.reload()}}function traceObject(b,a){return a.flashObject.traceObject(b)}function ratePamm(b){if(isRated()){var a=["pammId="+b,"&profit=",$PT("profit").value,"&pricing=",$PT("pricing").value,"&service=",$PT("service").value,"&platform=",$PT("platform").value].join("");fxAjax.sendRequest(fxVars.ratePamm+a,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function rateRebateProgram(b){if(isRated()){var a=["rebateId="+b,"&profitability=",$PT("profitability").value,"&pricing=",$PT("pricing").value,"&service=",$PT("service").value,"&use=",$PT("use").value].join("");fxAjax.sendRequest(fxVars.rateRebateProgram+a,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function showHideSlTpOptions(optionId,func){var allSlTpElements=[{el:$$PT("span.slPrice"),id:"tradesPrice"},{el:$$PT("span.tpPrice"),id:"tradesPrice"},{el:$$PT("span.slPips"),id:"tradesPips"},{el:$$PT("span.tpPips"),id:"tradesPips"},{el:$$PT("span.slProfit"),id:"tradesProfit"},{el:$$PT("span.tpProfit"),id:"tradesProfit"}];var obj,element;for(obj in allSlTpElements){var object=allSlTpElements[obj];for(element in object.el){if(object.id==optionId){showElement(object.el[element].id)}else{hideElement(object.el[element].id)}}}var header=$PT(optionId).label;$J(".slHeader").each(function(){this.innerHTML=header});$J(".tpHeader").each(function(){this.innerHTML=header});if(hasText(func)){eval(func)}}function tradingActivityTimeSwitcher(optionId,func){if(optionId==1){$J(".userTime").css("display","none");$J(".brokerTime").css("display","")}if(optionId==0){$J(".brokerTime").css("display","none");$J(".userTime").css("display","")}if(hasText(func)){eval(func)}}function setPortfoliosChartsOptions(){mainChartStatus=getRadioIndex("growthOptions");drawdownChartStatus=getRadioIndex("drawdownOptions");monthType=getRadioIndex("growthMonthOptions");symbolChartStatus=getRadioIndex("symbolOptions")}function startPostUploadMain(a){hideElement("uploadResponse"+a);$PT("fileLoader"+a).style.display="";return true}function completePostUploadMain(response,params){if(response.error=="false"){var id=response.id;hideElement("fileLoader"+id);var tempId=Math.floor(Math.random()*99999);var link="<a target='_blank' href='"+response.path+"' title='"+response.file+"' type='image'  name='orderFiles"+params.id+"' id='"+response.type+"orderFileLink"+tempId+"'>"+response.file+"</a> &nbsp;<a href='javascript:void(0)' class='font10 underline' id='"+response.type+"orderFileRemove"+tempId+"' onclick='removeOrderFile("+tempId+',"'+response.type+"\")'>"+$T("tRemove")+"</a>&nbsp;<br id='"+response.type+"orderFileBr"+tempId+"'/>&nbsp;";var image=eval(response.isImage);if(image){var insert=new Element("a",{href:"javascript:void(0);",style:"display:",id:""+response.type+"insert"+tempId,className:"font10 underline"});insert.update($T("tInsert"));insert.onclick=function(){insertAtCursor($PT(params.text),response.path+"\n")}}new Insertion.Before($PT(params.upload),link);new Insertion.Before($PT(response.type+"orderFileBr"+tempId),insert)}else{hideElement("fileLoader"+id);inlineMsg("cabinetLabel"+id,response.message,6)}}function removeFile(a){filesUploaded.pop($PT("fileLink"+a).name);$PT("uploadForm"+a).remove()}function getFileLink(b){var a=$PT("fileLink"+b);if(a.title=="image"){return"\n"+a.href+"\n"}else{return"<a href='"+a.href+"' target='_blank'>"+a.name+"</a>"}}function getRadioIndex(b){var a=$$PT("input[name="+b+"]");for(var c=0;c<a.length;c++){if(a[c].checked){return c}}}function getAttributeByRadioChecked(a,b){return $$PT("input[name="+a+"]:checked")[0].getAttribute(b)}function getCommentsOptions(b){var a=[];var f=$$PT("input[commentId=1]").map($F);var d=$$PT("select[name="+b+"]");for(var c in d){if(!isNaN(c)&&hasText(d[c].value)&&hasText(f[c])){a.push("&commentOption=");a.push(d[c].value)}}return a.join("")}function escapeHtml(a){return(a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))}function beforeRunFunc(a){if(a!=undefined){a.runFunc()}}function disposeCharts(b){try{b.each(function(c){try{FusionCharts(c).dispose()}catch(d){}})}catch(a){}}function getAccountTracking(b,a){if(hasText(b)&&!hasText($PT("tracking").innerHTML)&&hasText(a)){fxAjax.sendRequest(fxVars.getAccountTracking+b+"&l="+a,{loader:true,callback:"getAccountTrackingResponse"})}else{showHideElement("tracking")}}function getAccountTrackingResponse(a){if(!a.error){$PT("tracking").innerHTML=a.content.data;showElement("tracking")}else{inlineMsg("trackingButton","<b>"+$T("tError")+"</b><br>"+a.message,3)}}function getCalendarChart(b){var a=new Chart(820,314,"chart"+b);a.renderChart("/calendar-chart.json?id="+b)}function displayElementByClass(a,c){var b=document.getElementsByClassName(a);for(i=0;i<b.length;i++){if(c==0){b[i].style.display="none"}else{if(c==1){b[i].style.display=""}}}}var $JD=(function(){function a(f){$J(f).modal("show")}function d(f){if(f=="#accountNotification"){notificationDialogIsOpen=false}$J(f).modal("hide")}function c(f){var g=$(f);g.find("input:not(:button), textarea").each(function(){$(this).val("")})}function b(f,h){var g=$(f);if(h.close!=undefined){g.off("hidden.bs.modal").on("hidden.bs.modal",h.close)}if(h.title!=undefined){$(f+"Title").html(h.title)}g.modal("show")}return{open:a,close:d,destroy:c,create:b}})();function getServerTime(){var a=dt.getTime();a+=MINUTE*dt.getTimezoneOffset()*-1;return a}function updateTimeById(f,c){var b=$PT(f).getAttribute("time");var a=dateToString(b);if(a!="false"){$PT(f).innerHTML=a;var d=getServerTime()-b;if((d/HOUR)>1){c=MINUTE}setTimeout('updateTimeById("'+f+'", "'+c+'")',c)}}function loadWallPostNotification(f,g,c,k,a,o){if(typeof chartsLoc=="undefined"&&hasText(a)){var b=createChartUrl(f,g,c,k,a,o);window.open(b,"_self")}var h="";var m;if(g==10){h="comment"+c}else{if(g==11){h="post"+c}}if($PT(h)!=null){goToChartNotification(h,false,true)}else{if(showMoreBloack){if(f==lastChartId){if($PT("post"+k)==null){var l=$$PT("#userMessages [postId]");m=l[l.length-1].getAttribute("postId")}if(Number(m)>k){var d=["firstPostOid=",k,"&invite="+o];if(m!=null){d.push("&lastPostOid="+m)}showMoreBloack=false;fxAjax.sendRequest(fxVars.getWallPosts+d.join(""),{params:{lastPostOid:m,firstPostOid:k,id:c,objectId:h},loader:false,callback:"loadWallPostNotificationResponse"})}else{jQuery("#userMessages [lastOid]").each(function(r){var s=Number(this.getAttribute("firstOid"));var q=Number(this.getAttribute("lastOid"));if(k<q&&k>s){getWallPostsBetweenOids(s,q,this,o,h)}})}}else{switchTab("tabs21","chartContainer",$PT("chartTab"+f));loadChart(f,chart_type_chart,true,null,h,false,g,c,k);hideElement("feedLoader")}}}hideElement("notificationCont")}function goToChartNotification(b,c,a){goToNotification(b,c,a,"chartDiscussion")}function goToNotification(b,d,a,c){var f=new Element("div",{style:"height: 100%; border-left: 3px solid orange; left: 0; top: 0;z-index:1",className:"absolute"});if(!d){f=new Element("div",{style:"height: 100%; border-left: 3px solid orange; left: 0; top:0;;z-index:1",className:"absolute"})}if($PT(b)!=null){if(a){moveScroller(c,b)}$PT(b).insertBefore(f,$PT(b).firstChild);$(f).fadeOut(3000)}}function loadWallPostNotificationResponse(a,d){if(!a.error){var f=new Element("div",{style:"height: 100%; border-left: 3px solid orange; left: 0px; top: 0px;z-index:1",className:"absolute"});var b=a.content.post;if(d.lastPostOid==null){$PT("post"+d.firstPostOid).innerHTML=b}else{var c=new Element("span",{});c.innerHTML=b;$PT("userMessages").appendChild(c)}if(a.content.lastOid!=null){$PT("showMoreWallPost").setAttribute("lastOid",a.content.lastOid)}else{hideElement("showMoreWallPost");$PT("showMoreWallPost").setAttribute("lastOid",0)}if(a.content.lastTime!=null){$PT("showMoreWallPost").setAttribute("lastTime",a.content.lastTime)}updateFeedScrooler("chartDiscussion");moveScroller("chartDiscussion",d.objectId);$PT(d.objectId).insertBefore(f,$PT(d.objectId).firstChild);$(f).fadeOut(3000)}showMoreBloack=true}function moveScroller(a,d){try{var b=document.getElementById(a).getBoundingClientRect().top;var c=document.getElementById(d).getBoundingClientRect().top;var h=jQuery("#"+a);var f=h.data("jsp");f.scrollBy(0,c-b)}catch(g){}return false}function createNotificationScroller(){jQuery("#notify").jScrollPane({hijackInternalLinks:true,animateScroll:true,verticalGutter:0}).bind("jsp-scroll-y",function(c,b,d,a){if(a){updateNotifications($PT("notificationElement"),ACTIVITY_PAGING)}});jQuery("#notify").hover(function(){jQuery(document).bind("mousewheel DOMMouseScroll",function(a){stopWheel(a)})},function(){jQuery(document).unbind("mousewheel DOMMouseScroll")});jQuery("#loggedIn").disableSelection()}function stopWheel(a){if(!a){a=window.event}if(a.preventDefault){a.preventDefault()}a.returnValue=false}function isLogin(){return hasText($F("userId"))}function getJElementsByAttribute(a,b){return $J("["+a+"='"+b+"']")}function showHideElementByElement(b,a){if(a){showElement(b)}else{hideElement(b)}}function displayJElementByAttribute(b,d,a){var c=getJElementsByAttribute(b,d);for(i=0;i<c.length;i++){showHideElementByElement(c[i],a)}}function showHidePortfolioAccounts(id){var portfolio=$J("#portfolioTitle"+id);var isOpen=eval(portfolio.attr("isOpen"));displayJElementByAttribute("portfolioOid",id,!isOpen);portfolio.attr("isOpen",!isOpen);if(!isOpen){$J("#expandButton"+id).text("-")}else{$J("#expandButton"+id).text("+")}}function updateSettingsPortfolioAccountsSize(newId,oldId){var id=0;var toIncrease=true;for(i=0;i<2;i++){if(i==0){id=newId}else{id=oldId;toIncrease=false}var accountsSize=$J("#portfolioAccountsSize"+id);var oldAccountSize=eval(accountsSize.attr("accountsSize"));var newValue=0;if(toIncrease){newValue=oldAccountSize+1}else{newValue=oldAccountSize-1}accountsSize.attr("accountsSize",newValue);accountsSize.text(newValue)}}function rateTradingPlatform(a){if(isRated()){var b=["tradingPlatformId=",a,"&features=",$PT("features").value,"&design=",$PT("design").value,"&mobility=",$PT("mobility").value,"&easeOfUse=",$PT("easeOfUse").value].join("");fxAjax.sendRequest(fxVars.rateTradingPlatform+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function addAccountSwitchPlatform(){var a=$J("#platformId option:selected").attr("type");if(a=="none"){$J("#accountSettings").html("");$J("#mainCancel").show()}else{fxAjax.sendRequest(fxVars.settingsAddAccountSwitch+a,{loader:true,callback:"addAccountSwitchPlatformResponse"})}}function addAccountSwitchPlatformResponse(a){$J("#mainCancel").hide();$J("#accountSettings").html(a.content.data)}function getRecentTopicFromPage(){var b=$J(".recent td");var a=[];for(var c=0;c<b.length;c++){a.push(b[c].id)}return a}function setLastPostsEffect(c,a){for(var b=0;b<a.length;b++){if($J.inArray(a[b],c)==-1){Effect.Pulsate(a[b],{pulses:5,duration:5})}}}function getCalendar(m,o){var d=collectionCalendarFilter();var f="";var k="";var l=$PT("startDate");var b=$PT("endDate");var q=$F("calPeriod");if(l!=undefined&&$F(l)!=""&&b!=undefined&&$F(b)!=""){var c=userFormatToDefaultFormat($F(l),o);var h=userFormatToDefaultFormat($F(b),o);if(q==-1){if(new Date(c)>new Date(h)){inlineMsg(m+"Statement",$T("tStartBeforeEnd"),3);return false}else{if(((new Date(h).getTime()-new Date(c).getTime())/1000)>THREE_MONTHS_IN_SECONDS){inlineMsg(m+"Statement",$T("tStartEndInRange3Months"),3);return false}}}f=getDbTimeFormat(c);k=getDbTimeFormat(h)}var g=["?start=",f,"&end=",k,"&filter=",d,"&calPeriod=",q];var a=$PT(m+"Statement").href;if($is(a)){$PT(m+"Statement").href=a.substring(0,a.indexOf("?")!=-1?a.indexOf("?"):a.length)+g.join("")}}function isFlashEnabled(){var a=false;try{var b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(b){a=true}}catch(c){if(navigator.mimeTypes["application/x-shockwave-flash"]!=undefined){a=true}}return a}function showInformationFlashMsg(c){if(!isFlashEnabled()){var b="http://get.adobe.com/flashplayer/";var a=new Element("div",{className:"center information relative",style:"top: 50%; left: 25%; width: 45%; padding: 0px 7px; z-index:110;"});var d=new Element("a",{className:"underline pointer",href:b,target:"_blank"});a.innerHTML="This site requires the latest flash version to be installed. Please go here to download: ";d.innerHTML=b;a.appendChild(d);c.appendChild(a)}}function bubbleResponse(b){if(b!=null){var a=new Element("div").update(b.bubble);var c=$PT("bubbleWindow");var d=b.time;c.insertBefore(a,c.firstChild);fxWebsocket.updateLastCalendarEventTime(d);playNotificationSound()}}function changeInboxSubscribe(c){var b=[];b.push("conId="+c);var a=$PT("subscribe").checked;b.push("&subscribe="+a);fxAjax.sendRequest(fxVars.changeInboxSubscribe+b.join(""),{params:{subscribe:a},loader:true,callback:"changeInboxSubscribeResponse"})}function changeInboxSubscribeResponse(a,b){if(!a.error){showInboxUnsubscribeTooltip(b.subscribe)}}function showInboxUnsubscribeTooltip(a){new Tip("#subTip",a?"Unsubscribe in order to stop receiving email notifications for this conversation.":"By subscribing to this conversation you are turning on the email notifications for private messages.",{title:a?"Unsubscribe To Conversation":"Subscribe To Conversation",maxWidth:200})}function switchSwapChartSymbol(){var b=[];var a=getRadioValue("symbol");var c=getRadioValue("swapLongShort");if(a!=undefined&&c!=undefined){b.push("symbolInfoOid="+a);b.push("&swapShortLong="+c);swapDifferenceChart.renderChart("/get-swap-chart-by-symbol.json?"+b.join(""))}}var TYPE_LOW="low";var TYPE_HIGH="high";function findTableLowHigh(b){var a=false;var d=$F(b+"Window");switch(b){case TYPE_LOW:$J(".lightRed").attr("class","");break;case TYPE_HIGH:$J(".lightGreen").attr("class","");break}if(d!="-"){if(isNaN(d)&&d!=""){inlineMsg(b+"Window",$T("tYouMustEnterValidNumber"),3);a=true}if(!a){var c=parseFloat(d);$J("[minMax=1]").each(function(f,g){switch(b){case TYPE_LOW:if(c>=parseFloat(g.textContent)){g.className="lightRed radius3 padd5"}break;case TYPE_HIGH:if(c<=parseFloat(g.textContent)){g.className="lightGreen radius3 padd5"}break}})}}}function changeBrokerSwapsSymbols(a){var c=5;if(sumOfCheckBoxElements("moreColumnName")<(c+1)){var b=getCheckBoxesIds("moreColumnName");setCookie("brokerSwapSymbols",'"'+b+'"',YEAR,false);fxAjax.sendRequest(fxVars.changeBrokerSwapsSymbols,{params:{},loader:true,callback:"changeBrokerSwapsSymbolsResponse"})}else{$PT(a).checked=false;inlineMsg($PT("moreButt"),$T("tMaxNumberOfColumns",[c]),3)}}function changeBrokerSwapsSymbolsResponse(a,c){if(!a.error){var b=a.content.newTable;$PT("swapsTable").innerHTML=b;$PT("swapSponsorBrokerTableContainer").innerHTML=a.content.swapSponsorBokerTable;runAjaxScripts(b);SortableTable.find();findTableLowHigh(TYPE_LOW);findTableLowHigh(TYPE_HIGH)}}function setOnMouseOutClass(b,a){if(a==undefined){a="zebraSort"}b.className=b.getAttribute(a)}function removeExistChildren(d,g){var f=[];var c=d.children;for(var b=0;b<c.length;b++){var a=c[b];if($$PT("#"+g+" [id="+a.id+"]").length>0){f.push(a)}}for(var b=0;b<f.length;b++){f[b].remove()}}function sortDashboard(){var a=$J("#sortable").sortable("toArray");var c=[];for(var b=0;b<a.length;b++){if(a[b+1]!=undefined){try{$J("."+a[b]).after($J("."+a[b+1]))}catch(d){}}c.push($PT(a[b]).getAttribute("orderId"))}fxAjax.sendRequest(fxVars.saveUserDashboardOrder+c,{params:{},callback:""})}function getActivity(){if(!busy&&!stopScroll){busy=true;var a;var b=document.getElementsByName("lastNotificationOid");if(b.length>0){a=b[b.length-1].value;showElement("acLoader");fxAjax.sendRequest(fxVars.getActivity+a,{contentType:"text/html",loader:false,callback:"getActivityResponse"})}}}var stopScroll=false;function getActivityResponse(a,b){if(!a.error){if(hasText(a.content.data)){$PT("activityCont").innerHTML+=a.content.data}else{hideElement("showMoreActivity");stopScroll=true}}hideElement("acLoader");busy=false}function createInboxNotificationScroller(){jQuery("#inboxNotify").jScrollPane({hijackInternalLinks:true,animateScroll:true,verticalGutter:0}).bind("jsp-scroll-y",function(c,b,d,a){if(a){updateInboxNotifications($PT("inboxNotificationElement"),ACTIVITY_PAGING)}});jQuery("#inboxNotify").hover(function(){jQuery(document).bind("mousewheel DOMMouseScroll",function(a){stopWheel(a)})},function(){jQuery(document).unbind("mousewheel DOMMouseScroll")})}function removeExistsChildren(c,g){var f=c.children;for(var b=0;b<f.length;b++){var a=f[b];var d=$$PT("#"+g+" [id="+a.id+"]")[0];if(d!=null){d.remove()}}}function buildSparklines(){$J("span[parsed='false']").each(function(a,b){this.buy=$J(b).attr("position")==0;$J(b).sparkline("html",{type:"line",width:"90",height:"30",minSpotColor:"#ff0000",maxSpotColor:"#00bf00",lineColor:this.buy?"#6064FF":"#F27B85",fillColor:this.buy?"#CCDDFF":"#EAD7D9"});var c=$AT(b,"data");if(c!=undefined){new Tip(b,c,{hook:{target:"rightmiddle",tooltip:"leftmiddle"},offset:{x:30,y:0}});if(b.innerHTML.trim()[0]=="<"){$J(b).attr("parsed","true")}}})}function showJqueryMessageWithTitle(d,b,c){var a=$PT(d);a.title=c;showJqueryMessage(d,b)}function showJqueryMessage(d,c){var b=$PT(d);if(b!=null){var a={title:b.title,message:(hasText(c))?c:$T("tGeneralError"),showCancelBtn:false};buildModalMessageDialog(a)}}function newBubble(c){var a=new Element("div").update(c);var b=$PT("bubbleWindow");b.insertBefore(a,b.firstChild);playNotificationSound()}function selectAllCalendarSymbols(element){var selected=eval(element.getAttribute("selected"));var elements=$$PT("#symbolsTable input[name=eventsSymbol]");for(var i=0;i<elements.length;i++){elements[i].checked=!selected}if(!selected){element.innerHTML=$T("tHideAll")}else{element.innerHTML=$T("tShowAll")}element.setAttribute("selected",!selected)}function roundNumUp(a,c){var b=Math.pow(10,c);return Math.ceil(a*b)/b}function updateMaeMfeChart(a){var c=[];c.push(getAttributeByRadioChecked("maeMfeOptions","maeMfeType"));c.push(getAttributeByRadioChecked("maeMfeSecondOptions","maeMfeSecondType"));var b=new Chart(856,319,"scatterChartMaeMfe",2);b.renderChart("/charts.json?chartType=16&l=p&type="+c+"&accountOid="+a+buildAdvancedStatisticsUrl(false,true))}function getCalendarEvents(){var a=$PT("pageNumber").value;var d=$PT("dataForMore").value;var c=$PT("cnt").value;var f=$PT("lastDay").value;var b=$PT("futureEventFound").value;showElement("acLoader");fxAjax.sendRequest(fxVars.getMoreCalendarEvents+a+d+"&cnt="+c+"&lastDay="+f+"&futureEventFound="+b,{contentType:"text/html",loader:false,callback:"getCalendarEventsResponse"})}function getCalendarEventsResponse(c,d){if(!c.error){var b=c.content.rows;for(var a=0;a<b.length;a++){$J("#calendar tr:last").after(b[a])}$PT("pageNumber").value=c.content.pageNumber;$PT("cnt").value=c.content.newCnt;$PT("lastDay").value=c.content.lastDay;$PT("futureEventFound").value=c.content.futureEventFound;if(!c.content.hasMore){$J("#showMoreCustomCalendar").remove()}hideElement("acLoader")}}function getCalendarNextDayEvents(){var b=$F("filter");var c=$F("lastEventDate");var a=$F("cnt");showElement("acLoader");fxAjax.sendRequest(fxVars.getCalendarNextDayEvents+"filter="+b+"&cnt="+a+"&lastEventDate="+c,{contentType:"text/html",loader:false,callback:"getCalendarNextDayEventsResponse"})}function getCalendarNextDayEventsResponse(c,d){if(!c.error){var b=c.content.rows;for(var a=0;a<b.length;a++){$J("#calendar tr:last").after(b[a])}$PT("lastEventDate").value=c.content.lastEventDate;if(c.content.newCnt!=null){$PT("cnt").value=c.content.newCnt}hideElement("acLoader")}}function scaleInputText(b,f){var d=b.value;var a=parseFloat(d);if(!isNaN(a)){var c=(/^\d+(\.\d+)*$/).exec(d);if(c!=null){b.value=(a==0)?d:parseFloat((parseFloat(d)).toFixed(f))}}}function buildCalendarWidgetURL(b,c){var a=["?ps=",c];$PT("calendarWidgetLink").value='<!-- myfxbook.com economic calendar widget - Start -->\n       <script type="text/javascript" src='+b+"/scripts/fxCalendar.js"+a.join("")+"><\/script>\n       <!-- myfxbook.com market widget - End -->";jQuery("#economicCalendarWidgetWidgetDialog .fx_calendar").attr("src",widgetsTomcatUrl+"/widgets/calendar.html"+a.join(""))}function resetPageSizeddl(){jQuery("#ps option[value='10']").attr("selected","selected")}function analyzeByMaster(a){var b="\\_autoTrade_"+a;$J("#commentAnalyze").val(b);$J("#openTime").attr("checked",true);$J("#analyzeButton").click()}function tryDukascopyLogin(a){hideElement("loginResponse");var b=false;var c=["&newAccount=",a];if(a){if(validate("systemName",VALID_SYSTEM_NAME)&&validate("loginVal",VALID_TEXT)&&validate("investorPassword",VALID_ACCOUNT_PASSWORD)&&validate("accountType",VALID_ACCOUNT_TYPE)){b=true;showElement("overlay");showElement("loginResponse");$PT("loginResponse").innerHTML="Connecting to your account <img src='../../../images/circle1.gif' alt=''";showElement("loginLoad");c.push("&login=",$F("loginVal"),"&accountType=",$PT("accountType").value,"&accountName=",encodeParameter($F("systemName")));c.push("&investorPassword=",encodeParameter($F("investorPassword")))}}if(b){fxAjax.sendRequest(fxVars.tryDukascopyLogin+c.join(""),{params:{login:$F("loginVal"),newAccount:a},loader:false,callback:"checkDukascopyLoginResponse"})}}function checkDukascopyLogin(b,c,a){fxAjax.sendRequest(fxVars.checkDukascopyLogin+b+"&lastStatus="+c,{params:{login:b,newAccount:a},loader:false,callback:"checkDukascopyLoginResponse"})}function checkDukascopyLoginResponse(h,f){var c=h.content.menu;var d=h.content.accountUrl;var k=h.content.accountOid;var l=h.error;var m=h.message;var b=h.content.code;var g=h.content.newAccountStatus;var a=true;if(!l&&g!=STATUS_ERROR){if(f.newAccount){$PT("loginResponse").innerHTML=m;if(g==STATUS_LOGIN_PENDING||g==STATUS_LOGIN_PASS||g==STATUS_CREATING_ACCOUNT||g==STATUS_CALCULATING){checkDukascopyLogin(f.login,g,true);a=false}else{if(g==STATUS_LOGIN_FAILED||g==STATUS_CALC_COMPLETE||g==STATUS_SERVER_DOWN){if(g==STATUS_CALC_COMPLETE){hideElement("settings");hideElement("broker");showElement("connection");$PT("takeMe").href=d;$PT("setPrivacy").onclick=function(){getAccountForm(parseInt(k))};runAjaxScripts(getContent(c))}}}}}else{$PT("loginResponse").innerHTML=m;if(f.newAccount&&h.content.data!=undefined){$PT("loginResponse").innerHTML+=h.content.data}}if(a){hideElement("loginLoad");hideElement("overlay")}}function isMobile(){var a=false;(function(b){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4))){a=true}})(navigator.userAgent||navigator.vendor||window.opera);return a}function authorizeCtrade(){window.location.href="https://connect.spotware.com/oauth/v2/auth?access_type=online&approval_prompt=auto&client_id=3_2dbx8f89z30gg4oskc8oswwgwo4kkcgc88w0k4g4o448k08g88&redirect_uri=https://www.myfxbook.com/ctrader_auth&response_type=code&scope=accounts"}function tryCtraderLogin(f,d,a){if(validate("accountName"+f,VALID_SYSTEM_NAME)){hideElement("accountConnButton"+f);hideElement("loginResponse"+f);showElement("loginResponse"+f);showElement("loginLoad"+f);$PT("loginResponse"+f).innerHTML=" &nbsp;&nbsp;Connecting to your account";var b=$F("accountName"+f);var c="accountId="+f+"&accountName="+encodeParameter(b)+"&oauthToken="+encodeParameter(d)+"&login="+a;fxAjax.sendRequest(fxVars.addCtraderAccount+c,{params:{id:f},loader:false,callback:"checkCtraderLoginResponse"})}}function checkCtraderLogin(b,a){fxAjax.sendRequest(fxVars.checkCtraderLogin+b+"&lastStatus="+a,{params:{id:b},loader:false,callback:"checkCtraderLoginResponse"})}function checkCtraderLoginResponse(g,d){var b=g.content.menu;var c=g.content.accountUrl;var h=d.id;var k=g.error;var l=g.message;var a=g.content.code;var f=g.content.newAccountStatus;if(!k&&f!=STATUS_ERROR){$PT("loginResponse"+h).innerHTML=" &nbsp;&nbsp;"+l;if(f==STATUS_LOGIN_PENDING||f==STATUS_LOGIN_PASS||f==STATUS_CREATING_ACCOUNT||f==STATUS_CALCULATING){checkCtraderLogin(d.id,f)}else{if(f==STATUS_LOGIN_FAILED||f==STATUS_CALC_COMPLETE||f==STATUS_SERVER_DOWN){hideElement("loginLoad"+h);if(f==STATUS_CALC_COMPLETE){showElement("connection"+h);$PT("takeMe"+h).href=c;$PT("accountsNav").innerHTML=b;runAjaxScripts(getContent(b))}}}}else{$PT("loginResponse"+h).innerHTML=l;hideElement("loginLoad"+h);if(d.newAccount){if(hasText(g.content.data)){$PT("loginResponse"+h).innerHTML+=g.content.data}hideElement("accountName"+h);hideElement("accountConnButton"+h)}else{}}}function defaultFormatTouserFormat(a,d){try{var c=a.split("/");if(d==TIME_FORMAT_CUSTOM){a=c[1]+"/"+c[0]+"/"+c[2]}}catch(b){}return a}function showJqueryMessageWithOkAndCancel(h,f,g,a,d){var c=$PT(h);if(c!=null){var b={title:c.title,message:(hasText(f))?f:"",textAlignCenter:(hasText(f)),okOnClickEvent:g,cancelOnClickEvent:a};buildModalMessageDialog(b)}}function isRated(){try{var pass=false;$J("[attr=rate]").each(function(index,element){if(eval($J(element).val())>0){pass=true;return false}});if(!pass){inlineMsg("rateButton","<strong>"+$T("tError")+"</strong><br/>"+$T("tPleaseProvideRating"));return false}}catch(e){}return true}function createLineBreakes(b){try{if(b==null){return null}return b.replace(/\n/g,"<br/>").replace(/\r/g,"")}catch(a){return""}}(function(a){a.titleAlert=function(f,c){if(a.titleAlert._running){a.titleAlert.stop()}a.titleAlert._settings=c=a.extend({},a.titleAlert.defaults,c);if(c.requireBlur&&a.titleAlert.hasFocus){return}c.originalTitleInterval=c.originalTitleInterval||c.interval;a.titleAlert._running=true;a.titleAlert._initialText=document.title;document.title=f;var b=true;var d=function(){if(!a.titleAlert._running){return}b=!b;document.title=(b?f:a.titleAlert._initialText);a.titleAlert._intervalToken=setTimeout(d,(b?c.interval:c.originalTitleInterval))};a.titleAlert._intervalToken=setTimeout(d,c.interval);if(c.stopOnMouseMove){a(document).mousemove(function(g){a(this).unbind(g);a.titleAlert.stop()})}if(c.duration>0){a.titleAlert._timeoutToken=setTimeout(function(){a.titleAlert.stop()},c.duration)}};a.titleAlert.defaults={interval:500,originalTitleInterval:null,duration:0,stopOnFocus:true,requireBlur:false,stopOnMouseMove:false};a.titleAlert.stop=function(){clearTimeout(a.titleAlert._intervalToken);clearTimeout(a.titleAlert._timeoutToken);document.title=a.titleAlert._initialText;a.titleAlert._timeoutToken=null;a.titleAlert._intervalToken=null;a.titleAlert._initialText=null;a.titleAlert._running=false;a.titleAlert._settings=null};a.titleAlert.hasFocus=true;a.titleAlert._running=false;a.titleAlert._intervalToken=null;a.titleAlert._timeoutToken=null;a.titleAlert._initialText=null;a.titleAlert._settings=null;a.titleAlert._focus=function(){a.titleAlert.hasFocus=true;if(a.titleAlert._running&&a.titleAlert._settings.stopOnFocus){var b=a.titleAlert._initialText;a.titleAlert.stop();setTimeout(function(){if(a.titleAlert._running){return}document.title=".";document.title=b},1000)}};a.titleAlert._blur=function(){a.titleAlert.hasFocus=false};a(window).bind("focus",a.titleAlert._focus);a(window).bind("blur",a.titleAlert._blur)})(jQuery);function getTime(b){var a=new Date(b+Number(MINUTE*$F("userTimezoneOffset"))+(MINUTE*dt.getTimezoneOffset()));return format2Digits(a.getHours())+":"+format2Digits(a.getMinutes())}function clearCheckbox(b){var a=document.getElementsByName(b);for(var c=0;c<a.length;c++){a[c].checked=false}}function dashboardOutlookMore(b){var a=10;var c=false;if(sumOfCheckBoxElements("outlookSymbolsNames")<=a){$J("tr[symbolId='"+b+"']").toggle();c=true}else{$PT("outlookSN"+b).checked=false;inlineMsg($PT("outlookMore"),$T("tMaxNumberOfSymbols",[a]),3)}if(c){fxAjax.sendRequest(fxVars.updateOutlookSymbolsFilter+getCheckBoxesValuesByNameAndAttr("outlookSymbolsNames","symbolId"),{loader:false})}}function getUserPositionsSlippage(element,slaveAccountOid,masterAccountOid,unsubscribed){var positionsSlippageElement=$PT("positionsSlipage"+masterAccountOid);if(!eval(element.getAttribute("hasData"))){fxAjax.sendRequest(fxVars.getUserPositionsSlippage+"slaveAccountOid="+slaveAccountOid+"&masterAccountOid="+masterAccountOid,{params:{positionsSlippageElement:positionsSlippageElement,element:element},loader:true,callback:"getUserPositionsSlippageResponse"})}else{showHideElement(positionsSlippageElement);element.innerHTML=isShown(positionsSlippageElement)?"-":"+";if(isShown(positionsSlippageElement)){element.parentNode.parentNode.className="bg6"}else{element.parentNode.parentNode.className=(unsubscribed)?"lightRed":""}}}function getUserPositionsSlippageResponse(a,d){if(!a.error){var c=a.content.data;if(hasText(c)){showHideElement(d.positionsSlippageElement);d.positionsSlippageElement.innerHTML=c;d.element.setAttribute("hasData",true);d.element.innerHTML=isShown(d.element.id)?"-":"+";d.element.parentNode.parentNode.className=isShown(d.element.id)?"bg6":"";runAjaxScripts(c)}}else{var b=a.message;if(b!=null){showJqueryMessage("positionsSlipageMsg",b)}}}function sortPortfolioAutoTrade(){jQuery("#autotradeMasterStats [oid]").each(function(){try{var c=this.getAttribute("oid");var a=$PT("positionsSlipage"+c);jQuery(a.parentNode).insertAfter(this)}catch(b){}})}function showSubscribedAndUnsubscribedAutoTrade(a){jQuery("#autotradeMasterStats [unsubscribed="+a+"]").each(function(b){var d=this.getAttribute("oid");var c=$PT("positionsSlipage"+d);var g=$PT("expandButton"+d);if(a){if($PT("showUnsubscribed").checked){showElement(this)}else{hideElement(this);hideElement(c);try{g.innerHTML="+"}catch(f){}this.className="lightRed"}}else{if($PT("showSubscribed").checked){showElement(this)}else{hideElement(this);hideElement(c);try{g.innerHTML="+"}catch(f){}this.className=""}}});toggleAutotradeTabContent()}function toggleAutotradeTabContent(){if(countVisibleRowsWithAttrebute("autotradeMasterStats","unsubscribed")==0){showElement("autoTradeIsEmpty");hideElement("autotradeMasterStats")}else{hideElement("autoTradeIsEmpty");showElement("autotradeMasterStats")}}function countVisibleRowsWithAttrebute(b,a){return $J("#"+b+" tr["+a+'][style!="display: none;"]').length}function selectAllCheckboxesByName(b){var a=document.getElementsByName(b);for(var c=0;c<a.length;c++){a[c].checked=true}}function trackBrokerManageLinkClick(d,b,c,g,a){var f=["link=",encodeParameter(d),"&type=",b,"&oid=",c,"&token=",a].join("");if(g==undefined||!g){window.open("/link-track-redirect.html?"+f)}else{window.open("/link-track-redirect.html?"+f,"_self")}return false}function refreshDashSystemsTable(){fxAjax.sendRequest(fxVars.refreshDashSystemsTable,{params:{},callback:"refreshDashSystemsTableResponse"})}function refreshDashSystemsTableResponse(a,c){if(!a.error){var b=a.content.systems;if(hasText(b)){$J("#my").html(b);runAjaxScripts(b)}}}function htmlDecode(a){var b=document.createElement("div");b.innerHTML=a;return b.childNodes.length===0?"":b.childNodes[0].nodeValue}function createScroller(d){try{var c=jQuery("#"+d);var a=c.data("jsp");if(a!=null){a.reinitialise()}else{jQuery("#"+d).jScrollPane({hijackInternalLinks:true,animateScroll:true,verticalGutter:0}).hover(function(){jQuery(document).bind("mousewheel DOMMouseScroll",function(f){stopWheel(f)})},function(){jQuery(document).unbind("mousewheel DOMMouseScroll")})}}catch(b){}}function getStrategiesPerPage(b){var a=$J("#strategyGroupCombo").val();if(hasText(b)&&!isNaN(b)&&hasText(a)&&!isNaN(a)){setCookie("usrpp",b,YEAR);var c=["results=",b,"&groupOid=",a];fxAjax.sendRequest(fxVars.getStrategiesPerPage+c.join(""),{params:{},loader:true,callback:"getStrategiesPerPageResponse"})}}function getStrategiesPerPageResponse(a,c){if(!a.error){var b=a.content.data;if(hasText(b)){$J("#myStrategiesTable").html(b);runAjaxScripts(b)}}}function showExposureTableByDirection(b){var a=$J("#exposuresData0");var c=$J("#exposuresData1");if(b.checked){c.hide();a.show()}else{a.hide();c.show()}}function changeOutlookSymbols(){var a=getCheckBoxesIds("outlookSymbols");if(!hasText(a)){a="0"}setCookie("ous",'"'+a+'"',YEAR,false);fxAjax.sendRequest(fxVars.changeOutlookSymbols,{params:{},loader:true,callback:"changeOutlookSymbolsResponse"})}function changeOutlookSymbolsResponse(a,c){if(!a.error){var b=a.content.newTable;$PT("outlookSymbolsTable").innerHTML=b;runAjaxScripts(b)}}function selectAllOutlookSymbols(element){var selected=eval(element.getAttribute("selected"));var elements=$$PT("#outlookSymbolsTableMore input[name=outlookSymbols]");for(var i=0;i<elements.length;i++){elements[i].checked=!selected}if(!selected){element.innerHTML=$T("tHideAll")}else{element.innerHTML=$T("tShowAll")}element.setAttribute("selected",!selected);changeOutlookSymbols()}function Tip(b,c,a){$J(document).ready(function(d){if(a!=undefined){Tipped.create(b,buildTip(a.title,c),a)}else{Tipped.create(b,buildTip("",c))}})}function buildTip(c,b){var a=$J("<div/>");if(hasText(c)){a.append("<b>"+c+"</b>");a.append("</br>")}a.append("<div>"+b+"</div>");return a.html()}function TipList(b,c,a){$J(document).ready(function(d){if(a!=undefined){Tipped.create(b,buildTipAsList(a.title,c),a)}else{Tipped.create(b,buildTipAsList("",c))}})}function buildTipAsList(d,b){var c=$J("<div/>");if(hasText(d)){c.append("<b>"+d+"</b>");c.append("</br>")}var a=$("<ul>").appendTo("body");$(b.items).each(function(f,g){a.append($(document.createElement("li")).text(g))});c.append(a);return c.html()}function updateIndicatorsTable(d,c,b){var a=getCheckBoxesValues("symbols");var h=getCheckBoxesValues("indicators");if(a.split(",").length<=10){hideElement("symbolChangedMessage");var g=getComboValue("timeScales");$J("#selectedTimeFrame").val(g);$J("#selectedSymbols").val(a);$J("#selectedIndicators").val(h);var f=["&symbols=",a,"&indicators=",h,"&timeFrame=",g,"&isPatterns=",b];fxAjax.sendRequest(fxVars.updateIndicatorsTable,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:f.join(""),loader:c,callback:"updateIndicatorsTableResponse"})}else{if(!isShown($PT("symbolChangedMessage"))){$PT("symbolChangedMessage").innerHTML=$T("tOnly10Symbols");showElement("symbolChangedMessage")}if($PT("symbol"+d)){$PT("symbol"+d).checked=false}}}function updateIndicatorsTableResponse(b){if(!b.error){var a=b.content.indicatorsTable;if(a){$PT("indicatorsTable").innerHTML=a;runAjaxScripts($PT("indicatorsTable").innerHTML)}}}function updateSingleIndicatorTable(c,d,a){var b=getCheckBoxesValues("symbols");var g=getCheckBoxesValues("indicators");$J("#selectedSymbols").val(b);$J("#selectedIndicators").val(g);var f=["&symbols=",b,"&indicators=",g,"&isPatterns=",c,"&type=",d,"&oid=",a];fxAjax.sendRequest(fxVars.updateSingleIndicatorTable,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:f.join(""),loader:false,callback:"updateSingleIndicatorResponse"})}function updateSingleIndicatorResponse(b){if(!b.error){var a=b.content.singleTable;if(a){$PT("singleTable").innerHTML=a}}}function refreshIndicatorsTable(a){var b=$J("#selectedSymbols").val();var f=$J("#selectedIndicators").val();var d=$J("#selectedTimeFrame").val();var c=["&symbols=",b,"&indicators=",f,"&timeFrame=",d];fxAjax.sendRequest(fxVars.refreshIndicatorsTable,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:c.join(""),params:{isPattern:a,single:false},loader:false,callback:"refreshIndicatorsTableResponse"})}function refreshIndicatorSingleTable(a){var b=$J("#selectedSymbols").val();var g=$J("#selectedIndicators").val();var c=$J("#singleType").val();var d=$J("#selectedObjectOid").val();var f=["&symbols=",b,"&indicators=",g,"&type=",c,"&oid=",d];fxAjax.sendRequest(fxVars.refreshIndicatorSingleTable,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:f.join(""),params:{isPattern:a,single:true,type:c,indicatorOid:d},loader:false,callback:"refreshIndicatorsTableResponse"})}var neutralPatterns=[35,37,41,42,47,57,66,74];function refreshIndicatorsTableResponse(a,b){if(!a.error){jQuery.each(a.content.data,function(f,g){if(b.isPattern){var c="-";var d=$J("#"+f);var h=d.attr("pName");if((b.single&&((b.type==1&&isContains(neutralPatterns,b.indicatorOid))||(b.type==0&&(f.contains("o35")||f.contains("o37")||f.contains("o41")||f.contains("o42")||f.contains("o47")||f.contains("o57")||f.contains("o66")||f.contains("o74")))))||(f.contains("i35")||f.contains("i37")||f.contains("i41")||f.contains("i42")||f.contains("i47")||f.contains("i57")||f.contains("i66")||f.contains("i74"))){if(g==100||g==-100){c="<img src='"+staticServerPath+"/images/circle2.gif' alt='"+h+" Bullish/Bearish/Uncertainty' title='"+h+" Bullish/Bearish/Uncertainty'>"}}else{if(g==100){c="<img src='"+staticServerPath+"/images/up_arrow.png' alt='"+h+" Bullish' title='"+h+" Bullish'>"}else{if(g==-100){c="<img src='"+staticServerPath+"/images/down_arrow.png' alt='"+h+" Bearish' title='"+h+" Bearish'>"}}}d.html(c)}else{$J("#"+f).html(g)}})}}function selectAllCheckBoxes(element,countDivName,checkBoxName,callFunction){var selected=isAllCheckBoxesSelected(countDivName,checkBoxName);var elements=$$PT("#"+countDivName+" input[name="+checkBoxName+"]");for(var i=0;i<elements.length;i++){elements[i].checked=!selected}if(!selected){element.innerHTML=$T("tHideAll")}else{element.innerHTML=$T("tShowAll")}eval(callFunction)}function isAllCheckBoxesSelected(a,b){return !($J("#"+a+" input[name="+b+"]").not(":checked").length>0)}function calcBarWidth(c,d){var b=60;if(c>20){c=20}var a="<div class='floatLeft' style='background:#00dd4e;width:"+Math.round(c/20*b)+"px;height:7px;'</div>";document.getElementById(d).innerHTML=a}function updateDashboardWatchedFilter(){fxAjax.sendRequest(fxVars.updateDashboardWatchedFilter+getCheckBoxesIds("watchedMoreColumnName"),{loader:false})}function declineProvider(a){fxAjax.sendRequest(fxVars.declineProvider+"accountOid="+a,{params:{accountOid:a},loader:false,callback:"declineProviderResponse"})}function declineProviderResponse(a,b){if(!a.error){hideElement("declineProviderMsg"+b.accountOid)}}function buildConfirmationTip(element,content,func){var msg;var msgcontent;msg=document.createElement("div");msgcontent=document.createElement("div");msg.appendChild(msgcontent);msgcontent.innerHTML=content+"<br/><br/>";msg.style.display="block";var buttons;buttons=document.createElement("div");buttons.id="buttons";var cancelButt=document.createElement("input");cancelButt.type="button";cancelButt.className="popupButton";cancelButt.value="  No  ";cancelButt.onclick=function(){Tipped.remove(element)};var okButt=document.createElement("input");okButt.type="button";okButt.className="popupButton";okButt.value="  Yes  ";okButt.onclick=function(){Tipped.remove(element);eval(func)};buttons.appendChild(okButt);buttons.appendChild(cancelButt);msgcontent.appendChild(buttons);return msg}function ConfirmationTip(b,a,d,c){$J(document).ready(function(f){if(Tipped.findElement(b)==null){if(a!=undefined){Tipped.create(b,buildConfirmationTip(b,d,c),a)}else{Tipped.create(b,buildConfirmationTip(b,d,c))}Tipped.show(b)}})}function calendarMultiEmailAlert(c,b){var a=[];jQuery("[calendarOid]").each(function(d){var f=Number(this.getAttribute("calendarOid"));if(calRequests[f]!=true){calRequests[f]=true;a.push(f)}});if(a.length>0){fxAjax.sendRequest(fxVars.calendarMultiNotification,{contentType:"application/x-www-form-urlencoded; charset=utf-8",params:{foundOids:a,add:b,e:c},postBody:["oids=",a.join(","),"&add=",b].join(""),method:"post",loader:true,callback:"calendarMultiEmailAlertResponse"});c.cancelBubble=true;if(c.stopPropagation){c.stopPropagation()}}}function calendarMultiEmailAlertResponse(a,g){var f=a.message;var b=a.content.list;if(!a.error){for(var c=0;c<b.length;c++){var d=b[c];if(g.add){$PT("calendarAlert"+d).onclick=function(h){calendarEmailAlert(h?h:window.event,Number(this.getAttribute("calendaroid")),false)};$PT("calendarAlert"+d).className="notifyOn"}else{$PT("calendarAlert"+d).onclick=function(h){calendarEmailAlert(h?h:window.event,Number(this.getAttribute("calendaroid")),true)};$PT("calendarAlert"+d).className="notifyOff"}}}else{inlineMsg("calendarAlertMain","<b>Error</b><br>"+f,3)}for(c=0;c<g.foundOids.length;c++){d=Number(g.foundOids[c]);calRequests[d]=false}}String.prototype.contains=function(a){return this.indexOf(a)!=-1};function enableOrDisableTimeZoneData(a){jQuery(".enableOrDisableTimeZone").each(function(b){jQuery(this).prop("disabled",a)})}function getTimezoneOffset(){return new Date().getTimezoneOffset()/60*(-1)}function deletePostAttachment(a,d,b){if(confirm("Are you sure?")&&a!=undefined&&d!=undefined){var c=["postOid=",a,"&attachmentOid=",d];fxAjax.sendRequest(fxVars.deletePostAttachment+c.join(""),{loader:false,params:{postOid:a,attachmentOid:d,lastAttachment:b},callback:"deletePostAttachmentResponse"})}}function deletePostAttachmentResponse(a,b){if(hasText(a)){$J("#postAttachment"+b.attachmentOid+b.postOid).remove();if(b.lastAttachment){$J("#postAttachments").remove()}}}function buildOutlookWidgetURL(b){var c=Number(getRadioValue("outlookSymbolWidgetMode"));var a=[];jQuery("#outlookWidgetLink input:checked").each(function(){a.push(this.getAttribute("oid"))});var f=["type=",c,"&symbols=",a.join(",")];var d=b+"/widgets/outlook.html?"+f.join("");jQuery("[name=outlook_iframe]").each(function(){this.setAttribute("src",d)});$PT("outlookWidgetText").value='<!-- myfxbook.com outlook widget - Start -->\n       <script type="text/javascript" src='+b+"/scripts/fxOutlook.js?"+f.join("")+"><\/script>\n       <!-- myfxbook.com outlook widget - End -->"}function onOffCalendarNotify(b,a){$PT("calendarAlert"+b).className=(a)?"notifyOff":"notifyOn";$PT("calendarAlert"+b).onclick=function(c){calendarEmailAlert(c?c:window.event,b,a)}}function getUrlVars(){var d=[],c;var a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var b=0;b<a.length;b++){c=a[b].split("=");d.push(c[0]);d[c[0]]=c[1]}return d}function rateBinaryBroker(a){if(isRated()){var b=["brokerId="+a,"&platform=",$PT("platform").value,"&spreads=",$PT("spreads").value,"&service=",$PT("service").value,"&features=",$PT("features").value].join("");fxAjax.sendRequest(fxVars.rateBinaryBroker+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function showSendTrySignalStartConfirmation(a){var b="sendTrySignalStart("+a+")";$("#trySignalStartDataMsg").modal("show")}function sendTrySignalStart(a){fxAjax.sendRequest(fxVars.sendTrySignalStart+"accountOid="+a,{params:{oid:a},callback:"sendTrySignalStartResponse"})}function sendTrySignalStartResponse(a,b){if(!a.error){$J("#trySignalStart"+b.oid).removeClass("blue").css({cursor:"default"}).addClass("bg7 whiteColor").removeAttr("onclick");$J("#trySignalStartDataMsg").modal("hide");showJqueryMessage("trySignalStartMsg"+b.oid,a.message)}}function getSpreadsByType(b){var a;if(typeof b=="undefined"||b==null){a=jQuery("#typeComboBox option:selected").val()}else{a=b}fxAjax.sendRequest(fxVars.getSpreadsByType+"serverType="+a,{params:{serverType:a},loader:true,callback:"getSpreadsByTypeResponse"})}function getSpreadsByTypeResponse(a){if(!a.error){var b=a.content.spreadsTable;jQuery("#spreadsTbody").html(a.content.spreadsTable)}}var BROKER_PROMOTION_PRIORITY_ACTION={DECREASE:0,INCREASE:1,};function changeBrokerPromotionPriority(k,c,b){function a(l){this.element=l;this.filterElementId=function(m){return this.element.find(m).attr("id")};this.sort=function(){this.element.find("[id^=tr]:visible").sort(function(q,o){var r=parseInt(jQuery(q).find("[id^=priority]").val());var m=parseInt(jQuery(o).find("[id^=priority]").val());return(r<m)?1:(r>m)?-1:0}).appendTo(this.element)}}function f(l){this.element=l;this.id=this.element.attr("id");this.oid=this.id.substr(2);this.input=this.element.find("[id^=priority]");this.priority=parseInt(this.input.val())||0;this.prev=function(){return new f(this.element.closest("[id^=tr]").prev("[id^=tr]"))};this.next=function(){return new f(this.element.closest("[id^=tr]").next("[id^=tr]"))};this.focus=function(){(function(o,m){jQuery("html, body").animate({scrollTop:o.top-(m/2),scrollLeft:o.left})})(this.element.offset(),this.element.height())};this.getNearRow=function(o,m){switch(o){case BROKER_PROMOTION_PRIORITY_ACTION.INCREASE:if(this.id===m.filterElementId("[id^=tr]:visible:first")){return}return this.prev();case BROKER_PROMOTION_PRIORITY_ACTION.DECREASE:if(this.id===m.filterElementId("[id^=tr]:visible:last")){return false}return this.next();default:throw new Error("unknown action {@see BROKER_PROMOTION_PRIORITY_ACTION}")}};this.replaceWith=function(o,m){this.input.val(o.priority);saveBrokerPromotionPriority(o.priority,this.oid,m);o.input.val(this.priority);saveBrokerPromotionPriority(this.priority,o.oid,m)}}var h=new a(jQuery("#promotionManageTable"));var g=new f(jQuery("#tr"+c));var d=g.getNearRow(k,h);if(d instanceof f){g.replaceWith(d,b);h.sort();g.focus();return true}return false}function saveBrokerPromotionPriority(c,b,a){fxAjax.sendRequest(fxVars.changeBrokerPromotionPriority+jQuery.param({brokerOid:a,promotionOid:b,priority:c}),{loader:true,callback:function(d){console.log(d)}})}function getBrokersPromotionsByType(){var a=$J("input[name=promotionsType]:checked").val();fxAjax.sendRequest(fxVars.getBrokersPromotionsByType+"type="+a,{params:{type:a},loader:true,callback:"getBrokersPromotionsByTypeResponse"})}function getBrokersPromotionsByTypeResponse(a){if(!a.error){var b=a.content.data;$J("#allBrokersCont").html(b)}}function saveBrokerPromotion(b,l){var k=$J("#title"+b).val();var m=$J("#textArea"+b).val();var f=$J("#type"+b+" option:selected").val();var c=$J("#vaildDate"+b).val();var a=$J("#url"+b).val();var g=$J("#nonExpiring"+b).prop("checked");var h=(parseInt(jQuery("[id^=priority]:first").val())+1)||0;var d=["title=",encodeParameter(k),"&text=",encodeParameter(m),"&type=",f,"&date=",c,"&promotionOid=",b,"&brokerOid=",l,"&url=",encodeParameter(a),"&nonExpiring=",g,"&priority=",h];if(validate("title"+b,VALID_TITLE)&&validate("url"+b,VALID_URL)&&validate("textArea"+b,VALID_TEXT)&&(g||validate("vaildDate"+b,VALID_DATE))){fxAjax.sendRequest(fxVars.saveBrokerPromotion+d.join(""),{params:{promotionOid:b},loader:true,callback:"saveBrokerPromotionResponse"})}}function saveBrokerPromotionResponse(b,f){if(!b.error){var d=b.content.savedObj;var g=b.content.newPromotionObjectOid;showJqueryMessageWithTitle("brokerPromotionMsg","Promotion was successfully saved","Promotion");if($J("#noPromotionFound").is(":visible")){$J("#noPromotionFound").hide()}var c=$J("#tr"+f.promotionOid).length;var a=b.content.newPromotionObjectOid;if(c==0&&d){$J("#newPromotionFirstTr").after(d);$J("#title"+f.promotionOid).val("");$J("#url"+f.promotionOid).val("");$J("#textArea"+f.promotionOid).val("");$J("#type"+f.promotionOid+" option:first").attr("selected","selected");$J("#vaildDate"+f.promotionOid).val("");$J("#newPromotion").click();$J("#vaildDate"+f.promotionOid).prop("disabled",false);$J("#vaildDate"+f.promotionOid).datepicker({dateFormat:userTimeFormat});$J("#vaildDate"+g).datepicker({dateFormat:userTimeFormat});$J("#nonExpiring"+f.promotionOid).prop("checked",false);$J("#nonExpiring"+g).change(function(){var l=$J("#vaildDate"+g);if($J(this).is(":checked")){var h=new Date();var k=new Date(h.getTime()+86400000);l.datepicker("setDate",k);l.prop("disabled",true)}else{l.prop("disabled",false)}})}}else{if(b.content.code==118){showJqueryMessageWithTitle("brokerPromotionMsg",b.message,"Promotion")}else{showJqueryMessageWithTitle("brokerPromotionMsg","Error promotion was not saved ","Promotion")}}}function deleteBrokerPromotion(b,a){if(!confirm("Are you sure you want to delete this promotion?")){return}var c=["promotionOid=",b,"&brokerOid=",a];fxAjax.sendRequest(fxVars.deleteBrokerPromotion+c.join(""),{params:{promotionOid:b},loader:true,callback:"deleteBrokerPromotionResponse"})}function deleteBrokerPromotionResponse(b,c){if(!b.error){var a=b.content.deleted;if(a){showJqueryMessageWithTitle("brokerPromotionMsg","promotion was deleted ","Promotion");$J("#tr"+c.promotionOid).remove();if($J("#promotionManageTable tr").length<=1){$J("#noPromotionFound").show()}}else{showJqueryMessageWithTitle("brokerPromotionMsg","promotion was  not deleted ","Error")}}else{showJqueryMessageWithTitle("brokerPromotionMsg","promotion was  not deleted ","Error")}}function adjustOffset(a,d){var c=a.value,f=d;if(c.indexOf("\r\n")>-1){var b=c.replace(/\r\n/g,"\n").slice(0,d).match(/\n/g);f+=b?b.length:0}return f}$J.fn.setCursorPosition=function(a){if(this.lengh==0){return this}return $J(this).setSelection(a,a)};$J.fn.setSelection=function(b,c){if(this.lengh==0){return this}input=this[0];if(input.createTextRange){var a=input.createTextRange();a.collapse(true);a.moveEnd("character",c);a.moveStart("character",b);a.select()}else{if(input.setSelectionRange){input.focus();b=adjustOffset(input,b);c=adjustOffset(input,c);input.setSelectionRange(b,c)}}return this};$J.fn.focusEnd=function(){this.setCursorPosition(this.val().length)};function removeValueFromArray(b,a){b.splice(b.indexOf(a),1)}function loadSoundNotification(){try{if(!hasText(notificationSound)){notificationSound=document.createElement("audio");notificationSound.setAttribute("src","/scripts/myfxbook.mp3")}}catch(a){}}function playNotificationSound(){try{if(hasText(notificationSound)){notificationSound.play()}}catch(a){}}function checkAllFields(f,d){var c=document.getElementById(d);var b=$J(c).find("input[type=radio][name]");for(var a=f;a<b.length;a=a+2){b[a].checked=true}if(d!="invitationTable"){if(!f){$J(b).slice(2).prop("disabled",true)}else{$J(b).map(function(){$J(this).prop("disabled",false)})}}}function getBrokersByPlatform(){var c=$PT("serverId");clearCombo("serverId");var a=jQuery("#platformId option:selected").val();var d=JSON.parse($PT("allServers")!=null?$PT("allServers").value:[]);for(var b=0;b<d.length;b++){if(d[b].platformOid==a){jQuery("#serverId").append("<option value="+d[b].oid+">"+d[b].name+"</option>")}}}function realContestRegistration(){if(!busy&&validate("firstName",VALID_EN_NAME)&&validate("lastName",VALID_EN_NAME)&&validate("country",VALID_COUNTRY)&&validate("email",VALID_EMAIL)){$PT("realContestReg").style.display="none";busy=true;var a=["firstName=",encodeParameter($F("firstName")),"&lastName=",encodeParameter($F("lastName")),"&email=",encodeParameter($F("email")),"&country=",$F("country"),"&countryName=",$J("#country option:selected").text()];fxAjax.sendRequest(fxVars.realContestRegistration+a.join(""),{contentType:"text/xml",params:{},loader:false,callback:"realContestRegistrationResponse"})}}function realContestRegistrationResponse(b,h){var c=b.error;var g=b.message;var f=b.content.code;var d=$J("#realContestReg");hideElement("contestLoad");if(!c){$J("#submitRealContestForm").submit();d.find("td").remove();d.find("tr").append("<td style='color:#ffffff;font-size: 16px;padding-left: 40px'>Registration in Progress!</td>");showElement("realContestReg");if(f=="undefined"||f==null){var a=parseInt($PT("competitorsTotal").innerHTML);$PT("competitorsTotal").innerHTML=a+1}}else{showElement("realContestReg");inlineMsg("scbutt","<b>"+$T("tError")+"</b><br>"+g,3)}busy=false}function updateLimitedSymbolsMessage(a){var b=["accountOid=",a];fxAjax.sendRequest(fxVars.updateLimitedSymbolsMessage+b.join(""),{params:{accountOid:a},loader:true,callback:"updateLimitedSymbolsMessageResponse"})}function updateLimitedSymbolsMessageResponse(a,f){var c=a.error;var d=a.message;var b=f.accountOid;if(!c){$J("#fxcmAccountLimitedSymbol").remove()}}function emailUnsubscribe(d,c,b){if(hasText(d)){var a,f="";if(c===2||c===11||c===9||c===6||c===16){a=$("input[name=unsubscribe]:checked").val();if(a>0){f="&id="+a}}else{if(c===10){f="&id="+$("#objectId").val()}}fxAjax.sendRequest(fxVars.emailUnsubscribe+"?type="+c+"&code="+d+"&email="+b+f,{contentType:"text/xhtml",params:"",loader:true,callback:"emailUnsubscribeResponse"})}}function emailUnsubscribeResponse(a){$J("#wrapper").text(a.content.message)}function getAnalyzedMagicsNumbers(){var a=getCheckBoxesValues("accountMagic");var b=$J("#nonMagic");if(b&&b.is(":checked")){a=a.split(",").concat(b.val().split(","));a.push("-12345");a.join(",")}return a}function removeBlockedWords(f){try{var b=blockedWords.split(",");var a;if(hasText(f)){for(var c=0;c<b.length;c++){a=new RegExp(b[c],"i");if(f.match(a)){f=f.replace(a,"")}}}}catch(d){console.error("exception thrown by removeBlockedWords")}return(hasText(f))?f:"none"}function showHideConnectBtn(a){if(a){$J("#testButton").show()}else{$J("#testButton").hide()}}function drawBasicChart(a,c){var b=$("#"+a).highcharts();b.series[0].update({data:c},true)}function validateSlaveSettings(a){var b=jQuery("#totalLots").val();var d=jQuery("#totalOpenTrades").val();var c=true;if(!validate("totalLots",VALID_DOUBLE_POSITIVE,undefined)){c=false}if(!validate("totalOpenTrades",VALID_INTEGER_OR_EMPTY,undefined)){c=false}if(c){saveSlaveSettings(a)}}function escapeSelector(a){return a.replace(/(:|\.|\[|\]|,|=|@)/g,"\\$1")}function selectOrClearAllTree(d,a){var c=jQuery(a);for(var b=0;b<c.length;b++){if(d){jQuery(c[b]).jstree(true).select_all()}else{jQuery(c[b]).jstree(true).deselect_all()}}}function buildModalMessageDialog(properties){if(properties.okBtnClass==undefined){properties.okBtnClass="btn blue"}if(properties.closeOnClickOk==undefined){properties.closeOnClickOk=true}var okButton=jQuery('<button id="okBtn" type="button" class="'+properties.okBtnClass+'"'+(properties.closeOnClickOk?' data-dismiss="modal"':"")+">");var cancelButton=jQuery('<button id="cancelBtn" type="button" class="btn btn-default" data-dismiss="modal">');if(!hasText(properties.title)){properties.title=$T("tInformation")}if(!hasText(properties.message)){properties.message=""}if(properties.showCancelBtn==undefined){properties.showCancelBtn=true}if(properties.showOkBtn==undefined){properties.showOkBtn=true}if(properties.showTitle==undefined){properties.showTitle=true}if(!hasText(properties.okMessageBtn)){properties.okMessageBtn=$T("tOk")}if(!hasText(properties.cancelMessageBtn)){properties.cancelMessageBtn=$T("tCancel")}if(properties.okOnClickEvent!=undefined&&hasText(properties.okOnClickEvent)){okButton.attr("onclick","").unbind("click").click(function(){eval(properties.okOnClickEvent)})}if(properties.hideFooterAndHeader==undefined){properties.hideFooterAndHeader=false}if(properties.disableOkButton==undefined){properties.disableOkButton=false}if(properties.disableOkButton){okButton.prop("disabled",true)}if(properties.modalOnCloseEvent==undefined){properties.modalOnCloseEvent=""}if(properties.textAlignCenter==undefined){properties.textAlignCenter=true}if(properties.showCloseBtn==undefined){properties.showCloseBtn=true}if(properties.cancelOnClickEvent!=undefined){cancelButton.click(function(){eval(properties.cancelOnClickEvent)})}if(properties.dontCloseModalOnOutsideClick==undefined){properties.dontCloseModalOnOutsideClick=false}if(properties.customHeight!=undefined){properties.isCustomHeight=true}if(properties.modalSizeLarge==undefined){properties.modalSizeLarge=false}if(properties.showCheckbox==undefined){properties.showCheckbox=false}if(!hasText(properties.checkboxMsg)){properties.checkboxMsg="I have read and understood."}var checkbox=jQuery('<span style="float: left; margin: 8px 0px"><input type="checkbox" id="modal-checkbox" onchange="document.getElementById(\'okBtn\').disabled = !this.checked;"><label for="modal-checkbox">&ensp;'+properties.checkboxMsg+"</label></span>");var bootstrapIso=jQuery('<div id="biModalMessageDiv" class="bi">');var modalMessage=jQuery('<div id="modalMessage" class="modal fade" tabindex="-1"'+(properties.dontCloseModalOnOutsideClick?' data-backdrop="static" data-keyboard="false"':"")+">");var modalDialog=jQuery('<div class="modal-dialog'+(properties.modalSizeLarge?" modal-lg":"")+'" style="vertical-align: middle">');var modalContent=jQuery('<div class="modal-content">');modalContent.appendTo(modalDialog);modalDialog.appendTo(modalMessage);modalMessage.appendTo(bootstrapIso);modalContent.append(properties.hideFooterAndHeader?"":jQuery('<div class="modal-header" id="modalMessageHeader">').append(properties.showCloseBtn?jQuery('<button type="button" class="close" data-dismiss="modal" aria-hidden="true">'):"").append((properties.showTitle)?jQuery('<h4 class="modal-title" id="modalMessageTitle">').html(properties.title):"")).append(jQuery('<div class="modal-body" id="modalMessageBody" style="'+(properties.isCustomHeight?" height:"+properties.customHeight+" ":"")+(properties.textAlignCenter?"text-align:center":"")+'">').html(properties.message)).append(properties.hideFooterAndHeader?"":jQuery('<div class="modal-footer" id="modalMessageFooter">').append((properties.showCheckbox?checkbox:"")).append((properties.showCancelBtn)?cancelButton.html(properties.cancelMessageBtn):"").append((properties.showOkBtn)?okButton.html(properties.okMessageBtn):""));$(document.body).append(bootstrapIso);var biModalMessageDiv=jQuery("#biModalMessageDiv");if(hasText(properties.modalOnCloseEvent)){modalMessage.on("hidden.bs.modal",function(){eval(properties.modalOnCloseEvent);biModalMessageDiv.remove()})}else{modalMessage.on("hidden.bs.modal",function(){biModalMessageDiv.remove()})}modalMessage.modal("show")}function removeScriptTags(a){if(typeof a!="string"||a.indexOf("<script")==-1){return a}var b=$(a).wrapAll("<div>").parent();b.find("script").remove();return b.html()}function loadScript(d,f){var b,c,a;c=false;b=document.createElement("script");b.type="text/javascript";b.src=d;b.onload=b.onreadystatechange=function(){if(!c&&(!this.readyState||this.readyState=="complete")){c=true;f()}};a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a)}function cleanTopNews(){var d=10;var b=jQuery("[id^='newsItem']");try{if(b.length>d){var a=jQuery(b.slice(0,d)[9]);if(a.parent().nextAll().length>0){a.parent().nextAll().remove()}else{if(a.nextAll().length>0){a.nextAll().remove()}}}else{if(b.length==d){var c=jQuery("#scrollbar_container .information");if(c.length>0){c.parent().remove()}}}}catch(f){}}function initCookieConsent(){window.cookieconsent.initialise({palette:{popup:{background:"#2f2f2f"},button:{background:"#ff9900",text:"#faf7f7"}},position:"bottom-right",content:{href:"/privacy.html?anchorId=cookie_policy"}})}function goToCookieConsentPolicy(a){if(a){$("body,html").animate({scrollTop:$("#"+a).offset().top-25})}}function approveDisapprovePremiumOffers(b){var a=["approve=",b];$("#premiumOffersConfirmation").hide();fxAjax.sendRequest(fxVars.approveDisapprovePremiumOffers,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:a.join(""),params:{},loader:true,callback:"approveDisapprovePremiumOffersResponse"})}function approveDisapprovePremiumOffersResponse(a,b){premiumOffersConfirmationDiv=$("#premiumOffersConfirmation");if(!a.error){premiumOffersConfirmationDiv.html($T("tThankYou"))}else{premiumOffersConfirmationDiv.html($T("tError"))}premiumOffersConfirmationDiv.show();premiumOffersConfirmationDiv.delay(3000).fadeOut("slow")}function flashElement(a,b){$(a).show();setTimeout(function(){$(a).fadeOut()},b*1000)}function isIEOrEdge(){var b=window.navigator.userAgent;var a=b.indexOf("MSIE")>-1;var c=b.indexOf("Edge")>-1;return a||c}function getBrokersByPlatformOid(b){b=b||jQuery("#platformOid").val();var a=jQuery("#serverOid");a.prop("disabled","disabled");a.empty();jQuery("<option/>",{text:"Loading...",selected:true}).appendTo(a);fxAjax.sendRequest(fxVars.getBrokersByPlatformOid+"platformOid="+b,{loader:false,callback:"createBrokersOptions"})}function createBrokersOptions(b){var a=jQuery("#serverOid");a.empty();jQuery("<option/>",{id:"br0",value:0,text:"Any",selected:(serverOid===0)}).appendTo(a);for(var c=0;c<b.length;c++){jQuery("<option/>",{id:"br"+b[c].oid,value:b[c].oid,text:b[c].name,selected:(b[c].oid===serverOid)}).appendTo(a)}a.prop("disabled",false)}function getMoreMagics(d,g,b,h,k,f){var a=$("#moreMagicsButton"+g);var c=fxVars.getMagicNumbers+"accountOid="+d+"&page="+g+"&location="+b+"&invitation="+h+"&profileOid="+k;fxAjax.sendRequest(c,{loader:true,callback:function(l){if(l&&hasText(l.content)){var m=$(l.content);if(m.length){switch(b){case"set":var o=$(m).find("[name='magicColors']");attachColorPicker(o);a.before(m).remove();break;case"p":case"s":if(!$("#magicsPinBg").hasClass("active")){$("#magicTable label:not([for=nonMagic])").css("font-weight","normal")}if(k===-1){$("#magicTable").html(l.content);$("#magicList").css("pointer-events","auto");$("#clearSearchSettings").hide()}else{a.before(m).remove()}break;case"sp":if(g===0){$("#magicTable").html(l.content);$("#clearSearchSettings").show()}else{a.before(m).remove()}setProfileInfo(k,f)}if($("#selectAllMagics").attr("allchecked")==="true"){$("[name=accountMagic]").prop("checked",true)}}}else{if(b==="sp"&&g===0){$("#magicTable").html("");$("#clearSearchSettings").show();setProfileInfo(k,f)}else{a.remove()}}}})}function getPortfolioData(){fxAjax.sendRequest(fxVars.portfolioMenuMap,{contentType:"application/json",params:{},loader:false,callback:"getPortfolioDataResponse"})}function getPortfolioDataResponse(a){if(!a.error){$("#accountsNav").html(a.content.menu)}}function getChartsMenuData(){fxAjax.sendRequest("/menuCharts.json",{contentType:"application/json",params:{},loader:false,callback:"getChartsMenuDataResponse"})}function getChartsMenuDataResponse(a){if(!a.error){$("#headerChartsMenu").html(a.content.menu)}}if(!window.DHTMLSuite){var DHTMLSuite=new Object()}if(!String.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"")}}var DHTMLSuite_funcs=new Object();if(!window.DHTML_SUITE_THEME){var DHTML_SUITE_THEME="blue"}if(!window.DHTML_SUITE_THEME_FOLDER){var DHTML_SUITE_THEME_FOLDER="../images/calendar/"}if(!window.DHTML_SUITE_JS_FOLDER){var DHTML_SUITE_JS_FOLDER=staticServerPath+"/scripts/"}var DHTMLSuite=new Object();var standardObjectsCreated=false;DHTMLSuite.eventEls=new Array();var widgetDep=new Object();widgetDep.formValidator=["dhtmlSuite-formUtil.js"];widgetDep.paneSplitter=["dhtmlSuite-paneSplitter.js","dhtmlSuite-paneSplitterModel.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.menuBar=["dhtmlSuite-menuBar.js","dhtmlSuite-menuItem.js","dhtmlSuite-menuModel.js"];widgetDep.windowWidget=["dhtmlSuite-windowWidget.js","dhtmlSuite-resize.js","dhtmlSuite-dragDropSimple.js","ajax.js","dhtmlSuite-dynamicContent.js"];widgetDep.colorWidget=["dhtmlSuite-colorWidgets.js","dhtmlSuite-colorUtil.js"];widgetDep.colorSlider=["dhtmlSuite-colorWidgets.js","dhtmlSuite-colorUtil.js","dhtmlSuite-slider.js"];widgetDep.colorPalette=["dhtmlSuite-colorWidgets.js","dhtmlSuite-colorUtil.js"];widgetDep.calendar=["dhtmlSuite-calendar.js","dhtmlSuite-dragDropSimple.js"];widgetDep.dragDropTree=["dhtmlSuite-dragDropTree.js"];widgetDep.slider=["dhtmlSuite-slider.js"];widgetDep.dragDrop=["dhtmlSuite-dragDrop.js"];widgetDep.imageEnlarger=["dhtmlSuite-imageEnlarger.js","dhtmlSuite-dragDropSimple.js"];widgetDep.imageSelection=["dhtmlSuite-imageSelection.js"];widgetDep.floatingGallery=["dhtmlSuite-floatingGallery.js","dhtmlSuite-mediaModel.js"];widgetDep.contextMenu=["dhtmlSuite-contextMenu.js","dhtmlSuite-menuBar.js","dhtmlSuite-menuItem.js","dhtmlSuite-menuModel.js"];widgetDep.dynamicContent=["dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.textEdit=["dhtmlSuite-textEdit.js","dhtmlSuite-textEditModel.js","dhtmlSuite-listModel.js"];widgetDep.listModel=["dhtmlSuite-listModel.js"];widgetDep.resize=["dhtmlSuite-resize.js"];widgetDep.dragDropSimple=["dhtmlSuite-dragDropSimple.js"];widgetDep.dynamicTooltip=["dhtmlSuite-dynamicTooltip.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.modalMessage=["dhtmlSuite-modalMessage.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.tableWidget=["dhtmlSuite-tableWidget.js","ajax.js"];widgetDep.progressBar=["dhtmlSuite-progressBar.js"];widgetDep.tabView=["dhtmlSuite-tabView.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.infoPanel=["dhtmlSuite-infoPanel.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.form=["dhtmlSuite-formUtil.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.autoComplete=["dhtmlSuite-autoComplete.js","ajax.js"];widgetDep.chainedSelect=["dhtmlSuite-chainedSelect.js","ajax.js"];var depCache=new Object();DHTMLSuite.include=function(b){if(!widgetDep[b]){alert("Cannot find the files for widget "+b+". Please verify that the name is correct");return}var a=widgetDep[b];for(var c=0;c<a.length;c++){if(!depCache[a[c]]){document.write("<script");document.write(' language="javascript"');document.write(' type="text/javascript"');document.write(' src="'+DHTML_SUITE_JS_FOLDER+a[c]+'">');document.write("<\/script>");depCache[a[c]]=true}}};DHTMLSuite.discardElement=function(a){a=DHTMLSuite.commonObj.getEl(a);var b=document.getElementById("IELeakGBin");if(!b){b=document.createElement("DIV");b.id="IELeakGBin";b.style.display="none";document.body.appendChild(b)}b.appendChild(a);b.innerHTML=""};DHTMLSuite.createStandardObjects=function(){DHTMLSuite.clientInfoObj=new DHTMLSuite.clientInfo();DHTMLSuite.clientInfoObj.init();if(!DHTMLSuite.configObj){DHTMLSuite.configObj=new DHTMLSuite.config();DHTMLSuite.configObj.init()}DHTMLSuite.commonObj=new DHTMLSuite.common();DHTMLSuite.variableStorage=new DHTMLSuite.globalVariableStorage();DHTMLSuite.commonObj.init();DHTMLSuite.domQueryObj=new DHTMLSuite.domQuery();DHTMLSuite.commonObj.addEvent(window,"unload",function(){DHTMLSuite.commonObj.__clearMemoryGarbage()});standardObjectsCreated=true};DHTMLSuite.config=function(){var a;var c;var b;var d};DHTMLSuite.config.prototype={init:function(){this.imagePath=DHTML_SUITE_THEME_FOLDER+DHTML_SUITE_THEME+"/";this.cssPath="/styles/";this.defaultCssPath=this.cssPath;this.defaultImagePath=this.imagePath},setCssPath:function(a){this.cssPath=a},resetCssPath:function(){this.cssPath=this.defaultCssPath},resetImagePath:function(){this.imagePath=this.defaultImagePath},setImagePath:function(a){this.imagePath=a}};DHTMLSuite.globalVariableStorage=function(){var c;this.menuBar_highlightedItems=new Array();var d;var b;this.arrayDSObjects=new Array();this.arrayOfDhtmlSuiteObjects=this.arrayDSObjects;var a;this.ajaxObjects=new Array()};DHTMLSuite.globalVariableStorage.prototype={};DHTMLSuite.common=function(){var d;var c;var a;var b;this.okToSelect=true;this.cssCacheStatus=true;this.eventEls=new Array()};DHTMLSuite.common.prototype={init:function(){this.loadedCSSFiles=new Array()},loadCSS:function(b,c){if(!c&&c!==false){c=true}if(!this.loadedCSSFiles[b]){this.loadedCSSFiles[b]=true;var a=document.createElement("LINK");if(!this.cssCacheStatus){if(b.indexOf("?")>=0){b=b+"&"}else{b=b+"?"}b=b+"rand="+Math.random()}if(c){a.href=DHTMLSuite.configObj.cssPath+b}else{a.href=b}a.rel="stylesheet";a.media="screen";a.type="text/css";document.getElementsByTagName("HEAD")[0].appendChild(a)}},__setTextSelOk:function(a){this.okToSelect=a},__isTextSelOk:function(){return this.okToSelect},setCssCacheStatus:function(a){this.cssCacheStatus=a},getEl:function(a){if(typeof a=="string"){if(document.getElementById(a)){return document.getElementById(a)}if(document.forms[a]){return document.forms[a]}if(document[a]){return document[a]}if(window[a]){return window[a]}}return a},isArray:function(a){if(a.constructor.toString().indexOf("Array")!=-1){return true}return false},getStyle:function(b,c){b=this.getEl(b);if(document.defaultView&&document.defaultView.getComputedStyle){var d=null;var a=document.defaultView.getComputedStyle(b,"");if(a){d=a[c]}return b.style[c]||d}if(document.documentElement.currentStyle&&DHTMLSuite.clientInfoObj.isMSIE){var d=null;if(b.currentStyle){value=b.currentStyle[c]}return(b.style[c]||d)}return b.style[c]},getLeftPos:function(b){if(document.getBoxObjectFor){if(b.tagName!="INPUT"&&b.tagName!="SELECT"&&b.tagName!="TEXTAREA"){return document.getBoxObjectFor(b).x}}var a=b.offsetLeft;while((b=b.offsetParent)!=null){if(b.tagName!="HTML"){a+=b.offsetLeft;if(document.all){a+=b.clientLeft}}}return a},getTopPos:function(b){if(document.getBoxObjectFor){if(b.tagName!="INPUT"&&b.tagName!="SELECT"&&b.tagName!="TEXTAREA"){return document.getBoxObjectFor(b).y}}var a=b.offsetTop;while((b=b.offsetParent)!=null){if(b.tagName!="HTML"){a+=(b.offsetTop-b.scrollTop);if(document.all){a+=b.clientTop}}}return a},getCookie:function(c){var d=document.cookie.indexOf(c+"=");var a=d+c.length+1;if((!d)&&(c!=document.cookie.substring(0,c.length))){return null}if(d==-1){return null}var b=document.cookie.indexOf(";",a);if(b==-1){b=document.cookie.length}return unescape(document.cookie.substring(a,b))},setCookie:function(b,g,c,l,d,a){c=c*60*60*24*1000;var f=new Date();var h=new Date(f.getTime()+(c));var k=b+"="+escape(g)+((c)?";expires="+h.toGMTString():"")+((l)?";path="+l:"")+((d)?";domain="+d:"")+((a)?";secure":"");document.cookie=k},deleteCookie:function(a,c,b){if(this.getCookie(a)){document.cookie=a+"="+((c)?";path="+c:"")+((b)?";domain="+b:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}},cancelEvent:function(){return false},addEvent:function(d,b,a,c){if(!c){c=""}if(d.attachEvent){if(typeof DHTMLSuite_funcs[b+a+c]!="function"){DHTMLSuite_funcs[b+a+c]=function(){a.apply(window.event.srcElement)};d.attachEvent("on"+b,DHTMLSuite_funcs[b+a+c])}d=null}else{d.addEventListener(b,a,false)}this.__addEventEl(d)},removeEvent:function(d,b,a,c){if(d.detachEvent){d.detachEvent("on"+b,DHTMLSuite_funcs[b+a+c]);DHTMLSuite_funcs[b+a+c]=null;d=null}else{d.removeEventListener(b,a,false)}},__clearMemoryGarbage:function(){if(!DHTMLSuite.clientInfoObj.isMSIE){return}for(var c=0;c<DHTMLSuite.eventEls.length;c++){try{var a=DHTMLSuite.eventEls[c];a.onclick=null;a.onmousedown=null;a.onmousemove=null;a.onmouseout=null;a.onmouseover=null;a.onmouseup=null;a.onfocus=null;a.onblur=null;a.onkeydown=null;a.onkeypress=null;a.onkeyup=null;a.onselectstart=null;a.ondragstart=null;a.oncontextmenu=null;a.onscroll=null;a=null}catch(b){}}for(var c in DHTMLSuite.variableStorage.arrayDSObjects){DHTMLSuite.variableStorage.arrayDSObjects[c]=null}window.onbeforeunload=null;window.onunload=null;DHTMLSuite=null},__addEventEl:function(a){DHTMLSuite.eventEls[DHTMLSuite.eventEls.length]=a},getSrcElement:function(b){var a;if(b.target){a=b.target}else{if(b.srcElement){a=b.srcElement}}if(a.nodeType==3){a=a.parentNode}return a},getKeyFromEvent:function(b){var a=this.getKeyCode(b);return String.fromCharCode(a)},getKeyCode:function(a){if(a.keyCode){code=a.keyCode}else{if(a.which){code=a.which}}return code},isObjectClicked:function(c,b){var d=this.getSrcElement(b);var a=d.tagName+"("+d.className+")";if(d==c){return true}while(d.parentNode&&d.tagName.toLowerCase()!="html"){d=d.parentNode;a=a+","+d.tagName+"("+d.className+")";if(d==c){return true}}return false},getObjectByClassName:function(b,a){var c=this.getSrcElement(b);if(c.className==a){return c}while(c&&c.tagName.toLowerCase()!="html"){c=c.parentNode;if(c.className==a){return c}}return false},getObjectByAttribute:function(c,b){var d=this.getSrcElement(c);var a=d.getAttribute(b);if(!a){a=d[b]}if(a){return d}while(d&&d.tagName.toLowerCase()!="html"){d=d.parentNode;var a=d.getAttribute("attribute");if(!a){a=d[b]}if(a){return d}}return false},getUniqueId:function(){var b=Math.random()+"";b=b.replace(".","");var a=Math.random()+"";a=a.replace(".","");return b+a},getAssociativeArrayFromString:function(b){if(!b){return}var a=new Array();var c=b.split(/,/g);for(var f=0;f<c.length;f++){var d=c[f].split(/:/);a[d[0]]=d[1]}return a},correctPng:function(f){f=DHTMLSuite.commonObj.getEl(f);var b=f;var d=b.width;var a=b.height;var c="<span style=\"display:inline-block;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b.src+"',sizingMethod='scale');width:"+d+";height:"+a+'"></span>';b.outerHTML=c},__evaluateJs:function(g){g=this.getEl(g);var f=g.getElementsByTagName("SCRIPT");var b="";var d="";for(var h=0;h<f.length;h++){if(f[h].src){var c=document.getElementsByTagName("head")[0];var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("src",f[h].src)}else{if(DHTMLSuite.clientInfoObj.isOpera){d=d+f[h].text+"\n"}else{d=d+f[h].innerHTML}}}if(d){this.__installScript(d)}},__installScript:function(a){try{if(!a){return}if(window.execScript){window.execScript(a)}else{if(window.jQuery&&jQuery.browser.safari){window.setTimeout(a,0)}else{window.setTimeout(a,0)}}}catch(b){}},__evaluateCss:function(b){b=this.getEl(b);var d=b.getElementsByTagName("STYLE");var a=document.getElementsByTagName("HEAD")[0];for(var c=0;c<d.length;c++){a.appendChild(d[c])}}};DHTMLSuite.clientInfo=function(){var d;var c;var a;var f;var g;var b;var f};DHTMLSuite.clientInfo.prototype={init:function(){this.browser=navigator.userAgent;this.isOpera=(this.browser.toLowerCase().indexOf("opera")>=0)?true:false;this.isFirefox=(this.browser.toLowerCase().indexOf("firefox")>=0)?true:false;this.isMSIE=(this.browser.toLowerCase().indexOf("msie")>=0)?true:false;this.isOldMSIE=(this.browser.toLowerCase().match(/msie\s[0-6]/gi))?true:false;this.isSafari=(this.browser.toLowerCase().indexOf("safari")>=0)?true:false;this.navigatorVersion=navigator.appVersion.replace(/.*?MSIE\s(\d\.\d).*/g,"$1")/1;this.isOldMSIE=(this.isMSIE&&this.navigatorVersion<7)?true:false},getBrowserWidth:function(){if(self.innerWidth){return self.innerWidth}return document.documentElement.offsetWidth},getBrowserHeight:function(){if(self.innerHeight){return self.innerHeight}return document.documentElement.offsetHeight}};DHTMLSuite.domQuery=function(){document.getElementsByClassName=this.getElementsByClassName;document.getElementsByAttribute=this.getElementsByAttribute};DHTMLSuite.domQuery.prototype={};var jscolor={dir:"/images/jscolor/",bindClass:"color",binding:true,preloading:true,removeColorPicker:function(){if(jscolor.picker!=undefined){if(jscolor.picker.owner!=undefined){delete jscolor.picker.owner;document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)}}},install:function(){jscolor.addEvent(window,"load",jscolor.init)},init:function(){if(jscolor.binding){jscolor.bind()}if(jscolor.preloading){jscolor.preload()}},getDir:function(){if(!jscolor.dir){var a=jscolor.detectDir();jscolor.dir=a!=false?a:"/images/jscolor/"}return jscolor.dir},detectDir:function(){var c=location.href;var d=document.getElementsByTagName("base");for(var a=0;a<d.length;a++){if(d[a].href){c=d[a].href}}var d=document.getElementsByTagName("script");for(var a=0;a<d.length;a++){if(d[a].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(d[a].src)){var f=new jscolor.URI(d[a].src);var b=f.toAbsolute(c);b.path=b.path.replace(/[^\/]+$/,"");delete b.query;delete b.fragment;return b.toString()}}return false},bind:function(){var matchClass=new RegExp("(^|\\s)("+jscolor.bindClass+")\\s*(\\{[^}]*\\})?","i");var e=document.getElementsByTagName("input");for(var i=0;i<e.length;i++){var m;if(!e[i].color&&e[i].className&&(m=e[i].className.match(matchClass))){var prop={};if(m[3]){try{eval("prop="+m[3])}catch(eInvalidProp){}}e[i].color=new jscolor.color(e[i],prop)}}},preload:function(){for(var a in jscolor.imgRequire){jscolor.loadImage(a)}},images:{pad:[181,101],sld:[16,101],cross:[15,15],arrow:[7,11]},imgRequire:{},imgLoaded:{},requireImage:function(a){jscolor.imgRequire[a]=true},loadImage:function(a){if(!jscolor.imgLoaded[a]){jscolor.imgLoaded[a]=new Image();jscolor.imgLoaded[a].src=jscolor.getDir()+a}},fetchElement:function(a){return typeof(a)=="string"?document.getElementById(a):a},addEvent:function(a,c,b){if(a.addEventListener){return a.addEventListener(c,b,false)}else{if(a.attachEvent){return a.attachEvent("on"+c,b)}else{return false}}},fireEvent:function(a,c){if(!a){return false}else{if(document.createEventObject){var b=document.createEventObject();return a.fireEvent("on"+c,b)}else{if(document.createEvent){var b=document.createEvent("HTMLEvents");b.initEvent(c,true,true);return a.dispatchEvent(b)}else{if(a["on"+c]){return a["on"+c]()}else{return false}}}}},getElementPos:function(d){var a=0,f=0;var c=d.getBoundingClientRect();a=c.left;f=c.top;var b=jscolor.getViewPos();a+=b[0];f+=b[1];return[a,f]},getElementSize:function(a){return[a.offsetWidth,a.offsetHeight]},getMousePos:function(a){if(!a){a=window.event}if(typeof a.pageX=="number"){return[a.pageX,a.pageY]}else{if(typeof a.clientX=="number"){return[a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a.clientY+document.body.scrollTop+document.documentElement.scrollTop]}}},getViewPos:function(){var a=document.documentElement;return[(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),(window.pageYOffset||a.scrollTop)-(a.clientTop||0)]},getViewSize:function(){if(typeof window.innerWidth=="number"){return[window.innerWidth,window.innerHeight]}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){return[document.body.clientWidth,document.body.clientHeight]}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){return[document.documentElement.clientWidth,document.documentElement.clientHeight]}else{return[0,0]}}}},URI:function(a){this.scheme=null;this.authority=null;this.path="";this.query=null;this.fragment=null;this.parse=function(d){var c=d.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);this.scheme=c[3]?c[2]:null;this.authority=c[5]?c[6]:null;this.path=c[7];this.query=c[9]?c[10]:null;this.fragment=c[12]?c[13]:null;return this};this.toString=function(){var c="";if(this.scheme!=null){c=c+this.scheme+":"}if(this.authority!=null){c=c+"//"+this.authority}if(this.path!=null){c=c+this.path}if(this.query!=null){c=c+"?"+this.query}if(this.fragment!=null){c=c+"#"+this.fragment}return c};this.toAbsolute=function(f){var f=new jscolor.URI(f);var d=this;var c=new jscolor.URI;if(f.scheme==null){return false}if(d.scheme!=null&&d.scheme.toLowerCase()==f.scheme.toLowerCase()){d.scheme=null}if(d.scheme!=null){c.scheme=d.scheme;c.authority=d.authority;c.path=b(d.path);c.query=d.query}else{if(d.authority!=null){c.authority=d.authority;c.path=b(d.path);c.query=d.query}else{if(d.path==""){c.path=f.path;if(d.query!=null){c.query=d.query}else{c.query=f.query}}else{if(d.path.substr(0,1)=="/"){c.path=b(d.path)}else{if(f.authority!=null&&f.path==""){c.path="/"+d.path}else{c.path=f.path.replace(/[^\/]+$/,"")+d.path}c.path=b(c.path)}c.query=d.query}c.authority=f.authority}c.scheme=f.scheme}c.fragment=d.fragment;return c};function b(f){var c="";while(f){if(f.substr(0,3)=="../"||f.substr(0,2)=="./"){f=f.replace(/^\.+/,"").substr(1)}else{if(f.substr(0,3)=="/./"||f=="/."){f="/"+f.substr(3)}else{if(f.substr(0,4)=="/../"||f=="/.."){f="/"+f.substr(4);c=c.replace(/\/?[^\/]*$/,"")}else{if(f=="."||f==".."){f=""}else{var d=f.match(/^\/?[^\/]*/)[0];f=f.substr(d.length);c=c+d}}}}}return c}if(a){this.parse(a)}},color:function(E,d){this.required=true;this.adjust=true;this.hash=false;this.caps=true;this.valueElement=E;this.styleElement=E;this.hsv=[0,0,1];this.rgb=[1,1,1];this.pickerOnfocus=true;this.pickerMode="HSV";this.pickerPosition="bottom";this.pickerFace=10;this.pickerFaceColor="ThreeDFace";this.pickerBorder=1;this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight";this.pickerInset=1;this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow";this.pickerZIndex=100000;for(var v in d){this[v]=d[v]}this.hidePicker=function(){if(w()){g()}};this.showPicker=function(){if(!w()){var O=jscolor.getElementPos(E);var L=jscolor.getElementSize(E);var I=jscolor.getViewPos();var Q=jscolor.getViewSize();var H=[2*this.pickerBorder+4*this.pickerInset+2*this.pickerFace+jscolor.images.pad[0]+2*jscolor.images.arrow[0]+jscolor.images.sld[0],2*this.pickerBorder+2*this.pickerInset+2*this.pickerFace+jscolor.images.pad[1]];var P,N,M;switch(this.pickerPosition.toLowerCase()){case"left":P=1;N=0;M=-1;break;case"right":P=1;N=0;M=1;break;case"top":P=0;N=1;M=-1;break;default:P=0;N=1;M=1;break}var K=(L[N]+H[N])/2;var J=[-I[P]+O[P]+H[P]>Q[P]?(-I[P]+O[P]+L[P]/2>Q[P]/2&&O[P]+L[P]-H[P]>=0?O[P]+L[P]-H[P]:O[P]):O[P],-I[N]+O[N]+L[N]+H[N]-K+K*M>Q[N]?(-I[N]+O[N]+L[N]/2>Q[N]/2&&O[N]+L[N]-K-K*M>=0?O[N]+L[N]-K-K*M:O[N]+L[N]-K+K*M):(O[N]+L[N]-K+K*M>=0?O[N]+L[N]-K+K*M:O[N]+L[N]-K-K*M)];l(J[P],J[N])}};this.importColor=function(){if(!a){this.exportColor()}else{if(!this.adjust){if(!this.fromString(a.getAttribute("hex"),z)){G.style.backgroundColor=G.jscStyle.backgroundColor;G.style.color=G.jscStyle.color;this.exportColor(z|F)}}else{if(!this.required&&/^\s*$/.test(a.getAttribute("hex"))){a.setAttribute("hex","");G.style.backgroundColor=G.jscStyle.backgroundColor;G.style.color=G.jscStyle.color;this.exportColor(z|F)}else{if(this.fromString(a.getAttribute("hex"))){}else{this.exportColor()}}}}};this.exportColor=function(H){if(!(H&z)&&a){var I=this.toString();if(this.caps){I=I.toUpperCase()}if(this.hash){I="#"+I}a.setAttribute("hex",I)}if(!(H&F)&&G){G.style.backgroundColor="#"+this.toString();G.style.color=0.213*this.rgb[0]+0.715*this.rgb[1]+0.072*this.rgb[2]<0.5?"#FFF":"#000"}if(!(H&x)&&w()){u()}if(!(H&f)&&w()){D()}};this.fromHSV=function(K,J,I,H){K<0&&(K=0)||K>6&&(K=6);J<0&&(J=0)||J>1&&(J=1);I<0&&(I=0)||I>1&&(I=1);this.rgb=h(K==null?this.hsv[0]:(this.hsv[0]=K),J==null?this.hsv[1]:(this.hsv[1]=J),I==null?this.hsv[2]:(this.hsv[2]=I));this.exportColor(H)};this.fromRGB=function(L,K,H,I){L<0&&(L=0)||L>1&&(L=1);K<0&&(K=0)||K>1&&(K=1);H<0&&(H=0)||H>1&&(H=1);var J=A(L==null?this.rgb[0]:(this.rgb[0]=L),K==null?this.rgb[1]:(this.rgb[1]=K),H==null?this.rgb[2]:(this.rgb[2]=H));if(J[0]!=null){this.hsv[0]=J[0]}if(J[2]!=0){this.hsv[1]=J[1]}this.hsv[2]=J[2];this.exportColor(I)};this.fromString=function(J,I){var H=J.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);if(!H){return false}else{if(H[1].length==6){this.fromRGB(parseInt(H[1].substr(0,2),16)/255,parseInt(H[1].substr(2,2),16)/255,parseInt(H[1].substr(4,2),16)/255,I)}else{this.fromRGB(parseInt(H[1].charAt(0)+H[1].charAt(0),16)/255,parseInt(H[1].charAt(1)+H[1].charAt(1),16)/255,parseInt(H[1].charAt(2)+H[1].charAt(2),16)/255,I)}return true}};this.toString=function(){return((256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1))};function A(M,L,I){var N=Math.min(Math.min(M,L),I);var J=Math.max(Math.max(M,L),I);var H=J-N;if(H==0){return[null,0,J]}var K=M==N?3+(I-L)/H:(L==N?5+(M-I)/H:1+(L-M)/H);return[K==6?0:K,H/J,J]}function h(L,K,I){if(L==null){return[I,I,I]}var J=Math.floor(L);var M=J%2?L-J:1-(L-J);var H=I*(1-K);var N=I*(1-K*M);switch(J){case 6:case 0:return[I,N,H];case 1:return[N,I,H];case 2:return[H,I,N];case 3:return[H,N,I];case 4:return[N,H,I];case 5:return[I,H,N]}}function g(){delete jscolor.picker.owner;document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)}function l(H,O){if(!jscolor.picker){jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div")};for(var K=0,N=4;K<jscolor.images.sld[1];K+=N){var I=document.createElement("div");I.style.height=N+"px";I.style.fontSize="1px";I.style.lineHeight="0";jscolor.picker.sld.appendChild(I)}jscolor.picker.sldB.appendChild(jscolor.picker.sld);jscolor.picker.box.appendChild(jscolor.picker.sldB);jscolor.picker.box.appendChild(jscolor.picker.sldM);jscolor.picker.padB.appendChild(jscolor.picker.pad);jscolor.picker.box.appendChild(jscolor.picker.padB);jscolor.picker.box.appendChild(jscolor.picker.padM);jscolor.picker.boxB.appendChild(jscolor.picker.box)}var M=jscolor.picker;s=[H+m.pickerBorder+m.pickerFace+m.pickerInset,O+m.pickerBorder+m.pickerFace+m.pickerInset];B=[null,O+m.pickerBorder+m.pickerFace+m.pickerInset];M.box.onmouseup=M.box.onmouseout=function(){E.focus()};M.box.onmousedown=function(){q=true};M.box.onmousemove=function(P){c&&y(P);r&&k(P)};M.padM.onmouseup=M.padM.onmouseout=function(){if(c){c=false;jscolor.fireEvent(a,"change")}};M.padM.onmousedown=function(P){c=true;y(P)};M.sldM.onmouseup=M.sldM.onmouseout=function(){if(r){r=false;jscolor.fireEvent(a,"change")}};M.sldM.onmousedown=function(P){r=true;k(P)};M.box.style.width=4*m.pickerInset+2*m.pickerFace+jscolor.images.pad[0]+2*jscolor.images.arrow[0]+jscolor.images.sld[0]+"px";M.box.style.height=2*m.pickerInset+2*m.pickerFace+jscolor.images.pad[1]+"px";M.boxB.style.position="absolute";M.boxB.style.clear="both";M.boxB.style.left=H+"px";M.boxB.style.top=O+"px";M.boxB.style.zIndex=m.pickerZIndex;M.boxB.style.border=m.pickerBorder+"px solid";M.boxB.style.borderColor=m.pickerBorderColor;M.boxB.style.background=m.pickerFaceColor;M.pad.style.width=jscolor.images.pad[0]+"px";M.pad.style.height=jscolor.images.pad[1]+"px";M.padB.style.position="absolute";M.padB.style.left=m.pickerFace+"px";M.padB.style.top=m.pickerFace+"px";M.padB.style.border=m.pickerInset+"px solid";M.padB.style.borderColor=m.pickerInsetColor;M.padM.style.position="absolute";M.padM.style.left="0";M.padM.style.top="0";M.padM.style.width=m.pickerFace+2*m.pickerInset+jscolor.images.pad[0]+jscolor.images.arrow[0]+"px";M.padM.style.height=M.box.style.height;M.padM.style.cursor="crosshair";M.sld.style.overflow="hidden";M.sld.style.width=jscolor.images.sld[0]+"px";M.sld.style.height=jscolor.images.sld[1]+"px";M.sldB.style.position="absolute";M.sldB.style.right=m.pickerFace+"px";M.sldB.style.top=m.pickerFace+"px";M.sldB.style.border=m.pickerInset+"px solid";M.sldB.style.borderColor=m.pickerInsetColor;M.sldM.style.position="absolute";M.sldM.style.right="0";M.sldM.style.top="0";M.sldM.style.width=jscolor.images.sld[0]+jscolor.images.arrow[0]+m.pickerFace+2*m.pickerInset+"px";M.sldM.style.height=M.box.style.height;try{M.sldM.style.cursor="pointer"}catch(J){M.sldM.style.cursor="hand"}switch(b){case 0:var L="hs.png";break;case 1:var L="hv.png";break}M.padM.style.background="url('"+jscolor.getDir()+"cross.gif') no-repeat";M.sldM.style.background="url('"+jscolor.getDir()+"arrow.gif') no-repeat";M.pad.style.background="url('"+jscolor.getDir()+L+"') 0 0 no-repeat";u();D();jscolor.picker.owner=m;document.getElementsByTagName("body")[0].appendChild(M.boxB)}function u(){switch(b){case 0:var K=1;break;case 1:var K=2;break}var O=Math.round((m.hsv[0]/6)*(jscolor.images.pad[0]-1));var N=Math.round((1-m.hsv[K])*(jscolor.images.pad[1]-1));jscolor.picker.padM.style.backgroundPosition=(m.pickerFace+m.pickerInset+O-Math.floor(jscolor.images.cross[0]/2))+"px "+(m.pickerFace+m.pickerInset+N-Math.floor(jscolor.images.cross[1]/2))+"px";var H=jscolor.picker.sld.childNodes;switch(b){case 0:var M=h(m.hsv[0],m.hsv[1],1);for(var I=0;I<H.length;I++){H[I].style.backgroundColor="rgb("+(M[0]*(1-I/H.length)*100)+"%,"+(M[1]*(1-I/H.length)*100)+"%,"+(M[2]*(1-I/H.length)*100)+"%)"}break;case 1:var M,P,L=[m.hsv[2],0,0];var I=Math.floor(m.hsv[0]);var J=I%2?m.hsv[0]-I:1-(m.hsv[0]-I);switch(I){case 6:case 0:M=[0,1,2];break;case 1:M=[1,0,2];break;case 2:M=[2,0,1];break;case 3:M=[2,1,0];break;case 4:M=[1,2,0];break;case 5:M=[0,2,1];break}for(var I=0;I<H.length;I++){P=1-1/(H.length-1)*I;L[1]=L[0]*(1-P*J);L[2]=L[0]*(1-P);H[I].style.backgroundColor="rgb("+(L[M[0]]*100)+"%,"+(L[M[1]]*100)+"%,"+(L[M[2]]*100)+"%)"}break}}function D(){switch(b){case 0:var H=2;break;case 1:var H=1;break}var I=Math.round((1-m.hsv[H])*(jscolor.images.sld[1]-1));jscolor.picker.sldM.style.backgroundPosition="0 "+(m.pickerFace+m.pickerInset+I-Math.floor(jscolor.images.arrow[1]/2))+"px"}function w(){return jscolor.picker&&jscolor.picker.owner==m}function t(){if(a==E){m.importColor()}if(m.pickerOnfocus){m.hidePicker()}}function o(){if(a!=E){m.importColor()}}function y(I){var K=jscolor.getMousePos(I);var H=K[0]-s[0];var J=K[1]-s[1];switch(b){case 0:m.fromHSV(H*(6/(jscolor.images.pad[0]-1)),1-J/(jscolor.images.pad[1]-1),null,f);break;case 1:m.fromHSV(H*(6/(jscolor.images.pad[0]-1)),null,1-J/(jscolor.images.pad[1]-1),f);break}}function k(H){var J=jscolor.getMousePos(H);var I=J[1]-s[1];switch(b){case 0:m.fromHSV(null,null,1-I/(jscolor.images.sld[1]-1),x);break;case 1:m.fromHSV(null,1-I/(jscolor.images.sld[1]-1),null,x);break}}var m=this;var b=this.pickerMode.toLowerCase()=="hvs"?1:0;var q=false;var a=jscolor.fetchElement(this.valueElement),G=jscolor.fetchElement(this.styleElement);var c=false,r=false;var s,B;var z=1<<0,F=1<<1,x=1<<2,f=1<<3;jscolor.addEvent(E,"focus",function(){if(m.pickerOnfocus){m.showPicker()}});jscolor.addEvent(E,"blur",function(){if(!q){setTimeout(function(){q||t();q=false},0)}else{q=false}});if(a){var C=function(){m.fromString(a.getAttribute("hex"),z)};jscolor.addEvent(a,"keyup",C);jscolor.addEvent(a,"input",C);jscolor.addEvent(a,"blur",o);a.setAttribute("autocomplete","off")}if(G){G.jscStyle={backgroundColor:G.style.backgroundColor,color:G.style.color}}switch(b){case 0:jscolor.requireImage("hs.png");break;case 1:jscolor.requireImage("hv.png");break}jscolor.requireImage("cross.gif");jscolor.requireImage("arrow.gif");this.importColor()}};jscolor.install();var spreadsTh;var spreadsSpan;var spreadsTable;var sortable=false;var spreadTableStyle=false;var simulatorHistoryTh;var simulatorHistorySpan;var simulatorHistoryTable;var simulatorHistorySortable=false;var simulatorHistoryTableStyle=false;var simulatorPage=false;var dynamicSort=false;SortableTable=function(b){var c=$J("#"+b.id+" tr").not(".skipSort");var a=this;this.table=b;this.rows=$A(c).map(function(d){return $PT(d)});this.headerRow=this.rows.shift();this.headers=$J(this.headerRow).find("th").toArray();this.headers.each(function(f){var d=$PT(document.createElement("span"));d.table=b.id;$A(f.childNodes).each(function(g){d.appendChild(g)});f.appendChild(d);d.onclick=function(){if($PT("spreadMainTable")!=undefined&&this.table=="spreadMainTable"){spreadsTable=a;sortable=true;spreadsTh=f;spreadsSpan=d;spreadTableStyle=true;sortPromotedTable(true,spreadsTable,spreadsTh,spreadsSpan);sortPromotedTable(false,spreadsTable,spreadsTh,spreadsSpan,true)}else{if($PT("forexBrokerSwapTable")!=undefined&&this.table=="forexBrokerSwapTable"){sortPromotedTable(true,a,f,d);sortPromotedTable(false,a,f,d,true)}else{if($PT("symbolMarketHeatMap")!=undefined&&this.table=="symbolMarketHeatMap"){dynamicSort=true;a.sortOnColumn(f,d)}else{if(hasText(f.getAttribute("sort"))){a.sortOnColumn(f,d)}}}}if($PT("simulatorHistoryTable")!=undefined&&this.table=="simulatorHistoryTable"){var g=false;if(!simulatorHistorySortable){g=true}simulatorHistorySortable=true;simulatorHistoryTh=f;simulatorHistorySpan=d;simulatorHistoryTableStyle=true;simulatorHistoryTable=a;if(g){initSimulatorHistoryTable()}}}});$J(document).ready(function(){var d=$J(floatTheadTables);if(d.length>0){d.floatThead({position:"fixed",floatContainerClass:"floatTable bg5",floatTableClass:"floatTableTh"});$J("#spreadMainTable").floatThead("reflow")}})};SortableTable.find=function(){$$PT("table.sortable").each(function(a){if(!$J(a).hasClass("floatTableTh")){new SortableTable(a)}})};SortableTable.prototype.simpleCompare=function(d,c){return d<c?-1:d==c?0:1};SortableTable.prototype.compareComposer=function(b){var a=this;return function(d,c){if(d==""||d=="-"){d=0}else{if(c==""||c=="-"){c=0}}return a.simpleCompare(b(d),b(c))}};SortableTable.prototype.compareComposerDate=function(b){var a=this;return function(d,c){if(d==""||d=="-"){d=0}else{if(c==""||c=="-"){c=0}}return a.simpleCompare(b(d),b(c))}};SortableTable.prototype.compareFunction=function(a){switch(a){case"caseSensitive":return this.simpleCompare;case"integer":return this.compareComposer(function(b){return parseInt(b.replace(/^.*?(\d+).*$/,"$1"))});case"float":return this.compareComposer(function(b){return parseFloat(b)});case"date":return this.compareComposerDate(Date.parse);case"long":return this.compareComposer(function(b){return b});default:return this.compareComposer(function(b){return String(b).toLowerCase()})}};SortableTable.prototype.sortOnColumn=function(th,span,sortRule){if($PT("forexBrokerSwapTable")==undefined&&$PT("portfolioOverallTable")==undefined&&$PT("userTable")==undefined&&$PT("strategiesTable")==undefined&&$PT("spreadMainTable")==undefined&&$PT("symbolMarket")==undefined&&$PT("symbolMarketVolatility")==undefined&&$PT("symbolMarketHeatMap")==undefined&&$PT("symbolMarketCorrelation")==undefined&&$PT("mastersTable")==undefined&&$PT("dashboardSystemsTable")==undefined&&$PT("watchTable")==undefined&&$PT("masterFollowersTable")==undefined&&$PT("exposuresTable0")==undefined&&$PT("exposuresTable1")==undefined){deleteAllRows()}var pos=$A(this.headerRow.cells).indexOf(th);if(pos==-1){pos=th.cellIndex}var ss=$A(span.childNodes);var sortFn=this.compareFunction(th.getAttribute("sort"));span.order=span.order||1;if(sortRule!=undefined){span.order*=-1}removeRowsZebraColor();this.rows.sort(function(rowA,rowB){if(rowA.getElementsByTagName("td")[pos]==undefined||rowA.getElementsByTagName("td")[pos].getAttribute("val")==null){return span.order*sortFn(dismissSymbol(rowA.getCellText(pos)),dismissSymbol(rowB.getCellText(pos)))}else{return span.order*sortFn(rowA.getElementsByTagName("td")[pos].getAttribute("val"),rowB.getElementsByTagName("td")[pos].getAttribute("val"))}});span.order*=-1;for(var i=0;i<=this.headers.length;i++){if($PT(this.table.id+"Img"+i)!=undefined){$PT(this.table.id+"Img"+i).className=""}}if(span.order<0){$PT(this.table.id+"Img"+pos).className="sortUp"}else{$PT(this.table.id+"Img"+pos).className="sortDown"}var alt=0;var tbody=this.table.tBodies[0];this.rows.each(function(row){if((alt+=1)%2){if(!row.hasClassName("alt")){row.addClassName("alt")}}else{row.removeClassName("alt")}tbody.appendChild(row)});tbody=moveEmptyRowsDown(this.rows,tbody,pos);var skipedRows=$J(".bottomRow");skipedRows.each(function(index){if(tbody==skipedRows[index].parentNode){tbody.appendChild(skipedRows[index])}});setRowsZebraColor();var endSortFunc=this.table.getAttribute("endSortFunc");if(hasText(endSortFunc)){eval(endSortFunc)}};SortableTable.prototype.setup;if(!simulatorPage){jQuery(document).ready(function(){SortableTable.find()})}function dismissSymbol(a){return a.replace(RegExp("[$||%|:]"),"").trim()}function setRowsZebraColor(){$J(".zebraStyle tr:not(.skipSort):not(.headersRow):odd").addClass("bg1").attr("zebraSort","bg1")}function removeRowsZebraColor(){$J(".zebraStyle tr").removeClass("bg1").attr("zebraSort","")}function moveEmptyRowsDown(d,a,g){var f=[];var c;d.each(function(h){if(h.getElementsByTagName("td")[g]==undefined||h.getElementsByTagName("td")[g].getAttribute("val")==null){c=h.getCellText(g)}else{c=h.getElementsByTagName("td")[g].getAttribute("val")}if(c=="-"){f.push(h)}});if(f.length>0){for(var b=0;b<f.length;b++){a.appendChild(f[b])}}return a}function sortPromotedTable(k,f,d,b,a){if(f){if($J("table.floatTableTh tr").length!=0){var h=true}var g;var c=f.table.id;if(k){g=$J("#"+c+" tr.promote").not("#"+c+".floatTableTh tr,.skipSort,.size-row")}else{g=$J("#"+c+" tr").not(".promote").not("#"+c+".floatTableTh tr,.skipSort,.size-row")}if(!h){f.rows=$A(g).map(function(l){return $PT(l)});f.headerRow=f.rows.shift();f.headers=Selector.findChildElements(f.headerRow,["th"])}else{if(h){f.rows=$A(g)}if($J("table.floatTableTh tr").length>1){f.headerRow=$J("table.floatTableTh tr.headerPromoted")}else{f.headerRow=$J("table.floatTableTh")}f.headers=$J(f.headerRow).find("th")}f.sortOnColumn(d,b,a)}}var windowOpen=0;function getGeneralData(){var b=true;clearTimeout(toolbar);var a=isShown($PT("footerToolbar"));if(a){if(!isNaN(windowOpen)){if(isShown("calendarTop")){windowOpen=1}else{if(isShown("newsTop")){windowOpen=2}else{if(isShown("symbolTop")){windowOpen=3}else{windowOpen=4}}}}else{windowOpen=0}var d={};d.r=Math.random();var c=getServerTime();if(getlastCalendarEventTime()-c>=0){b=false}if(b){var f=[isShown($PT("symbolTop")),"&getCalendarEvents=",b,"&windowOpen=",windowOpen];fxAjax.sendRequest(fxVars.getGeneralData+f.join(""),{loader:false,callback:"getGeneralResponse"})}else{toolbar=setTimeout("getGeneralData()",60000)}}else{hideElement("footerToolbar")}}function getlastCalendarEventTime(){var a=$$PT("#calendarToolbar [name=calendarTime]")[0];return(a!=null)?a.getAttribute("time"):0}var toolbar;function getGeneralResponse(a){if(!a.error){var b=a.content;if(b){if(b.calendarTop){$PT("calendarTop").innerHTML=b.calendarTop}if(b.calendarToolbar){$PT("calendarToolbar").innerHTML=b.calendarToolbar}}}if("newsTop" in b){try{buildNewsToolbar((function(f,d){return f.filter(function(g){if(d.providers.length!==0){return d.providers.indexOf(g.provider)!==-1}return d.locales.indexOf((function(h){switch(h){case"en":return 1;case"ru":return 9;default:return 0}})(g.locale))!==-1}).sort(function(h,g){if(h.time>g.time){return -1}if(h.time<g.time){return 1}return 0}).slice(0,5).reverse()})(b.newsTop,{locales:(function(){try{var d=JSON.parse(JSON.parse(getCookie("userPreferences")));if("newsProviderLanguagesOids" in d){return d.newsProviderLanguagesOids.split(",").map(Number)}}catch(f){}})()||[1],providers:(function(){try{var d=JSON.parse(JSON.parse(getCookie("userPreferences")));if("newsProviderCompanyOids" in d){return d.newsProviderCompanyOids.split(",").map(Number)}}catch(f){}})()||[]}))}catch(c){console.log("error in getGeneralResponse buildNewsToolbar",c,b)}}toolbar=setTimeout("getGeneralData()",60000)}function showToolbarNew(a){fxWebsocket.getTokenForToolbar(a)}function showToolBar(a,b){fxAjax.sendRequest(fxVars.showToolbar+a+"&token="+b,{params:{showToolbar:a},loader:false,callback:"showToolbarNewResponse"})}function showToolbarNewResponse(response,params){if(!response.error){clearTimeout(toolbar);if(eval(params.showToolbar)){showElement("footerToolbar")}else{hideElement("footerToolbar")}}getGeneralData()}function dateToText(b,a,m){var k=a-b;var l;if(k<=MINUTE&&k>0){var g=Math.floor(k/SECOND);if(m){l=$T("tTimeLeftSecondsAgo",[g])}else{l=$T("tTimeLeftSeconds",[g])}}else{if(k>=MINUTE&&k<=HOUR){var c=Math.floor(k/MINUTE);if(m){l=$T("tTimeLeftMinAgo",[c])}else{l=$T("tTimeLeftMin",[c])}}else{if(k>=HOUR&&k<=DAY){var d=Math.floor(k/HOUR);c=Math.floor((k%HOUR)/MINUTE);if(m){l=$T("tTimeLeftHMinAgo",[d,c])}else{l=$T("tTimeLeftHMin",[d,c])}}else{if(k>=DAY){var f=Math.floor(k/DAY);if(m){l=f<=1?$T("tTimeLeftDayAgo",[f]):$T("tTimeLeftDaysAgo",[f])}else{l=f<=1?$T("tTimeLeftDay",[f]):$T("tTimeLeftDays",[f])}}else{if(m){l=$T("tTimeLeftSecondsAgo",[0])}else{l=$T("tTimeLeftSeconds",[0])}}}}}return l}function limitString(b,a){if(b.length>a){return b.substring(0,a)+"..."}else{return b}}function toolbarUrl(a){this.url=a;this.runFunc=function(b){navigateToNewWindow(this.url);stop(b)}}function toolBarSymbolUpdateResponse(h){var m=h[1];var b={};if(hasText(m)){var q=m.split(";");if(q.length>0){for(var t=0;t<q.length;t++){var r=q[t].split("|");if(r.length==2){var d=false;var k=r[1];var c=(r[0]!=null)?symbolOidToNameMap[r[0]]:null;var o="symbol"+c;b[o]=k}}}var a=$$PT("#symbolTop span[name], #symbolToolbar span[name]");for(var g=0;g<a.length;g++){var f=a[g];k=b[f.getAttribute("name")];if(k!=null){var l=$AT(f,"value");if(hasText(l)){if(l<k){f.className="greenBG"}else{if(l>k){f.className="redBG"}}}f.setAttribute("value",k);f.innerHTML=k}else{f.className="paddlr2"}}}}function updateToolbarTimes(){var calendarTimeElements=jQuery("[name=calendarTime][name=calendarTime]");for(var i=0;i<calendarTimeElements.length;i++){var calendarTime=calendarTimeElements[i];var timestamp=eval(calendarTime.getAttribute("time"));var newCalendarTime=dateToText(getServerTime(),timestamp,false);calendarTime.innerHTML="("+newCalendarTime+")"}var calendarElements=jQuery("[name=calendarCircle][name=calendarCircle]");for(var i=0;i<calendarElements.length;i++){var calendar=calendarElements[i];if(parseFloat(calendar.getAttribute("time"))-getServerTime()<=60000){Effect.Pulsate(calendar.id,{pulses:3,duration:1.5})}}var newsElements=jQuery("[name=newsTime][name=newsTime]");for(var i=0;i<newsElements.length;i++){var newsTime=newsElements[i];var timestamp=eval(newsTime.getAttribute("time"));newsTime.innerHTML="("+dateToText(timestamp,getServerTime(),true)+")"}}function buildNewsToolbar(b){if(b.length===0){return}var a=$("#newsTop");$.each(b,function(c,d){d.oid=parseInt(d.oid);d.time=parseInt(d.time);d.title=$("<li/>").html(d.title).text();a.find("li:nth-child(2)").remove();a.append('<li><span class="hover pointer padd7" newsid="'+d.oid+'" data-navigatetonewwindow="/news-redirect.html?id='+d.oid+'">'+d.title+'</span><span name="newsTime" time="'+d.time+'">('+dateToText(d.time,getServerTime(),true)+")</span></li>");if(c===(b.length-1)){$("#newsToolbar").html('<div><span class="pointer padd7">'+d.title+'</span><span name="newsTime" time="'+d.time+'">('+dateToText(d.time,getServerTime(),true)+")</span></div>")}});$("[data-navigatetonewwindow]").click(function(){return navigateToNewWindow($(this).data("navigatetonewwindow"))})}function getNewsToolbarData(){clearTimeout(toolbar);var a=isShown($PT("footerToolbar"));if(a){if(!isNaN(windowOpen)){if(isShown("newsTop")){windowOpen=2}}else{windowOpen=0}var b=[];jQuery("#newsTop span[newsId]").each(function(){b.push($AT(this,"newsId"))});var c={};c.r=Math.random();var d=["&getNews=",true,"&windowOpen=",windowOpen,"&newsOids=",encodeParameter(b)];fxAjax.sendRequest(fxVars.getGeneralData+d.join(""),{loader:false,callback:"getGeneralResponse"})}else{hideElement("footerToolbar")}}function getToolbarNewsFirstTime(){fxAjax.sendRequest("/toolbarNews.json",{contentType:"application/json",params:{},loader:false,callback:"getToolbarNewsFirstTimeResponse"})}function getToolbarNewsFirstTimeResponse(a){if(!a.error){$("#newsTop").html(a.content.newsTop);$("#newsToolbar").html(a.content.newsToolbar)}}function submitEnterWallComment(h,k,c,f,d,b,g){var a;if(window.event){a=window.event.keyCode}else{if(h){a=h.which}else{return true}}if(a==13){if(h.preventDefault){h.preventDefault()}else{h.returnValue=false}if(h.shiftKey){$PT(k).value=$PT(k).value+"\n"}else{addWallPost(k,c,f,d,b,null,null,true,g);$PT(k).value=""}}}var showMoreBloack=true;function showMoreWallPost(k,b,g,l){var d=true;var h=true;if(showMoreBloack){showMoreBloack=false;var f=["userPageId=",k,"&wallPostType=",b,"&objectId=",g];if(b==1){var c=$AT($PT("showMoreWallPost"),"paging");if(Number(c)!=0){f.push("&paging="+c)}else{d=false}}else{if(b==2||b==3){var a=$AT($PT(getWallPostIdsByType(b).showMoreWallPost),"lastTime");h=false;if(Number(a)!=0){f.push("&lastTime="+a);showElement(getWallPostIdsByType(b).feedLoader)}else{d=false}if(hasText(l)){f.push("&invite=",l)}}}if(d){fxAjax.sendRequest(fxVars.showMoreWallPosts+f.join(""),{params:{objectId:g},loader:h,callback:"showMoreWallPostResponse"})}else{showMoreBloack=true;hideElement(getWallPostIdsByType(b).feedLoader)}}}function showMoreWallPostResponse(b,d){if(!b.error){var a=b.content.wallPostType;var c=new Element("span",{});c.innerHTML=b.content.posts;$PT(getWallPostIdsByType(a).userMessages).appendChild(c);if(a==1){if(b.content.paging!=null){$PT("showMoreWallPost").setAttribute("paging",b.content.paging)}else{hideElement("showMoreWallPost");$PT("showMoreWallPost").setAttribute("paging",0)}}else{if(a==2){if(b.content.lastTime!=null){$PT("showMoreWallPost").setAttribute("lastTime",b.content.lastTime)}else{hideElement("showMoreWallPost");$PT("showMoreWallPost").setAttribute("lastTime",0)}if(chartsArray[d.objectId]==null){chartsArray[d.objectId]={}}chartsArray[d.objectId].feedObject=jQuery("#feedData").clone();updateFeedScrooler("chartDiscussion",false);hideElement("feedLoader")}else{if(a==3){if(b.content.lastTime!=null){$PT("newsShowMoreWallPost").setAttribute("lastTime",b.content.lastTime)}else{hideElement("newsShowMoreWallPost");$PT("newsShowMoreWallPost").setAttribute("lastTime",0)}updateFeedScrooler("newsDiscussion",false);hideElement("newsFeedLoader")}}}}runAjaxScripts(b.content.posts);showMoreBloack=true}function removeWallPost(d,f,b,c,a){fxAjax.sendRequest(fxVars.removeWallPosts+f+"&isComment="+b+"&userPageId="+c,{params:{element:d,id:f,isComment:b,wallPostType:a},loader:true,callback:"removeWallPostResponse"})}function removeWallPostResponse(b,c){if(!b.error){$PT(c.element).remove();var a=getWallPostIdsByType(c.wallPostType).postText+c.id;if(!c.isComment&&$PT(a)!=undefined){$PT(a).remove()}}}function editWallPostSave(d,a){var c="commentText"+d;if(validate(c,VALID_TEXT)){var b=["&id=",d,"&text=",encodeParameter($F(c)),"&userPageId=",a];fxAjax.sendRequest(fxVars.editWallPosts,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:b.join(""),params:{id:d},loader:true,callback:"editWallPostResponse"})}}function editWallPostResponse(a,b){if(!a.error){$PT("postData"+b.id).innerHTML=a.content.text;showElement("postData"+b.id);hideElement("postTextData"+b.id);showElement("editComment"+b.id)}}function editWallPost(a){hideElement("postData"+a);showElement("postTextData"+a);hideElement("editComment"+a)}function addWallPost(k,b,g,c,a,h,f,d){addWallPost(k,b,g,c,a,h,f,d,true)}function addWallPost(text,toUid,commentId,wallPostType,objectId,internalType,internalObjectId,resize,returnResponse){var commentTo="";var allowAddWallPost=true;if(commentId){commentTo="&postOid="+commentId}if(wallPostType==2){var connStatus=$PT("connStatusOn");if(connStatus!=null){allowAddWallPost=eval(connStatus.getAttribute("connected"))}else{allowAddWallPost=false}}if(allowAddWallPost){if(validate(text,VALID_EMOJI)){if(validate(text,VALID_TEXT)&&$AT($PT(text),"allowPost")=="true"){var data=["&text=",encodeParameter($F(text)),"&toUser=",toUid,commentTo,"&wallPostType=",wallPostType,"&objectId=",objectId,"&returnResponse=",returnResponse];if(internalType!=null&&internalObjectId!=null){data.push("&internalType="+internalType);data.push("&internalObjectId="+internalObjectId)}fxAjax.sendRequest(fxVars.addWallPost,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:data.join(""),params:{comment:commentId,toUid:toUid,resize:resize,wallPostType:wallPostType,objectId:objectId},loader:false,callback:"addWallPostResponse"});$PT(getWallPostIdsByType(wallPostType).userComment).value=""}else{$PT(text).value="";$PT(text).setAttribute("allowPost","true");inlineMsg(text,$T("tOops")+"<br>"+$T("tNoTextEntered"),3)}}}}function addWallPostResponse(response,params){if(!response.error&&response.content.wallPostResponse){$J("#"+getWallPostIdsByType(params.wallPostType).userComment).attr("rows",1);var post=new Element("div",{style:"display:none"});var oid=response.content.oid;var pending=response.content.pending;post.innerHTML=response.content.post;var wallPostType=response.content.wallPostType;var divCopy=new Element("div",{});if(response.content.subscribed){if(wallPostType==1){$PT("response"+params.toUid).className="";$PT("response"+params.toUid).innerHTML="";var subscribe=$$PT("td[name=subscribe"+params.toUid+"]");if(subscribe!=null){for(var i=0;i<subscribe.length;i++){subscribe[i].innerHTML="<a href='javascript:void(0);' onclick='feedUnsubscribe("+params.toUid+","+params.wallPostType+")' class='unsubscribe gray'>"+$T("tFeedUnsucscribe")+"</a>"}}}}if(params.comment){if($PT(getWallPostIdsByType(params.wallPostType).comment+oid)==null||pending){$PT(getWallPostIdsByType(params.wallPostType).post+params.comment).appendChild(post);$PT(getWallPostIdsByType(params.wallPostType).commentText+params.comment).value="";if(wallPostType==2){divCopy.innerHTML=response.content.post;var feedCopy=chartsArray[lastChartId].feedObject;var postCopy=feedCopy.find("#post"+params.comment);postCopy.append(divCopy)}else{if(wallPostType==3){if(eval($F("userFeedAutoSubscribe"))){updateNewsSubscribeCheckboxElement($PT("subscribeToNews"),params.objectId,true)}}}}}else{if($PT(getWallPostIdsByType(params.wallPostType).post+oid)==null||pending){var firstElement=$PT(getWallPostIdsByType(params.wallPostType).userMessages);firstElement.insertBefore(post,firstElement.firstChild)}if(wallPostType==2){divCopy.innerHTML=response.content.post;var feedCopy=chartsArray[lastChartId].feedObject;var userMessages=feedCopy.find("#"+getWallPostIdsByType(params.wallPostType).userMessages);if(userMessages.children().size()>0){jQuery(divCopy).insertBefore(userMessages.children()[0])}else{userMessages.append(divCopy)}}else{if(wallPostType==3){if(eval($F("userFeedAutoSubscribe"))){updateNewsSubscribeCheckboxElement($PT("subscribeToNews"),params.objectId,true)}}}}jQuery(post).slideDown(300);runAjaxScripts(response.content.post);if(Jlinker!=undefined&&linkerList!=undefined&&response.content.wallPostType==1){Jlinker.createLinkerByElement(linkerList,$J(post))}}}function removeWallPostCheck(g,f,h,c,d,a){var b={hideOn:[{element:"self",event:"click"}],showOn:"false",hook:{target:"leftmiddle",tooltip:"rightmiddle"}};ConfirmationTip(g,b,$T("tConfirmWallPostDelete")+"<br/><br/><div class='center'><span class='exclamation'>"+$T("tCannotUndo")+"</span></div>","removeWallPost('"+f+"',"+h+","+c+","+d+","+a+")")}function updateWallPostText(a,c){var b=$PT(a);b.setAttribute("allowPost","false");b.value=c;b.onclick=function(){this.value="";this.onclick={};this.setAttribute("allowPost","true")};b.onchange=function(){this.setAttribute("allowPost","true");this.onclick={}}}function getPostComments(a,d,c,g,h,f,b){var k=$PT(g);if(k!=null){k.onclick=function(){}}fxAjax.sendRequest(fxVars.getPostComments+a+"&commentId="+d,{params:{postId:a,commentId:d,resize:c,showPostCommentsId:g,postElementId:h,commentElementId:f,scroolerId:b},loader:false,callback:"getPostCommentsResponse"})}function getPostCommentsResponse(b,h){if(!b.error){var g=b.content.comments;var a=b.content.wallPostType;var c=$PT(h.postElementId);var k=$PT(h.commentElementId);var f=$PT(h.showPostCommentsId);if(g!=null){var d=new Element("span",{});d.innerHTML=g;c.insertBefore(d,k);hideElement(h.showPostCommentsId)}if(h.resize){if(a!=null&&(a==2||a==3)){updateFeedScrooler(h.scroolerId,false)}}}if(f!=null){f.onclick=function(){getPostComments(h.postId,h.commentId,h.resize)}}}function getWallPostsBetweenOids(c,g,d,b,a){var f=["firstPostOid=",c,"&lastPostOid=",g,"&invite=",b];fxAjax.sendRequest(fxVars.getWallPostsBetweenOids+f.join(""),{params:{lastPostOid:g,element:d,objectId:a},loader:false,callback:"getWallPostsBetweenOidsResponse"})}function getWallPostsBetweenOidsResponse(c,g){if(!c.error){var f=c.content.posts;var b=c.content.wallPostType;var a=getWallPostIdsByType(b).post;var d=new Element("span",{});d.innerHTML=f;$PT(a+g.lastPostOid).parentNode.insertBefore(d,$PT(a+g.lastPostOid).nextSibling);updateFeedScrooler(getWallPostIdsByType(b).discussion,false);g.element.remove();if($PT(g.objectId)!=null){goToNotification(g.objectId,false,true,getWallPostIdsByType(b).discussion)}}}function feedSubscribe(a,b,c){var d=[a,"&type=",b];if(c){d.push("&objectOid="+c)}fxAjax.sendRequest(fxVars.feedSubscribe+d.join(""),{params:{toUid:a,subscribe:true,type:b,objectOid:c},callback:"feedResponse"})}function feedResponse(d,f){var b=f.type;if(b==1){$PT("response"+f.toUid).innerHTML=d.message;showElement("response"+f.toUid);$PT("response"+f.toUid).className="response";var a=$$PT("td[name=subscribe"+f.toUid+"]");for(var c=0;c<a.length;c++){if(f.subscribe){a[c].innerHTML="<a href='javascript:void(0);' onclick='feedUnsubscribe("+f.toUid+","+b+")' class='unsubscribe gray'>"+$T("tFeedUnsucscribe")+"</a>"}else{a[c].innerHTML="<a href='javascript:void(0);' onclick='feedSubscribe("+f.toUid+","+b+")' class='subscribe gray'>"+$T("tFeedSubscribe")+"</a>"}}}else{if(b==3){updateNewsSubscribeCheckboxElement($PT("subscribeToNews"),f.objectOid,f.subscribe)}}}function feedUnsubscribe(a,b,c){var d=[a,"&type=",b];if(c){d.push("&objectOid="+c)}fxAjax.sendRequest(fxVars.feedUnsubscribe+d.join(""),{params:{toUid:a,subscribe:false,type:b,objectOid:c},callback:"feedResponse"})}function feedSubscriptionDelete(b,a){fxAjax.sendRequest(fxVars.feedSubscriptionDelete+a,{callback:"feedSubscriptionDeleteResponse"})}function feedSubscriptionDeleteResponse(a,b){$PT("subscriptionsFeedCont").innerHTML=a.content.data}function submitEnterWallPost(g,l,d,c,a,k,o,m,b,h){var f;if(window.event){f=window.event.keyCode}else{if(g){f=g.which}else{return true}}if(f==13&&!g.shiftKey){if(g.preventDefault){g.preventDefault()}else{g.returnValue=false}addWallPost(l,d,c,a,k,o,m,b,h)}}function getWallPostIdsByType(a){if(a==1||a==2){return{post:"post",comment:"comment",commentText:"commentText",userComment:"userComment",userMessages:"userMessages",showMoreWallPost:"showMoreWallPost",feedLoader:"feedLoader",discussion:"chartDiscussion",postText:"postText"}}else{if(a==3){return{post:"newsPost",comment:"newsComment",commentText:"newsCommentText",userComment:"userCommentNews",userMessages:"newsUserMessages",showMoreWallPost:"newsShowMoreWallPost",feedLoader:"newsFeedLoader",discussion:"newsDiscussion",postText:"newsPostText"}}}}var showAsk=true;var brokerPipsChart=-1;var PARAM_SPREAD=0;var PARAM_ASK=1;var PARAM_SPREAD_WITH_COMMISSION=2;var PARAM_VOLUME=3;var PARAM_SYMBOL=1;var PARAM_SERVER=0;var symbolId=-1;var RED="E48585";var GREEN="83B242";var ROW_HEIGHT=20;var CSV_PARAM_KEY=0;var CSV_PARAM_V=1;var spreads;var quotes;function getSpreads(a,c,g){var d={};if(g!=undefined){showAsk=g}if(!c){showLoading()}d.symbols=getCheckBoxesValues("spreadsSymbols");d.mt4Servers=getCheckBoxesValues("spreadsServer");d.r=Math.random();var b=[spreadTomcatUrl+"/getSpreads.html"];jQuery.ajax({url:b,jsonp:"cb",dataType:"jsonp",data:d,crossDomain:true,timeout:50000,success:function(h){f(h)},error:function(h){f(h)},complete:function(h){hideLoading()}});function f(h){if(a=="brokerQuotes"){getBrokerQuotesResponse(h,a)}else{if(a=="brokerVolume"){getBrokerVolumeResponse(h,a,c)}else{getSpreadsResponse(h,a)}}}}function getSpreadsResponse(b,a){var d=0;if(a=="quotes"){d=PARAM_ASK}else{if(a=="volume"){d=PARAM_VOLUME}}clearTimeout(spreads);if(b){var c=b.split(";");c.forEach(function(q){if(q.length>0){var m=q.split(",");var g="spreadHref"+m[CSV_PARAM_KEY];var l="spreadHrefSponsor"+m[CSV_PARAM_KEY];if($PT(g)||$PT(l)){var o=m[CSV_PARAM_V].split("|");var k;if(d==PARAM_ASK){var f=parseInt($PT("symbol"+m[CSV_PARAM_KEY].split("_")[PARAM_SYMBOL]).getAttribute("decimals"));if(showAsk){k=roundNumber(o[PARAM_ASK],f)}else{k=roundNumber(parseFloat(o[PARAM_ASK])-parseFloat(o[PARAM_SPREAD]/Math.pow(10,f-1)),f)}}else{if(d==PARAM_VOLUME){k=o[d];if(k<0){return}}else{isIncludeCommission(o)?k=o[PARAM_SPREAD]:k=o[PARAM_SPREAD_WITH_COMMISSION];var h=m[CSV_PARAM_KEY].split("_")[PARAM_SYMBOL]}}if($PT(g)){$PT(g).innerHTML=k;$PT(g).className=(a=="spreads")?"spreadTd tdUnderline":"spreadTd";$PT(g).parentNode.text=k}if($PT(l)){$PT(l).innerHTML=k;$PT(l).className=(a=="spreads")?"spreadTd tdUnderline":"spreadTd";$PT(l).parentNode.text=k}}}});sortSpreadTable();spreadTableColor(a);spreads=setTimeout(function(){getSpreads(a,true)},(a=="volume")?20000:1000)}}function isIncludeCommission(a){return $PT("includeCommission")!=undefined&&(!$PT("includeCommission").checked||!hasText(a[PARAM_SPREAD_WITH_COMMISSION]))}function setCookieIncludeCommission(){setCookie("includeCommission",$PT("includeCommission").checked?"1":"0",YEAR,false)}function ChartRow(a,d,f){var c=GREEN;var b=RED;if(!f){d=d*-1}return{label:a,value:d,color:d>0?c:b}}function brokersChart(c,a,b){return{chart:{yaxisname:b,xaxisname:"",canvasbgcolor:"FFFFFF",bgcolor:"FFFFFF",bgangle:"90",numdivlines:"0",canvasborderthickness:"0",animation:"0",yAxisMinValue:c,yAxisMaxValue:a,plotGradientColor:"",plotBorderThickness:"0",showBorder:"0",plotSpacePercent:"0%"},data:[]}}function getBrokerQuotesResponse(g,c){if(g&&$PT("noData")==undefined){clearTimeout(quotes);var a=8;var r;var q;var b;var d;var f=showAsk;var k=1;var m;var l;var h=[];var s=g.split(";");s.forEach(function(w){if(w.length>0){l=w.split(",");d=l[CSV_PARAM_V].split("|");m=l[CSV_PARAM_KEY];var v=m.split("_");if($PT(m)){var u=parseInt($PT("symbol"+m.split("_")[1]).getAttribute("decimals"));if(u==1||u==2||u==3){u=3}if(u==4||u==5){u=5}r=roundNumber(d[PARAM_ASK],u);q=roundNumber(parseFloat(d[PARAM_ASK])-parseFloat(d[PARAM_SPREAD]/Math.pow(10,u-1)),u);$PT(m+"Spread").innerHTML=d[PARAM_SPREAD];$PT(m+"Ask").innerHTML=r;$PT(m+"Bid").innerHTML=q;if(parseInt(v[PARAM_SYMBOL])==symbolId){if(showAsk){b=r}else{b=q}}}if(v[PARAM_SYMBOL]==symbolId){if(parseFloat(d[PARAM_ASK])!=-1){u=parseInt($PT("symbol"+symbolId).getAttribute("decimals"));if(u==1||u==2||u==3){u=3}if(u==4||u==5){u=5}if(showAsk){param=roundNumber(b-parseFloat(d[PARAM_ASK]),u)}else{param=roundNumber(b-(parseFloat(d[PARAM_ASK])-parseFloat(d[PARAM_SPREAD]/Math.pow(10,u-1))),u)}if($PT("server"+v[0])){var t=roundNumber(param*Math.pow(10,u-1),u);h.push(new ChartRow($PT("server"+v[PARAM_SERVER]).getAttribute("serverName"),t,f));k++;if(Math.abs(t)>a){a=parseInt(Math.abs(t))}}}}}});a=a+2;var o=brokersChart("-"+a,a.toString(),"Pips");o.data=h.sort(sort_by("label",true,function(t){return t.toUpperCase()}));$PT("chartPips").setStyle("height:"+(50+k*ROW_HEIGHT)+"px");brokerPipsChart.setJSONData(o)}quotes=setTimeout(function(){getSpreads(c,true)},1000)}function getBrokerVolumeResponse(d,b,k){if(d&&$PT("noData")==undefined){clearTimeout(quotes);var a=8;var q;var c;var h=1;var f=[];var g;var m;var l;var r=d.split(";");r.forEach(function(v){if(v.length>0){l=v.split(",");m=l[CSV_PARAM_KEY];var u=m.split("_");c=l[CSV_PARAM_V].split("|");if($PT(m)){var s=parseInt(c[PARAM_VOLUME]);if(s<0){s=0}$PT(m+"Volume").innerHTML=s;if(parseInt(u[PARAM_SYMBOL])==symbolId){g=s}}if(u[PARAM_SYMBOL]==symbolId){if($PT("server"+u[PARAM_SERVER])){var t=parseInt(c[PARAM_VOLUME]);if(t<0){t=0}f.push(new ChartRow($PT("server"+u[PARAM_SERVER]).getAttribute("serverName"),t-g,true));h++;if(t>a){a=t}}}}});a=a+2;var o=brokersChart("-"+a,a.toString(),"Volume");o.data=f.sort(sort_by("label",true,function(s){return s.toUpperCase()}));$PT("chartPips").setStyle("height:"+(50+h*ROW_HEIGHT)+"px");brokerPipsChart.setJSONData(o)}if(!k){hideLoading()}quotes=setTimeout(function(){getSpreads(b,true)},60000)}function updateSpreadMenu(c,g){var d=c;if(g!=undefined&&g){$PT("spreadServer"+c).checked=true}var b=getCheckBoxesValues("spreadsSymbols");if(b.split(",").length<=10){hideElement("spreadChangedMessage");var a=$PT("pageId").getAttribute("pageId");var f=["&spreadSymbols=",b,"&servers=",getCheckBoxesValues("spreadsServer"),"&pageId=",a,"&promoteServer=",g!=undefined?d:""];fxAjax.sendRequest(fxVars.updateSpreadMenu,{params:{pageId:a},contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:f.join(""),loader:false,callback:"updateSpreadMenuResponse"});clearSortSpreadsTableParams()}else{if(!isShown($PT("spreadChangedMessage"))){$PT("spreadChangedMessage").innerHTML=$T("tOnly10Symbols");showElement("spreadChangedMessage")}if($PT("spreadSymbol"+c)){$PT("spreadSymbol"+c).checked=false}}}function updateSpreadMenuResponse(c,g){if(!c.error){var f=c.content.spreadsTable;var b=c.content.spreadsSponsorTable;var a=c.content.brokerPromoteWidget;if(f){$PT("spreadTable").innerHTML=f;if(b){$PT("spreadSponsorTable").innerHTML=b}$J("#brokerPromoteWidget").html(a);runAjaxScripts(f);SortableTable.find();if(spreadsTable!=undefined){for(var d=0;d<spreadsTable.headers.length;d++){if($PT(spreadsTable.table.id+"Img"+d)!=undefined){$PT(spreadsTable.table.id+"Img"+d).className=""}}}getSpreads(g.pageId,true)}}}function spreadTableColor(d){var h={};var o={};var l={};var c={};var b=getCheckBoxesValues("spreadsSymbols").split(",");if(b){symbolsSize=b.length}var g=$$PT("#spreadMainTable a");for(var k=0;k<g.length;k++){var q=parseFloat(g[k].innerHTML);if(!isNaN(q)&&g[k].getAttribute("tdId")){spreadValue=q;selectedSymbol=g[k].getAttribute("tdId")%symbolsSize;if(o[selectedSymbol]==null){o[selectedSymbol]=spreadValue;l[selectedSymbol]=g[k].id;h[selectedSymbol]=spreadValue;c[selectedSymbol]=g[k].id}else{if(parseFloat(o[selectedSymbol])<=parseFloat(spreadValue)){o[selectedSymbol]=spreadValue;l[selectedSymbol]=g[k].id}else{if(parseFloat(o[selectedSymbol])>parseFloat(spreadValue)&&parseFloat(h[selectedSymbol])>parseFloat(spreadValue)){h[selectedSymbol]=spreadValue;c[selectedSymbol]=g[k].id}}}}}var f;var m;if(d=="volume"||(showAsk!=undefined&&!showAsk)){f=" lightRed ";m=" lightGreen "}else{f=" lightGreen ";m=" lightRed "}var a=(d=="spreads"||d=="volume")?" tdUnderline ":"";for(var k=0;k<g.length;k++){var q=parseFloat(g[k].innerHTML);if(!isNaN(q)&&g[k].getAttribute("tdId")){spreadValue=q;selectedSymbol=g[k].getAttribute("tdId")%symbolsSize;if(o[selectedSymbol]!=null&&o[selectedSymbol]==spreadValue&&o[selectedSymbol]!=h[selectedSymbol]){g[k].parentNode.className="spreadTd"+m+a}else{if(h[selectedSymbol]!=null&&h[selectedSymbol]==spreadValue&&o[selectedSymbol]!=h[selectedSymbol]){g[k].parentNode.className="spreadTd"+f+a}else{if(h[selectedSymbol]!=null&&h[selectedSymbol]==spreadValue&&o[selectedSymbol]==spreadValue&&o[selectedSymbol]==h[selectedSymbol]){g[k].parentNode.className="spreadTd "+a}else{g[k].parentNode.className="spreadTd "+a}}}}}h=null;o=null;l=null;c=null}function getCurrentSpreadFromChart(c,b,f){var g={};g.r=Math.random();var d=c+"_"+b;var a=[spreadTomcatUrl+"/getCurrentSpreadFromChart.json?key=",d].join("");jQuery.ajax({url:a,jsonp:"cb",dataType:"jsonp",data:g,crossDomain:true,timeout:5000,success:function(h){getCurrentSpreadFromChartResponse(h,c,b,f)},error:function(h){getCurrentSpreadFromChartResponse(h,c,b,f)},complete:function(h){}})}function getCurrentVolumeFromChartResponse(a,c,b,d){if(a){var f=a.split(",");if(f[PARAM_VOLUME]>0){$PT("currentVolume").innerHTML=f[PARAM_VOLUME]}}if(d){setTimeout("getCurrentVolumeFromChart("+c+","+b+","+d+")",1000)}}function getCurrentVolumeFromChart(c,b,f){var g={};g.r=Math.random();var d=c+"_"+b;var a=[spreadTomcatUrl+"/getCurrentSpreadFromChart.json?key=",d].join("");jQuery.ajax({url:a,jsonp:"cb",dataType:"jsonp",data:g,crossDomain:true,timeout:5000,success:function(h){getCurrentVolumeFromChartResponse(h,c,b,f)},error:function(h){getCurrentVolumeFromChartResponse(h,c,b,f)},complete:function(h){}})}function getCurrentSpreadFromChartResponse(a,c,b,d){if(a){var f=a.split(",");$PT("currentSpread").innerHTML=isIncludeCommission(f)?f[PARAM_SPREAD]:f[PARAM_SPREAD_WITH_COMMISSION]}if(d){setTimeout("getCurrentSpreadFromChart("+c+","+b+","+d+")",1000)}}function selectAllBrokers(element,serverId){var selected=eval(element.getAttribute("selected"));var elements=$$PT("#serversTable input[name=spreadsServer]");for(var i=0;i<elements.length;i++){elements[i].checked=!selected}if(!selected){element.innerHTML=$T("tHideAll")}else{element.innerHTML=$T("tShowAll")}element.setAttribute("selected",!selected);updateSpreadMenu(serverId)}function sortSpreadTable(){if(sortable){var a=true;$J("#spreadMainTable tr").removeClass("bg1");sortPromotedTable(true,spreadsTable,spreadsTh,spreadsSpan,a);sortPromotedTable(false,spreadsTable,spreadsTh,spreadsSpan,a);$J("#spreadMainTable tr:odd").addClass("bg1")}}function clearSortSpreadsTableParams(){spreadsTh=null;spreadsSpan=null;spreadsTable=null;sortable=false;spreadTableStyle=false}function getSpreadsLastUpdateDate(b){var c={};c.r=Math.random();c.timeLimitColor=b;var a=[spreadTomcatUrl+"/getSpreadsLastUpdateDate.json?limitInSec=",b].join("");jQuery.ajax({url:a,jsonp:"cb",dataType:"jsonp",data:c,crossDomain:true,timeout:5000,success:function(d){getSpreadsLastUpdateDateResponse(d,b)},error:function(d){getSpreadsLastUpdateDateResponse(d,b)},complete:function(d){}})}function getSpreadsLastUpdateDateResponse(b,d){if(b){for(var c in b){var a="broker_"+c;if($PT(a)){$PT(a).innerHTML=b[c]}}}setTimeout(function(){getSpreadsLastUpdateDate(d)},30000)}function roundNumber(a,b){return(parseFloat(a)).toFixed(b).toString()}var activeSymbol;function updateSymbol(c,d,a){var b;if(d!=activeSymbol){if(isNaN(c)){b=$PT(c).getAttribute("symbolId")}else{b=c}if(parseInt(b)!=symbolId){$PT(d).setStyle({background:"#f8f8f8"});if(hasText(activeSymbol)){$PT(activeSymbol).setStyle({background:""})}$PT("symbolLabel").innerHTML=$PT(d).getAttribute("symbolName")}activeSymbol=d;symbolId=b;getSpreads(a,false)}}var sort_by=function(c,a,d){var b=function(f){return d?d(f[c]):f[c]};return function(h,g){var f=b(h),k=b(g);return((f<k)?-1:(f>k)?+1:0)*[-1,1][+!!a]}};var loading="Loading...";var lastEventId;var selectedTimeScale=60;var tradesHistory={};var openTradesHistory={};var savedBrowserChartData={candles:[],open:[],history:[]};var eventMap={};var GOLD_OID=132;var SILVER_OID=138;var XAUUSD_OID=51;var XAGUSD_OID=50;var GOLDUS_OID=2550;var TEN_DAYS_RANGE=864000;var openTradePageNum=1;var historyPageNum=1;var startDate,endDate,lastTrade;var getTradeInfo=true;var event,point;var selectedEvent,currentSymbol="";function colorTradeValue(f,d,a){var c;(d>0)?c="green":c="red";var b=new Element("span",{className:c});(a)?b.innerHTML=d+a:b.innerHTML=d;f.appendChild(b)}function formatDateTime(a,b){if(b===1){return a.getUTCDate()+"/"+(a.getUTCMonth()+1)+"/"+a.getUTCFullYear()+" "+format2Digits(a.getUTCHours())+":"+format2Digits(a.getUTCMinutes())}else{return(a.getUTCMonth()+1)+"/"+a.getUTCDate()+"/"+a.getUTCFullYear()+" "+format2Digits(a.getUTCHours())+":"+format2Digits(a.getUTCMinutes())}}function hideTradeBrowserWindow(){hideElement("tradeBrowserWindow")}function showTradeBrowserWindow(){var a={top:"62px",left:"20px"};var b=$("#tradeBrowserWindow");showElement("tradeBrowserWindow");if(!isInViewportVertically(b)||!isInViewportHorizontally(b)){b.css(a)}}function isInViewportVertically(d){var a=$(window).scrollTop();var c=a+$(window).height();var b=$(d).offset().top;var f=b+$(d).outerHeight();return b>=a&&f<=c}function isInViewportHorizontally(d){var c=$(d).offset().left;var f=c+$(d).outerWidth();var b=$(window).scrollLeft();var a=b+$(window).width();return c>=b&&f<=a}function getTradeBrowserInfo(c,b){if(haveTradeData){var f,g,a=savedBrowserChartData.candles;if(a){f=a[0][0];g=a[a.length-1][0]}if(!lastSymbol){lastSymbol=$F("tradeSymbols")}var d=["accountOid=",c,"&symbolOid=",lastSymbol,"&timeScale=",selectedTimeScale,"&lastPoint=",f,"&closeTime=",g,"&l=",b,"&invitation=",invitation];ChartUtils.toggleLoader(true);fxAjax.sendRequest(fxVars.getTradeBrowserInfo+d.join("")+buildTradeBrowserUrl(),{loader:false,callback:"getTradeBrowserInfoResponse"})}}function getTradeBrowserInfoResponse(a){try{if(!a.error){var c=a.content.data;if(c!=null&&c!==""){var f=a.content.history;var g=a.content.openTrades;var b;for(b in f){if(!tradesHistory[b]){tradesHistory[b]=f[b]}}for(b in g){if(!openTradesHistory[b]){openTradesHistory[b]=g[b]}}updateChart(c,g,null,f,null,true);(a.content.tradeHistory)?$PT("tradeHistoryPaging").innerHTML=a.content.tradeHistory:$PT("tradeHistoryPaging").innerHTML="";(a.content.openTradesHistory)?$PT("openTradesPaging").innerHTML=a.content.openTradesHistory:$PT("openTradesPaging").innerHTML=""}}}catch(d){ChartUtils.log(d)}ChartUtils.toggleLoader(false)}function getTradeConfig(b,d,g,o,k,m,h,q,r){if(r&&savedBrowserChartData.candles[0]){return}ChartUtils.createLoader();if(hasText(m)){if(m.startsWith("h")){$PT("closedTradesCheckBox").checked=true}else{$PT("openTradeCheckBox").checked=true}$PT("showEvents").checked=true}if(getTradeInfo){getTradeInfo=false;haveTradeData=true;updateTimeScale(h);hideElement("tooltip");var c="";lastSymbol=d;var f=$PT("tradeSymbol"+getFilteredSymbolId(d));if(f){f.selected="true"}if(g){c="&timeScale="+selectedTimeScale;tradesHistory={};openTradesHistory={}}else{switchTab("tabs19","tradeBrowser",$PT("tradeBrowserElement"))}var l="&symbolOid=";if(d){l+=d}var a=["accountOid=",b,l+"&selectTab=",g,"&openTime=",o,"&closeTime=",k,"&eventMarkId=",m+c,"&showOpen=",$PT("openTradeCheckBox").checked,"&showEvents=",$PT("showEvents").checked,"&l="+q,"&invitation=",invitation,"&showClose=",$PT("closedTradesCheckBox").checked];ChartUtils.toggleLoader(true);fxAjax.sendRequest(fxVars.getTradeConfigInfo+a.join("")+buildTradeBrowserUrl(),{params:{selectTab:g,eventMarkId:m,symbol:f.innerHTML},loader:false,callback:"getTradeConfigResponse"})}}function getTradeConfigResponse(a,k){getTradeInfo=true;if(!a.error){if(a.content){var f=a.content.history;var g=a.content.openTrades;var c,b;for(c in f){tradesHistory[c]=f[c]}for(b in g){openTradesHistory[b]=g[b]}if(window.chart){updateChart(a.content.data,g,a.content.eventId,f,k.symbol)}else{drawChart(a.content.data,g,f,k.symbol,k.eventMarkId)}if(!k.selectTab){showTooltip(k.eventMarkId)}else{hideElement("tradeBrowserWindow")}if(a.content.tradeHistory){$PT("tradeHistoryPaging").innerHTML=a.content.tradeHistory}if(a.content.openTradesHistory){$PT("openTradesPaging").innerHTML=a.content.openTradesHistory}var d=a.content.timeScale;if(d){updateTimeScale(d)}}}ChartUtils.toggleLoader(false)}function getTradePaging(g,c,k,f,m){var a;if(f.className.indexOf("gray")===-1){if(c==="openTradeHistory"){a="&openTradePageNum="+k;openTradePageNum=k}if(c==="tradeHistory"){a="&historyPageNum="+k;historyPageNum=k}hideElement("tooltip");var l,h,b=savedBrowserChartData.candles;if(b){l=b[0][0];h=b[b.length-1][0]}var d=["accountOid=",g,"&symbolOid=",$F("tradeSymbols"),"&openTime=",l,"&closeTime=",h,a,"&l=",m,"&invitation=",invitation,"&showEvents=",$PT("showEvents").checked,"&showOpenTrades=",$PT("openTradeCheckBox").checked,"&showClose=",$PT("closedTradesCheckBox").checked];ChartUtils.toggleLoader(true);fxAjax.sendRequest(fxVars.getTradePaging+d.join("")+buildTradeBrowserUrl(),{params:{pageType:c,pageNum:k},loader:false,callback:"getTradePagingResponse"})}}function getTradePagingResponse(b,a){if(!b.error){var k=a.pageType;var h=window.chart;var d=h.plot(0);var c;if(k==="tradeHistory"){tradesHistory={};(b.content.tradeHistory)?$PT("tradeHistoryPaging").innerHTML=b.content.tradeHistory:$PT("tradeHistoryPaging").innerHTML="";var f=b.content.history;var g=parseTrades(f,"history");configureEventSeries(h,d,savedBrowserChartData.open,g);configureHistory(d,g);for(c in f){if(!tradesHistory[c]){tradesHistory[c]=f[c]}}}if(k==="openTradeHistory"){openTradesHistory={};(b.content.openTradesHistory)?$PT("openTradesPaging").innerHTML=b.content.openTradesHistory:$PT("openTradesPaging").innerHTML="";var m=b.content.openTrades;var l=parseTrades(m,"open");configureEventSeries(h,d,l,savedBrowserChartData.history);configureOpenTrades(d,l);for(c in m){if(!openTradesHistory[c]){openTradesHistory[c]=m[c]}}}hideElement("tradeBrowserWindow")}ChartUtils.toggleLoader(false)}function showOpenTrades(a){showTradesAnnotations(a,"t");ChartUtils.toggleLoader(false)}function showClosedTrades(a){showTradesAnnotations(a,"h");ChartUtils.toggleLoader(false)}function showEvents(a){showEventsSeries(a);ChartUtils.toggleLoader(false)}function saveTradesAsPNG(c){var f=new Date(ChartUtils.getMinDate(savedBrowserChartData.candles));var b=new Date(ChartUtils.getMaxDate(savedBrowserChartData.candles));var d=$F("tradeSymbols");var a=c+"."+$PT("tradeSymbol"+d).innerHTML+" "+f.toUTCString()+"-"+b.toUTCString();ChartUtils.exportPng(a,20,-85)}function updateTimeScale(a){$PT("tradeTimeScale"+selectedTimeScale).className="tagBG";if(a!=null){selectedTimeScale=a}$PT("tradeTimeScale"+selectedTimeScale).className="tagBG bold"}function getFilteredSymbolId(a){switch(a){case GOLD_OID:case GOLDUS_OID:a=XAUUSD_OID;break;case SILVER_OID:a=XAGUSD_OID;break}return a}function buildTradeBrowserUrl(){var c=new Array();var a="";var b="";if(hasText($F("durationStart"))){a=parseInt($F("durationStart"))*parseInt($F("selectedDuration"))}if(hasText($F("durationEnd"))){b=parseInt($F("durationEnd"))*parseInt($F("selectedDuration"))}c.push("&magicNumbers=");c.push(getCheckBoxesValues("accountMagic"));c.push("&tags=");c.push(getCheckBoxesValues("accountTag"));c.push("&days=");c.push(getCheckBoxesValues("days"));c.push("&hours=");c.push(getCheckBoxesValues("hours"));c.push(getCommentBoxesValues());c.push("&buySell=");c.push(getCheckBoxesValues("buySell"));c.push("&yieldStart=");c.push($F("yieldStart"));c.push("&yieldEnd=");c.push($F("yieldEnd"));c.push("&netProfitStart=");c.push($F("netProfitStart"));c.push("&netProfitEnd=");c.push($F("netProfitEnd"));c.push("&durationStart=");c.push(a);c.push("&durationEnd=");c.push(b);c.push("&takeProfitStart=");c.push($F("takeProfitStart"));c.push("&takeProfitEnd=");c.push($F("takeProfitEnd"));c.push("&stopLoss=");c.push($F("stopLoss"));c.push("&stopLossEnd=");c.push($F("stopLossEnd"));c.push("&sizingStart=");c.push($F("sizingStart"));c.push("&sizingEnd=");c.push($F("sizingEnd"));c.push("&selectedTime=");c.push(getCheckBoxesValues("selectedTime"));c.push("&pipsStart=");c.push($F("pipsStart"));c.push("&pipsEnd=");c.push($F("pipsEnd"));c.push(getCommentsOptions("commentOption"));return c.join("")}function drawChart(a,c,m,b,l){a=ChartUtils.checkData(a,"");c=ChartUtils.checkData(c,{});b=ChartUtils.checkData(b,"");try{currentSymbol=b.replace("/","");var o=parseChartData(a);var d=parseTrades(c,"open");var k=parseTrades(m,"history");var h=ChartUtils.initChart("chartContainer",[0,2,0,2],35,35);var g=ChartUtils.plot(h,"right",460,0,true);configureScroller(h,o);configureLabels(g.xAxis(),g.yAxis());configureSeries(g,o,b);configureEventSeries(h,g,d,k);configureOpenTrades(g,d);configureHistory(g,k);configureLegend(g.legend());ChartUtils.label(h,-220,true,o,getTimeFormat()+"yy HH:mm");ChartUtils.drawChart(h);selectBrowserChartRange(l,d.concat(k),o,h)}catch(f){ChartUtils.log(f)}ChartUtils.toggleLoader(false)}function configureOpenTrades(d,b){var a=d.annotations();removeTradesAnnotations("t");var c=new Date();b.forEach(function(g){var f=a.line({xAnchor:g.openTime,valueAnchor:g.openValue,secondXAnchor:c.getTime()+31536000000*2,secondValueAnchor:g.openValue,allowEdit:false,color:g.key});configureLineAnnotation(f,g)});if(!$PT("openTradeCheckBox").checked){showTradesAnnotations(false,"t")}}function configureHistory(c,b){var a=c.annotations();removeTradesAnnotations("h");b.forEach(function(f){var d=a.line({xAnchor:f.openTime,valueAnchor:f.openValue,secondXAnchor:f.closeTime,secondValueAnchor:f.closeValue,allowEdit:false,color:f.key});configureLineAnnotation(d,f)});if(!$PT("closedTradesCheckBox").checked){showTradesAnnotations(false,"h")}}function configureLineAnnotation(b,d){var a=["blue","red"];var f=a[d.action];b.maxHeight(d.id).zIndex(1);b.normal().stroke(f,1,"5 2");b.selected().stroke(f,3,"6 2").markers().size(8);b.markers().enabled(true).fill(f).type("triangle-right").stroke("1 #fff")}function configureEventSeries(c,f,a,d){showEventsSeries(false);f.eventMarkers({groups:groupEvents(a.concat(d))});eventsOnClick(c);var b=f.eventMarkers();if(b.position()!=="series"){ChartUtils.eventMarkers(f,"#fff").fill("#f2f2f2").selected({fill:"#68a4eb"}).hovered({stroke:{color:"#68a4eb",thickness:2}})}if($PT("showEvents").checked){showEventsSeries(true)}else{showEventsSeries(false)}return b}function configureSeries(d,c,a){var b=d.candlestick(c);b.name(a).risingFill("#dedede").risingStroke("#cecece").fallingFill("#b7b7b7").fallingStroke("#cecece").legendItem({iconFill:"#0084ff",fontColor:"#0084ff",fontWeight:600,fontSize:10});updateYMax(b.yScale(),c);return b}function configureLabels(b,a){a.drawFirstLabel(false).drawLastLabel(false).ticks({stroke:"#000",length:4}).labels({fontSize:10,fontColor:"#000",format:"{%value}{decimalsCount:4, zeroFillDecimals:true}",offsetX:30,offsetY:-2,zIndex:200,position:"right"});b.labels({fontSize:9,fontColor:"#595959",fontWeight:600,offsetY:-2,height:15}).minorLabels({fontSize:9,fontColor:"#595959",fontWeight:600,offsetY:-2})}function configureLegend(a){ChartUtils.legend(a).margin(0).title().useHtml(true);a.titleFormat(ChartUtils.legendTitleFormat(a,"",getTimeFormat()+"yyyy HH:mm",3));ChartUtils.legendItemFormat(a,4,0)}function configureScroller(a,b){var c;c=function(d){if(d.startRatio===0&&d.source==="selected-range-drag"){getTradeBrowserInfo(getAccountOid(),getLocation())}};ChartUtils.scroller(a,b,c)}function groupEvents(b){var a=[];eventMap={};b.forEach(function(h,d){var g=h.action===0?"B":"S";var c=h.closeTime?"red":"blue";a.push({format:g,data:{data:[{date:h.openTime,description:h.key,title:c,format:g}]},fontColor:c});eventMap[h.key]=d});return a}function eventsOnClick(a){a.removeAllListeners("eventMarkersSelect");a.listen("eventMarkersSelect",function(c){var b=c.eventMarker.description;unselectEvent();if(b===selectedEvent){if($("#tradeBrowserWindow").css("display")==="none"){showTooltip(b);selectEvent(b)}else{unselectTrades();hideTradeBrowserWindow();selectedEvent=""}}else{showTooltip(b);selectTrade(b);selectEvent(b)}c.preventDefault()})}function selectTrade(f){var b=window.chart.plot(0).annotations();var g=b.getAnnotationsCount();unselectTrades(b);var d=0;for(d;d<g;d++){var a=b.getAnnotationAt(d);var h=a.stroke().color;if(a.color()===f){a.zIndex(1000).stroke(h,3,"6 2").markers().size(8)}else{a.zIndex(1).stroke(h,1,"5 2").markers().size(5)}}}function unselectTrades(b){var a=b||window.chart.plot(0).annotations();a.unselect()}function selectEvent(a){try{window.chart.plot(0).eventMarkers().group(eventMap[a]).fill("#68a4eb");selectedEvent=a}catch(b){ChartUtils.log(b)}}function unselectEvent(){try{window.chart.plot(0).eventMarkers().group(eventMap[selectedEvent]).fill("#f2f2f2")}catch(a){ChartUtils.log(a)}}function updateChart(a,f,b,o,d,c){a=ChartUtils.checkData(a,"");f=ChartUtils.checkData(f,{});o=ChartUtils.checkData(o,{});d=ChartUtils.checkData(d,"");currentSymbol=d.replace("/","");var s,m,q;if(!jQuery.isEmptyObject(a)&&a!==""){s=parseChartData(a,c);m=parseTrades(f,"open");q=parseTrades(o,"history")}else{s=[];m=[];q=[]}var r=m.concat(q);while(s.length>0&&s[s.length-1]===undefined){s.pop()}try{var l=window.chart;var k=l.plot(0);var g=k.getSeries(0);if(d){g.name(d)}g.data(s);configureScroller(l,s);configureEventSeries(l,k,m,q);configureOpenTrades(k,m);configureHistory(k,q);updateYMax(g.yScale(),s);selectBrowserChartRange(b,r,s,l)}catch(h){ChartUtils.log(h)}}function selectBrowserChartRange(c,g,f,b){var h,a;if(c){var d=g.find(function(k){return k.key===c});if(d){h=d.openTime-TEN_DAYS_RANGE;a=d.openTime+TEN_DAYS_RANGE;selectEvent(c);selectTrade(c)}}else{h=ChartUtils.getMinDate(f);a=ChartUtils.getMaxDate(f)}b.selectRange(h,a)}function updateYMax(c,b){var a=Array.max(b.map(function(d){return d[4]||0}))*1.01;c.maximum(a)}function showEventsSeries(b){try{var d=window.chart.plot(0).eventMarkers();var c;var a=Object.keys(eventMap).length;for(c=0;c<a;c++){ChartUtils.showEventsSeries(d,b,c);if(!b){hideTradeBrowserWindow()}}}catch(f){ChartUtils.log(f)}}function showTradesAnnotations(c,g){var b=window.chart.plot(0).annotations();var f=b.getAnnotationsCount();for(var d=0;d<f;d++){var a=b.getAnnotationAt(d);if(a.color().charAt(0)===g){a.enabled(c)}}}function removeTradesAnnotations(f){var b=window.chart.plot(0).annotations();var d=b.getAnnotationsCount();for(var c=0;c<d;c++){var a=b.getAnnotationAt(c);if(a&&a.color().charAt(0)===f){b.removeAnnotationAt(c)}}}function parseChartData(d,a){var c=d.split(";").map(function(h){var g=[];var f=h.split(",");f.forEach(function(k){g.push(Number(k))});return g}).sort(function(g,f){if(g[0]>f[0]){return 1}if(g[0]<f[0]){return -1}return 0});c.splice(0,1);var b=c.length-1;if(b>-1){while(c[b][1]===0){c[b][1]=undefined;c[b][2]=undefined;c[b][3]=undefined;c[b][4]=undefined;b--}}if(a){c=c.concat(savedBrowserChartData.candles)}savedBrowserChartData.candles=c;return c}function parseTrades(d,c){var a=["blue","red"];var b=Object.keys(d).map(function(g){var f=d[g];return{openTime:f.openTime,openValue:f.openValue,closeTime:f.closeTime,closeValue:f.closeValue,color:a[f.action],id:f.oid,action:f.action,key:g}});savedBrowserChartData[c]=b;return b}var Jlinker={createLinker:function(c,a){var b=a==null?$J(".linker"):$J("#"+a);this.createLinkerByElement(c,b)},createLinkerByElement:function(b,a){a.each(function(){var c="(?!(?:(?!</?[aA].*?>).)*?</[aA].*?>)(?![^<>]*>)";Jlinker.initLinkerProcess(b,this,c)})},initLinkerProcess:function(c,a,b){c.each(function(h){var d=new RegExp("\\b"+h.word+"\\b","i");var g=a.innerHTML.match(d);if(g!=null){var f=$J.unique(g);f.each(function(k){if(h.link!="warning"){a.innerHTML=a.innerHTML.replace(new RegExp("\\b"+k+"\\b"+b),"<a href="+h.link+' title="'+h.link+'" class="underline" target="_blank">'+k+"</a>")}else{a.innerHTML=a.innerHTML.replace(new RegExp('href="'+k+'"'),'href="'+serverPath+"/warningPage.html?link="+encodeParameter(k)+'"')}})}})},destroyLinker:function(){$J(".linker a").each(function(){this.outerHTML=this.textContent})}};var chartsDivs=["topAbsoluteCorrelationChart","topPositiveCorrelationChart","topNegativeCorrelationChart"];var symbolElementsMap={};var elementsSparksMap={};var sparkRangeSize=15;var symbolAnalysisCandleLimit=100;var lastClose=0;var dataTable;var timeScales=[1,5,15,30,60,240,1440,10080,43200];var quotesVolatilitySymbols=[];var chartsTypes=["1","2","3"];var colors=["#cce6fa","#f6d263"];var mainChartSymbol="";var correlationSymbolsMap=[];var quotesHeatMapSymbols=[];var isFirefox=window.dhtmlHistory.isFirefox;var isEdge=isIEOrEdge();var TIME_SCALE_D1=1440;function roundNumber(a,b){return Number(a).toFixed(b)}function roundNumberBySymbolDecimals(a,b){return roundNumber(a,((b==2||b==4)?b=b+1:b))}function calculatePips(d,b,a){var c=d-b;return roundNumber(c*Math.pow(10,(a==5||a==4)?(4):(a==2||a==3)?(2):(a)),1)}function calculatePercents(b,a,c){return roundNumber((b-a)/a*100,c)}function changePipsAndPercentColor(a,b){if(b>=0){a.className="green"}else{a.className="red"}}function changeValueColor(a,c,b){if(c<b){a.className="lightGreen radius3 padd5"}if(c>b){a.className="lightRed radius3 padd5"}}function changeElementValueColor(a,b){var c=$AT(a,"value");if(c<b){a.className="lightGreen radius3 paddlr5"}if(c>b){a.className="lightRed radius3 paddlr5"}}function quotesChannelResponse(k){var m=k[5];var s=k[8];var r=k[7];var f=k[6];var c=(hasText(k[1]))?symbolOidToNameMap[k[1]]:null;var a=symbolElementsMap[c];var b=parseInt($AT(a[0],"decimals"));var q=calculatePips(s,m,b);var d=calculatePercents(s,m,2);for(var h=0;h<a.length;h++){var g=a[h];var l=$AT(g,"value");if(hasText(l)){updateSymbolRange(c,m,f,r,s);var t=g.attributes.name.value;if(t=="high"+c){g.setAttribute("value",f);g.innerHTML=roundNumberBySymbolDecimals(f,b)}else{if(t=="low"+c){g.setAttribute("value",r);g.innerHTML=roundNumberBySymbolDecimals(r,b)}else{if(t=="changePips"+c){g.setAttribute("value",q);g.parentNode.text=q;g.innerHTML=(q>=0?"+":"")+q;changePipsAndPercentColor(g,q)}else{if(t=="changePercent"+c){g.setAttribute("value",d);g.parentNode.text=d;g.innerHTML=(d>=0?"+":"")+d+"%";changePipsAndPercentColor(g,d)}else{if(t=="open"+c){g.setAttribute("value",m);g.innerHTML=roundNumberBySymbolDecimals(m,b)}else{if(t=="close"+c){changeValueColor(g,l,s);g.setAttribute("value",s);g.innerHTML=roundNumberBySymbolDecimals(s,b);var o=elementsSparksMap["spark"+c][elementsSparksMap["spark"+c].length-1];if(o!=s){elementsSparksMap["spark"+c].push(s);if(elementsSparksMap["spark"+c].length>sparkRangeSize){elementsSparksMap["spark"+c].splice(0,1)}setSparkLine("#spark"+c,elementsSparksMap["spark"+c])}}}}}}}}}}function getSymbolAnalysisConfig(a){ChartUtils.createLoader();fxAjax.sendRequest(fxVars.getSymbolAnalysisConfig+a,{params:{symbol:a},callback:"getSymbolAnalysisConfigResponse"})}function getSymbolAnalysisConfigResponse(a,c){if(!a.error){var b=a.content.config;$J("#chartTooltipEvents").html(a.content.toolTips);createSymbolAnalysisChart(a.content.data,a.content.calendarMap,a.content.markets,c.symbol,a.content.decimalCount)}}function getSymbolAnalysisByTime(d,c,b){var f=$J(".tagBG.bold.radius2")[0];if(b!=f){ChartUtils.toggleLoader(true);var g=marketObject.getFirstDate();var a=marketObject.getLastDate();f.className="tagBG radius2";fxAjax.sendRequest(fxVars.getSymbolAnalysis+d+"&symbols="+c,{params:{time:d,symbol:c,start:g,end:a},callback:"getSymbolAnalysisByTimeResponse"})}}function getSymbolAnalysisByTimeResponse(a,b){if(!a.error){updateChartByTimeFrame(a.content.data,b.symbol,b.time);$PT("symbolAnalysisTimeScale"+b.time).className="tagBG bold radius2"}}function symbolAnalysisChannelResponse(v){var k=v[5];var m=v[8];var w=v[7];var d=v[6];var c=Number(v[4]);var s=v[2];var b=0;var r=(hasText(v[1]))?symbolOidToNameMap[v[1]]:null;var l=(hasText(v[9]))?Number(v[9])+(userTime):null;var g=marketObject.getChartById("main");var q=$J(".tagBG.bold")[0];var h=$PT("symbolAnalysisPips");var x=parseInt(h.attributes.decimals.value);var a=$PT("symbolAnalysisRange"+s);updateSymbolRange(r,k,d,w,m,s);if(s==TIME_SCALE_D1){var t=$PT("symbolAnalysisBid");changeElementValueColor(t,m);t.setAttribute("value",m);var o=$PT("symbolAnalysisPercent");var u=calculatePercents(m,k,2);var f=calculatePips(m,k,x);t.innerHTML=roundNumberBySymbolDecimals(m,x);o.innerHTML=(u>=0?"+":"")+u+"%";changePipsAndPercentColor(o,u);h.innerHTML=(f>=0?"+":"")+f+" pips";changePipsAndPercentColor(h,f)}updateLastPoint(s,q,r,c,b,l,k,d,w,m)}function createSymbolAnalysisChart(b,l,k,a,h){try{var g=ChartUtils.initChart("chartContainer",[0,1,0,1.5],2,1);var f=ChartUtils.plot(g,"left",null,0,true);configureGrid(f);configureMarketSeries(f,b,a);configureCrosshairLabels(g,h);configureSymbolAnalysisLegend(f.legend(),h);configureAxis(f.xAxis(),f.yAxis(),h);configurePriceIndicator(f,h);configureEvents(f,l,k);var c=ChartUtils.scroller(g,mapData(b,true));c.outlineStroke({color:"#000",thickness:1});ChartUtils.label(g,-150,false);ChartUtils.changeFontWeight(400,[f.legend(),g.label(),f.xAxis().labels(),f.xAxis().minorLabels()]);ChartUtils.drawChart(g);showMarketEvents(false,1);selectRange(g,b,30)}catch(d){ChartUtils.log(d)}ChartUtils.toggleLoader(false)}function configureGrid(c){var b="1 #000",a={drawFirstLine:false,drawLastLine:false,stroke:{color:"#CECECE",dash:"6 3"}};c.xGrid(a);c.yGrid(a);c.xMinorGrid(a);c.yAxis(0).stroke(b);c.yAxis(1).stroke(b);c.dataArea().background({topStroke:b,bottomStroke:b,rightStroke:b,leftStroke:b})}function configureMarketSeries(d,c,b){var a=d.removeAllSeries().candlestick(mapData(c,false));a.allowPointSettings(true);ChartUtils.candleSeries(a,b,"#2dcc2d","#ff0000")}function configureEvents(d,b,a){var c=ChartUtils.eventMarkers(d,"#666666");c.hovered({stroke:"1 #000",fontColor:"#000"});c.group(0,b).format("E");c.group(1,a).format("N");c.listen("eventMarkerMouseOver",function(k){var h=k.eventMarker.description;if(eventOn!=h){eventOn=h;var g,l;if(isFirefox){var f=k.originalEvent.originalEvent.target.getCurrentPoint();g=f.x;l=f.y}else{g=k.originalEvent.offsetX;l=k.originalEvent.offsetY}updateTooltip(g,l,h)}});c.listen("eventMarkerMouseOut",function(){hideTooltip();eventOn=0});c.listen("eventMarkerClick",function(g){var f=$J("#"+g.eventMarker.description+"url");window.open(f.val())})}function configureSymbolAnalysisLegend(c,b){var a=ChartUtils.legend(c);ChartUtils.legendTitleFormat(a,"","MMM dd, yyyy HH:mm",0);ChartUtils.legendItemFormat(a,b,0)}function configureCrosshairLabels(b,c){var d=isEdge||isFirefox?[0,4]:[2,5];var a={enabled:true,height:15,padding:d,fontSize:9,background:{fill:"#000"},hAlign:"center",format:function(){if(typeof this.value==="string"){return ChartUtils.formatDate(this.rawValue,"MMM d, yyyy HH:mm")}return ChartUtils.formatNumber(this.value,c)}};b.crosshair().xLabel(a).yLabel(a).xStroke("#595959",1).yStroke("#595959",1)}function configureAxis(d,b,c){var f=isEdge||isFirefox?-4:-2;var a=isEdge||isFirefox?32:26;b.orientation("right").ticks({stroke:"#000",length:4}).labels({fontSize:10,fontColor:"#000",format:"{%value}{decimalsCount:"+c+", zeroFillDecimals:true}",offsetX:a,offsetY:-2,zIndex:200,position:"right"});d.height(16).labels({fontSize:9,fontColor:"#595959",fontWeight:600,offsetY:f}).minorLabels({fontSize:9,fontColor:"#595959",fontWeight:600,offsetY:f})}function configurePriceIndicator(c,a){var b=isEdge||isFirefox?[0,4]:[2,4];c.priceIndicator().value("series-end").label({fontColor:"#fff",format:"{%value}{decimalsCount:"+a+", zeroFillDecimals:true}",fontSize:9,vAlign:"middle",height:15,padding:b,background:{fill:"#000",corners:4,stroke:false}})}function updateLastPoint(o,k,f,c,h,b,l,g,q,r){try{if(o===k.attributes.timeScale.value&&window.chart.plot().getSeriesAt(0).name().indexOf(f)>=0){var a=[],d=c+(userTime)-h*1000*60;if(b!=null){a=[b,undefined,undefined,undefined,undefined]}if(lastClose!=r){a=[d,l,g,q,r]}lastClose=r;addPoint(a)}}catch(m){ChartUtils.log(m)}}function updateChartByTimeFrame(c,b,a){try{chart=window.chart;configureMarketSeries(chart.plot(),c,b);ChartUtils.scroller(chart,mapData(c,true));selectRange(chart,c,a);ChartUtils.toggleLoader(false)}catch(d){ChartUtils.log(d)}}function addPoint(a){try{dataTable.addData([a])}catch(b){ChartUtils.log(b)}}function mapData(c,a){var b;if(a){b=dataTable.mapAs({value:1})}else{dataTable=anychart.data.table();dataTable.addData(c);b=dataTable.mapAs({open:1,high:2,low:3,close:4})}return b}function selectRange(a,c,b){end=ChartUtils.getMaxDate(c);start=end-getDeltaTime(b);a.selectRange(start,end)}function getDeltaTime(a){return a*60*1000*symbolAnalysisCandleLimit}function showMarketEvents(a,c){try{var b=window.chart;ChartUtils.showEventsSeries(b.plot().eventMarkers(),a,c)}catch(d){ChartUtils.log(d)}}function volatilityChannelResponse(m){var q=m[5];var u=m[8];var t=m[7];var k=m[6];var d=Number(m[4]);var s=m[2];var g=(hasText(m[1]))?symbolOidToNameMap[m[1]]:null;var h=$PT("symbol"+g);var l=$PT(g+"TimeScale"+s);var o=$AT(l,"value");var c=parseInt($AT(h,"decimals"));var f=calculatePips(k,t,c);var a=$F("lowVolatility");var r=$F("highVolatility");if($PT("pipsVolatility").checked){if(o!=f){l.setAttribute("value",f);l.innerHTML=f;compareTableValues(parseFloat(a),parseFloat(r),l,f)}}else{var b=calculatePercents(k,t,2);if(o!=b){l.setAttribute("value",b);l.innerHTML=b+"%";compareTableValues(parseFloat(a),parseFloat(r),l,b)}}l.setAttribute("high",k);l.setAttribute("low",t)}function updateSymbolRange(b,g,c,l,o,h){var q=150;var a=(o-g)/(c-l)*q;var f;var m=o-g;if(m>=0){f="#6fd265"}else{f="#fa8482"}var k=(g-l)/(c-l)*q;var d=k+a;if(a<0){a=a*-1;k=k-a}elem1=$PT("trend"+b+((h!=null)?h+"":""));elem1.style.width=a+"px";elem1.style.left=k+"px";elem1.style.background=f;elem1=$PT("pos"+b+((h!=null)?h+"":""));elem1.style.left=d+"px"}function updateMarketMenu(){var a=$PT("pageId").getAttribute("pageId");var b=getCheckBoxesValues("marketSymbols");var c=["&symbols=",b,"&pageId=",a];fxAjax.sendRequest(fxVars.updateMarketSymbolMenu,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:c.join(""),loader:false,params:{pageId:a},callback:"updateMarketMenuResponse"})}function updateMarketMenuResponse(b,f){if(!b.error){var d;var a;if(f.pageId=="forexMarket"){a=b.content.marketCurrenciesTable;if(hasText(a)){$PT("marketCurrenciesTable").innerHTML=a;d=$PT("symbolMarket")}symbolElementsMap={};setSymbolElementsMap(b.content.symbols);setSparkLine(".marketSparkline",[1,1])}else{if(f.pageId=="forexMarketVolatility"){a=b.content.marketVolatilityTable;if(hasText(a)){$PT("marketVolatilityTable").innerHTML=a;runAjaxScripts(a);d=$PT("symbolMarketVolatility")}quotesVolatilitySymbols=[];setVolatilitySymbols(b.content.symbols);if($PT("percentVolatility").checked){changeVolatilityPipsOrPercent("percentVolatility")}findVolatility()}else{if(f.pageId=="forexMarketHeatMap"){a=b.content.marketHeatMapTable;if(hasText(a)){$PT("marketHeatMapTable").innerHTML=a;runAjaxScripts(a);d=$PT("symbolMarketHeatMap");updateHeatMapColor(null)}quotesHeatMapSymbols=[];setHeatMapSymbols(b.content.symbols);if($PT("percentHeatMap").checked){changeHeatMapPipsOrPercent("percentHeatMap")}}}}for(var c=0;c<getHeaders(d).length;c++){if($PT(d.id+"Img"+c)!=undefined){$PT(d.id+"Img"+c).className=""}}SortableTable.find();notificationTip()}}function selectAllMarketSymbols(element){var selected=eval(element.getAttribute("selected"));var elements=$$PT("#symbolsTable input[name=marketSymbols]");for(var i=0;i<elements.length;i++){elements[i].checked=!selected}if(!selected){element.innerHTML=$T("tHideAll")}else{element.innerHTML=$T("tShowAll")}element.setAttribute("selected",!selected);updateMarketMenu()}function getTableRows(a){return $A(a.rows).map(function(b){return $PT(b)})}function getHeaders(b){var a=getTableRows(b).shift();return $J(a).find("th").toArray()}function setSymbolElementsMap(b){for(var d=0;d<b.length;d++){var a=[];symbolElementsMap[b[d]]=$$PT('#symbolMarket span[name="symbol'+escapeSelector(b[d])+'"], #symbolMarket span[name="open'+escapeSelector(b[d])+'"], #symbolMarket span[name="high'+escapeSelector(b[d])+'"], #symbolMarket span[name="low'+escapeSelector(b[d])+'"], #symbolMarket span[name="close'+escapeSelector(b[d])+'"], #symbolMarket span[name="changePips'+escapeSelector(b[d])+'"], #symbolMarket span[name="changePercent'+escapeSelector(b[d])+'"]');var c=$PT("spark"+b[d]);if(c!=undefined){a.push($AT(c,"value"));elementsSparksMap["spark"+b[d]]=a}}}function getHistoricalDataByDate(c,g,f){if(!isValidDate(userFormatToDefaultFormat($F("startDate"),c))){$PT("startDate").value=$PT("startDate").defaultValue}if(!isValidDate(userFormatToDefaultFormat($F("endDate"),c))){$PT("endDate").value=$PT("endDate").defaultValue}var k=userFormatToDefaultFormat($F("startDate"),c);var b=userFormatToDefaultFormat($F("endDate"),c);var a=new Date(k);var h=new Date(b);var d=["&start=",getDbTimeFormat(a),"&end=",getDbTimeFormat(h),"&symbol=",g,"&timeScale=",f,"&userTimeFormat=",c];if(a>h){inlineMsg("startDate",$T("tStartBeforeEnd"),3)}else{fxAjax.sendRequest(fxVars.getHistoricalDataByDate+d.join(""),{loader:true,callback:"getHistoricalDataByDateResponse"})}}function getHistoricalDataByDateResponse(a,f){var b=a.error;var c=a.message;var g=a.content.historyData;var d=$PT("historyData");if(!b){if(g!=undefined){d.innerHTML=g;$PT("startDate").value=a.content.startDate;$PT("endDate").value=a.content.endDate;SortableTable.find()}else{d.innerHTML="<div class='padd10 font12 center'><span class='information'>"+c+"</span></div><br/>"}}}function historicalSymbolChannelResponse(f){var g=f[5];var c=f[6];var l=f[7];var o=f[8];var d=$PT("symbolHistoryPips");var h=$PT("symbolHistoryBid");var m=$PT("symbolHistoryPercent");var a=parseInt(d.attributes.decimals.value);var b=calculatePercents(o,g,2);var k=calculatePips(o,g,a);changeElementValueColor(h,o);h.setAttribute("value",o);h.innerHTML=roundNumberBySymbolDecimals(o,a);m.innerHTML=(b>=0?"+":"")+b+"%";changePipsAndPercentColor(m,b);d.innerHTML=(k>=0?"+":"")+k+" pips";changePipsAndPercentColor(d,k)}function setVolatilitySymbols(a){for(var c=0;c<a.length;c++){var b=$PT("symbol"+a[c]);if(b!=undefined){quotesVolatilitySymbols.push($AT(b,"name"))}}cleanVolatilityElementsColor()}function findVolatility(){cleanVolatilityElementsColor();var a=$F("lowVolatility");var b=$F("highVolatility");if(isNaN(a)&&a!=""){inlineMsg("lowVolatility",$T("tYouMustEnterValidNumber"),3)}if(isNaN(b)&&b!=""){inlineMsg("highVolatility",$T("tYouMustEnterValidNumber"),3)}findAndChangeVolatilityColor(parseFloat(a),parseFloat(b))}function compareTableValues(c,a,b,d){if(c>=d){b.className="lightRed radius3 padd5"}else{if(a<=d){b.className="lightGreen radius3 padd5"}else{b.className=""}}}function findAndChangeVolatilityColor(d,g){for(var c=0;c<quotesVolatilitySymbols.length;c++){for(var a=0;a<timeScales.length;a++){var b=$PT(quotesVolatilitySymbols[c]+"TimeScale"+timeScales[a]);var f=parseFloat($AT(b,"value"));compareTableValues(d,g,b,f)}}}function cleanVolatilityElementsColor(){for(var c=0;c<quotesVolatilitySymbols.length;c++){for(var a=0;a<timeScales.length;a++){var b=$PT(quotesVolatilitySymbols[c]+"TimeScale"+timeScales[a]);if(b!=undefined){b.className=""}}}}function changeVolatilityPipsOrPercent(l){cleanVolatilityElementsColor();for(var h=0;h<quotesVolatilitySymbols.length;h++){for(var g=0;g<timeScales.length;g++){var k=$PT(quotesVolatilitySymbols[h]+"TimeScale"+timeScales[g]);if(k.getAttribute("value")!="-"){var m=parseFloat($AT(k,"value"));var d=parseFloat($AT(k,"high"));var c=parseFloat($AT(k,"low"));var a=parseFloat($AT(k,"decimals"));if(l=="pipsVolatility"){$PT("type1").innerHTML="pips";$PT("type2").innerHTML="pips";var f=calculatePips(d,c,a);k.setAttribute("value",f);k.innerHTML=f;$J(k).closest("td").attr("val",f)}else{$PT("type1").innerHTML="%";$PT("type2").innerHTML="%";var b=calculatePercents(d,c,2);k.setAttribute("value",b);k.innerHTML=b+"%";$J(k).closest("td").attr("val",b)}}}}}function symbolVolatilityChannelResponse(f){var g=f[5];var c=f[6];var l=f[7];var o=f[8];var d=$PT("symbolVolatilityPips");var h=$PT("symbolVolatilityBid");var m=$PT("symbolVolatilityPercent");var a=parseInt(d.attributes.decimals.value);var b=calculatePercents(c,l,2);var k=calculatePips(c,l,a);changeElementValueColor(h,o);h.setAttribute("value",o);h.innerHTML=roundNumberBySymbolDecimals(o,a);m.innerHTML=(b>=0?"+":"")+b+"%";changePipsAndPercentColor(m,b);d.innerHTML=(k>=0?"+":"")+k+" pips";changePipsAndPercentColor(d,k)}function analyzeVolatility(d,f){var b=getAttributeByRadioChecked("volatilityRadio","volatilityRadioType");for(var a=0;a<chartsTypes.length;a++){var c=["chartType=",chartsTypes[a],"&symbol=",d,"&type=",b,buildVolatilityChartsUrl(d)];fxAjax.sendRequest(fxVars.volatilityCharts+c.join(""),{params:{chartType:chartsTypes[a],isChangeType:f,symbol:d,type:b},loader:true,callback:"analyzeVolatilityResponse"})}}function analyzeVolatilityResponse(a,b){if(!a.error){var c="";switch(b.chartType){case"1":updateVolatilityChart($("#hourlyVolatilityChart").highcharts(),a.content.updatedChartData,b.type,b.symbol,a.content.categories,b.chartType);c="afterHourly";break;case"2":c="afterWeek";updateVolatilityChart($("#weekDailyVolatilityChart").highcharts(),a.content.updatedChartData,b.type,b.symbol,a.content.categories,b.chartType);break;case"3":c="afterMonth";updateVolatilityChart($("#monthDailyVolatilityChart").highcharts(),a.content.updatedChartData,b.type,b.symbol,a.content.categories,b.chartType);break}if(!b.isChangeType){setVolatilityStatAnalyze(a.content.afterAnalyzeData,c,b.symbol)}}reloadAds()}function getVolatilityChart(c,f,g,a){var b=getAttributeByRadioChecked("volatilityRadio","volatilityRadioType");var d=["chartType=",c,"&symbol=",f,"&type=",b,buildVolatilityChartsUrl(f)];fxAjax.sendRequest(fxVars.volatilityCharts+d.join(""),{params:{container:a,chartType:c,isChangeType:g,symbol:f},loader:true,callback:"getVolatilityChartResponse"})}function getVolatilityChartResponse(a,d){if(!a.error){var f="";var c=a.content.beforeAnalyzeData;switch(d.chartType){case"1":try{createVolatilityChart(d.container,a.content.updatedChartData,a.content.categories,d.chartType)}catch(b){ChartUtils.log(b)}f="afterHourly";break;case"2":f="afterWeek";try{createVolatilityChart(d.container,a.content.updatedChartData,a.content.categories,d.chartType)}catch(b){ChartUtils.log(b)}break;case"3":f="afterMonth";try{createVolatilityChart(d.container,a.content.updatedChartData,a.content.categories,d.chartType)}catch(b){ChartUtils.log(b)}break}if(!d.isChangeType){setVolatilityStatAnalyze(a.content.afterAnalyzeData,f,d.symbol)}}}function createVolatilityChart(a,d,b,c){var f=parseVolatilityResponse(d,b,c);if(c==2){b=b.map(function(g){return Highcharts.defaultOptions.lang.weekdays[Number(g)-1]})}Highcharts.chart(a,{chart:{className:"Pips",labelSymbol:"",spacing:[15,10,5,10]},series:f,xAxis:{categories:b,title:false,tickWidth:0,labels:{style:{color:"black",letterSpacing:"-1px",fontSize:"9px",}}},yAxis:{title:false,minorGridLineWidth:40,minorGridLineColor:"black",labels:{formatter:function(){return this.value+this.chart.options.chart.labelSymbol},style:{fontSize:"10px"},x:-4}},plotOptions:{series:{animation:!isIEOrEdge(),},column:{borderWidth:0,groupPadding:0.1,states:{hover:{brightness:0}},}},tooltip:{formatter:function(){return Highcharts.numberFormat(this.y,4)+this.series.chart.options.chart.labelSymbol+" "+this.series.name+" "+this.series.chart.options.chart.className},shadow:false,followPointer:true,hideDelay:150,backgroundColor:"#575454",borderColor:"#575454",borderRadius:5,padding:2,style:{color:"white",height:"20px",fontSize:"10px"},shape:"square"},legend:{itemStyle:{fontSize:"10px",fontWeight:"normal"},padding:0,itemMarginTop:0,itemMarginBottom:8,},credits:{enabled:false},scrollbar:{enabled:false},title:false,})}function parseVolatilityResponse(a,h){var m=[];try{var f,s,d,g,q,o,r,t=Object.keys(a);var b=t.length;for(f=0;f<b;f++){s=t[f];d=a[s];g={type:"column",name:s,data:[],color:colors[f],};r=h.length;for(o=0;o<r;o++){q=h[o];g.data.push(d[q]?d[q]:null)}m.push(g)}}catch(k){}return m}function updateVolatilityChart(k,a,o,d,h,m){var m,b,g,c;var q=parseVolatilityResponse(a,h);if(m==2){h=h.map(function(l){return Highcharts.defaultOptions.lang.weekdays[Number(l)-1]})}if(o==="1"){m="Pips";b=""}else{m="Percents";b="%"}while(k.series.length>0){k.series[0].remove(true)}if(q[0].name!=d){var f=q[1];q[1]=q[0];q[0]=f;q[0].color=colors[0];q[1].color=colors[1]}c=q.length;for(g=0;g<c;g++){k.addSeries(q[g])}k.update({chart:{className:m,labelSymbol:b},xAxis:{categories:h}},true)}function setVolatilityStatAnalyze(f,g,d){var c="";var b="";var a=$J("select").val();$PT(g+"Percent").innerHTML=f[d][0]+"%";$PT(g+"Pips").innerHTML=f[d][1];$PT(g+"Total").innerHTML=f[d][2];if(d!=a&&a!="Please select"){if(f[a]!=undefined){$PT("secondSymbol").innerHTML=a;$PT(g+"Percent1").innerHTML=f[a][0]+"%";$PT(g+"Pips1").innerHTML=f[a][1];$PT(g+"Total1").innerHTML=f[a][2]}else{setEmptyStat(g)}}else{$PT("secondSymbol").innerHTML="2nd symbol";setEmptyStat(g)}}function setEmptyStat(a){$PT(a+"Pips1").innerHTML="-";$PT(a+"Percent1").innerHTML="-";$PT(a+"Total1").innerHTML="-"}function buildVolatilityChartsUrl(d){var c=new Array();var b=new Array();var a=$J("select").val();c.push("&currencies=");b.push(encodeParameter(d));if(d!=a&&a!="Please select"){b.push(encodeParameter(a));b.join(",")}c.push(b);c.push("&weekDays=");c.push(getCheckBoxesValues("weekDays"));c.push("&hours=");c.push(getCheckBoxesValues("hours"));c.push("&monthDays=");c.push(getCheckBoxesValues("monthDays"));return c.join("")}function updateCorrelationMenu(b,a){var g=getCheckBoxesValues("colSymbols");var c=getCheckBoxesValues("rowSymbols");if(g.split(",").length<=10){hideElement("correlationSymbolChangedMessage");var f=getComboValue("timeScales");var d=["&colSymbols=",g,"&rowSymbols=",c,"&timeScale=",f];fxAjax.sendRequest(fxVars.updateCorrelationSymbolMenu,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:d.join(""),loader:a,callback:"updateCorrelationMenuResponse"})}else{if(!isShown($PT("correlationSymbolChangedMessage"))){$PT("correlationSymbolChangedMessage").innerHTML=$T("tOnly10Symbols");showElement("correlationSymbolChangedMessage")}if($PT("colSymbol"+b)){$PT("colSymbol"+b).checked=false}}}function updateCorrelationMenuResponse(b){if(!b.error){var d;var a=b.content.marketCorrelationTable;if(a){$PT("marketCorrelationTable").innerHTML=a;d=$PT("symbolMarketCorrelation");correlationSymbolsMap=[];setCorrelationSymbolMap();findCorrelation()}for(var c=0;c<getHeaders(d).length;c++){if($PT(d.id+"Img"+c)!=undefined){$PT(d.id+"Img"+c).className=""}}SortableTable.find()}reloadAds()}function selectAllCorrelationRowSymbols(element){var selected=eval(element.getAttribute("selected"));var elements=$$PT("#correlationSymbolsTable input[name=rowSymbols]");for(var i=0;i<elements.length;i++){elements[i].checked=selected}if(selected){element.innerHTML=$T("tHideAll")}else{element.innerHTML=$T("tShowAll")}element.setAttribute("selected",!selected);updateCorrelationMenu("")}function setCorrelationSymbolMap(){correlationSymbolsMap=$J(".correlation span")}function findAndChangeCorrelationColor(d,b){for(var a=0;a<correlationSymbolsMap.length;a++){var c=parseFloat($AT(correlationSymbolsMap[a],"value"));if(c!=0){compareTableValues(d,b,correlationSymbolsMap[a],c)}}}function cleanCorrelationElementsColor(){for(var a=0;a<correlationSymbolsMap.length;a++){correlationSymbolsMap[a].className=""}}function findCorrelation(){cleanCorrelationElementsColor();var b=$F("lowCorrelation");var a=$F("highCorrelation");if(b!="-"&&a!="-"){if(isNaN(b)&&b!=""){inlineMsg("lowCorrelation",$T("tYouMustEnterValidNumber"),3)}if(isNaN(a)&&a!=""){inlineMsg("highCorrelation",$T("tYouMustEnterValidNumber"),3)}findAndChangeCorrelationColor(parseFloat(b),parseFloat(a))}}function getCorrelationConfig(a,b){fxAjax.sendRequest(fxVars.getCorrelationConfig+a+"&colSymbol="+b,{params:{symbol:a+"-"+b},callback:"getCorrelationConfigResponse"})}function getCorrelationConfigResponse(a,b){if(!a.error){createCorrelationChart(a.content.data,b.symbol)}}function getSymbolCorrelationByTime(c,b){var g=[];var f=[];for(var a=0;a<$$PT("#correlationPairs td").length;a++){var k=$F("firstCorSymbol"+a);var h=$F("secondCorSymbol"+a);if(hasText(k)&&hasText(h)){g.push(k);f.push(h)}}var d=$J(".tagBG.bold.radius2")[0];if(b!=d){d.className="tagBG radius2";fxAjax.sendRequest(fxVars.getSymbolCorrelationByTime+c+"&firstSymbols="+g+"&secondSymbols="+f,{params:{time:c},loader:true,callback:"getSymbolCorrelationByTimeResponse"})}}function getSymbolCorrelationByTimeResponse(b,g){if(!b.error){var k,h,f,d,a,c={};a=$$PT("#correlationPairs td").length;for(d=0;d<a;d++){k=$F("firstCorSymbol"+d);h=$F("secondCorSymbol"+d);if(hasText(k)&&hasText(h)){f=b.content.quotesData[k+h];if(f!=undefined&&hasText(f)){c[k+h]=k+"-"+h}}}updateCorData(b.content.quotesData,c,true);selectTimeScale(g.time)}}function selectTimeScale(a){$PT("symbolCorrelationTimeScale"+a).className="tagBG bold radius2"}function getCorrelationChart(b){var a=b.target.getAttribute("nameId");var f=$F("firstCorSymbol"+a);var c=$F("secondCorSymbol"+a);if(hasText(f)&&hasText(c)){if(!checkSymbolsIfEquals(f,c,a)&&checkIfInputIsSymbol(f)&&checkIfInputIsSymbol(c)){var d=parseInt($J(".tagBG.bold.radius2")[0].getAttribute("timeScale"));$PT("firstCorSymbol"+a).disabled=true;$PT("secondCorSymbol"+a).disabled=true;fxAjax.sendRequest(fxVars.getSymbolCorrelationByTime+d+"&firstSymbols="+f+"&secondSymbols="+c,{params:{time:d,firstCorSymbol:f,secondCorSymbol:c,numTd:a},loader:true,callback:"getCorrelationChartResponse"})}}}function getCorrelationChartResponse(a,f){if(!a.error){var d,c,b={};d=f.firstCorSymbol;c=f.secondCorSymbol;b[d+c]=d+"-"+c;updateCorData(a.content.quotesData,b,false)}}function createCorrelationChart(c,b){c=ChartUtils.checkData(c,{});try{var a=Object.keys(c)[0];var l=parseCorrelationData(c);var h=ChartUtils.initChart("chartContainer",[0,1.5,10,1.5],2,1,[0,0,1,0]);var g=ChartUtils.plot(h,"left");var k=l[a];var d={};d[a]=b;mainChartSymbol=a;configureCorTooltip(h);configureCorLabels(g.xAxis(),g.yAxis());configureCorLegend(g.legend());addCorSeries(g,l,d);ChartUtils.label(h,-190,true,k,"MMM dd, yyyy");ChartUtils.scroller(h,k);ChartUtils.zeroLine(g,"#714e4b");ChartUtils.noData(g);ChartUtils.drawChart(h)}catch(f){console.warn(f)}}function configureCorLabels(b,a){a.orientation("right").drawLastLabel(false).drawFirstLabel(false).ticks({stroke:"#000",length:4}).labels({fontSize:10,fontColor:"#000",format:"{%value}{decimalsCount:1, zeroFillDecimals:true}%",zIndex:200,offsetY:-1});b.labels({fontSize:9,fontColor:"#595959",fontWeight:600,offsetY:-2}).minorLabels({fontSize:9,fontColor:"#595959",fontWeight:600,offsetY:-2})}function configureCorLegend(a){a.margin(0,0,0,-4).height(25).iconSize(0).itemsFormat("").titleFormat(function(){var b=this.rawValue?"Current Date: ":"Last Date: ";return b+ChartUtils.formatDate(this.value,"MMM dd-EEE, yyyy HH:mm")}).title({fontSize:10,fontWeight:600,color:"#595959"})}function configureCorTooltip(h){var d,m,f,b,g,c,o,s,a,r,k,q=h.tooltip();o='<div style="margin: 4px 0;"><div class="anychart-tooltip-icon" style="background:';s='"></div><span style = "line-height: 15px; color: ';r='">';k="</span> ";a="%</div>";q.enabled(true).useHtml(true).allowLeaveStage(true).titleFormat(function(){d=this.x;if(isNaN(d)){d=this.hoveredDate}if(isNaN(d)){return""}return ChartUtils.formatDate(d,"MMM dd-EEE, yyyy HH:mm")}).unionFormat(function(){c=this.points.length;var l="";for(g=0;g<c;g++){m=this.points[g];f=m.series.color();b=ChartUtils.numberOrNull(m.value);l+=o+f+s+f+r+m.seriesName+k+b+a}return l})}function updateCorData(g,b,a){var c=window.chart;var f=c.plot();var d=parseCorrelationData(g);if(a){f.removeAllSeries();ChartUtils.scroller(c,d[mainChartSymbol])}addCorSeries(f,d,b)}function addCorSeries(h,g,c){var f,k,b,a,d=Object.keys(g);a=d.length-1;for(b=a;b>-1;b--){f=d[b];k=g[f];if(k.length<1){continue}h.line(k).name(c[f]).connectMissingPoints(true)}}function removeCorSeries(b){if(b.replace("-","")===mainChartSymbol){return}var d,a,c,f=window.chart.plot();a=f.getSeriesCount();for(c=0;c<a;c++){d=f.getSeriesAt(c);if(d.name()===b){f.removeSeriesAt(c);return}}}function parseCorrelationData(f){var d,g,b,a,c={};for(d in f){g=[];b=f[d].split(";");b.forEach(function(h){a=h.split(",");g.push([Number(a[0]),Number(a[1])])});g.pop();c[d]=g}return c}function exportSymbolCorrelationAsPNG(d,b){var c=window.chart;if(c){var a=d+"-"+b+" "+c.label(0).text();ChartUtils.exportPng(a,30,-95)}}function initAutoCompleteCorr(a){for(var b=1;b<$$PT("#correlationPairs td").length;b++){$J("#firstCorSymbol"+b).autocompleteV2(a,{matchContains:true,minChars:0,max:54}).result(getCorrelationChart).next().click(function(){$J(this).prev().search()});$J("#secondCorSymbol"+b).autocompleteV2(a,{matchContains:true,minChars:0,max:54}).result(getCorrelationChart).next().click(function(){$J(this).prev().search()})}}function clearCorrelationPair(b){var c=$J("#firstCorSymbol"+b)[0];var a=$J("#secondCorSymbol"+b)[0];removeCorSeries(c.value+"-"+a.value);c.value="";a.value="";$PT("firstCorSymbol"+b).disabled=false;$PT("secondCorSymbol"+b).disabled=false}function checkSymbolsIfEquals(d,c,b){for(var a=0;a<$$PT("#correlationPairs td").length;a++){if(d==$F("firstCorSymbol"+a)&&c==$F("secondCorSymbol"+a)&&b!=a){clearCorrelationPair(b);return true}}return false}function checkIfInputIsSymbol(a){for(var b=0;b<symbols.size();b++){if(a==symbols[b]){return true}}return false}function getTopCorrelationByTimeScale(c){var b=getComboValue("timeScales");var a=["&symbol=",c,"&timeScale=",b];fxAjax.sendRequest(fxVars.getTopCorrelationByTimeScale+a.join(""),{params:{symbol:c},loader:true,callback:"getTopCorrelationByTimeScaleResponse"})}function getTopCorrelationByTimeScaleResponse(b,d){if(!b.error){var c;var a=b.content.topCorrelationTable;if(a){$PT("topCorrelationTable").innerHTML=a}renderCorrelationCharts(b.content.correlationChartsArray,d.symbol)}}function renderCorrelationCharts(b,c){b=JSON.parse(b);for(var a=0;a<b.length;a++){$J("#"+chartsDivs[a]).highcharts(getCorrelationChartSettings(b[a],c,a))}}function setSparkLine(a,b){$J(a).sparkline(b,{type:"line",width:"80 ",height:"25",minSpotColor:"#ff0000",maxSpotColor:"#00bf00",disableInteraction:true,disableTooltips:true,disableHighlight:true})}function setHeatMapSymbols(a){for(var c=0;c<a.length;c++){var b=$PT("symbol"+a[c]);if(b!=undefined){quotesHeatMapSymbols.push($AT(b,"name"))}}}function changeHeatMapPipsOrPercent(h){for(var f=0;f<quotesHeatMapSymbols.length;f++){for(var c=0;c<timeScales.length;c++){var g=$PT(quotesHeatMapSymbols[f]+"TimeScale"+timeScales[c]);if(g.getAttribute("value")!="-"){var k=parseFloat($AT(g,"value"));var l=parseFloat($AT(g,"close"));var d=parseFloat($AT(g,"openVal"));var a=parseFloat($AT(g,"decimals"));if(h=="pipsHeatMap"){var b=calculatePips(l,d,a);g.setAttribute("value",b);g.innerHTML=b}else{var m=calculatePercents(l,d,2);g.setAttribute("value",m);g.innerHTML=m+"%"}}}}updateHeatMapColor(null)}function updateHeatMapColor(){var k=2;var c=10;var d;var f=jQuery(".heat-map th").length;for(k;k<=f;k++){var h=jQuery(".heat-map tbody tr td:nth-child("+k+")").not(".stats-title").map(function(){return parseFloat(jQuery(this).text()).toFixed(2)}).get();var b=h.sort(function(m,l){return l-m});var a=Array.max(h).toFixed(2);var g=Array.min(h).toFixed(2);n=150;xr=255;xg=255;xb=255;yr=228;yg=76;yb=74;gr=88;gg=195;gb=63;jQuery(".heat-map tbody tr td:nth-child("+k+")").not(".stats-title").each(function(){var l=parseFloat(jQuery(this).text()).toFixed(2);var m;clr="rgb("+xr+","+xg+","+xb+")";if(l>0){d=(a/c);if(l/d>1){m=parseInt((Math.round(((l/d)/c)*100)).toFixed(0))}else{m=((1/c)*100).toFixed(0)}red=parseInt((xr+((m*(gr-xr))/(n-1))).toFixed(0));green=parseInt((xg+((m*(gg-xg))/(n-1))).toFixed(0));blue=parseInt((xb+((m*(gb-xb))/(n-1))).toFixed(0));clr="rgb("+red+","+green+","+blue+")"}else{d=(Math.abs(g)/c);if(l/d<-1){m=parseInt((Math.round(((Math.abs(l)/d)/c)*100)).toFixed(0))}else{m=((1/c)*100).toFixed(0)}red=parseInt((xr+((m*(yr-xr))/(n-1))).toFixed(0));green=parseInt((xg+((m*(yg-xg))/(n-1))).toFixed(0));blue=parseInt((xb+((m*(yb-xb))/(n-1))).toFixed(0));clr="rgb("+red+","+green+","+blue+")"}jQuery(this).css({backgroundColor:clr})})}}function getHeatMapData(){var a=getCheckBoxesValues("marketSymbols");var b=["&symbols=",a];fxAjax.sendRequest(fxVars.getHeatMapData,{method:"post",contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:b.join(""),loader:false,params:{},callback:"getHeatMapDataResponse"})}function getHeatMapDataResponse(g){for(var f in g.data){for(var d in g.data[f]){var h=jQuery("#"+f+"TimeScale"+d);var k=g.data[f][d].open;var a=g.data[f][d].close;var b=h.attr("decimals");h.attr("openVal",k);h.attr("close",a);h.attr("close",a);if($PT("pipsHeatMap").checked){var c=calculatePips(a,k,b);h.html(c);h.text(c);h.attr("value",c)}else{var l=calculatePercents(a,k,2);h.html(l+"%");h.text(l+"%");h.attr("value",l)}}}updateHeatMapColor()}jQuery.atmosphere=function(){jQuery(window).bind("beforeunload",function(){jQuery.atmosphere.unsubscribe()});var a=function(c){var b,f=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,d={};while(b=f.exec(c)){d[b[1]]=b[2]}return d};return{version:"1.0",requests:[],callbacks:[],connected:false,onError:function(b){},onClose:function(b){},onOpen:function(b){},onMessage:function(b){},onReconnect:function(c,b){},onMessagePublished:function(b){},onTransportFailure:function(b){},onLocalMessage:function(b){},AtmosphereRequest:function(F){var H={timeout:300000,method:"GET",headers:{},contentType:"",callback:null,url:"",data:"",suspend:true,maxRequest:60,reconnect:true,maxStreamingLength:10000000,lastIndex:0,logLevel:"info",requestCount:0,fallbackMethod:"GET",fallbackTransport:"streaming",transport:"long-polling",webSocketImpl:null,webSocketUrl:null,webSocketPathDelimiter:"@@",enableXDR:false,rewriteURL:false,attachHeadersAsQueryString:true,executeCallbackBeforeReconnect:false,readyState:0,lastTimestamp:0,withCredentials:false,trackMessageLength:false,messageDelimiter:"|",pingTimeout:35,lastPingTime:0,connectTimeout:-1,reconnectInterval:0,dropAtmosphereHeaders:false,uuid:0,shared:false,readResponsesHeaders:true,onError:function(ap){},onClose:function(ap){},onOpen:function(ap){},onMessage:function(ap){},onReconnect:function(aq,ap){},onMessagePublished:function(ap){},onTransportFailure:function(aq,ap){},onLocalMessage:function(ap){}};var P={status:200,responseBody:"",partialMessage:"",junkFull:false,expectedBodySize:-1,headers:[],state:"messageReceived",transport:"polling",error:null,request:null,id:0};var S=null;var k=null;var s=null;var z=null;var B=null;var ab=true;var g=0;var am=false;var T=null;var ah;var m=null;var E=jQuery.now();ao(F);function ai(){ab=true;am=false;g=0;S=null;k=null;s=null;z=null}function w(){ad();ai()}function ao(ap){w();H=jQuery.extend(H,ap)}function l(){return H.webSocketImpl!=null||window.WebSocket||window.MozWebSocket}function L(){return window.EventSource}function q(){if(H.shared&&!jQuery.browser.opera){m=aa(H);if(m!=null){if(H.logLevel=="debug"){jQuery.atmosphere.debug("Storage service available. All communication will be local")}if(m.open(H)){return}}if(H.logLevel=="debug"){jQuery.atmosphere.debug("No Storage service available.")}m=null}if(H.transport!="websocket"&&H.transport!="sse"){G("opening",H.transport,H);o()}else{if(H.transport=="websocket"){if(!l()){J("Websocket is not supported, using request.fallbackTransport ("+H.fallbackTransport+")")}else{ac(false)}}else{if(H.transport=="sse"){if(!L()){J("Server Side Events(SSE) is not supported, using request.fallbackTransport ("+H.fallbackTransport+")")}else{D(false)}}}}}function aa(au){var aq,at,ar="atmosphere-"+au.url,ap={storage:function(){if(!jQuery.atmosphere.supportStorage()){return}var ay=window.localStorage,aw=function(az){return jQuery.parseJSON(ay.getItem(ar+"-"+az))},ax=function(az,aA){ay.setItem(ar+"-"+az,jQuery.stringifyJSON(aA))};return{init:function(){ax("children",aw("children").concat([E]));jQuery(window).on("storage.socket",function(az){az=az.originalEvent;if(az.key===ar&&az.newValue){av(az.newValue)}});return aw("opened")},signal:function(az,aA){ay.setItem(ar,jQuery.stringifyJSON({target:"p",type:az,data:aA}))},close:function(){var az,aA=aw("children");jQuery(window).off("storage.socket");if(aA){az=jQuery.inArray(au.id,aA);if(az>-1){aA.splice(az,1);ax("children",aA)}}}}},windowref:function(){var aw=window.open("",ar.replace(/\W/g,""));if(!aw||aw.closed||!aw.callbacks){return}return{init:function(){aw.callbacks.push(av);aw.children.push(F.id);return aw.opened},signal:function(ax,ay){if(!aw.closed&&aw.fire){aw.fire(jQuery.stringifyJSON({target:"p",type:ax,data:ay}))}},close:function(){function ax(aA,az){var ay=jQuery.inArray(az,aA);if(ay>-1){aA.splice(ay,1)}}if(!at){ax(aw.callbacks,av);ax(aw.children,F.id)}}}}};function av(aw){var ay=jQuery.parseJSON(aw),ax=ay.data;if(ay.target==="c"){switch(ay.type){case"open":G("opening","local",H);break;case"close":at=true;if(ax.reason==="aborted"){af()}else{A("","closed",200,H.transport);if(ax.heir===E){af()}else{setTimeout(function(){af()},100)}}break;case"message":A(ax,"messageReceived",200,au.transport);break;case"localMessage":W(ax);break}}}if(!new RegExp("(?:^|; )("+encodeURIComponent(ar)+")=([^;]*)").test(document.cookie)){return}aq=ap.storage()||ap.windowref();if(!aq){return}return{open:function(){var aw;aw=aq.init();if(aw){setTimeout(function(){G("opening","local",au)},50)}return aw},send:function(aw){aq.signal("send",aw)},localSend:function(aw){aq.signal("localSend",jQuery.stringifyJSON({id:E,event:aw}))},close:function(){if(!am){aq.signal("close");aq.close()}}}}function X(){var aq,ap="atmosphere-"+H.url,au={storage:function(){if(!jQuery.atmosphere.supportStorage()){return}var av=window.localStorage;return{init:function(){jQuery(window).on("storage.socket",function(aw){aw=aw.originalEvent;if(aw.key===ap&&aw.newValue){ar(aw.newValue)}})},signal:function(aw,ax){av.setItem(ap,jQuery.stringifyJSON({target:"c",type:aw,data:ax}))},get:function(aw){return jQuery.parseJSON(av.getItem(ap+"-"+aw))},set:function(aw,ax){av.setItem(ap+"-"+aw,jQuery.stringifyJSON(ax))},close:function(){jQuery(window).off("storage.socket");av.removeItem(ap);av.removeItem(ap+"-opened");av.removeItem(ap+"-children")}}},windowref:function(){var av=ap.replace(/\W/g,""),aw=(jQuery('iframe[name="'+av+'"]')[0]||jQuery('<iframe name="'+av+'" />').hide().appendTo("body")[0]).contentWindow;return{init:function(){aw.callbacks=[ar];aw.fire=function(ax){var ay;for(ay=0;ay<aw.callbacks.length;ay++){aw.callbacks[ay](ax)}}},signal:function(ax,ay){if(!aw.closed&&aw.fire){aw.fire(jQuery.stringifyJSON({target:"c",type:ax,data:ay}))}},get:function(ax){return !aw.closed?aw[ax]:null},set:function(ax,ay){if(!aw.closed){aw[ax]=ay}},close:function(){}}}};function ar(av){var ax=jQuery.parseJSON(av),aw=ax.data;if(ax.target==="p"){switch(ax.type){case"send":ae(aw);break;case"localSend":W(aw);break;case"close":af();break}}}T=function at(av){aq.signal("message",av)};document.cookie=encodeURIComponent(ap)+"="+jQuery.now();aq=au.storage()||au.windowref();aq.init();if(H.logLevel=="debug"){jQuery.atmosphere.debug("Installed StorageService "+aq)}aq.set("children",[]);if(aq.get("opened")!=null&&!aq.get("opened")){aq.set("opened",false)}ah=aq}function G(ar,au,aq){if(H.shared&&au!="local"&&!jQuery.browser.opera){X()}if(ah!=null){ah.set("opened",true)}aq.close=function(){af();aq.reconnect=false};P.request=aq;var at=P.state;P.state=ar;P.status=200;var ap=P.transport;P.transport=au;y();P.state=at;P.transport=ap}function v(ar){var aq=H;if((ar!=null)&&(typeof(ar)!="undefined")){aq=ar}var ap=aq.url;var at=aq.data;if(aq.attachHeadersAsQueryString){ap=Q(aq);if(at!=""){ap+="&X-Atmosphere-Post-Body="+at}at=""}B=jQuery.ajax({url:ap,type:aq.method,dataType:"jsonp",error:function(au,aw,av){if(au.status<300&&aq.requestCount++<aq.maxRequest){K(B,aq)}else{A(aw,"error",au.status,aq.transport)}},jsonp:"jsonpTransport",success:function(au){if(aq.requestCount++<aq.maxRequest){if(!aq.executeCallbackBeforeReconnect){K(B,aq)}var aw=au.message;if(aw!=null&&typeof aw!="string"){try{aw=jQuery.stringifyJSON(aw)}catch(av){}}A(aw,"messageReceived",200,aq.transport);if(aq.executeCallbackBeforeReconnect){K(B,aq)}}else{jQuery.atmosphere.log(H.logLevel,["JSONP reconnect maximum try reached "+H.requestCount]);Z()}},data:aq.data,beforeSend:function(au){b(au,aq,false)}})}function U(ar){var aq=H;if((ar!=null)&&(typeof(ar)!="undefined")){aq=ar}var ap=aq.url;var at=aq.data;if(aq.attachHeadersAsQueryString){ap=Q(aq);if(at!=""){ap+="&X-Atmosphere-Post-Body="+at}at=""}B=jQuery.ajax({url:ap,type:aq.method,error:function(au,aw,av){if(au.status<300&&aq.requestCount++<aq.maxRequest){K(B,aq)}else{A(aw,"error",au.status,aq.transport)}},success:function(av,aw,au){if(aq.requestCount++<aq.maxRequest){if(!aq.executeCallbackBeforeReconnect){K(B,aq)}A(av,"messageReceived",200,aq.transport);if(aq.executeCallbackBeforeReconnect){K(B,aq)}}else{jQuery.atmosphere.log(H.logLevel,["AJAX reconnect maximum try reached "+H.requestCount]);Z()}},data:aq.data,beforeSend:function(au){b(au,aq,false)}})}function d(ap){if(H.webSocketImpl!=null){return H.webSocketImpl}else{if(window.WebSocket){return new WebSocket(ap)}else{return new MozWebSocket(ap)}}}function f(){var ap=Q(H);return decodeURI(jQuery('<a href="'+ap+'"/>')[0].href.replace(/^http/,"ws"))}function an(){var ap=Q(H);return ap}function D(aq){P.transport="sse";var ap=an(H.url);if(H.logLevel=="debug"){jQuery.atmosphere.debug("Invoking executeSSE");jQuery.atmosphere.debug("Using URL: "+ap)}if(aq){G("re-opening","sse",H)}if(!H.reconnect){if(k!=null){k.close()}return}k=new EventSource(ap,{withCredentials:H.withCredentials});if(H.connectTimeout>0){H.id=setTimeout(function(){if(!aq){k.close()}},H.connectTimeout)}k.onopen=function(ar){if(H.logLevel=="debug"){jQuery.atmosphere.debug("SSE successfully opened")}if(!aq){G("opening","sse",H)}aq=true;if(H.method=="POST"){P.state="messageReceived";k.send(H.data)}};k.onmessage=function(at){if(at.origin!="http://"+window.location.host){jQuery.atmosphere.log(H.logLevel,["Origin was not http://"+window.location.host]);return}P.state="messageReceived";P.status=200;var at=at.data;var ar=u(at,H,P);if(jQuery.trim(at).length==0){ar=true}if(!ar){y();P.responseBody=""}};k.onerror=function(ar){clearTimeout(H.id);P.state="closed";P.responseBody="";P.status=!aq?501:200;y();if(am){jQuery.atmosphere.log(H.logLevel,["SSE closed normally"])}else{if(!aq){J("SSE failed. Downgrading to fallback transport and resending")}else{if(H.reconnect&&(P.transport=="sse")){if(g++<H.maxRequest){H.requestCount=g;P.responseBody="";D(true)}else{k.close();jQuery.atmosphere.log(H.logLevel,["SSE reconnect maximum try reached "+H.requestCount]);Z()}}}}}}function ac(aq){P.transport="websocket";var ap=f(H.url);var ar=false;if(H.logLevel=="debug"){jQuery.atmosphere.debug("Invoking executeWebSocket");jQuery.atmosphere.debug("Using URL: "+ap)}if(aq){G("re-opening","websocket",H)}if(!H.reconnect){if(S!=null){S.close()}return}S=d(ap);if(H.connectTimeout>0){H.id=setTimeout(function(){if(!aq){var at={code:1002,reason:"",wasClean:false};S.onclose(at);try{S.close()}catch(au){}}},H.connectTimeout)}S.onopen=function(at){if(H.logLevel=="debug"){jQuery.atmosphere.debug("Websocket successfully opened")}if(!aq){G("opening","websocket",H)}else{H.onOpen(H)}aq=true;if(H.method=="POST"){P.state="messageReceived";S.send(H.data)}};S.onmessage=function(au){if(au.data.indexOf("parent.callback")!=-1){jQuery.atmosphere.log(H.logLevel,["parent.callback no longer supported with 0.8 version and up. Please upgrade"])}P.state="messageReceived";P.status=200;var au=au.data;var at=u(au,H,P);if(!at){y();P.responseBody=""}};S.onerror=function(at){clearTimeout(H.id)};S.onclose=function(at){if(ar){return}var au=at.reason;if(au===""){switch(at.code){case 1000:au="Normal closure; the connection successfully completed whatever purpose for which it was created.";break;case 1001:au="The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection.";break;case 1002:au="The endpoint is terminating the connection due to a protocol error.";break;case 1003:au="The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data).";break;case 1004:au="The endpoint is terminating the connection because a data frame was received that is too large.";break;case 1005:au="Unknown: no status code was provided even though one was expected.";break;case 1006:au="Connection was closed abnormally (that is, with no close frame being sent).";break}}jQuery.atmosphere.warn("Websocket closed, reason: "+au);jQuery.atmosphere.warn("Websocket closed, wasClean: "+at.wasClean);P.state="closed";P.responseBody="";P.status=!aq?501:200;y();clearTimeout(H.id);ar=true;if(am){jQuery.atmosphere.log(H.logLevel,["Websocket closed normally"])}else{if(!aq){J("Websocket failed. Downgrading to Comet and resending")}else{if(H.reconnect&&P.transport=="websocket"){if(H.reconnect&&g++<H.maxRequest){H.requestCount=g;P.responseBody="";ac(true)}else{jQuery.atmosphere.log(H.logLevel,["Websocket reconnect maximum try reached "+H.requestCount]);jQuery.atmosphere.warn("Websocket error, reason: "+at.reason);Z()}}}}}}function Z(){P.state="error";P.responseBody="";P.status=500;y()}function u(av,au,aq){if(au.trackMessageLength){var at=[];var ap=av.indexOf(au.messageDelimiter);if(aq.partialMessage.length==0){while(ap!=-1){var ar=av.substring(0,ap);at.push(ar);av=av.substring(ap+au.messageDelimiter.length,av.length);ap=av.indexOf(au.messageDelimiter)}}if(av.length!=0){aq.partialMessage+=av}ap=aq.partialMessage.indexOf(au.messageDelimiter);while(ap!=-1){ar=aq.partialMessage.substring(0,ap);at.push(ar);aq.partialMessage=aq.partialMessage.substring(ap+au.messageDelimiter.length,aq.partialMessage.length);ap=aq.partialMessage.indexOf(au.messageDelimiter)}if(at.length!=0){aq.responseBody=at.join(au.messageDelimiter);return false}else{return true}}else{aq.responseBody=av}return false}function J(ap){jQuery.atmosphere.log(H.logLevel,[ap]);if(typeof(H.onTransportFailure)!="undefined"){H.onTransportFailure(ap,H)}else{if(typeof(jQuery.atmosphere.onTransportFailure)!="undefined"){jQuery.atmosphere.onTransportFailure(ap,H)}}H.transport=H.fallbackTransport;if(H.reconnect&&H.transport!="none"||H.transport==null){H.method=H.fallbackMethod;P.transport=H.fallbackTransport;H.id=setTimeout(function(){q()},H.reconnectInterval)}}function Q(ar){var aq=H;if((ar!=null)&&(typeof(ar)!="undefined")){aq=ar}var ap=aq.url;if(!aq.attachHeadersAsQueryString){return ap}if(ap.indexOf("X-Atmosphere-Framework")!=-1){return ap}ap+=(ap.indexOf("?")!=-1)?"&":"?";ap+="X-Atmosphere-tracking-id="+aq.uuid;ap+="&X-Atmosphere-Framework="+jQuery.atmosphere.version;ap+="&X-Atmosphere-Transport="+aq.transport;ap+="&token="+TOKEN;ap+="&lastCalendarEventTime="+lastCalendarEventTime;ap+=getAtmosphereParams();if(aq.trackMessageLength){ap+="&X-Atmosphere-TrackMessageSize=true"}if(aq.lastTimestamp!=undefined){ap+="&X-Cache-Date="+aq.lastTimestamp}else{ap+="&X-Cache-Date="+0}if(aq.contentType!=""){ap+="&Content-Type="+aq.contentType}jQuery.each(aq.headers,function(at,av){var au=jQuery.isFunction(av)?av.call(this,aq,ar,P):av;if(au!=null){ap+="&"+encodeURIComponent(at)+"="+encodeURIComponent(au)}});return ap}function aj(){if(jQuery.browser.msie){if(typeof XMLHttpRequest=="undefined"){XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(ap){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(ap){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(ap){}throw new Error("This browser does not support XMLHttpRequest.")}}}return new XMLHttpRequest()}function o(at){var aq=H;if((at!=null)||(typeof(at)!="undefined")){aq=at}if((aq.transport=="jsonp")||((aq.enableXDR)&&(jQuery.atmosphere.checkCORSSupport()))){v(aq);return}if(aq.transport=="ajax"){U(at);return}if((aq.transport=="streaming")&&(jQuery.browser.msie&&jQuery.browser.version<10)){aq.enableXDR&&window.XDomainRequest?I(aq):al(aq);return}if((aq.enableXDR)&&(window.XDomainRequest)){I(aq);return}if(aq.reconnect&&aq.requestCount++<aq.maxRequest){var ar=aj();b(ar,aq,true);if(aq.suspend){s=ar}if(aq.transport!="polling"){P.transport=aq.transport}var ap=false;if(!jQuery.browser.msie){ar.onerror=function(){ap=true;try{P.status=XMLHttpRequest.status}catch(au){P.status=404}P.state="error";K(ar,aq,true)}}ar.onreadystatechange=function(){if(am){return}var ax=false;var aw=false;if(aq.transport=="streaming"){if(jQuery.browser.msie&&ar.readyState!=4){if(ar.readyState>=3){aw=true}}else{if(aq.readyState>2&&ar.readyState==4){aq.readyState=0;aq.lastIndex=0;K(ar,aq,true);return}}}aq.readyState=ar.readyState;if(ar.readyState==4){if(jQuery.browser.msie){aw=true}else{if(aq.transport=="streaming"){aw=true}else{if(aq.transport=="long-polling"){aw=true;clearTimeout(aq.id)}}}}else{if((!jQuery.browser.msie||jQuery.browser.msie&&jQuery.browser.version>=10)&&ar.readyState==3&&ar.status==200&&aq.transport!="long-polling"){aw=true;if(!jQuery.atmosphere.connected){jQuery.atmosphere.connected=true;H.onOpen(P)}else{jQuery.atmosphere.connected=true}}else{clearTimeout(aq.id)}}try{if(aq.readResponsesHeaders){var aB=ar.getResponseHeader("X-Atmosphere-tracking-id");if(aB!=null||aB!=undefined){H.uuid=aB.split(" ").pop()}}}catch(ay){}if(aw){var aA=ar.responseText;try{if(aq.readResponsesHeaders){var au=ar.getResponseHeader("X-Cache-Date");if(au!=null||au!=undefined){H.lastTimestamp=au.split(" ").pop()}}}catch(ay){}if(aq.transport=="streaming"){aq.lastPingTime=(new Date()).getTime();var aD=aA.substring(aq.lastIndex,aA.length);P.isJunkEnded=true;if(!P.junkFull&&(aD.indexOf("<!-- Welcome to the Atmosphere Framework.")==-1||aD.indexOf("<!-- EOD -->")==-1)){if(!jQuery.browser.opera){return}}else{P.junkFull=true}if(aq.lastIndex==0&&aD.indexOf("<!-- Welcome to the Atmosphere Framework.")!=-1&&aD.indexOf("<!-- EOD -->")!=-1){P.isJunkEnded=false}if(!P.isJunkEnded){var aC="<!-- EOD -->";var az=aC.length;var av=aD.indexOf(aC)+az;if(av>az&&av!=aD.length){P.responseBody=aD.substring(av);ax=u(P.responseBody,aq,P)}else{ax=true}}else{var aE=aA.substring(aq.lastIndex,aA.length);ax=u(aE,aq,P)}aq.lastIndex=aA.length;if(jQuery.browser.opera){jQuery.atmosphere.iterate(function(){if(ar.responseText.length>aq.lastIndex){try{P.status=ar.status;P.headers=a(ar.getAllResponseHeaders());if(H.readResponsesHeaders&&H.headers){jQuery.each(H.headers,function(aK){var aJ=ar.getResponseHeader(aK);if(aJ){P.headers[aK]=aJ}})}}catch(aI){P.status=404}if(!P.junkFull){var aH="<!-- EOD -->";var aF=aH.length;var aG=ar.responseText.indexOf(aH)+aF;aq.lastIndex=aG;P.junkFull=true}else{aq.lastPingTime=(new Date()).getTime();P.state="messageReceived";P.responseBody=ar.responseText.substring(aq.lastIndex);aq.lastIndex=ar.responseText.length;y();if((aq.transport=="streaming")&&(ar.responseText.length>aq.maxStreamingLength)){ar.abort();b(ar,aq,true)}}}},0)}if(ax){return}}else{ax=u(aA,aq,P);aq.lastIndex=aA.length}try{P.status=ar.status;P.headers=a(ar.getAllResponseHeaders());if(H.readResponsesHeaders&&H.headers){jQuery.each(H.headers,function(aG){var aF=ar.getResponseHeader(aG);if(aF){P.headers[aG]=aF}})}}catch(ay){P.status=404}if(aq.suspend){P.state=P.status==0?"closed":"messageReceived"}else{P.state="messagePublished"}if(!aq.executeCallbackBeforeReconnect){K(ar,aq,false)}if(P.responseBody.indexOf("parent.callback")!=-1){jQuery.atmosphere.log(aq.logLevel,["parent.callback no longer supported with 0.8 version and up. Please upgrade"])}y();if(aq.executeCallbackBeforeReconnect){K(ar,aq,false)}if((aq.transport=="streaming")&&(aA.length>aq.maxStreamingLength)){ar.abort();b(ar,aq,true)}}};ar.send(aq.data);if(aq.suspend){aq.id=setTimeout(function(){if(ab){ar.abort();ao(aq);q()}},aq.timeout);aq.lastPingTime=(new Date()).getTime();aq.ping=setTimeout(function(){r(ar,aq)},aq.pingTimeout*1000)}ab=true}else{jQuery.atmosphere.log(aq.logLevel,["Max re-connection reached."]);Z()}}function r(ar,aq){var ap=(new Date().getTime()-aq.lastPingTime)/1000;if((jQuery.atmosphere.connected||(!jQuery.atmosphere.connected&&jQuery.browser.msie))&&ap>aq.pingTimeout){if(ar!=null){ar.abort();ao(aq);q()}else{Y(aq);al(aq)}}clearTimeout(aq.ping);aq.ping=setTimeout(function(){r(ar,aq)},(aq.pingTimeout)*1000)}function b(ar,at,aq){var ap=Q(at);ap=jQuery.atmosphere.prepareURL(ap);if(aq){ar.open(at.method,ap,true);if(at.connectTimeout>-1){at.id=setTimeout(function(){if(at.requestCount==0){ar.abort();A("Connect timeout","closed",200,at.transport)}},at.connectTimeout)}}if(H.withCredentials){if("withCredentials" in ar){ar.withCredentials=true}}if(!H.dropAtmosphereHeaders){ar.setRequestHeader("X-Atmosphere-Framework",jQuery.atmosphere.version);ar.setRequestHeader("X-Atmosphere-Transport",at.transport);if(at.lastTimestamp!=undefined){ar.setRequestHeader("X-Cache-Date",at.lastTimestamp)}else{ar.setRequestHeader("X-Cache-Date",0)}if(at.trackMessageLength){ar.setRequestHeader("X-Atmosphere-TrackMessageSize","true")}if(at.contentType!=""){ar.setRequestHeader("Content-Type",at.contentType)}ar.setRequestHeader("X-Atmosphere-tracking-id",at.uuid)}jQuery.each(at.headers,function(au,aw){var av=jQuery.isFunction(aw)?aw.call(this,ar,at,aq,P):aw;if(av!=null){ar.setRequestHeader(au,av)}})}function K(ap,aq,ar){if(ar||(aq.suspend&&ap.status==200&&aq.transport!="streaming"&&ab)){if(aq.reconnect){jQuery.atmosphere.connected=false;P.junkFull=false;G("re-opening",aq.transport,aq);clearTimeout(aq.id);aq.id=setTimeout(function(){if(!jQuery.atmosphere.connected){o()}},aq.reconnectInterval)}}}function I(ap){z=O(ap);z.open()}function O(at){var ar=H;if((at!=null)&&(typeof(at)!="undefined")){ar=at}var aq="";var ax=ar.transport;var aw=0;var av=function(az){var aC=az.responseText;var aD=false;if(aC.indexOf("<!-- Welcome to the Atmosphere Framework.")!=-1){aD=true}if(aD){var aB="<!-- EOD -->";var ay=aB.length;var aA=aC.indexOf(aB);if(aA!==-1){aC=aC.substring(aA+ay+aw);aw+=aC.length}}A(aC,"messageReceived",200,ax)};var ap=new window.XDomainRequest();var au=ar.rewriteURL||function(az){var ay=/(?:^|;\s*)(JSESSIONID|PHPSESSID)=([^;]*)/.exec(document.cookie);switch(ay&&ay[1]){case"JSESSIONID":return az.replace(/;jsessionid=[^\?]*|(\?)|$/,";jsessionid="+ay[2]+"$1");case"PHPSESSID":return az.replace(/\?PHPSESSID=[^&]*&?|\?|$/,"?PHPSESSID="+ay[2]+"&").replace(/&$/,"")}return az};ap.onprogress=function(){av(ap)};ap.onerror=function(){if(ar.transport!="polling"){A(ap.responseText,"error",500,ax)}};ap.onload=function(){if(aq!=ap.responseText){av(ap)}if(ar.transport=="long-polling"){o()}};return{open:function(){if(ar.method=="POST"){ar.attachHeadersAsQueryString=true}var ay=Q(ar);if(ar.method=="POST"){ay+="&X-Atmosphere-Post-Body="+ar.data}ap.open(ar.method,au(ay));ap.send();if(ar.connectTimeout>-1){ar.id=setTimeout(function(){if(ar.requestCount==0){ap.abort();A("Connect timeout","closed",200,ar.transport)}},ar.connectTimeout)}},close:function(){ap.abort();A(ap.responseText,"closed",200,ax)}}}function Y(ap){if(z!=null){z.close();z=null}jQuery.atmosphere.connected=false}function al(ap){z=t(ap);z.open()}function t(at){var ar=H;if((at!=null)&&(typeof(at)!="undefined")){ar=at}var aq;var au=new window.ActiveXObject("htmlfile");au.open();au.close();var ap=ar.url;if(ar.transport!="polling"){P.transport=ar.transport}return{open:function(){var av=au.createElement("iframe");ap=Q(ar);if(ar.data!=""){ap+="&X-Atmosphere-Post-Body="+ar.data}ap=jQuery.atmosphere.prepareURL(ap);av.src=ap;au.body.appendChild(av);ar.lastPingTime=(new Date()).getTime();if(ar.ping==null){ar.ping=setTimeout(function(){r(null,ar)},ar.pingTimeout*1000)}var aw=av.contentDocument||av.contentWindow.document;aq=jQuery.atmosphere.iterate(function(){try{if(!aw.firstChild){return}if(aw.readyState==="complete"){try{jQuery.noop(aw.fileSize)}catch(aC){A("Connection Failure","error",500,ar.transport);return false}}var az=aw.body?aw.body.lastChild:aw;var aB=function(){jQuery.atmosphere.connected=true;var aI=az.cloneNode(true);aI.appendChild(aw.createTextNode("."));var aG=aI.innerText;var aH=true;if(aG.indexOf("<!-- Welcome to the Atmosphere Framework.")==-1){aH=false}if(aH){var aF="<!-- EOD -->";var aD=aF.length;var aE=aG.indexOf(aF)+aD;aG=aG.substring(aE)}return aG.substring(0,aG.length-1)};if(!jQuery.nodeName(az,"pre")){var ay=aw.head||aw.getElementsByTagName("head")[0]||aw.documentElement||aw;var ax=aw.createElement("script");ax.text="document.write('<plaintext>')";ay.insertBefore(ax,ay.firstChild);ay.removeChild(ax);az=aw.body.lastChild}A(aB(),"opening",200,ar.transport);aq=jQuery.atmosphere.iterate(function(){var aD=aB();if(aD.length>ar.lastIndex){P.status=200;A(aD,"messageReceived",200,ar.transport);az.innerText="";ar.lastIndex=0}if(aw.readyState==="complete"){A("","re-opening",200,ar.transport);al(ar);return false}},null);return false}catch(aA){jQuery.atmosphere.error(aA)}})},close:function(){if(aq){aq()}au.execCommand("Stop");A("","closed",200,ar.transport)}}}function ae(ap){if(m!=null){h(ap)}else{if(s!=null||k!=null){c(ap)}else{if(z!=null){R(ap)}else{if(B!=null){N(ap)}else{if(S!=null){C(ap)}}}}}}function h(ap){m.send(ap)}function x(aq){try{if(m){m.localSend(aq)}else{ah.signal("localMessage",jQuery.stringifyJSON({id:E,event:aq}))}}catch(ap){jQuery.atmosphere.error(ap)}}function c(aq){var ap=ag(aq);o(ap)}function R(aq){if(H.enableXDR&&jQuery.atmosphere.checkCORSSupport()){var ap=ag(aq);ap.reconnect=false;v(ap)}else{c(aq)}}function N(ap){c(ap)}function M(ap){var aq=ap;if(typeof(aq)=="object"){aq=ap.data}return aq}function ag(aq){var ar=M(aq);var ap={connected:false,timeout:60000,method:"POST",url:H.url,contentType:H.contentType,headers:{},reconnect:true,callback:null,data:ar,suspend:false,maxRequest:60,logLevel:"info",requestCount:0,transport:"polling",attachHeadersAsQueryString:true,enableXDR:H.enableXDR,uuid:H.uuid};if(typeof(aq)=="object"){ap=jQuery.extend(ap,aq)}return ap}function C(ap){var at=M(ap);var aq;try{if(H.webSocketUrl!=null){aq=H.webSocketPathDelimiter+H.webSocketUrl+H.webSocketPathDelimiter+at}else{aq=at}S.send(aq)}catch(ar){S.onclose=function(au){};S.close();J("Websocket failed. Downgrading to Comet and resending "+aq);c(ap)}}function W(aq){var ap=jQuery.parseJSON(aq);if(ap.id!=E){if(typeof(H.onLocalMessage)!="undefined"){H.onLocalMessage(ap.event)}else{if(typeof(jQuery.atmosphere.onLocalMessage)!="undefined"){jQuery.atmosphere.onLocalMessage(ap.event)}}}}function A(at,ap,aq,ar){if(ap=="messageReceived"){H.lastPingTime=(new Date()).getTime();if(u(at,H,P)){return}}P.transport=ar;P.status=aq;if(P.expectedBodySize==-1){P.responseBody=at}P.state=ap;y()}function V(ap){ak(ap,H);ak(ap,jQuery.atmosphere)}function ak(ap,aq){switch(ap.state){case"messageReceived":if(typeof(aq.onMessage)!="undefined"){aq.onMessage(ap)}break;case"error":if(typeof(aq.onError)!="undefined"){aq.onError(ap)}break;case"opening":if(typeof(aq.onOpen)!="undefined"){aq.onOpen(ap)}break;case"messagePublished":if(typeof(aq.onMessagePublished)!="undefined"){aq.onMessagePublished(ap)}break;case"re-opening":if(typeof(aq.onReconnect)!="undefined"){aq.onReconnect(H,ap)}break;case"unsubscribe":case"closed":if(typeof(aq.onClose)!="undefined"){aq.onClose(ap)}break}}function y(){var at=function(aw,ax){ax(P)};if(m==null&&T!=null){T(P.responseBody)}var au=typeof(P.responseBody)=="string"?P.responseBody.split(H.messageDelimiter):new Array(P.responseBody);for(var aq=0;aq<au.length;aq++){if(au.length>1&&au[aq].length==0){continue}P.responseBody=jQuery.trim(au[aq]);if(P.responseBody.length==0&&P.transport=="streaming"&&P.state=="messageReceived"){var ap=navigator.userAgent.toLowerCase();var ar=ap.indexOf("android")>-1;if(ar){continue}}V(P);if(jQuery.atmosphere.callbacks.length>0){if(H.logLevel=="debug"){jQuery.atmosphere.debug("Invoking "+jQuery.atmosphere.callbacks.length+" global callbacks: "+P.state)}try{jQuery.each(jQuery.atmosphere.callbacks,at)}catch(av){jQuery.atmosphere.log(H.logLevel,["Callback exception"+av])}}if(typeof(H.callback)=="function"){if(H.logLevel=="debug"){jQuery.atmosphere.debug("Invoking request callbacks")}try{H.callback(P)}catch(av){jQuery.atmosphere.log(H.logLevel,["Callback exception"+av])}}}}function af(){H.reconnect=false;P.request=H;ab=false;am=true;P.state="unsubscribe";P.responseBody="";P.status=408;y();ad();if(m==null&&T!=null){ah.signal("close",{reason:"",heir:!am?E:ah.get("children")[0]});document.cookie=encodeURIComponent("atmosphere-"+H.url)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"}if(ah!=null){ah.close()}if(m!=null){m.close()}}function ad(){if(z!=null){z.close();z=null}if(B!=null){B.abort();B=null}if(s!=null){s.abort();s=null}if(S!=null){S.close();S=null}if(k!=null){k.close();k=null}}this.subscribe=function(ap){ao(ap);q()};this.execute=function(){q()};this.invokeCallback=function(){y()};this.close=function(){af()};this.getUrl=function(){return H.url};this.push=function(ap){ae(ap)};this.pushLocal=function(ap){x(ap)};this.response=P},subscribe:function(b,f,d){jQuery.atmosphere.unsubscribe();if(typeof(f)=="function"){jQuery.atmosphere.addCallback(f)}if(typeof(b)!="string"){d=b}else{d.url=b}var c=new jQuery.atmosphere.AtmosphereRequest(d);c.execute();jQuery.atmosphere.requests[jQuery.atmosphere.requests.length]=c;return c},addCallback:function(b){if(jQuery.inArray(b,jQuery.atmosphere.callbacks)==-1){jQuery.atmosphere.callbacks.push(b)}},removeCallback:function(c){var b=jQuery.inArray(c,jQuery.atmosphere.callbacks);if(b!=-1){jQuery.atmosphere.callbacks.splice(b,1)}},unsubscribe:function(){if(jQuery.atmosphere.requests.length>0){for(var b=0;b<jQuery.atmosphere.requests.length;b++){jQuery.atmosphere.requests[b].close();clearTimeout(jQuery.atmosphere.requests[b].id);clearTimeout(jQuery.atmosphere.requests[b].response.request.ping)}}jQuery.atmosphere.requests=[];jQuery.atmosphere.callbacks=[]},unsubscribeUrl:function(c){var b=-1;if(jQuery.atmosphere.requests.length>0){for(var f=0;f<jQuery.atmosphere.requests.length;f++){var d=jQuery.atmosphere.requests[f];if(d.getUrl()==c){d.close();clearTimeout(d.id);b=f;break}}}if(b>=0){jQuery.atmosphere.requests.splice(b,1)}},publish:function(c){if(typeof(c.callback)=="function"){jQuery.atmosphere.addCallback(callback)}c.transport="polling";var b=new jQuery.atmosphere.AtmosphereRequest(c);jQuery.atmosphere.requests[jQuery.atmosphere.requests.length]=b;return b},checkCORSSupport:function(){if(jQuery.browser.msie&&!window.XDomainRequest){return true}else{if(jQuery.browser.opera){return true}}var b=navigator.userAgent.toLowerCase();var c=b.indexOf("android")>-1;if(c){return true}return false},S4:function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)},guid:function(){return(jQuery.atmosphere.S4()+jQuery.atmosphere.S4()+"-"+jQuery.atmosphere.S4()+"-"+jQuery.atmosphere.S4()+"-"+jQuery.atmosphere.S4()+"-"+jQuery.atmosphere.S4()+jQuery.atmosphere.S4()+jQuery.atmosphere.S4())},prepareURL:function(c){var d=jQuery.now();var b=c.replace(/([?&])_=[^&]*/,"$1_="+d);return b+(b===c?(/\?/.test(c)?"&":"?")+"_="+d:"")},param:function(b){return jQuery.param(b,jQuery.ajaxSettings.traditional)},supportStorage:function(){var c=window.localStorage;if(c){try{c.setItem("t","t");c.removeItem("t");return !!window.StorageEvent||Object.prototype.toString.call(c)==="[object Storage]"}catch(b){}}return false},iterate:function(d,c){var f;c=c||0;(function b(){f=setTimeout(function(){if(d()===false){return}b()},c)})();return function(){clearTimeout(f)}},log:function(d,c){if(window.console){var b=window.console[d];if(typeof b=="function"){b.apply(window.console,c)}}},warn:function(){jQuery.atmosphere.log("warn",arguments)},info:function(){jQuery.atmosphere.log("info",arguments)},debug:function(){jQuery.atmosphere.log("debug",arguments)},error:function(){jQuery.atmosphere.log("error",arguments)}}}();(function(d){var h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function a(f){return'"'+f.replace(h,function(k){var l=c[k];return typeof l==="string"?l:"\\u"+("0000"+k.charCodeAt(0).toString(16)).slice(-4)})+'"'}function b(f){return f<10?"0"+f:f}function g(q,o){var m,l,f,k,s=o[q],r=typeof s;if(s&&typeof s==="object"&&typeof s.toJSON==="function"){s=s.toJSON(q);r=typeof s}switch(r){case"string":return a(s);case"number":return isFinite(s)?String(s):"null";case"boolean":return String(s);case"object":if(!s){return"null"}switch(Object.prototype.toString.call(s)){case"[object Date]":return isFinite(s.valueOf())?'"'+s.getUTCFullYear()+"-"+b(s.getUTCMonth()+1)+"-"+b(s.getUTCDate())+"T"+b(s.getUTCHours())+":"+b(s.getUTCMinutes())+":"+b(s.getUTCSeconds())+'Z"':"null";case"[object Array]":f=s.length;k=[];for(m=0;m<f;m++){k.push(g(m,s)||"null")}return"["+k.join(",")+"]";default:k=[];for(m in s){if(Object.prototype.hasOwnProperty.call(s,m)){l=g(m,s);if(l){k.push(a(m)+":"+l)}}}return"{"+k.join(",")+"}"}}}d.stringifyJSON=function(f){if(window.JSON&&window.JSON.stringify){return window.JSON.stringify(f)}return g("",{"":f})}}(jQuery));var socket=jQuery.atmosphere;var subSocket;var callbackArray={1:"toolBarSymbolUpdateResponse",2:"updateOutloookQuotes",3:"updateQuotes",4:"symbolAnalysisChannelResponse",5:"volatilityChannelResponse",6:"quotesChannelResponse",7:"historicalSymbolChannelResponse",8:"symbolVolatilityChannelResponse",9:"autoCompleteUpdateSymbol"};var CHANNEL_SUSBSCRIBE=1;var CHANNEL_UNSUSBSCRIBE=2;var CHANNEL_SEND=3;var SOCKET_CLOSE=4;var connectinTimeout=1000*3;var showDisconnectMsg=false;var onOpenArray=[];var lastCalendarEventTime=0;var fxWebsocketData={};var rand=function(){return Math.random().toString(36).substr(2)};var token=function(){return rand()+rand()};var TOKEN=token();var reconnectTime=null;var reconnectTimeDelay=20000;var tokenEvent=jQuery.Deferred();jQuery(this).keypress(function(a){if(a.keyCode==27){a.preventDefault()}});var channels={_size:0,_channels:{},put:function(b,a){this._channels[b]=a;this._size++},remove:function(a){delete this._channels[a];this._size--},size:function(){return this._size},getAll:function(){return this._channels},get:function(a){return this._channels[a]}};var fxWebsocket={domain:null,parent:null,child:null,iframeId:null,_getChild:function(){if(this.child==null){this.child=document.getElementById(this.iframeId).contentWindow}return this.child},init:function(){if(window.addEventListener){addEventListener("message",onMessage,false)}else{attachEvent("onmessage",onMessage)}function onMessage(event){if(event.origin==atmosphereUrl||event.origin==serverPath){try{eval("fxWebsocket."+event.data)}catch(e){}}}if(fxWebsocket.parent!=null){fxWebsocket.sendToParent("onChildReady()")}},setChild:function(b,a){this.iframeId=b;this.domain=a;fxWebsocket.init()},setParent:function(a,b){this.parent=a;this.domain=b;fxWebsocket.init()},sendToParent:function(a){this.parent.postMessage(a,fxWebsocket.domain)},sendToChild:function(a){this._getChild().postMessage(a,fxWebsocket.domain)},onChildReady:function(){},onOpen:function(){},onClose:function(){if($PT("connStatusOn")){$PT("connStatusOn").style.display="none";$PT("connStatusOff").style.display="";$PT("connStatusOn").setAttribute("connected","false")}},onMessage:function(responseBody){try{var decodedData=unescape(responseBody);var responseArray=decodedData.split("<@>");var data;for(var i=0;i<responseArray.length;i++){var response=responseArray[i];if(hasText(response)){if(response[0]=="{"){data=eval("("+response+")")}if(data!=null){var runCallback=eval(data.callback);runCallback(data)}else{var data=response.split(",");var runCallback=eval(callbackArray[data[0]]);runCallback(data)}}}}catch(e){}},onReconnect:function(){if(reconnectTime==null){reconnectTime=new Date().getTime()}if(new Date().getTime()-reconnectTime>reconnectTimeDelay){connectionLostMsg()}fxWebsocket.onClose()},onShowToolbar:function(a,b){showToolBar(a,b)},onSaveEmailMinAlert:function(c,a,b){saveEmailMinAlert(c,a,b)},onGetToken:function(a){tokenEvent.resolve(a);tokenEvent=jQuery.Deferred()},connect:function(){initConnectParams();fxWebsocket.sendToChild("connectChild("+JSON.stringify(fxWebsocketData)+")")},subscribe:function(b,d,c,a){this.subscribeWithMsg(b,d,c,a,"")},subscribeWithMsg:function(c,f,d,a,b){fxWebsocket.sendToChild("subscribeChild('"+c+"','"+f+"','"+d+"','"+a+"','"+b+"')")},send:function(a,b,c){fxWebsocket.sendToChild("sendChild('"+a+"','"+escape(b)+"','"+c+"')")},sendWithInvite:function(b,c,d,a){fxWebsocket.sendToChild("sendChildWithInvite('"+b+"','"+escape(c)+"','"+d+"','"+a+"')")},disconnect:function(){fxWebsocket.sendToChild("disconnectChild()")},updateChartData:function(b,a){fxWebsocket.sendToChild("childUpdateChartData('"+b+"','"+a+"')")},reconnectIe:function(){fxWebsocket.sendToChild("onReconnectIe()")},unsubscribe:function(a,b){fxWebsocket.sendToChild("unSubscribeChild('"+a+"','"+b+"')")},updateLastCalendarEventTime:function(a){fxWebsocket.sendToChild("updateLastCalendarEventTimeChild('"+a+"')")},getTokenForToolbar:function(a){fxWebsocket.sendToChild("getTokenForToolbarChild('"+a+"')")},getTokenForsaveEmailMinAlert:function(b,a){fxWebsocket.sendToChild("getTokenForsaveEmailMinAlertChild('"+b+"','"+a+"')")},sendChatMsg:function(c,d,f,a,b){fxWebsocket.sendToChild("sendChatMsgChild('"+c+"','"+escape(d)+"','"+f+"','"+a+"','"+b+"')")},getToken:function(){fxWebsocket.sendToChild("getTokenChild()");return tokenEvent},childUpdateChartData:function(c,b){var a=channels.get(c);if(a!=null){a.time=b}},connectChild:function(a){fxWebsocketData=a;jQuery(document).ready(function(){var b={url:atmosphereUrl+"/atmosphere/websocket?url="+encodeParameter(gup("url")+"&host="+fxWebsocketData.host),transport:"streaming",trackMessageLength:true,messageDelimiter:"<@>",reconnectInterval:30000};b.contentType="text/html; charset=utf-8";b.onReconnect=function(c){TOKEN=token();fxWebsocket.sendToParent("onReconnect()")};b.onMessage=function(c){if(jQuery.atmosphere.connected&&c.status==200){fxWebsocket.sendToParent("onMessage('"+escape(c.responseBody)+"')")}};b.onOpen=function(c){if(jQuery.atmosphere.connected){fxWebsocket.sendToParent("onOpen()")}};b.onClose=function(c){TOKEN=token();if(jQuery.browser.msie){fxWebsocket.sendToParent("onReconnect()")}else{fxWebsocket.sendToParent("onClose()")}};subSocket=socket.subscribe(b)})},subscribeChild:function(channel,id,time,invite,message){time=eval(time);var channelObject={channel:channel,id:id,time:time,invite:invite};channels.put(channel+id,channelObject);fxWebsocket.push(CHANNEL_SUSBSCRIBE,channel,message,id,time,invite)},unSubscribeChild:function(a,b){channels.remove(a+b);fxWebsocket.push(CHANNEL_UNSUSBSCRIBE,a,"",b,null,null)},updateLastCalendarEventTimeChild:function(a){lastCalendarEventTime=a},getTokenForToolbarChild:function(a){fxWebsocket.sendToParent("onShowToolbar('"+a+"','"+TOKEN+"')")},getTokenForsaveEmailMinAlertChild:function(b,a){fxWebsocket.sendToParent("onSaveEmailMinAlert('"+b+"','"+a+"','"+TOKEN+"')")},getTokenChild:function(){fxWebsocket.sendToParent("onGetToken('"+TOKEN+"')")},sendToChart:function(b,a){if(hasText($F("userId"))){this.send("chart",JSON.stringify(a),b)}},sendChild:function(a,b,c){fxWebsocket.push(CHANNEL_SEND,a,unescape(b),c,null,null);jQuery("#text").val("");jQuery("#text").focus()},sendChildWithInvite:function(b,c,d,a){fxWebsocket.push(CHANNEL_SEND,b,unescape(c),d,null,a)},sendChatMsgChild:function(c,d,f,a,b){fxWebsocket.pushChatMsg(CHANNEL_SEND,c,unescape(d),f,a,b)},onReconnectIe:function(){jQuery.atmosphere.connected=false;fxWebsocket.sendToParent("onClose()");fxWebsocket.connectChild();fxWebsocket.sendToParent("onOpen()")},push:function(b,d,c,h,g,a){var f={};if(g!=null&&g!=0){f.l=g}this.initAndPushBaseParams(f,b,d,c,h,a)},disconnectChild:function(){fxWebsocket.push(SOCKET_CLOSE,"","");socket.unsubscribe()},pushChatMsg:function(c,f,d,h,a,b){var g={};if(b!=null&&hasText(b)){g.ty=b}this.initAndPushBaseParams(g,c,f,d,h,a)},initAndPushBaseParams:function(f,b,d,c,g,a){f.token=TOKEN;f.t=b;f.c=encodeParameter(d);f.m=c;f.id=g;if(a!=null&&hasText(a)){f.i=a}if(subSocket!=null){subSocket.push({data:JSON.stringify(f)})}}};function encodeParameter(a){return(encodeURI(a).replace(/&/g,"%26").replace(/=/g,"%3D").replace(/\+/g,"%2B").replace(/#/g,"%23").replace(/\?/g,"%3F").replace(/\:/g,"%3A"))}function getAtmosphereParams(){var a="";for(var b in fxWebsocketData){a+="&"+b+"="+fxWebsocketData[b]}return a}function initConnectParams(){var b=isVisible("footerToolbar");var a=[];jQuery("#newsTop span[newsId]").each(function(){a.push($AT(this,"newsId"))});fxWebsocketData.t=b;fxWebsocketData.newsOids=encodeParameter(a);fxWebsocketData.host=encodeParameter(window.location.hostname)}function gup(c,b){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+c+"=([^&#]*)";var f=new RegExp(a);var d;if(b==null){d=f.exec(window.location.href)}else{d=f.exec(b)}if(d==null){return""}else{return d[1]}}function hasText(a){try{if(a!=null){a=String(a);a=a.trim();return a.length!=0}}catch(b){}return false}var haveChanges=false;var sendMailToChartSubscribers=true;var currentTabNameChanged=false;var lastChartId=0;var loading="Loading...";var userLogin=false;var owner=false;var saveLock=false;var saveTimeOut;var effectActive=false;var NO_ACCOUNT=0;var elementIsSelected=false;var openTradesHistoryEvents={};var historyEvents={};var accountOid;var tradeBrowserOrder=[];var lastEventId;var timeFormat;var GOLD="GOLD";var GOLD_SYMBOL_NAME="XAUUSD";var SILVER="SILVER";var SILVER_SYMBOL_NAME="XAGUSD";var TVC=TVC;function saveCharts(t,c,k){try{if(!saveLock&&chartLoaderOff&&userLogin!=null&&owner!=null&&!updateScenario&&chart!=null&&chart.getSelectedAnnotationId()==null&&((haveChanges||currentTabNameChanged)&&owner)||(userLogin&&t)){saveLock=true;var a;var l=lastChartId;var v=null;var o="";if(t){l=0;v=lastChartId;if(chartsArray[lastChartId]!=null){o=chartsArray[lastChartId].i}}var h=true;if(k!=null){h=k}var m=getChartSymbol(2);var f=getChartSymbol(3);var s={size:"Custom",quality:100,width:335,height:180,resizingMode:"Stretch"};var q=chart.getAnnotationListAsJSON();var d=[];for(var r=0;r<q.length;r++){if(!isContains(chartsArray[lastChartId].accountAnnotation,q[r].id)){d.push(q[r])}}if(t){for(var r=0;r<d.length;r++){if(d[r]!=null){d[r].allowEdit=true}}}var b=getChartSymbol(1)+","+$PT("chartProfileTime"+quoteTime).getAttribute("time");var g={b:"#"+$AT($PT("chartProfileBackgroundColor"),"hex"),g:"#"+$AT($PT("chartProfileGridColor"),"hex"),s:"#"+$AT($PT("scrollerColor"),"hex"),t:"#"+$AT($PT("textColor"),"hex")};var w=["&charts=",encodeParameter(traceObject(chart.objectModel.settings.charts,chart)),"&annontations=",encodeParameter(traceObject(d,chart)),"&timeScale=",quoteTime,"&startTime=",chart.getFirstVisibleDate().getTime(),"&chartId=",l,"&type=",c,"&settings=",encodeParameter(traceObject(g,chart)),"&firstSymbol=",encodeParameter(getChartSymbol(1)),"&copyId=",v,"&i=",o,"&sendMailToChartSubscribers=",sendMailToChartSubscribers,"&tvc=",TVC];if(hasText(m)){w.push("&secondSymbol=",encodeParameter(m))}if(hasText(f)){w.push("&thirdSymbol=",encodeParameter(f))}try{w.push("&image=");w.push(encodeParameter(chart.getPNGImageBase64Encoded(s)))}catch(u){}fxAjax.sendRequest(fxVars.saveCharts,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",asynchronous:h,postBody:w.join(""),params:{symbols:a,saveNew:t,chartName:b,id:JSON.stringify(lastChartId)},loader:false,callback:"saveChartsResponse"})}else{clearTimeout(saveTimeOut);saveTimeOut=setTimeout("saveCharts(false,0)",10000)}}catch(u){saveLock=false}}function saveChartsResponse(response,params){try{if(!response.error){var tempId=Number(eval(params.id));var lastTime=response.content.lastTime;var saved=(response.content.saved!=null)?response.content.saved:false;if(lastTime!=null){chartsArray[tempId].lastUpdate=lastTime}chartsArray[tempId].saved=saved;fxWebsocket.updateChartData(chart_subscribe+tempId,dt.getTime());fxWebsocket.sendToChart(tempId,{type:"chartLastUpdate",o:{id:chart_subscribe+tempId,time:dt.getTime()},callback:"chartUpdate"});if(params.saveNew&&!updateScenario){userChartsCount++;var oid=response.content.oid;if(oid!=null){var url=createChartUrl(oid,null,null,null,params.chartName,response.content.invite);var li=new Element("li",{});var aMenu=new Element("a",{id:"chartMenuItem"+oid,href:url});aMenu.innerHTML=params.chartName;li.appendChild(aMenu);$PT("chartsMenu").appendChild(li);var a=new Element("a",{className:"underline pointer"});var br=new Element("br",{});var span=new Element("span",{});a.onclick=function(){window.open(url)};a.innerHTML=params.chartName;span.appendChild(a);showChartMsg("Chart copied to your workspace: ",span);hideElement("copyChart")}else{showChartMsg("Error copying the chart.")}}if(params.element!=null){var element=params.element;addWallPost(element.text,element.toUid,element.commentId,element.wallPostType,element.objectId,element.internalType,response.content.oid,true)}haveChanges=false;currentTabNameChanged=false;sendMailToChartSubscribers=true;clearTimeout(saveTimeOut);saveTimeOut=setTimeout("saveCharts(false,0)",10000)}if(selectedAnnotationId!=null){chart.selectAnnotation(selectedAnnotationId);selectedAnnotationId=null}}catch(e){saveLock=false}saveLock=false}var chartLoading=true;var chartLoaderOff=true;var chartsZindex=101;var chartsPosts={};var chartsComments={};function loadChart(c,h,o,l,a,t,z,b,y){if(!chartLoading){if(lastChartId!=c||l){chartLoading=true;showElement("feedLoader");hideElement("seriesSettings");hideElement("chartCompare");hideElement("indicatorFirstOption");hideElement("chartTimeScale");hideElement("linkToChart");try{chart.deselectAnnotaion();saveCharts(false,chart_type_chart)}catch(w){}var m="chart"+c;if($PT(m)==null||l){if(l==null){createChartFlash(c,false,null,null)}var A=["oid=",c,"&type=",h];if(o!=null){A.push("&loadWallPost="+o)}fxAjax.sendRequest(fxVars.loadChart+A.join(""),{params:{type:h,load:l,oid:c,objectId:a,post:t,notificationType:z,notificationId:b,postOid:y},callback:"loadChartResponse"})}else{chart=chartsArray[c].o;$PT("chart"+c).style.zIndex=chartsZindex;for(var u in chartsArray){if(u!=c){$PT("chart"+u).style.zIndex=99}}chartsZindex++;if(l!=null&&l){changePostChoice(false,"0")}fillChartSettings(chartsArray[c].s,chartsArray[c].n,chartsArray[c].t,chartsArray[c].p,c,chartsArray[c].userVote,chartsArray[c].totalVotes,chartsArray[c].v,chartsArray[c].type,chartsArray[c].i,chartsArray[c].d,chartsArray[c].subscribers,chartsArray[c].users);var k=chartsArray[c].feedObject;$PT("feedData").innerHTML=k.html();var f=chartsPosts[c];if(f!=null){for(var u=0;u<f.length;u++){if(f[u]!=null){if(f[u].remove!=null){var v=$PT("post"+f[u].oid);var r=$PT("postText"+f[u].oid);if(r!=null&&v!=null){r.remove();v.remove();var B=k.find("#"+v.id);var q=k.find("#"+r.id);if(q!=null){q.remove()}if(B!=null){B.remove()}updateFeedScrooler("chartDiscussion",false)}}else{createChartPost(f[u].lastOid,f[u].post,c)}}goToChartNotification("post"+f[u].lastOid,true,false)}delete chartsPosts[c]}for(var u in chartsComments){if(u==c){var g=chartsComments[u];for(var s=0;s<g.length;s++){var t=$PT("post"+g[s].p);if(t!=null){if(g[s].remove!=null){var d=$PT("comment"+g[s].oid);if(d!=null){d.remove();var x=k.find("#"+d.id);if(x!=null){x.remove()}updateFeedScrooler("chartDiscussion",false)}}else{addChartComment(g[s].p,g[s].c,c);goToChartNotification("comment"+g[s].id,false,false)}}}}}delete chartsComments[c];chartLoading=false;hideElement("feedLoader");updateFeedScrooler("chartDiscussion",true);addQuoteDataPoints(c);lastChartId=c;if(t!=null&&a!=null){loadWallPostNotification(c,z,b,y,"","")}}lastChartId=c;updateChartNotification(true,lastChartId)}}haveChanges=false;sendMailToChartSubscribers=true}function loadChartResponse(response,params){if(!response.error){var configObject;var chartObject=response.content.chart;var config=response.content.config;var type=chartObject.type;if(config){configObject=eval("("+config+")");if(type==chart_type_scenario){showScenarioMode(configObject,true)}chart.setConfig(configObject);chart.objectModel=configObject}if(params.load==null||!params.load){var chartSettings=chartObject.settings;var chartName=chartObject.profileName;var chartId=chartObject.oid;var publishChart=chartObject.publishChart;var timeScale=chartObject.timeScale;var userVote=chartObject.userVote;var totalVotes=chartObject.votes;var views=chartObject.views;var firstSymbol=chartObject.firstSymbol;var secondSymbol=chartObject.secondSymbol;var thirdSymbol=chartObject.thirdSymbol;var invite=chartObject.invite;var deleted=chartObject.deleted;var subscribers=chartObject.subscribers;var lastUpdate=chartObject.lastUpdate;var saved=hasText(chartObject.imageName);chartsArray[params.oid].n=chartName;chartsArray[params.oid].t=timeScale;chartsArray[params.oid].userVote=userVote;chartsArray[params.oid].totalVotes=totalVotes;chartsArray[params.oid].p=publishChart;chartsArray[params.oid].v=views;chartsArray[params.oid].type=type;chartsArray[params.oid].s=chartSettings;chartsArray[params.oid].firstSymbol=firstSymbol;chartsArray[params.oid].secondSymbol=secondSymbol;chartsArray[params.oid].thirdSymbol=thirdSymbol;chartsArray[params.oid].lastPoints=eval("("+chartObject.lastPoints+")");chartsArray[params.oid].i=invite;chartsArray[params.oid].d=deleted;chartsArray[params.oid].subscribers=subscribers;chartsArray[params.oid].lastUpdate=lastUpdate;chartsArray[params.oid].saved=saved;updateWallPost(response,chartId);chartsArray[params.oid].feedObject=jQuery("#feedData").clone();jQuery("#chartDiscussion").scrollTop(0);fillChartSettings(chartSettings,chartName,timeScale,publishChart,chartId,userVote,totalVotes,views,type,invite,deleted,subscribers,chartsArray[params.oid].users);if(!hasText(chartObject.lastPoints)){showChartMsg("Chart is not available currently, please try again later.<br/><br/>We apologize for the inconvenience.")}fxWebsocket.subscribe(firstSymbol,timeScale,null,null);if(secondSymbol!=null){fxWebsocket.subscribe(secondSymbol,timeScale,null,null)}if(thirdSymbol!=null){fxWebsocket.subscribe(thirdSymbol,timeScale,null,null)}chartsArray[params.oid].o.enableInteractivity();updateAnnotations(eval($F("chartOwner")))}if(params.objectId!=null&&params.post!=null){loadWallPostNotification(params.oid,params.notificationType,params.notificationId,params.postOid,"","")}delete chartsPosts[params.oid];if(chartsComments[params.oid]!=null){delete chartsComments[params.oid]}}haveChanges=false;sendMailToChartSubscribers=true;chartsLoader(false,loading);hideElement("feedLoader");if(params.type==chart_type_chart){$PT("showMoreWallPost").setAttribute("paging",2);showMoreBloack=true}if(params.load!=null&&params.load){changePostChoice(false,"0")}lastChartId=params.oid;updateChartNotification(true,lastChartId);hideElement("feedLoader");feedChannelSubscribe(true)}function clearIndicatorsLinks(){$PT("firstIndictorList").parentNode.parentNode.style.display="none";$PT("secondIndictorList").parentNode.parentNode.style.display="none";$PT("thirdIndictorList").parentNode.parentNode.style.display="none"}function createIndicatorsLinks(){clearIndicatorsLinks();$PT("firstIndictorList").innerHTML="";$PT("secondIndictorList").innerHTML="";$PT("thirdIndictorList").innerHTML="";var d=chart.objectModel.settings.charts;for(var c=0;c<d.length;c++){var a=d[c];var f=a.technicalIndicators;for(var b=0;b<f.length;b++){loadIndicator(f[b],a.id,false)}}}function getChartSymbol(a){if(a==1){return chartsArray[lastChartId].firstSymbol}else{if(a==2){return chartsArray[lastChartId].secondSymbol}else{if(a==3){return chartsArray[lastChartId].thirdSymbol}}}}function removeChartConfirm(){var a={title:"Chart Alert",message:$T("tConfirmChartDelete"),okMessageBtn:"Delete",okOnClickEvent:"removeChart();",okBtnClass:"btn red"};buildModalMessageDialog(a)}function removeChart(b){var a=lastChartId;if(b!=null){a=Number(b)}tabs=$$PT("#chartsTabs li");if(tabs.length>2||b!=null){fxAjax.sendRequest(fxVars.removeChart+a,{params:{chartId:a},callback:"removeChartResponse"})}reloadAds()}function removeChartResponse(d,c){if(!d.error){var l=c.chartId;var h=$PT("chartTab"+l);if(h!=null){h.remove()}tabs=$$PT("#chartsTabs li");var g=tabs[tabs.length-2];if(g!=null){switchTab("tabs21","chartContainer",g);loadChart(g.getAttribute("chartOid"),chart_type_chart,true)}initializeTabScroller();var f=$PT("publishChart"+l);var b=$PT("userChart"+l);if(f){f.remove()}if(b){b.remove()}var k=$PT("chart"+l);if(k){k.remove()}delete chartsArray[l];hideElement("seriesSettings");if($PT("createNewChart")!=null){$PT("createNewChart").disabled=false}var a=$PT("chartMenuItem"+c.chartId);if(a){a.parentNode.remove()}userChartsCount--;if(userChartsCount==1){hideElement("removeChart")}showElement("newChart");scroolToSelectedChart()}}function publishChartConfirm(b){chart.deselectAnnotaion();haveChanges=true;sendMailToChartSubscribers=true;saveCharts(false,chart_type_chart);if($PT("publishChart").innerHTML!=$T("tPublished")){var c="Publish your chart to share it with the Myfxbook community and make it public.<br/>After publication, others can follow, discuss and analyze it in real-time!";var a={title:"Chart Alert",message:c,okMessageBtn:"Publish Chart",okOnClickEvent:"updatePublishChart();",textAlignCenter:false};buildModalMessageDialog(a)}}function updatePublishChart(a){if(lastChartId!=0){fxAjax.sendRequest(fxVars.updatePublishChart+lastChartId+"&invite="+chartsArray[lastChartId].i,{params:{oid:lastChartId,element:$PT("publishChart")},callback:"updatePublishChartResponse"})}else{(publishChart)?showElement("chartTopicDiscussion"):hideElement("chartTopicDiscussion")}}function updatePublishChartResponse(a,c){if(!a.error){var b=c.element;b.innerHTML=$T("tPublished");b.className="default buttonOn floatRight";haveChanges=true;sendMailToChartSubscribers=true;if(!TVC){saveCharts(false,chart_type_chart);$PT("chartFirstSymbol").disabled="disabled"}else{b.onclick=function(){}}chartsArray[lastChartId].p=true}}function changeTimeScale(c){if(c!=null){quoteTime=c}var b=$$PT("#chartTimeScale li");for(var a=0;a<b.length;a++){if(b[a].getAttribute("value")==c){b[a].className="selected";$PT("chartTimeScaleLabel").innerHTML=b[a].getAttribute("time")}else{b[a].className=""}}}function getQuotesByTime(c){$PT("chartTimeScaleLabel").innerHTML=c.getAttribute("time");var g=c.value;chartsLoader(true,loading);if(g!=null){quoteTime=g}var h=chart.getFirstDate();var a=chart.getLastDate();var b;b=getChartSymbol(1);var d=getChartSymbol(2);if(hasText(d)&&d!=getChartSymbol(1)){b+="%2c"+d}var f=getChartSymbol(3);if(hasText(f)&&f!=getChartSymbol(1)&&f!=d){b+="%2c"+f}fxAjax.sendRequest(fxVars.getQuotes+quoteTime+"&symbols="+b,{params:{firstSymbol:getChartSymbol(1),secondSymbol:d,thirdSymbol:f,start:h,end:a},callback:"getQuotesByTimeResponse"})}function getQuotesByTimeResponse(response,params){if(!response.error){var lastPoints=response.content.lastPoint;if(hasText(lastPoints)){chartsArray[lastChartId].lastPoints=eval("("+lastPoints+")")}chart.removeDataRange("dataSetFirstQuoteSymbol",params.start,params.end);chart.removeDataRange("dataSetSecondQuoteSymbol",params.start,params.end);chart.removeDataRange("dataSetThirdQuoteSymbol",params.start,params.end);if(params.firstSymbol){chart.appendData("dataSetFirstQuoteSymbol",response.content.quotesData[params.firstSymbol])}if(hasText(params.secondSymbol)){chart.appendData("dataSetSecondQuoteSymbol",response.content.quotesData[params.secondSymbol]);fxWebsocket.subscribe(params.secondSymbol,quoteTime,null,null)}if(hasText(params.thirdSymbol)){chart.appendData("dataSetThirdQuoteSymbol",response.content.quotesData[params.thirdSymbol]);fxWebsocket.subscribe(params.thirdSymbol,quoteTime,null,null)}chart.commitDataChanges();var startDate=new Date(chart.getLastDate().getTime()-quoteTime*60*1000*100);chart.zoomTo(startDate,chart.getLastDate());changeCurrentTabName(false);fxWebsocket.subscribe(params.firstSymbol,quoteTime,null,null)}chartsLoader(false,loading);updateChartMenu();chartsArray[lastChartId].t=quoteTime}function updateSeriesScale(){var g=getChartSymbol(1);var c=getChartSymbol(2);var d=getChartSymbol(3);var a=chart.getChartById("main");var b=symbolsDecimals[g];var f="{%Value}{numDecimals:"+b+",plusSign:false}";if(hasText(c)||hasText(d)){f="{%Value}{numDecimals:2,plusSign:true}%";a.valueAxes.primary.scale.mode="PercentChanges";a.valueAxes.primary.labels.format=f;changeValueAxisToPercent(true)}else{a.valueAxes.primary.scale.mode="Values";a.valueAxes.primary.labels.format=f;changeValueAxisToPercent(false)}chart.getSeriesById("main","dataSetFirstQuoteSymbolSeries").valueHighlighter.labels[0].format=f;changeSeriesFormat()}function updateSymbolByDataSetId(a,b){switch(a){case"dataSetFirstQuoteSymbol":chartsArray[lastChartId].firstSymbol=b;break;case"dataSetSecondQuoteSymbol":chartsArray[lastChartId].secondSymbol=b;break;case"dataSetThirdQuoteSymbol":chartsArray[lastChartId].thirdSymbol=b;break}updateSeriesScale()}function getQuotesData(m,f){haveChanges=true;sendMailToChartSubscribers=true;chartsLoader(true,loading);var g=m.getAttribute("dataSet");if(owner){fxWebsocket.sendToChart(lastChartId,{type:"compare",o:{elementId:m.id,symbol:f},callback:"chartUpdate"})}if(hasText(f)){var a=chart.getFirstDate();var h=chart.getLastDate();fxAjax.sendRequest(fxVars.getQuotes+quoteTime+"&symbols="+f,{params:{dataSetId:g,symbol:f,start:a,end:h},callback:"quotesResponse"})}else{chart.getSeriesById("main",g+"Series").enabled=false;chart.applySettingsChanges();chartsLoader(false,loading);f="";var k;updateSymbolByDataSetId(g,f)}switch(g){case"dataSetFirstQuoteSymbol":$PT("chartFirstSymbol").value=f;$PT("firstSeriesName").innerHTML=f;k="dpFirstQuoteSymbol";break;case"dataSetSecondQuoteSymbol":$PT("chartSecondSymbol").value=f;$PT("secondSeriesName").innerHTML=f;k="dpSecondQuoteSymbol";break;case"dataSetThirdQuoteSymbol":$PT("chartThirdSymbol").value=f;$PT("thirdSeriesName").innerHTML=f;k="dpThirdQuoteSymbol";break}var d=[];if(!hasText(f)){var q=chart.objectModel.settings.charts;for(var r=0;r<q.length;r++){var b=q[r].technicalIndicators;for(var l=0;l<b.length;l++){if(b[l].dataProvider==k){var o=$PT("remove"+b[l].id);if(o!=null){d.push(o)}}}}}if(d.length>0){for(var l=0;l<d.length;l++){d[l].onclick()}}}function updateChartMenu(){var c=$PT("chartMenuItem"+lastChartId);if(c!=null){var b=getChartSymbol(1)+","+$PT("chartTimeScaleLabel").innerHTML;var a=createChartUrl(lastChartId,null,null,null,b);c.innerHTML=b;c.href=a}}function quotesResponse(response,params){if(!response.error){if(params.symbol){var dataSetId=params.dataSetId;var series=dataSetId+"Series";chart.removeDataRange(dataSetId,params.start,params.end);chart.appendData(dataSetId,response.content.quotesData[params.symbol]);chart.commitDataChanges();chart.getSeriesById("main",series).name=params.symbol;chart.getSeriesById("main",series).enabled=true;chart.applySettingsChanges();haveChanges=true;sendMailToChartSubscribers=true;updateSymbolByDataSetId(dataSetId,params.symbol);if(dataSetId=="dataSetFirstQuoteSymbol"){changeCurrentTabName(true)}updateChartMenu()}}var lastPoints=eval("("+response.content.lastPoint+")");if(hasText(lastPoints)){for(var i in lastPoints){chartsArray[lastChartId].lastPoints[i]=lastPoints[i]}}chart.applySettingsChanges();chartsLoader(false,loading);fxWebsocket.subscribe(params.symbol,quoteTime,null,null)}function onSeriesTypeChange(g,d,m){var h=chart.getSeriesById("main",dataSetType);h.type=g.getAttribute("value");if(h.type){var a=$$PT("#seriesType li");for(var k=0;k<a.length;k++){if(a[k]!=g){a[k].className=""}else{a[k].className="selected"}}$PT("seriesTypeLabel").innerHTML=g.innerHTML;var c=$PT("chartProfileSeriesColor");$PT("candlestickRisingLineColor").setAttribute("hex",((h.type=="Candlestick")?h.candlestickSeries.rising.line.color:"#000000"));$PT("candlestickRisingBorderColor").setAttribute("hex",(h.type=="Candlestick")?h.candlestickSeries.rising.border.color:"#000000");$PT("candlestickRisingFillColor").setAttribute("hex",(h.type=="Candlestick")?h.candlestickSeries.rising.fill.color:"#000000");$PT("candlestickFallingLineColor").setAttribute("hex",(h.type=="Candlestick")?h.candlestickSeries.falling.line.color:"#000000");$PT("candlestickFallingBorderColor").setAttribute("hex",(h.type=="Candlestick")?h.candlestickSeries.falling.border.color:"#000000");$PT("candlestickFallingFillColor").setAttribute("hex",(h.type=="Candlestick")?h.candlestickSeries.falling.fill.color:"#000000");new jscolor.color($PT("candlestickRisingLineColor"));new jscolor.color($PT("candlestickRisingBorderColor"));new jscolor.color($PT("candlestickRisingFillColor"));new jscolor.color($PT("candlestickFallingLineColor"));new jscolor.color($PT("candlestickFallingBorderColor"));new jscolor.color($PT("candlestickFallingFillColor"));if(h.type!="Candlestick"){c.setAttribute("hex",h.color);new jscolor.color(c)}$PT("ohlcRising").setAttribute("hex",(h.type=="OHLC")?h.ohlcSeries.rising.color:"#000000");$PT("ohlcFaling").setAttribute("hex",(h.type=="OHLC")?h.ohlcSeries.falling.color:"#000000");new jscolor.color($PT("ohlcRising"));new jscolor.color($PT("ohlcFaling"));var b=$$PT("#addSeriesAndIndicators [class=Candlestick]");var l="";if(h.type!="Candlestick"&&h.type!="OHLC"){l="none";showElement("seriesColor");hideElement("ohlcSeries")}else{if(h.type=="OHLC"){showElement("ohlcSeries");hideElement("seriesColor");l="none"}else{hideElement("seriesColor");hideElement("ohlcSeries")}}for(var k=0;k<b.length;k++){b[k].style.display=l}chart.applySettingsChanges();if(m==null||m){haveChanges=true;sendMailToChartSubscribers=true}if(d==null||d){var f={type:"seriesTypeChange",o:{id:g.getAttribute("value"),dataSetType:dataSetType},callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,f)}}}function onSeriesColorChange(b){chart.getSeriesById("main",dataSetType).color="#"+$AT($PT("chartProfileSeriesColor"),"hex");chart.applySettingsChanges();haveChanges=true;sendMailToChartSubscribers=true;if(b){var a={type:"seriesColorChange",o:{color:$AT($PT("chartProfileSeriesColor"),"hex"),dataSetType:dataSetType},callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,a)}}function changeChartBackroundColor(c,g,l,k){var f=chart.objectModel.settings.charts;var a;if(c){a=c}else{a="#"+$AT($PT("chartProfileBackgroundColor"),"hex")}for(var d=0;d<f.length;d++){f[d].background.fill.color=a;f[d].legend.background.fill.color=a;f[d].xAxis.labels.background={fill:{color:a}}}chart.objectModel.settings.background.fill.color=a;chart.objectModel.settings.scroller.outsideSelectedRange.backgroundFill.color=a;var h=chart.objectModel.settings.defaults.chart.valueAxes.primary.axisMarkers.lineMarkers;for(var d=0;d<h.length;d++){h[d].labels[0].font.color=a}if(!l){haveChanges=true;sendMailToChartSubscribers=true}if(g){createCross($PT("cross"),true)}if(k){var b={type:"backroundColor",o:$PT("chartProfileBackgroundColor").getAttribute("hex"),callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,b)}}function changeCandlestickSettings(f,a){var d=chart.getSeriesById("main",dataSetType);var b="#"+f.getAttribute("hex");switch(f.id){case"candlestickRisingLineColor":d.candlestickSeries.rising.line.color=b;break;case"candlestickRisingBorderColor":d.candlestickSeries.rising.border.color=b;break;case"candlestickRisingFillColor":d.candlestickSeries.rising.fill.color=b;break;case"candlestickFallingLineColor":d.candlestickSeries.falling.line.color=b;break;case"candlestickFallingBorderColor":d.candlestickSeries.falling.border.color=b;break;case"candlestickFallingFillColor":d.candlestickSeries.falling.fill.color=b;break}chart.applySettingsChanges();haveChanges=true;sendMailToChartSubscribers=true;if(a){var c={type:"candlestickSettings",o:{color:f.getAttribute("hex"),id:f.id,dataSetType:dataSetType},callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,c)}}function changeOhlcSettings(d,f){var c=chart.getSeriesById("main",dataSetType);var a="#"+d.getAttribute("hex");switch(d.id){case"ohlcRising":if(c.ohlcSeries==null){c.ohlcSeries={rising:{color:a}}}else{c.ohlcSeries.rising={color:a}}break;case"ohlcFaling":if(c.ohlcSeries==null){c.ohlcSeries={falling:{color:a}}}else{c.ohlcSeries.falling={color:a}}break}chart.applySettingsChanges();haveChanges=true;sendMailToChartSubscribers=true;if(f){var b={type:"ohlcSettings",o:{color:d.getAttribute("hex"),id:d.id,dataSetType:dataSetType},callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,b)}}function showGrid(a,g){var d=chart.objectModel.settings.charts;for(var c=0;c<d.length;c++){var f=d[c];if(f){f.valueAxes.primary.grid.enabled=a;f.xAxis.majorGrid.enabled=a;f.xAxis.minorGrid.enabled=a;chart.applySettingsChanges()}}haveChanges=true;sendMailToChartSubscribers=true;if(g){var b={type:"showGrid",o:a,callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,b)}}var dataSetType="dataSetFirstQuoteSymbolSeries";var dataProvider="dpFirstQuoteSymbol";var selectedIndicatorList="firstIndictorList";function hideEditDlg(){dlg.style.display="none"}function changeChartGridColor(c){var f=chart.objectModel.settings.charts;var a="#"+$AT($PT("chartProfileGridColor"),"hex");for(var d=0;d<f.length;d++){if(f[d].valueAxes.primary.grid==null){f[d].valueAxes.primary={grid:{line:{color:a}}}}else{f[d].valueAxes.primary.grid.line.color=a}if(f[d].xAxis.majorGrid==null){f[d].xAxis.majorGrid={line:{color:a}}}else{f[d].xAxis.majorGrid.line.color=a}if(f[d].xAxis.minorGrid==null){f[d].xAxis.minorGrid={line:{color:a}}}else{f[d].xAxis.minorGrid.line.color=a}}chart.applySettingsChanges();haveChanges=true;sendMailToChartSubscribers=true;if(c){var b={type:"gridColor",o:$AT($PT("chartProfileGridColor"),"hex"),callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,b)}}function exitChartPage(a){if(userLogin!=null&&owner!=null&&(haveChanges&&owner)){chart.deselectAnnotaion();saveCharts(false,chart_type_chart,false)}}function createNewChart(){if(!chartLoading){chartLoading=true;hideElement("seriesSettings");try{saveCharts(false,chart_type_chart)}catch(g){}chartsLoader(true,loading);var d=Math.floor(Math.random()*99999);var a="EURUSD,M30 ";var h=$PT("chartsTabs");var l=new Element("li",{className:"off"});var k=new Element("span",{});var b=new Element("span",{className:"chartSettings radius3 padd2"});var c=new Element("span",{id:"",style:"display:none"});var f=new Element("a",{className:"pointer"});b.onmouseout=function(){if(this.parentNode.parentNode.className=="on"){this.style.opacity="0.6"}};b.onmouseover=function(){if(this.parentNode.parentNode.className=="on"){this.style.opacity="1"}this.className="chartSettings radius3 padd2";this.style.opacity=0.6};f.onclick=function(){showSeriesSettings(this)};k.innerHTML=a;f.appendChild(b);l.appendChild(k);l.appendChild(f);l.appendChild(c);h.insertBefore(l,$PT("createNewChart"));switchTab("tabs21","chartContainer",l);initializeTabScroller();fxAjax.sendRequest(fxVars.newChart,{params:{li:l,span:k,name:a,spanNotification:c},callback:"createNewChartResponse"})}}function createNewChartResponse(response,params){if(!response.error){var quotesData=response.content.quotesData;userChartsCount++;var oid=response.content.oid;params.li.id="chartTab"+oid;params.li.setAttribute("chartOid",oid);params.span.id="chartName"+oid;params.spanNotification.id="chartNotification"+oid;params.spanNotification.className="countRedSmall";params.li.onclick=function(){if(!chartLoading&&this.className=="off"){loadChart(oid,chart_type_chart);switchTab("tabs21","chartContainer",params.li)}};var defaultTimeScale=30;createChartFlash(oid,false,params.name,defaultTimeScale,"EURUSD","","",false,0,false,0,chart_type_chart,response.content.lastPoint,response.content.invite,false,0,dt.getTime(),"");var config=response.content.config;if(config){chart.setConfig(config);chart.objectModel=eval("("+config+")")}fillChartSettings(null,params.name,defaultTimeScale,false,oid,false,0,0,chart_type_chart,response.content.invite,false,0,null);haveChanges=true;sendMailToChartSubscribers=true;updateWallPost(response,oid);jQuery("#userComment").autosize();selectTool("crossP");showElement("removeChart");updateChartNotification(true,lastChartId);if(!quotesData){showChartMsg("Chart is not available currently, please try again later.<br/><br/>We apologize for the inconvenience.")}fxWebsocket.subscribe("EURUSD",30,null,null)}scroolToSelectedChart();feedChannelSubscribe(true)}function chartsLoader(b,d,c){var a=chart;if(c!=null){a=c}if(b){if(a.showWaitingState(d)){a.disableInteractivity();chartLoaderOff=false}}else{if(a.hideWaitingState()){a.enableInteractivity();chartLoaderOff=true}}}function changeCurrentTabName(a){sendMailToChartSubscribers=(haveChanges||a);currentTabNameChanged=true;var d=$PT("chartName"+lastChartId);var c=$$PT("#chartTimeScale [class=selected]")[0];var b=getChartSymbol(1)+","+c.getAttribute("time")+" ";if(d){d.innerHTML=b;saveCharts(false,chart_type_chart);updateChartFacebookData(lastChartId,b)}}var indicatorList=[{id:"dataSetFirstQuoteSymbolSeries",list:"firstIndictorList"},{id:"dataSetSecondQuoteSymbolSeries",list:"secondIndictorList"},{id:"dataSetThirdQuoteSymbolSeries",list:"thirdIndictorList"}];function changeIndicatorsList(){var b=$$PT("#dataSetType [class=selected]")[0];var f=b.getAttribute("value");dataProvider=b.getAttribute("dataProvider");switch(f){case"dataSetSecondQuoteSymbolSeries":selectedIndicatorList="secondIndictorList";break;case"dataSetThirdQuoteSymbolSeries":selectedIndicatorList="thirdIndictorList";break;default:selectedIndicatorList="firstIndictorList";break}dataSetType=f;var d=$$PT("#dataSetType li");for(var a=0;a<d.length;a++){if(d[a]!=b){d[a].className=""}else{d[a].className="selected"}}$PT("seriesLabel").innerHTML=b.innerHTML;var c=chart.getSeriesById("main",dataSetType).type;var d=$$PT("#seriesType li");for(var a=0;a<d.length;a++){if(d[a].getAttribute("value")!=c){d[a].className=""}else{d[a].className="selected"}}$PT("seriesTypeLabel").innerHTML=c;initSeriesSettings()}function initSeriesSettings(){try{var k=chart.getChartById("main");var d=chart.getSeriesById("main",dataSetType);var b=$PT("chartProfileSeriesColor");if(d.type){var h=$$PT("#seriesType li[value="+d.type+"]")[0];if(h!=null){onSeriesTypeChange(h,false,false);hideElement("seriesType")}}if(k!=null){var c=$PT("chartProfileBackgroundColor");if(c!=null){c.setAttribute("hex",k.background.fill.color);new jscolor.color(c)}}$PT("textColor").setAttribute("hex",chart.objectModel.settings.scroller.gridLine.color);new jscolor.color($PT("textColor"));var a=k.valueAxes.primary.grid;var l=a.line.color;$PT("chartProfileGridColor").setAttribute("hex",l);new jscolor.color($PT("chartProfileGridColor"));$PT("showGrid").checked=a.enabled;var f=chart.objectModel.settings.scroller.insideSelectedRange.seriesFill.color;$PT("scrollerColor").setAttribute("hex",f);new jscolor.color($PT("scrollerColor"));$PT("chartTimeScaleLabel").innerHTML=$PT("chartProfileTime"+quoteTime).getAttribute("time");changeTextColor(false,true,false);changeChartBackroundColor(null,null,true,false);showCross();if(userChartsCount==1){hideElement("removeChart")}if($$PT("#indicatorFirstOption a[remove]").length>0){hideElement("noIndicators")}else{showElement("noIndicators")}}catch(g){}}function changeValueAxisToPercent(f){var b=symbolsDecimals[getChartSymbol(1)];var a=(b!=null)?b:5;var d="{%Value.LastVisible}";var c="{%Value}{numDecimals:"+a+",plusSign:false}";if(f){d="{%PercentValueChange.LastVisible}";c="{%Value}{numDecimals:2,plusSign:false}%"}chart.objectModel.settings.defaults.chart.valueAxes.primary.axisMarkers.lineMarkers[0].valueToken=d;chart.objectModel.settings.defaults.chart.valueAxes.primary.axisMarkers.lineMarkers[0].labels[0].format=c}function initSymbols(){changeSymbolSelect("chartFirstSymbol","EURUSD");changeSymbolSelect("chartSecondSymbol","");changeSymbolSelect("chartThirdSymbol","")}function showSeriesSettings(a){if(a.parentNode.className.indexOf("off")==-1){showElement("seriesSettings")}}function voteForChart(a){if(a.className.indexOf("buttonOn")!=-1){vote=0}else{vote=1}fxAjax.sendRequest(fxVars.voteForChart+lastChartId+"&vote="+vote+"&invite="+chartsArray[lastChartId].i,{params:{element:a},callback:"voteForChartResponse"})}function voteForChartResponse(a,d){if(!a.error){var b=d.element;var c;if(b.className.indexOf("buttonOn")!=-1){b.className=" floatRight marginR10  pointer buttonOff";chartsArray[lastChartId].userVote=false}else{if(b.className.indexOf("buttonOff")!=-1){b.className=" floatRight marginR10  pointer buttonOn";chartsArray[lastChartId].userVote=true}}if(c!=null){chartsArray[lastChartId].totalVotes=c}}}function undoRedo(g,c){haveChanges=true;sendMailToChartSubscribers=true;var d=g[lastChartId];if(d!=null){var a=d.pop(d.length-1);if(a){if(a.all!=null){if(c==0){pushToAnnotationList(a,false);for(var b=0;b<a.annontations.length;b++){if(a.annontations[b]!=null){chart.addAnnotation(a.annontations[b]);pushAnnotation(a.annontations[b].id)}}}else{pushToAnnotationList(a,true);chart.removeAllAnnotations();fxWebsocket.sendToChart(lastChartId,{type:"annotationRemoveAll",o:{},callback:"chartUpdate"})}}else{var f=chart.getAnnotationAsJSON(a.id);if(f==null){f={newElement:true,id:a.id}}if(c==0){pushToAnnotationList(f,false)}else{pushToAnnotationList(f,true)}if(f){chart.removeAnnotation(a.id);fxWebsocket.sendToChart(lastChartId,{type:"annotationRemove",o:{id:a.id},callback:"chartUpdate"})}if(!a.newElement){chart.addAnnotation(a);pushAnnotation(a.id)}}}}}function addTemplate(d){var h=d.keyCode?d.keyCode:d.which?d.which:d.charCode;if(h==13){var g=[];var a=$F("templateName");var c={};c.c=chart.objectModel.settings.charts;c.s=chart.objectModel.settings.scroller;c.b=chart.objectModel.settings.background;g.push(c);var f=["templateName=",a,"&template=",encodeParameter(traceObject(g,chart))];var b={};b.b=chart.objectModel.settings.background.fill.color;b.b=chart.objectModel.settings.background.fill.color;fxAjax.sendRequest(fxVars.addTemplate,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:f.join(""),params:{template:traceObject(g,chart),templateName:a},loader:false,callback:"addTemplateResponse"})}}function addTemplateResponse(response,params){if(!response.error){var oid=response.content.oid;var mainDiv=$PT("templateList");var li=new Element("li",{id:"templateRemove"+oid});li.innerHTML=params.templateName;var a=new Element("a",{className:"floatRight closer"});li.onclick=function(){loadTemplate(oid,params.templateName,true);hideElement("tempateSelect")};a.onclick=function(e){removeTemplate(oid);e.stopPropagation()};li.appendChild(a);mainDiv.appendChild(li);$PT("templateName").value="New Template...";$PT("templateName").blur();haveChanges=true;sendMailToChartSubscribers=true;templates[oid]=eval("("+params.template+")")}}function removeTemplate(a){fxAjax.sendRequest(fxVars.removeTemplate+a,{params:{oid:a},callback:"removeTemplateResponse"})}function removeTemplateResponse(a,c){if(!a.error){var b=$PT("templateRemove"+c.oid);if(b){b.remove()}selectDefaultTemplate()}}function loadTemplate(id,name,sendLoadTemplate){if(id!=null){var elements=$$PT("#templateList li");for(var i=0;i<elements.length;i++){if(elements[i].id=="templateRemove"+id){elements[i].className="selected"}else{elements[i].className=""}}$PT("tempateSelectName").innerHTML=name+'<img alt="" src="../../../images/controlDown.png">';var secondSeries=$F("chartSecondSymbol");var thirdSeries=$F("chartThirdSymbol");var template=eval("("+traceObject(templates[id],chart)+")");chart.objectModel.settings.charts=template[0]["c"];chart.objectModel.settings.scroller=template[0]["s"];chart.objectModel.settings.background=template[0]["b"];chart.getSeriesById("main","dataSetFirstQuoteSymbolSeries").name=getChartSymbol(1);var second=chart.getSeriesById("main","dataSetSecondQuoteSymbolSeries");var third=chart.getSeriesById("main","dataSetThirdQuoteSymbolSeries");if(hasText(secondSeries)){second.name=secondSeries;second.enabled=true}else{second.enabled=false}if(hasText(thirdSeries)){third.name=thirdSeries;third.enabled=true}else{third.enabled=false}updateSeriesScale();chart.applySettingsChanges();createIndicatorsLinks();initSeriesSettings();haveChanges=true;sendMailToChartSubscribers=true;saveCharts(false,chart_type_chart);if(sendLoadTemplate){var object={type:"loadTemplate",o:{id:id,template:templates[id]},callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,object)}}}function updateWallPost(a,c){var b=a.content.wallPost;if(b!=null){$PT("feedData").innerHTML=b;chartsArray[c].feedObject=jQuery("#feedData").clone();updateFeedScrooler("chartDiscussion",true)}}function updateChartView(){var b=lastChartId+"&r="+Math.random();var a=new Element("img",{src:"/ucv.jpg?id="+b,style:"display:none"})}function updateChartSubscribers(c,b){var a=(TVC)?c:c.checked;fxAjax.sendRequest(fxVars.updateChartSubscribers+a+"&chartId="+lastChartId+"&invite="+b,{params:{element:c,subscribe:a}})}function chartAlert(a){$PT("chartAlert").innerHTML=a;showElement("chartAlert")}var chartsPoints={};var chartsDataSets=["dataSetFirstQuoteSymbol","dataSetSecondQuoteSymbol","dataSetThirdQuoteSymbol"];var chart_type_chart=0;var chart_type_scenario=1;function addScenario(f,b,d,c,a){saveCharts(true,chart_type_scenario,{text:f,toUid:b,commentId:d,wallPostType:c,objectId:a,internalType:chart_type_scenario})}function loadScenario(chartId,scenarioId,element){chartsLoader(true,loading);var load=eval(element.getAttribute("scenario"));var id=chartId;var type=chart_type_chart;var scenarios=$$PT("#userMessages [scenario]");for(var i=0;i<scenarios.length;i++){scenarios[i].className="pointer floatRight scenarioOn";scenarios[i].setAttribute("scenario","true")}if(load){id=scenarioId;element.className="pointer floatRight scenarioOn";type=chart_type_scenario}else{element.className="pointer floatRight scenarioOff"}loadChart(id,type,false,true);element.setAttribute("scenario",!load)}var updateScenario=false;function changePostChoice(d,f,b){var c=$F("userId");if(hasText(c)&&c!=0){if(d){haveChanges=true;sendMailToChartSubscribers=true;saveCharts(false,chart_type_chart);hideElement("userComment");showElement("scenarioMsg");hideElement("addWallPost");updateScenario=true;showScenarioMode(null,false,true)}else{var a=getWallPostIdsByType(b).postText;var g=getWallPostIdsByType(b).commentText;if($PT(a+f).style.display=="none"){showElement(a+f);$PT(g+f).focus()}else{hideElement(a+f);$PT(g+f).blur()}showElement(getWallPostIdsByType(b).userComment);updateFeedScrooler(getWallPostIdsByType(b).discussion,false);updateScenario=false}}}function showScenarioMode(d,c,a){var b="#"+$AT($PT("chartProfileBackgroundColor"),"hex");if(c){b=d.settings.background.fill.color}var f=[{anchor:"TopCenter",xPadding:0,yPadding:50,format:"Scenario Mode",font:{family:"Arial",color:b,size:15,bold:true},background:{enabled:true,fill:{enabled:true,color:"#"+$AT($PT("textColor"),"hex")},insideMargin:{left:10,top:1,right:10,bottom:0},corners:{type:"Rounded",all:"4"}}}];if(c){d.settings.labels=f}else{if(a){chart.objectModel.settings.labels=f}else{chart.objectModel.settings.labels=[]}chart.applySettingsChanges()}}function changeTextColor(k,u,l){var b=chart.objectModel.settings;if(!u){haveChanges=true;sendMailToChartSubscribers=true}var t="#"+$PT("textColor").getAttribute("hex");var s;var a;for(var d=0;d<b.charts.length;d++){var q=b.charts[d];q.legend.title.font={color:t};q.legend.dateTime.font={color:t};var h=q.seriesList;if(h!=null){for(var g=0;g<h.length;g++){var m=symbolsDecimals[h[g].name];var f=(m!=null)?m:5;s='<textformat><font size="10" color="'+t+'">{%SeriesName}:</font></textformat><textformat><font color="'+t+'">O: {%Open.LastVisible}{numDecimals:'+f+",plusSign:false}   H: {%High.LastVisible}{numDecimals:"+f+",plusSign:false}   L: {%Low.LastVisible}{numDecimals:"+f+",plusSign:false}   C: {%Close.LastVisible}{numDecimals:"+f+",plusSign:false}</font></textformat>";a='<textformat><font size="10" color="'+t+'">{%SeriesName}:</font></textformat><textformat><font color="'+t+'">O: {%Open.Current}{numDecimals:'+f+",plusSign:false}   H: {%High.Current}{numDecimals:"+f+",plusSign:false}   L: {%Low.Current}{numDecimals:"+f+",plusSign:false}   C: {%Close.Current}{numDecimals:"+f+",plusSign:false}</font></textformat>";h[g].legendItem.labels.focusSettings.mouseOut.format=s;h[g].legendItem.labels.focusSettings.mouseOver.format=a}}else{if(q.legend.labels.focusSettings!=null){var r=q.legend.labels.focusSettings.mouseOut.format.indexOf("numDecimals:")+12;f=q.legend.labels.focusSettings.mouseOut.format[r];q.legend.labels.focusSettings.mouseOut.format='{%SeriesIcon} <b><font color="%Color">{%SeriesName} </font><font color="'+t+'">{%Value.LastVisible}{numDecimals:'+f+"}</font>";q.legend.labels.focusSettings.mouseOver.format='{%SeriesIcon} <b><font color="%Color">{%SeriesName} </font><font color="'+t+'"> {%Value.Current}{numDecimals:'+f+"}</font>"}}if(q.xAxis.labels.majorLabels!=null){q.xAxis.labels.majorLabels.font={bold:false,family:"Arial",size:10,color:t}}if(q.xAxis.labels.minorLabels!=null){q.xAxis.labels.minorLabels.font={bold:false,family:"Arial",size:10,color:t}}q.xAxis.dateHighlighter.line.color=t;q.valueAxes.primary.labels.font={color:t};q.legend.background.border={color:t};q.background.border={color:t}}b.scroller.timeScale.labels.font={color:t};chart.objectModel.settings.scroller.border={color:t};chart.objectModel.settings.scroller.selectedRangeOutline={color:t};chart.objectModel.settings.scroller.gridLine.color=t;var o=chart.objectModel.settings.defaults.chart.valueAxes.primary.axisMarkers.lineMarkers;for(var g=0;g<o.length;g++){o[g].labels[0].background.fill.color=t;o[g].line.color=t}if(k){createCross($PT("cross"),true)}if(l){var c={type:"textColor",o:$PT("textColor").getAttribute("hex"),callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,c)}}function changeScrollerColor(d){var c=chart.objectModel.settings;var a="#"+$AT($PT("scrollerColor"),"hex");c.scroller.insideSelectedRange.seriesFill.color=a;c.scroller.insideSelectedRange.seriesLine.color=a;c.scroller.outsideSelectedRange.seriesFill.color="LightColor(LightColor(LightColor("+a+")))";c.scroller.outsideSelectedRange.seriesLine.color=a;chart.objectModel.settings.scroller.insideSelectedRange.backgroundFill.color="LightColor(LightColor(LightColor("+a+")))";chart.applySettingsChanges();haveChanges=true;sendMailToChartSubscribers=true;if(d){var b={type:"scrollerColor",o:$AT($PT("scrollerColor"),"hex"),callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,b)}}function copyAnnotation(){var c=quoteTime*1000*60*2;var b=chart.getSelectedAnnotationId();if(b!=null){var a=chart.getAnnotationAsJSON(b);if(a!=null){a=changeDateTotimestamp(a,2,c);a.id=Math.random();chart.addAnnotation(a);haveChanges=true;sendMailToChartSubscribers=true}}}function createCross(d,c,a){var f="#"+$AT($PT("textColor"),"hex");var b="#"+$AT($PT("chartProfileBackgroundColor"),"hex");chart.getChartById("main").xAxis.dateHighlighter.labels[0].background.fill.color=f;chart.getChartById("main").xAxis.dateHighlighter.line.color=f;chart.getChartById("main").xAxis.dateHighlighter.labels[0].font.color=b;chart.getSeriesById("main","dataSetFirstQuoteSymbolSeries").valueHighlighter.labels[0].background.fill.color=f;chart.getSeriesById("main","dataSetFirstQuoteSymbolSeries").valueHighlighter.line.color=f;chart.getSeriesById("main","dataSetFirstQuoteSymbolSeries").valueHighlighter.labels[0].font.color=b;if(!c&&a!=null){chart.getChartById("main").xAxis.dateHighlighter.enabled=a;chart.getSeriesById("main","dataSetFirstQuoteSymbolSeries").valueHighlighter.enabled=a;$PT("cross").setAttribute("enable",a)}chart.applySettingsChanges()}function addCustomList(a,c,f){var d=$$PT("#"+a+" li");for(var b=0;b<d.length;b++){d[b].onclick=function(){if(!f){var h=$$PT("#"+a+" li[class=selected]")[0];if(h==this){return false}}for(var g=0;g<d.length;g++){if(d[g]!=this){d[g].className=""}else{d[g].className="selected"}}c(this)}}}function changeSymbolSelect(b,a){$PT(b).value=a}function updateFeedScrooler(d,a){var c=jQuery("#"+d);var b=c.data("jsp");b.reinitialise();if(a){b.scrollTo(0,0)}}function destroyFeedScroller(){var b=j("#chartDiscussion");var a=b.data("jsp");a.destroy()}function showCross(){var showCross=eval($PT("cross").getAttribute("enable"));if(showCross){selectTool("crossP")}else{selectTool("SelectionTool")}createCross($PT("cross"),false,showCross)}var chartTabsPosition=0;var tabLength=107;var tabsWidth=0;var spacerWidth=12;function chartTabsScroller(a){tabsWidth=$J(document).width()-(120+spacerWidth+(isShown("chartDiscussion")?300:0));tabs=$$PT("#chartsTabs li");if(a){if(((tabs.length)*tabLength)-tabsWidth>chartTabsPosition){chartTabsPosition+=tabLength;jQuery("#chartsTabs").animate({left:"-="+tabLength+"px"},500)}}else{if(chartTabsPosition-tabLength<=0){jQuery("#chartsTabs").animate({left:"+="+chartTabsPosition+"px"},300);chartTabsPosition=0}else{chartTabsPosition-=tabLength;jQuery("#chartsTabs").animate({left:"+="+tabLength+"px"},300)}}}function scroolToSelectedChart(){tabsWidth=$J(document).width()-(120+spacerWidth+(isShown("chartDiscussion")?300:0));var a=1;tabs=$$PT("#chartsTabs li");for(var b=0;b<tabs.length;b++){if(tabs[b].className=="on"){break}else{a++}}if((a*tabLength)<tabsWidth){chartTabsPosition=0}else{chartTabsPosition=a*tabLength-tabsWidth+tabLength+30}$PT("chartsTabs").style.left=-chartTabsPosition+"px"}function spacerIsDisplayed(element){var show=eval(element.getAttribute("show"));if(show){hideElement("chartFeed");hideElement("rightArrow");showElement("leftArrow");hideElement("feedTs");hideElement("feedBs");tabsWidth+=400}else{showElement("chartFeed");showElement("rightArrow");hideElement("leftArrow");showElement("feedBs");showElement("feedTs");tabsWidth-=400}element.setAttribute("show",!show);scroolToSelectedChart()}function updateSeriesData(){var a=chart.getChartById("main");for(var c=0;c<a.seriesList.length;c++){var b=a.seriesList[c];if(hasText(b.name)&&b.enabled){if(b.id=="dataSetFirstQuoteSymbolSeries"){changeSymbolSelect("chartFirstSymbol",b.name);$PT("firstSeriesName").innerHTML=b.name}else{if(b.id=="dataSetSecondQuoteSymbolSeries"){changeSymbolSelect("chartSecondSymbol",b.name);$PT("secondSeriesName").innerHTML=b.name}else{if(b.id=="dataSetThirdQuoteSymbolSeries"){changeSymbolSelect("chartThirdSymbol",b.name);$PT("thirdSeriesName").innerHTML=b.name}}}}}}var defaultTemplate="Light Gray";function fillChartSettings(r,c,y,w,u,z,B,o,g,x,t,f,v){$PT("cPname").innerHTML=c;if(t=="true"){$PT("chartDeleted").style.display=""}else{$PT("chartDeleted").style.display="none"}selectDefaultTemplate();initSymbols();updateSeriesData();createIndicatorsLinks();if(g==chart_type_chart&&hasText($F("userId"))){var h="#"+c.replace(/%2c/gi,"-").replace("/","").replace(" ","")+"/"+u+"/"+x;window.location.hash=h}changeTimeScale(y);var d=$PT("publishChart");if(d!=null){if(w){d.innerHTML=$T("tPublished");d.onclick=function(){};hideElement("privateChart")}else{showElement("privateChart");d.innerHTML=$T("tPublish");d.className="floatRight buttonOn";d.onclick=function(){publishChartConfirm(this)}}}(B!=null&&$PT("chartVoteCount")!=null)?$PT("chartVoteCount").innerHTML=B:0;(f!=null&&$PT("chartFollowCount")!=null)?$PT("chartFollowCount").innerHTML=f:0;var s=$PT("chartViews");if(s!=null){s.innerHTML=o}initSeriesSettings();var q=$PT("chartVote");if(q!=null){q.setAttribute("show",false)}hideElement("chartVotesWindow");var b=$PT("chartFollowing");if(b!=null){b.setAttribute("show",false)}hideElement("chartFollowingWindow");updateChartUsers(v);updateChartFacebookData(u,c);var k=$PT("chartFirstSymbol");(chartsArray[u].p)?k.disabled="disabled":k.disabled="";var m=false;try{m=chartsArray[u].feedObject.find("#userMessages").children().size()>0}catch(A){}if(!m){hideElement("discussLinkCont")}else{var a=$J("#linkToDiscussion");if(a!=undefined){var l="/forex-charts/"+c.replace(" ","")+"/discussion/";if(!w){l+=x+"/"}l+=u+",1";a.attr("href",l);showElement("discussLinkCont")}}}function createChartPost(a,h,d){if($PT("post"+a)==null){var b=new Element("div",{style:"display:none"});var g=new Element("div",{});b.innerHTML=h;g.innerHTML=h;var c=chartsArray[d].feedObject;var f=c.find("#userMessages");if(f.children().size()>0){jQuery(g).insertBefore(f.children()[0])}else{f.append(g)}$PT("userMessages").insertBefore(b,$PT("userMessages").firstChild);feedSlideDown(b,"chartDiscussion");runAjaxScripts(h);updateFeedLastTime()}}function addChartComment(a,k,g){var c=$PT("post"+a);if(c!=null){var d=new Element("div",{style:"display:none"});var h=new Element("div",{});d.innerHTML=k;h.innerHTML=k;var f=chartsArray[g].feedObject;var b=f.find("#"+c.id);b.append(h);c.appendChild(d);feedSlideDown(d,"chartDiscussion");updateFeedLastTime()}}function saveChartScreenshot(){try{hideElement("screenshotTd");showElement("screenshotLoading");showElement("chartScreenShotWindow");var a={width:300,height:100,top:100,resizable:false};a.close=function(d,f){jQuery.destroy("#chartScreenShotWindow")};chart.objectModel.settings.labels.push({anchor:"LeftBottom",yPadding:0,xPadding:0,format:"Chart by Myfxbook.com, GMT "+(userTime<0?userTime/3600000:"-"+userTime/3600000),background:{enabled:true,fill:{color:"#"+$AT($PT("chartProfileBackgroundColor"),"hex")},insideMargin:{all:3},border:{enabled:true,color:"#"+$PT("textColor").getAttribute("hex")}},font:{color:"#"+$PT("textColor").getAttribute("hex"),family:"tahoma",size:11,bold:true}});chart.applySettingsChanges();var b=["image=",encodeParameter(chart.getPNGImageBase64Encoded()),"&name=",$PT("chartName"+lastChartId).innerHTML]}catch(c){chart.objectModel.settings.labels=[];chart.applySettingsChanges()}fxAjax.sendRequest(fxVars.saveChartScreenshot,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:b.join(""),params:{},loader:false,callback:"saveChartScreenshotResponse"})}function saveChartScreenshotResponse(a){if(!a.error){var b=a.content.imageUrl;if(b!=null){$PT("chartScreenshotUrl").value=b;$PT("imageView").href=b}hideElement("screenshotLoading");showElement("screenshotTd")}chart.objectModel.settings.labels=[];chart.applySettingsChanges()}function showChartWindow(d){var c=$PT(d);var b=$$PT("[chartWindow]");for(var a=0;a<b.length;a++){if(b[a].id!=d){hideElement(b[a].id)}}if(isShown(c)){hideElement(c)}else{showElement(c)}}function updateFeedTimes(f,c){var b=$$PT(f);var d;for(var a=0;a<b.length;a++){d=dateToString(Number(b[a].getAttribute("time")));if(d!="false"){b[a].innerHTML=d}}b=[];if(c){b=$$PT(c)}for(a=0;a<b.length;a++){d=dateToString(Number(b[a].getAttribute("time")));if(d!="false"){b[a].innerHTML=d}}setTimeout("updateFeedTimes('"+f+"'"+(c?",'"+c+"'":"")+")",5000)}function updateAnnotations(a){if(!a){var c=chart.objectModel.annotations.annotationList;for(var b=0;b<c.length;b++){if(c[b]!=null){c[b].allowEdit=false}}chart.applyConfigChanges()}}function openNewChart(){var a=httpServerPath+"/forex-charts/";var b=$$PT("#chartsMenu li[chartItem]");a+="nc";window.location=a}function changeDateTotimestamp(object,type,userTime){for(var o in object){if(o=="firstTimeAnchor"||o=="secondTimeAnchor"||o=="thirdTimeAnchor"||o=="timeAnchor"){if(type==1){object[o]=object[o].getTime()-(userTime)}else{if(type==0){object[o]=new Date(eval(object[o])+(userTime))}else{if(type==2){object[o]=new Date(object[o].getTime()+(userTime))}}}}if((typeof object[o]=="object")){changeDateTotimestamp(object[o],type,userTime)}}return object}function chartUpdate(data){try{var type=data.type;var uid=Number($F("userId"));switch(type){case"inbox":var span=new Element("span",{});span.innerHTML=data.data;var updateInboxCount=data.updateInboxCount;removeExistsChildren(span,"inboxNotify");if($PT("inboxNotificationsTB")){$PT("inboxNotificationsTB").insertBefore(span,$PT("inboxNotificationsTB").firstChild);var inboxActivityCount=Number($PT("newInboxNotification").innerHTML);if(updateInboxCount){if(inboxActivityCount==0){$PT("newInboxNotification").className="countRed"}$PT("newInboxNotification").innerHTML=inboxActivityCount+1}updateFeedScrooler("inboxNotify",false)}newBubble(data.bubbleData);break;case"notifications":var span=new Element("span",{});var chartOid=data.chartOid;var wallPost=data.wallPost;var notificationType=data.notificationType;var notificationData=data.data;var bubbleData=data.bubbleData;if(hasText(notificationData)){if(uid!=data.from&&chartOid!=null&&lastChartId!=chartOid&&wallPost!=null){updateChartNotification(false,chartOid)}span.innerHTML=notificationData;if(notificationType!=-1){removeExistChildren(span,"notify")}if($PT("notificationsTB")){$PT("notificationsTB").insertBefore(span,$PT("notificationsTB").firstChild);var activityCount=Number($PT("newNotification").innerHTML);if(activityCount==0){$PT("newNotification").className="countRed"}$PT("newNotification").innerHTML=activityCount+1;updateFeedScrooler("notify",false)}}if(hasText(bubbleData)){newBubble(bubbleData)}var marketNotificationOid=data.marketNotificationOid;if(marketNotificationOid!=undefined){if(data.marketNotifyOff!=undefined&&data.marketNotifyOff){onOffMarketNotify(data.marketSymbolOid,"notifyOff")}removeDeletedMarketNotification(marketNotificationOid)}var calendarNotificationOid=data.calendarNotificationOid;if(calendarNotificationOid!=undefined){if(data.calendarNotificationIsSent!=undefined){onOffCalendarNotify(calendarNotificationOid,data.calendarNotificationIsSent)}}break;case"comment":var commnet=data.data;var postOid=data.post;var chartOid=Number(data.chartOid);var commentOid=Number(data.oid);var commentObject=$PT("comment"+commentOid);var pending=data.pending;var from=Number(data.from);var commentText=$PT("commentText"+postOid);if(commentText!=null){commentText.style.height="15px"}if(pending&&from==uid){break}if(commentObject==null){if(postOid!=null){var post=$PT("post"+postOid);if(post!=null){addChartComment(postOid,commnet,lastChartId)}else{var chartsData=[];if(chartsComments[chartOid]!=null){chartsData=chartsComments[chartOid]}chartsData.push({c:commnet,p:postOid,id:commentOid});chartsComments[chartOid]=chartsData;updateFeedLastTime()}if(uid!=from){goToChartNotification("comment"+commentOid,false,false)}else{wallPostChangeOwnerSettings()}}}break;case"post":chartOid=Number(data.chartOid);post=data.post;post=changeAvatar(post);var lastOid=Number(data.lastOid);from=Number(data.from);if(chartOid!=null&&$PT("post"+lastOid)==null){if(lastChartId==chartOid){createChartPost(lastOid,post,lastChartId)}else{chartsData=[];if(chartsPosts[chartOid]!=null){chartsData=chartsPosts[chartOid]}var postData={lastOid:{},post:{}};postData.lastOid=lastOid;postData.post=post;chartsData.push(postData);chartsPosts[chartOid]=chartsData;updateFeedLastTime()}if(uid!=from){goToChartNotification("post"+lastOid,true,false)}else{wallPostChangeOwnerSettings()}}else{if(uid==from){wallPostChangeOwnerSettings()}}break;case"annotation":if(uid==data.uid){data.o.allowEdit=true}chart.addAnnotation(changeDateTotimestamp(data.o,0,userTime));chartUpdateMsg("Chart Updated",true);break;case"indicator":if(uid!=data.uid){var mainChart=chart.getChartById("main");var inidcator=data.o.indicator;var chartObject=data.o.chart;if(inidcator!=null||chartObject!=null){if(chartObject==null){var idx=mainChart.technicalIndicators.indexOf(inidcator);if(idx==-1){mainChart.technicalIndicators.push(inidcator)}}else{idx=chart.getChartById(chartObject.id);if(idx==null){chart.objectModel.settings.charts.push(chartObject)}}chart.applySettingsChanges();chartUpdateMsg("Chart Updated",true)}}break;case"annotationRemove":var id=data.o.id;if(id!=null){chart.removeAnnotation(id)}chartUpdateMsg("Chart Updated",true);break;case"indicatorRemove":var chartId=data.o.chart;var indicator=data.o.indicator;if(chartId&&chartId!="main"){var list=chart.objectModel.settings.charts;for(var i=0;i<list.length;i++){if(list[i].id==chartId){list.splice(i,1);break}}}else{mainChart=chart.getChartById("main");list=mainChart.technicalIndicators;for(var i=0;i<list.length;i++){if(indicator.id==list[i].id){list.splice(i,1)}}}chartUpdateMsg("Chart Updated",true);chart.applySettingsChanges();break;case"annotationRemoveAll":chart.removeAllAnnotations();chartUpdateMsg("Chart Updated",true);break;case"users":var users=data.users;id=data.id;var usersObject={users:users,notConnected:data.notConnected};if(id!=null){chartsArray[id].users=usersObject}if(id==lastChartId){updateChartUsers(usersObject)}break;case"votes":var vote=data.vote;var chartOid=data.chartOid;if(chartOid!=null){chartsArray[chartOid].totalVotes=vote;var chartVoteCount=$PT("chartVoteCount");if(vote!=null&&chartVoteCount!=null&&lastChartId==chartOid){chartVoteCount.innerHTML=vote;if(!effectActive){effectActive=true;jQuery("#chartVoteCount").effect("pulsate",{times:4},1500,function(){effectActive=false})}}}break;case"following":var following=data.following;id=data.id;if(following!=null&&id!=null){chartsArray[id].subscribers=following;var chartFollowCount=$PT("chartFollowCount");if(chartFollowCount!=null&&lastChartId==id){chartFollowCount.innerHTML=following;if(!effectActive){effectActive=true;jQuery("#chartFollowCount").effect("pulsate",{times:4},1500,function(){effectActive=false})}}}break;case"removePost":var oid=data.oid;chartOid=data.chartOid;post=$PT("post"+oid);var postText=$PT("postText"+oid);if(postText!=null){postText.remove()}if(post!=null){post.remove();chartsArray[lastChartId].feedObject=jQuery("#feedData").clone();updateFeedScrooler("chartDiscussion",false)}else{chartsData=[];if(chartsPosts[chartOid]!=null){chartsData=chartsPosts[chartOid]}var postData={oid:oid,remove:true};chartsData.push(postData);chartsPosts[chartOid]=chartsData}break;case"removeComment":var oid=data.oid;chartOid=data.chartOid;var postId=data.postId;var comment=$PT("comment"+oid);if(comment!=null){comment.remove();chartsArray[lastChartId].feedObject=jQuery("#feedData").clone();updateFeedScrooler("chartDiscussion",false)}else{chartsData=[];if(chartsComments[chartOid]!=null){chartsData=chartsComments[chartOid]}var postData={oid:oid,remove:true,p:postId};chartsData.push(postData);chartsComments[chartOid]=chartsData}break;case"removeChart":showElement("chartDeleted");break;case"compare":var symbol=data.o.symbol;var element=$PT(data.o.elementId);if(element!=null){getQuotesData(element,symbol);hideElement("chartSecondSymbol");hideElement("chartThirdSymbol");chartUpdateMsg("Chart Updated",true)}break;case"removeFollowing":updateChartSubscribersResponse(data,false);break;case"addFollowing":updateChartSubscribersResponse(data,true);break;case"indicatorEdit":var mainChart=chart.getChartById("main");var inidcator=data.o.indicator;var chartObject=data.o.chart;if(inidcator!=null||chartObject!=null){if(chartObject==null){var indicatorsList=mainChart.technicalIndicators;for(var i=0;i<indicatorsList.length;i++){if(indicatorsList[i].id==inidcator.id){}indicatorsList[i]=inidcator;break}}else{var chartsList=chart.objectModel.settings.charts;for(var j=0;j<chartsList.length;j++){if(chartsList[j].id==chartObject.id){chartsList[j]=chartObject;break}}}chart.applySettingsChanges();chartUpdateMsg("Chart Updated",true)}break;case"textColor":$PT("textColor").setAttribute("hex",data.o);changeTextColor(true,false,false);chart.applySettingsChanges();chartUpdateMsg("Chart Updated",true);break;case"backroundColor":$PT("chartProfileBackgroundColor").setAttribute("hex",data.o);changeChartBackroundColor(null,true,false,false);chart.applySettingsChanges();chartUpdateMsg("Chart Updated",true);break;case"gridColor":$PT("chartProfileGridColor").setAttribute("hex",data.o);changeChartGridColor(false);chartUpdateMsg("Chart Updated",true);break;case"scrollerColor":$PT("scrollerColor").setAttribute("hex",data.o);changeScrollerColor(false);chartUpdateMsg("Chart Updated",true);break;case"candlestickSettings":var element=$PT(data.o.id);dataSetType=data.o.dataSetType;element.setAttribute("hex",data.o.color);changeCandlestickSettings(element,false);chartUpdateMsg("Chart Updated",true);break;case"showGrid":showGrid(data.o,false);chartUpdateMsg("Chart Updated",true);break;case"seriesTypeChange":element=$$PT("#seriesType li[value="+data.o.id+"]")[0];dataSetType=data.o.dataSetType;if(element!=null){onSeriesTypeChange(element,false,false);chartUpdateMsg("Chart Updated",true)}break;case"ohlcSettings":dataSetType=data.o.dataSetType;element=$PT(data.o.id);if(element!=null){element.setAttribute("hex",data.o.color);changeOhlcSettings(element,false);chartUpdateMsg("Chart Updated",true)}break;case"seriesColorChange":dataSetType=data.o.dataSetType;$PT("chartProfileSeriesColor").setAttribute("hex",data.o.color);onSeriesColorChange(false);chartUpdateMsg("Chart Updated",true);break;case"loadTemplate":var template=data.o.template;if(template!=null){templates[data.o.id]=template;loadTemplate(data.o.id,"",false);chartUpdateMsg("Chart Updated",true)}break;case"chartsActivity":var div=new Element("div",{style:"display:none"});var chartsActivity=data.chartsActivity;var chartObject=data.chart;var chartTimeScale=data.timeScale;var chartSymbols=data.symbols;var symbols=getCheckBoxesValues("chartSymbol").split(",");var timeSacles=getCheckBoxesValues("chartTimeScale").split(",");if(jQuery.inArray(chartTimeScale.toString(),timeSacles)!=-1&&(jQuery.inArray(chartSymbols[0],symbols)!=-1||jQuery.inArray(chartSymbols[1],symbols)!=-1||jQuery.inArray(chartSymbols[2],symbols)!=-1)){if(chartsActivity!=null){var activityOid=data.activity;if(activityOid!=null&&$PT("activity"+activityOid)==null){var chartsActivitySpan=$PT("chartsActivity");if(eval(chartsActivitySpan.getAttribute("empty"))==true){chartsActivitySpan.innerHTML=""}chartsActivitySpan.setAttribute("empty",false);div.innerHTML=chartsActivity;chartsActivitySpan.insertBefore(div,chartsActivitySpan.firstChild);jQuery(div).slideDown(300)}}if(chartObject!=null){var chartOid=data.chartOid;if(chartOid!=null&&$PT("publishChart"+chartOid)==null){var publishCharts=$PT("publishCharts");if(eval(publishCharts.getAttribute("empty"))==true){publishCharts.innerHTML=""}var div=new Element("div",{style:"display:none"});div.innerHTML=chartObject;publishCharts.insertBefore(div,publishCharts.firstChild);jQuery(div).slideDown(600);publishCharts.setAttribute("empty",false)}}}break;case"chartLastUpdate":var time=data.o.time;id=data.o.id;if(id!=null&&time!=null){fxWebsocket.updateChartData(id,time)}break;case"updateAccount":loadAccountToChart(lastChartId,false);break}var chartUpdateElement=$PT("lastUpdate");if(chartUpdateElement!=null){var updateTime=new Date().getTime();chartUpdateElement.setAttribute("time",updateTime);chartUpdateElement.innerHTML=dateToString(updateTime)}}catch(e){}}function showChartMsg(d,b){try{var a=$PT("chartMsgBody");a.innerHTML=d;if(b!=null){a.appendChild(b)}$("#chartMsg").modal("show")}catch(c){}}function createChartUrl(f,g,h,b,d,a){var c=["/forex-charts/",d.replace("/",""),"/",f,"/",a];if(g!=null&&h!=null){c.push("/",f,",",g,",",h)}if(b!=null){c.push(",",b)}return c.join("")}var lastChartUpdateTime=0;var notificationTime=5*1000*60;function wallPostChangeOwnerSettings(){$PT("userComment").style.height="16px";$PT("userComment").value="";var a=$PT("chartFollow");if(a!=null){a.checked=true}}function chartUpdateMsg(c,a){var b=$PT("chartUpdated");if(b!=null){b.innerHTML=c;if(a){if(!effectActive){effectActive=true;jQuery("#chartUpdated").effect("pulsate",{times:3},3000).fadeOut(function(){effectActive=false})}}else{showElement(b.id)}}}function displayRemovePostOrComment(b,c,f,g){var a=b.getAttribute("uid");var d=$PT(g);if(d!=null&&d.className.indexOf("owner")!=-1||($F("userId")==a)){displayElementByClass(c,f)}}function feedSlideDown(a,b){jQuery(a).slideDown(300,function(){updateFeedScrooler(b,false)})}function updateChartSubscribersResponse(h,d){if(d){var b=h.name;var g=h.user;var l=h.invitation;if(hasText(b)&&hasText(g)){var c=createChartUrl(lastChartId,null,null,null,b,l);var m=new Element("li",{});var o=new Element("br",{});var k=new Element("span",{className:"gray font10"});k.innerHTML=g;var a=new Element("a",{id:"chartMenuFollowItem"+lastChartId,href:c});a.innerHTML=b;a.appendChild(o);a.appendChild(k);m.appendChild(a);$PT("chartsFollowingMenu").appendChild(m);if($$PT("#chartsFollowingMenu li").size()>=2){hideElement("chartMenuFollowItemNoCharts")}}}else{var f=$PT("chartMenuFollowItem"+lastChartId);if(f!=null){f.parentNode.remove()}if($$PT("#chartsFollowingMenu li").size()<2){showElement("chartMenuFollowItemNoCharts")}}if(TVC){updateTVCSubscribe(d)}}function connectionLostMsg(){try{if(!showDisconnectMsg){var a=$PT("chartMsgBody");a.innerHTML=$T("tConnectionLostReconnecting")+"<br/><br/> <div class='center'><img src='/images/loader4.gif'/></div>";$("#chartMsg").modal("show");showDisconnectMsg=true}}catch(b){}}function getChartQuotes(a){fxAjax.sendRequest(fxVars.getChartQuotes+lastChartId+"&invite="+chartsArray[lastChartId].i+"&symbol="+a,{params:{oid:lastChartId},callback:"getChartQuotesResponse"})}function getChartQuotesResponse(response,params){if(!response.error){var config=response.content.config;var quotesData=response.content.quotesData;var timeScale=response.content.timeScale;chart.setConfig(config);var lastPoint=response.content.lastPoint;if(lastPoint!=null){chartsArray[params.oid].lastPoints=eval("("+lastPoint+")")}if(quotesData){createIndicatorsLinks();initSeriesSettings();if(timeScale!=null&&quoteTime!=timeScale){quoteTime=timeScale;changeTimeScale(quoteTime);changeCurrentTabName(false);updateChartMenu()}updateAnnotations(eval($F("chartOwner")))}else{showChartMsg("Chart is not available currently, please try again later.<br/><br/>We apologize for the inconvenience.")}}chartLoading=false}function updateChartNotification(a,c){var b=$PT("chartNotification"+c);if(b!=null){if(a){b.innerHTML=0;hideElement(b.id)}else{b.innerHTML=Number(b.innerHTML)+1;showElement(b.id)}}}function updateChartLink(){try{var b=chartsArray[lastChartId];var a=serverPath+"/forex-charts/"+b.n.replace("/","").replace(" ","")+"/"+lastChartId+(!b.p?"/"+b.i:"")}catch(c){$PT("linkToChartInput").value=""}$PT("linkToChartInput").value=a;showElement("linkToChart")}function selectDefaultTemplate(){$PT("tempateSelectName").innerHTML=defaultTemplate+'<img alt="" src="../../../images/controlDown.png">';var b=$$PT("#templateList li");for(var a=0;a<b.length;a++){if(b[a].getAttribute("default")!=null){b[a].className="selected"}else{b[a].className=""}}}function feedChannelSubscribe(a){var d=0;var f=$$PT("#userMessages [time]");for(var b=0;b<f.length;b++){var c=Number(f[b].getAttribute("time"));d=(c>d)?c:d}if(d==0){d=getMetaContent("server-timestamp")}if(a){fxWebsocket.subscribe(feed_subscribe,lastChartId,d,chartsArray[lastChartId].i)}onOpenArray.push("fxWebsocket.subscribe('"+feed_subscribe+"','"+lastChartId+"','"+d+"','"+chartsArray[lastChartId].i+"')")}function updateFeedLastTime(){fxWebsocket.updateChartData("feed"+lastChartId,dt.getTime())}function pushToAnnotationList(c,a){var b;if(a){b=annotationUndoList[lastChartId]}else{b=annotationRedoList[lastChartId]}if(b==null){b=[];(a)?annotationUndoList[lastChartId]=b:annotationRedoList[lastChartId]=b}b.push(c)}function getChartVotesOrFollowing(b,a){if((Number($PT("chartVoteCount").innerHTML)!=0&&a)||(Number($PT("chartFollowCount").innerHTML)!=0&&!a)){if(a){$PT("chartVotes").innerHTML="";showElement("chartVotesLoader");showElement("chartVotesWindow")}else{$PT("chartFollowingUsers").innerHTML="";showElement("chartFollowingUsersLoader");showElement("chartFollowingWindow")}fxAjax.sendRequest(fxVars.getChartVotesOrFollowing+lastChartId+"&invite="+chartsArray[lastChartId].i+"&vote="+a,{callback:"getChartVotesOrFollowingResponse"})}}function getChartVotesOrFollowingResponse(a){if(!a.error){var c=a.content.chartVotes;if(c!=null){hideElement("chartVotesLoader");$PT("chartVotes").innerHTML=a.content.chartVotes;createScroller("chartVotesScroller")}var b=a.content.followingUsers;if(b!=null){hideElement("chartFollowingUsersLoader");$PT("chartFollowingUsers").innerHTML=b;if(!jQuery("#chartFollowingUsersScroller div").hasClass("jspContainer")){createScroller("chartFollowingUsersScroller")}}}}function updateChartUsers(h){if(h!=null){var b=h.users;var o=$PT("connectedUsers");var m=$PT("connectedUsersCount");var g=$PT("notConnectedCount");o.innerHTML="";var c=0;if(b!=null){c=b.length}var l=new Element("span",{});var d=false;if(b!=null&&c>0){l.innerHTML=": ";for(var f=0;f<c;f++){if(b[f]=="Staff"){d=true;continue}var k=new Element("a",{className:"underline"});k.innerHTML=b[f];k.href="/members/"+b[f];k.target="_blank";l.innerHTML=l.innerHTML+k.outerHTML;if(f!=c-1){l.innerHTML=l.innerHTML+", "}else{l.innerHTML=l.innerHTML+"."}}}else{l.innerHTML=". "}if(d){c=c-1}o.appendChild(l);if(b!=null){$PT("connectedUsersCount").innerHTML=c}$PT("notConnectedCount").innerHTML=h.notConnected;$PT("totalConnectedCount").innerHTML=parseInt(c)+parseInt(h.notConnected);if(!effectActive){effectActive=true;jQuery("#totalConnectedCount").effect("pulsate",{times:4},1500,function(){effectActive=false})}}}var quoteData={};var lastClose=0;function updateQuotes(o){var q=o[5];var v=o[8];var t=o[7];var g=o[6];var b=o[4];var k=0;var a=(hasText(o[9]))?Number(o[9])+(userTime):null;var f=(hasText(o[1]))?symbolOidToNameMap[o[1]]:null;var s=o[2];for(var h in chartsArray){var u=chartsArray[h].o;var m=u.getChartById("main");if(m!=null){var d=m.seriesList;for(var l=0;l<d.length;l++){var c=Number(b)+(userTime)-k*1000*60;if(d[l].name==f&&chartsArray[h].t==s){if(h==lastChartId&&chartsArray[h].loaded!=null){if(a!=null){u.appendData(chartsDataSets[l],a+",,,,;")}if(hasText(c)&&lastClose!=v){u.appendData(chartsDataSets[l],c+","+q+","+g+","+t+","+v);u.commitDataChanges()}lastClose=v}else{if(quoteData[h]==null){quoteData[h]={}}var r=quoteData[h];r[c]={p:","+q+","+g+","+t+","+v+";",d:chartsDataSets[l]};if(a!=null){r[a]={p:",,,,;",d:chartsDataSets[l]}}}}}}}}function addQuoteDataPoints(d){var b=quoteData[d];if(b!=null){for(var c in b){var a=b[c];chart.appendData(a.d,c+a.p)}chart.commitDataChanges();delete quoteData[d]}}function updateChartFacebookData(b,a){$PT("chartFacebook").setAttribute("content",serverPath+"/chartImage.png?oid="+b);$PT("chartFacebookTitle").setAttribute("content",a+" Analysis By "+$F("chartOwnerName"))}function changeAvatar(f){var c=new Element("span",{className:"underline"}).update(f);var a=$F("avatarUrl");var d=jQuery(c).find("img.avatarElement");for(var b=0;b<d.length;b++){if(d[b]!=null){d[b].setAttribute("src",a)}}return c.innerHTML}function changeSeriesFormat(){var k=chart.getChartById("main");var g=k.seriesList;var a=k.technicalIndicators;if(g!=null){for(var f=0;f<g.length;f++){var d=g[f];var h=symbolsDecimals[d.name];var b=(h!=null)?h:5;if(hasText(b)){d.legendItem.labels.focusSettings.mouseOut.format='<textformat><font size="10" color="#000000">{%SeriesName}:  </font></textformat><textformat><font color="#000000">O: {%Open.LastVisible}{numDecimals:'+b+",plusSign:false}   H: {%High.LastVisible}{numDecimals:"+b+",plusSign:false}   L: {%Low.LastVisible}{numDecimals:"+b+",plusSign:false}   C: {%Close.LastVisible}{numDecimals:"+b+",plusSign:false}</font></textformat>";d.legendItem.labels.focusSettings.mouseOver.format='<textformat><font size="10" color="#000000">{%SeriesName}:  </font></textformat><textformat><font color="#000000">O: {%Open.Current}{numDecimals:'+b+",plusSign:false}   H: {%High.Current}{numDecimals:"+b+",plusSign:false}   L: {%Low.Current}{numDecimals:"+b+",plusSign:false}   C: {%Close.Current}{numDecimals:"+b+",plusSign:false}</font></textformat>"}}}for(var c=0;c<a.length;c++){loadIndicator(a[c],"main",true)}}function setAccountToChart(a){var b=[$F("accountCombo"),"&chartId=",lastChartId];fxAjax.sendRequest(fxVars.setOpenTrades+b.join(""),{callback:"setAccountToChartResponse"})}function setAccountToChartResponse(a){if(!a.error){loadAccountToChart(lastChartId,true)}}function loadAccountToChart(b,a){fxAjax.sendRequest(fxVars.loadOpenTrades+b+"&symbol="+getFilteredSymbolName($F("chartFirstSymbol"))+"&invite="+chartsArray[b].i,{params:{update:a,id:b},callback:"loadAccountToChartResponse"})}var accountTimeout;function loadAccountToChartResponse(response,params){clearTimeout(accountTimeout);var error=true;removeAccountAnnotation(params.id);if(!response.error){if(response.content.accountOid==undefined){accountOid=0}else{accountOid=parseInt(response.content.accountOid)}chartsArray[params.id].accountLoaded=true;chartsArray[params.id].accountOid=accountOid;setSelectedAccount(accountOid);if(accountOid!=NO_ACCOUNT){chart.objectModel.eventMarkers.groups=eval("("+response.content.config+")").groups;if(response.content.openTrades!=undefined){openTradesHistoryEvents=response.content.openTrades}if(response.content.history!=undefined){historyEvents=response.content.history}var annotations=eval("("+response.content.config+")").annotations.annotationList;if(annotations!=undefined){for(var i=0;i<annotations.length;i++){chart.addAnnotation(annotations[i]);chartsArray[params.id].accountAnnotation.push(annotations[i].id)}}if(hasText(response.content.url)){$J("#linkToSystem").attr("href",response.content.url);showElement("linkToSystem")}else{hideElement("linkToSystem")}error=false}else{error=true}}if(error){chart.objectModel.eventMarkers.groups=[];chartsArray[params.id].accountOid=0;setSelectedAccount(0);hideElement("linkToSystem")}if(params.update){var object={type:"updateAccount",callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,object)}chart.applyEventMarkersChanges();chart.applySettingsChanges();accountTimeout=setTimeout("loadAccountToChart(lastChartId,false)",60000)}function removeAccountAnnotation(c){var b=chart.getAnnotationListAsJSON();for(var a=0;a<b.length;a++){if(isContains(chartsArray[c].accountAnnotation,b[a].id)){chart.removeAnnotation(b[a].id)}}chartsArray[c].accountAnnotation=[]}function setSelectedAccount(b){if(b!=undefined&&owner){var a=$$PT("#accountCombo [value="+b+"]")[0];if(a!=undefined){$$PT("#accountCombo [value="+b+"]")[0].selected=true}}}function getFilteredSymbolName(a){switch(a){case GOLD_SYMBOL_NAME:a=GOLD;break;case SILVER_SYMBOL_NAME:a=SILVER;break}return a}var popups=["notificationCont","inboxNotificationCont","userPanel","searchbar"];function hideSearchForm(){$PT("searchForm").className="searchFormOff";$PT("search").value="";hideElement("searchForm");showElement("searchButton")}jQuery(document).keydown(function(a){if(a.keyCode==27){popups.each(function(b){if(b=="searchbar"){hideSearchForm()}else{hideElement(b)}})}});jQuery(document).ready(function(){popups.each(function(b){var a=jQuery("#"+b)[0];jQuery(document).on("click",function(c){if(jQuery(c.target).closest(a).length===0){if(b=="searchbar"){hideSearchForm()}else{jQuery(a).hide()}}})})});function hideAllMenus(){popups.each(function(b){var a=jQuery("#"+b)[0];if(b=="searchbar"){hideSearchForm()}else{jQuery(a).hide()}})}var updatingNotifications=false;var endPaging=false;var activityLoaded=false;var ACTIVITY_PRELOAD=1;var ACTIVITY_LOAD=2;var ACTIVITY_PAGING=3;function updateNotifications(d,f,c){var l=isVisible("notificationCont");var k=(f==ACTIVITY_PRELOAD);var a=(f==ACTIVITY_PAGING);var g=parseInt($PT("newNotification").innerHTML);var b=false;switch(f){case ACTIVITY_PRELOAD:if(!activityLoaded){activityLoaded=true;b=true}else{return}break;case ACTIVITY_LOAD:if(activityLoaded){if(!l){hideAllMenus();showElement("notificationCont")}else{if(c==null||(c!=null&&!c)){hideElement("notificationCont")}}}if(updatingNotifications){return}b=(g!=0);updateFeedScrooler("notify");break;case ACTIVITY_PAGING:showElement("notificationCont");b=true;break}if(b){updatingNotifications=true;var h="";if(a){h="&firstOid="+$PT("newNotification").getAttribute("oid")}if(!a||(a&&!endPaging)){fxAjax.sendRequest(fxVars.updateNotifications+"&preload="+k+h,{params:{paging:a,element:d,preload:k},loader:false,callback:"updateNotificationsResponse"});showElement("activityLoader")}else{hideElement("activityLoader");updatingNotifications=false}}}function updateNotificationsResponse(a,f){if(!a.error&&a.content){var b=a.content.notifications;var d=a.content.notificationOid;if(d!=null){$PT("newNotification").setAttribute("oid",d)}else{endPaging=true}if(hasText(b)){var c=new Element("span",{});c.innerHTML=b;removeExistChildren(c,"notify");$PT("notifyTb").appendChild(c);updateFeedScrooler("notify")}if(!f.preload){$PT("newNotification").innerHTML=0;$PT("newNotification").className="countRed grayBG"}else{if(isVisible("notificationCont")){updatingNotifications=false;updateNotifications($PT("notificationCont"),ACTIVITY_LOAD,true)}}}hideElement("activityLoader");updatingNotifications=false}var updatingInboxNotification=false;var endInboxPaging=false;var activityInboxLoaded=false;function updateInboxNotifications(c,g){var f=isVisible("inboxNotificationCont");var b=(g==ACTIVITY_PAGING);var a=false;switch(g){case ACTIVITY_PRELOAD:if(!activityInboxLoaded){activityInboxLoaded=true;a=true}else{return}break;case ACTIVITY_LOAD:if(activityInboxLoaded){if(f){hideElement("inboxNotificationCont")}else{hideAllMenus();showElement("inboxNotificationCont")}}if(updatingInboxNotification){return}updateFeedScrooler("inboxNotify");break;case ACTIVITY_PAGING:showElement("inboxNotificationCont");a=true;break}if(a){updatingInboxNotification=true;var d="";if(b){d="&firstOid="+$PT("newInboxNotification").getAttribute("oid")}if(!b||(b&&!endInboxPaging)){fxAjax.sendRequest(fxVars.updateInboxNotifications+d,{params:{paging:b,element:c},loader:false,callback:"updateInboxNotificationsResponse"});showElement("inboxActivityLoader")}else{hideElement("inboxActivityLoader");updatingInboxNotification=false}}}function updateInboxNotificationsResponse(a,d){if(!a.error&&a.content){var f=a.content.inboxNotifications;var c=a.content.inboxNotificationsOid;if(c!=null){$PT("newInboxNotification").setAttribute("oid",c)}else{endInboxPaging=true}if(hasText(f)){var b=new Element("span",{});b.innerHTML=f;removeExistsChildren(b,"inboxNotify");$PT("inboxNotifyTb").appendChild(b);updateFeedScrooler("inboxNotify")}}hideElement("inboxActivityLoader");updatingInboxNotification=false}function showBugReportDialog(b){var a={};a.width=512;if(b){a.height=347}else{a.height=446}a.resizable=false;a.modal=true;a.title=$T("tBugReport");a.close=function(c,d){$JD.destroy("#reportBugForm");hideElement("bugSent");showElement("bugFormContent");jQuery("#reportBugForm [name=bugReportFileRemove]").each(function(){this.click()})};initBugForm();$JD.create("#reportBugForm",a);$J("#bugDescription").focus()}function showResendActivationDialog(){var a={};a.width=450;a.height=103;a.resizable=false;a.modal=true;a.title=$T("tResendActivation");a.close=function(b,c){$JD.destroy("#activation");$PT("emailActivation").value="";hideElement("activationResponse");hideElement("activationClose");showElement("activationCont")};$JD.create("#activation",a)}function showForgotPasswordDialog(){var a={};a.width=450;a.height=103;a.resizable=false;a.modal=true;a.title=$T("tResetPassword");a.close=function(b,c){$JD.destroy("#forgotPassword");$PT("emailForgot").value="";hideElement("forgotResponse");showElement("forgotCont")};$JD.create("#forgotPassword",a)}function getUserVouchers(a){if(hasText(a)&&!hasText($PT("vouchers").innerHTML)){fxAjax.sendRequest(fxVars.getUserVouchers+a,{loader:true,callback:"getUserVouchersResponse"})}else{showHideElement("vouchers")}}function getUserVouchersResponse(a){if(!a.error){$PT("vouchers").innerHTML=a.content.data;showElement("vouchers")}else{inlineMsg("vouchersButton","<b>"+$T("tError")+"</b><br>"+a.message,3)}}function sortPortfolioMenu(){var c=$J(".sortableLi");var a=[];for(var b=0;b<c.length;b++){a.push(c[b].id)}fxAjax.sendRequest(fxVars.saveUserPortfolioMenuOrder+a,{params:{},callback:""})}function getCotStatement(f,c,d){var a=["?type=",c,"&data=",d];var b=$PT(f+"Statement").href;if($is(b)){$PT(f+"Statement").href=b.substring(0,b.indexOf("?")!=-1?b.indexOf("?"):b.length)+a.join("")}}function showUpdateInvestorPassPopup(){var a={};a.top=535;a.resizable=false;a.close=function(b,c){$JD.destroy("#investorPassInputPopup");$PT("investorPassword").value="";hideElement("investorPassChanged");showElement("investorPasswordLabel");showElement("investorPassword");showElement("saveButton");showElement("cancelButton")};$JD.create("#investorPassInputPopup",a)}function updateInvestorPass(){if(validate("accountOid",VALID_ACCOUNT)&&validate("investorPassword",VALID_ACCOUNT_PASSWORD)){var a=$F("accountOid");var b=$F("investorPassword");var c=[];c.push(a);c.push("&investorPassword="+encodeParameter(b));fxAjax.sendRequest(fxVars.updateInvestorPassword+c.join(""),{params:{},callback:"updateInvestorPassResponse"})}}function updateInvestorPassResponse(a){if(!a.error){hideElement("investorPasswordLabel");hideElement("investorPassword");hideElement("saveButton");hideElement("cancelButton");$PT("investorPassChanged").style.display="block";$PT("investorPassword").value="";setTimeout(function(){$JD.close("#investorPassInputPopup")},1000)}}var contestAnalysisChartsDivs=["winBalance","lossBalance","margin","winTrades","lossTrades","pie","winAvgPips","lossAvgPips"];var contestAnalysisChartsData=["winBalanceChartData","lossBalanceChartData","marginCalledChartData","winTradesChartData","lossTradesChartData","pieChartData","winAvgPipsChartData","lossAvgPipsChartData"];function getContestAnalysisCharts(a,b){if(a.length>0){fxAjax.sendRequest(fxVars.getContestAnalysisCharts+b,{params:{charts:a},callback:"getContestAnalysisChartsResponse"})}}function getContestAnalysisChartsResponse(a,d){if(!a.error){if(d.charts){for(var c=0;c<d.charts.length;c++){var b=jQuery.parseJSON((a.content[contestAnalysisChartsData[c]]));d.charts[c].setDataJson(b)}}}}function getCheckBoxIntValue(a){return($PT(a)!=null&&$PT(a).checked)?1:0}function showLoginDialog(){var a=$("#loginDialogOkButton");a.html("Login");a.off("click").click(function(){loginDialog()});$("#loginDialog").modal("show")}function loginDialog(){if(validate("loginDialogEmail",VALID_EMAIL)&&validate("loginDialogPassword",VALID_PASSWORD)){var a=["loginEmail=",$PT("loginDialogEmail").value,"&loginPassword=",encodeParameter($PT("loginDialogPassword").value),"&remember=",$PT("loginDialogRemember").checked];fxAjax.sendRequest(fxVars.loginUrl,{method:"post",postBody:a.join(""),contentType:"text/xml",params:{loginRedirect:getcTraderAuthRedirectUrl(window.location.href)},loader:true,callback:"loginDialogResponse"})}}function loginDialogResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){if(hasText(f.loginRedirect)){window.location=f.loginRedirect}else{window.location=serverPath+"/dashboard"}}else{$PT("loginDialogResponse").innerHTML=c}}var accountRegType;function registrationDialog(){if(validate("registrationDialogUserName",VALID_USER_NAME)&&validate("registrationDialogEmail",VALID_EMAIL)&&validate("registrationDialogPassword",VALID_PASSWORD)&&validate("registrationDialogConfirmPassword",VALID_PASSWORD_CONFIRM3)&&validate("registrationDialogCaptcha",VALID_CAPTHCA)&&validate("registrationDialogAgree",VALID_AGREE)){var a=["username=",$PT("registrationDialogUserName").value,"&email=",$PT("registrationDialogEmail").value,"&password=",encodeParameter($PT("registrationDialogPassword").value),"&captcha=",$PT("registrationDialogCaptcha").value];fxAjax.sendRequest(fxVars.regUrl,{method:"post",postBody:a.join(""),contentType:"text/xml",params:{registrationRedirect:window.location.href},loader:true,callback:"registrationDialogResponse"})}}function registrationDialogResponse(f,c){var d=f.getElementsByTagName("response")[0];var h=d.getAttribute("error");var a=d.getAttribute("code");var l=d.getAttribute("message");if(h=="false"){$PT("registrationContent").innerHTML="<div class='font12 lh18 center'>"+l+"</div><br/><br/><a class=\"bold underline\" style='color:#0066ff;' href='javascript:switchRegistrationToLoginDialog()' >Login</a><span id='registrationResponse' class='red' style='padding-left:50px'></span>";var g=$("#loginDialog");var k=$("#loginDialogOkButton");k.html("Ok");k.off("click").click(function(){g.modal("hide")});var b=$("#loginDialogCancelButton");b.hide();g.off("hidden.bs.modal").on("hidden.bs.modal",function(){b.show();g.off("hidden.bs.modal")});setCookie("reglr",c.registrationRedirect,YEAR,true);if(accountRegType!=undefined){setCookie("rat",accountRegType,YEAR,true)}$J("#registerLink").remove()}else{if(a==30){inlineMsg("registrationDialogUserName","<b>"+$T("tError")+"</b><br>"+l,3)}if(a==7){inlineMsg("registrationDialogCaptcha","<b>"+$T("tError")+"</b><br>"+l,3);reloadCaptcha();clearField("registrationDialogCaptcha")}if(a==13){inlineMsg("registrationResponse","<b>"+$T("tError")+"</b><br>"+l,3)}if(a==8){inlineMsg("registrationDialogEmail","<b>"+$T("tError")+"</b><br>"+l,3)}}}function switchLoginToRegistrationDialog(a){accountRegType=a;switchLoginRegistrationDialog("Registration","Register","registrationDialog();","loginContent","registrationContent")}function switchRegistrationToLoginDialog(){switchLoginRegistrationDialog("Login","Login","loginDialog();","registrationContent","loginContent")}function switchLoginRegistrationDialog(title,bText,bFunction,hide,show){$("#loginDialogTitle").html(title);var okButton=$("#loginDialogOkButton");okButton.html(bText);okButton.off("click").click(function(){eval(bFunction)});var cancelButton=$("#loginDialogCancelButton");cancelButton.show();hideElement(hide);showElement(show)}function hideShowElementsByName(d,a){var c=document.getElementsByName(d);for(var b=0;b<c.length;b++){a?showElement(c[b]):hideElement(c[b])}}function getcTraderAuthRedirectUrl(b){var a=$J("#cTraderOauth").val();return(a!=undefined&&hasText(a))?a:b}function elementIsExist(a){return a.length>0}function updateUserTermsAndPrivacyVer(){$("#modalMessage").find("#okBtn").attr("disabled",true);fxAjax.sendRequest(fxVars.acceptUpdatedPrivacyAndTermsVersion,{contentType:"text/xml",loader:true,callback:"updateUserTermsAndPrivacyVerResponse"})}function updateUserTermsAndPrivacyVerResponse(a){var b=a.error!=undefined?a.error:true;var d=a.message!=undefined?a.message:"General error.";var c=$("#modalMessage");if(!b){c.modal("hide")}else{if(b){if($("#termsPopupErrorMsg")!=null){$("#termsPopupErrorMsg").remove()}$("#modalMessage").find("#modalMessageBody").height(620);$("#modalMessage").find("#modalMessageBody").append($('<div id="termsPopupErrorMsg" align="left" class="alert alert-danger marginT10" style="margin-bottom: 0 !important;">'+d+"</div>"));c.find("#okBtn").attr("disabled",false)}}}function showTermsAndPolicyModal(a){var b={title:$T("tPrivacyPolicy"),message:a,okOnClickEvent:"updateUserTermsAndPrivacyVer()",showCancelBtn:false,dontCloseModalOnOutsideClick:true,customHeight:"600px",modalSizeLarge:true,showCloseBtn:false,textAlignCenter:false,closeOnClickOk:false,showCheckbox:true,disableOkButton:true,checkboxMsg:$T("tIreadAndUnderstoodThePrivacy"),};buildModalMessageDialog(b)}function showAutoTradeMovedDialog(){var a={};a.width=450;a.height=103;a.resizable=false;a.modal=true;a.title=$T("tAutoTrade.moved.dialog");a.close=function(b,c){$JD.destroy("#AutoTradeMovedDialog");hideElement("AutoTradeMovedClose")};$JD.create("#AutoTradeMovedDialog",a)}function autoTradeMovedtermsAgre(){document.getElementById("transferNewAutoTrade").disabled=document.getElementById("AutoTradeMovedDialogAgree").checked!==true}function forwardToAutoTrade(b){var a=null;if(b!=null){a="/forwardToAutoTradeSite.json?accountOid="+b}else{a="/forwardToAutoTradeSite.json"}fxAjax.sendRequest(a,{contentType:"application/json",params:{},loader:false,callback:"forwardToAutoTradeResponse"})}function forwardToAutoTradeResponse(a){window.location.replace(a.content.autoTradeData)}
/* Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 *
 * Requires: 1.2.2+
 */
(function(d){var b=["DOMMouseScroll","mousewheel"];if(d.event.fixHooks){for(var a=b.length;a;){d.event.fixHooks[b[--a]]=d.event.mouseHooks}}d.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var f=b.length;f;){this.addEventListener(b[--f],c,false)}}else{this.onmousewheel=c}},teardown:function(){if(this.removeEventListener){for(var f=b.length;f;){this.removeEventListener(b[--f],c,false)}}else{this.onmousewheel=null}}};d.fn.extend({mousewheel:function(f){return f?this.bind("mousewheel",f):this.trigger("mousewheel")},unmousewheel:function(f){return this.unbind("mousewheel",f)}});function c(m){var k=m||window.event,h=[].slice.call(arguments,1),o=0,l=true,g=0,f=0;m=d.event.fix(k);m.type="mousewheel";if(k.wheelDelta){o=k.wheelDelta/120}if(k.detail){o=-k.detail/3}f=o;if(k.axis!==undefined&&k.axis===k.HORIZONTAL_AXIS){f=0;g=-1*o}if(k.wheelDeltaY!==undefined){f=k.wheelDeltaY/120}if(k.wheelDeltaX!==undefined){g=-1*k.wheelDeltaX/120}h.unshift(m,o,g,f);return(d.event.dispatch||d.event.handle).apply(this,h)}})(jQuery);(function(d,f,g){d.fn.jScrollPane=function(a){function b(br,bb){var bk,a9=this,a1,bF,aK,bD,a6,a0,s,aO,bi,bS,bs,aW,bh,aX,aV,bO,a5,bz,a2,aM,bw,by,bJ,bC,bl,aT,bu,bm,aI,bq,bP,aZ,be,bG=true,ba=true,bQ=false,aU=false,bA=br.clone(false,false).empty(),bM=d.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";bP=br.css("paddingTop")+" "+br.css("paddingRight")+" "+br.css("paddingBottom")+" "+br.css("paddingLeft");aZ=(parseInt(br.css("paddingLeft"),10)||0)+(parseInt(br.css("paddingRight"),10)||0);function bx(l){var t,q,r,h,k,m,o=false,u=false;bk=l;if(a1===g){k=br.scrollTop();m=br.scrollLeft();br.css({overflow:"hidden",padding:0});bF=br.innerWidth()+aZ;aK=br.innerHeight();br.width(bF);a1=d('<div class="jspPane" />').css("padding",bP).append(br.children());bD=d('<div class="jspContainer" />').css({width:bF+"px",height:aK+"px"}).append(a1).appendTo(br)}else{br.css("width","");o=bk.stickToBottom&&bf();u=bk.stickToRight&&bv();h=br.innerWidth()+aZ!=bF||br.outerHeight()!=aK;if(h){bF=br.innerWidth()+aZ;aK=br.innerHeight();bD.css({width:bF+"px",height:aK+"px"})}if(!h&&be==a6&&a1.outerHeight()==a0){br.width(bF);return}be=a6;a1.css("width","");br.width(bF);bD.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}a1.css("overflow","auto");if(l.contentWidth){a6=l.contentWidth}else{a6=a1[0].scrollWidth}a0=a1[0].scrollHeight;a1.css("overflow","");s=a6/bF;aO=a0/aK;bi=aO>1;bS=s>1;if(!(bS||bi)){br.removeClass("jspScrollable");a1.css({top:0,width:bD.width()-aZ});aR();bp();a8();aJ()}else{br.addClass("jspScrollable");t=bk.maintainPosition&&(bh||bO);if(t){q=bU();r=bW()}bR();c();bn();if(t){bc(u?(a6-bF):q,false);bd(o?(a0-aK):r,false)}bg();bI();bB();if(bk.enableKeyboardNavigation){a7()}if(bk.clickOnTrack){aP()}bt();if(bk.hijackInternalLinks){aS()}}if(bk.autoReinitialise&&!bq){bq=setInterval(function(){bx(bk)},bk.autoReinitialiseDelay)}else{if(!bk.autoReinitialise&&bq){clearInterval(bq)}}k&&br.scrollTop(0)&&bd(k,false);m&&br.scrollLeft(0)&&bc(m,false);br.trigger("jsp-initialised",[bS||bi])}function bR(){if(bi){bD.append(d('<div class="jspVerticalBar" />').append(d('<div class="jspCap jspCapTop" />'),d('<div class="jspTrack" />').append(d('<div class="jspDrag" />').append(d('<div class="jspDragTop" />'),d('<div class="jspDragBottom" />'))),d('<div class="jspCap jspCapBottom" />')));a5=bD.find(">.jspVerticalBar");bz=a5.find(">.jspTrack");bs=bz.find(">.jspDrag");if(bk.showArrows){by=d('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",bT(0,-1)).bind("click.jsp",bV);bJ=d('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",bT(0,1)).bind("click.jsp",bV);if(bk.arrowScrollOnHover){by.bind("mouseover.jsp",bT(0,-1,by));bJ.bind("mouseover.jsp",bT(0,1,bJ))}bE(bz,bk.verticalArrowPositions,by,bJ)}aM=aK;bD.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){aM-=d(this).outerHeight()});bs.hover(function(){bs.addClass("jspHover")},function(){bs.removeClass("jspHover")}).bind("mousedown.jsp",function(k){d("html").bind("dragstart.jsp selectstart.jsp",bV);bs.addClass("jspActive");var h=k.pageY-bs.position().top;d("html").bind("mousemove.jsp",function(l){a4(l.pageY-h,false)}).bind("mouseup.jsp mouseleave.jsp",bo);return false});aQ()}}function aQ(){bz.height(aM+"px");bh=0;a2=bk.verticalGutter+bz.outerWidth();a1.width(bF-a2-aZ);try{if(a5.position().left===0){a1.css("margin-left",a2+"px")}}catch(h){}}function c(){if(bS){bD.append(d('<div class="jspHorizontalBar" />').append(d('<div class="jspCap jspCapLeft" />'),d('<div class="jspTrack" />').append(d('<div class="jspDrag" />').append(d('<div class="jspDragLeft" />'),d('<div class="jspDragRight" />'))),d('<div class="jspCap jspCapRight" />')));bC=bD.find(">.jspHorizontalBar");bl=bC.find(">.jspTrack");aX=bl.find(">.jspDrag");if(bk.showArrows){bm=d('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",bT(-1,0)).bind("click.jsp",bV);aI=d('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",bT(1,0)).bind("click.jsp",bV);if(bk.arrowScrollOnHover){bm.bind("mouseover.jsp",bT(-1,0,bm));aI.bind("mouseover.jsp",bT(1,0,aI))}bE(bl,bk.horizontalArrowPositions,bm,aI)}aX.hover(function(){aX.addClass("jspHover")},function(){aX.removeClass("jspHover")}).bind("mousedown.jsp",function(k){d("html").bind("dragstart.jsp selectstart.jsp",bV);aX.addClass("jspActive");var h=k.pageX-aX.position().left;d("html").bind("mousemove.jsp",function(l){a3(l.pageX-h,false)}).bind("mouseup.jsp mouseleave.jsp",bo);return false});aT=bD.innerWidth();bH()}}function bH(){bD.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){aT-=d(this).outerWidth()});bl.width(aT+"px");bO=0}function bn(){if(bS&&bi){var k=bl.outerHeight(),h=bz.outerWidth();aM-=k;d(bC).find(">.jspCap:visible,>.jspArrow").each(function(){aT+=d(this).outerWidth()});aT-=h;aK-=h;bF-=k;bl.parent().append(d('<div class="jspCorner" />').css("width",k+"px"));aQ();bH()}if(bS){a1.width((bD.outerWidth()-aZ)+"px")}a0=a1.outerHeight();aO=a0/aK;if(bS){bu=Math.ceil(1/s*aT);if(bu>bk.horizontalDragMaxWidth){bu=bk.horizontalDragMaxWidth}else{if(bu<bk.horizontalDragMinWidth){bu=bk.horizontalDragMinWidth}}aX.width(bu+"px");aV=aT-bu;bK(bO)}if(bi){bw=Math.ceil(1/aO*aM);if(bw>bk.verticalDragMaxHeight){bw=bk.verticalDragMaxHeight}else{if(bw<bk.verticalDragMinHeight){bw=bk.verticalDragMinHeight}}bs.height(bw+"px");aW=aM-bw;bL(bh)}}function bE(q,m,r,k){var h="before",o="after",l;if(m=="os"){m=/Mac/.test(navigator.platform)?"after":"split"}if(m==h){o=m}else{if(m==o){h=m;l=r;r=k;k=l}}q[h](r)[o](k)}function bT(l,h,k){return function(){bj(l,h,this,k);this.blur();return false}}function bj(o,q,h,l){h=d(h).addClass("jspActive");var m,r,t=true,k=function(){if(o!==0){a9.scrollByX(o*bk.arrowButtonSpeed)}if(q!==0){a9.scrollByY(q*bk.arrowButtonSpeed)}r=setTimeout(k,t?bk.initialDelay:bk.arrowRepeatFreq);t=false};k();m=l?"mouseout.jsp":"mouseup.jsp";l=l||d("html");l.bind(m,function(){h.removeClass("jspActive");r&&clearTimeout(r);r=null;l.unbind(m)})}function aP(){aJ();if(bi){bz.bind("mousedown.jsp",function(l){if(l.originalTarget===g||l.originalTarget==l.currentTarget){var o=d(this),h=o.offset(),m=l.pageY-h.top-bh,r,t=true,k=function(){var v=o.offset(),u=l.pageY-v.top-bw/2,x=aK*bk.scrollPagePercent,w=aW*x/(a0-aK);if(m<0){if(bh-w>u){a9.scrollByY(-x)}else{a4(u)}}else{if(m>0){if(bh+w<u){a9.scrollByY(x)}else{a4(u)}}else{q();return}}r=setTimeout(k,t?bk.initialDelay:bk.trackClickRepeatFreq);t=false},q=function(){r&&clearTimeout(r);r=null;d(document).unbind("mouseup.jsp",q)};k();d(document).bind("mouseup.jsp",q);return false}})}if(bS){bl.bind("mousedown.jsp",function(l){if(l.originalTarget===g||l.originalTarget==l.currentTarget){var o=d(this),h=o.offset(),m=l.pageX-h.left-bO,r,t=true,k=function(){var v=o.offset(),u=l.pageX-v.left-bu/2,x=bF*bk.scrollPagePercent,w=aV*x/(a6-bF);if(m<0){if(bO-w>u){a9.scrollByX(-x)}else{a3(u)}}else{if(m>0){if(bO+w<u){a9.scrollByX(x)}else{a3(u)}}else{q();return}}r=setTimeout(k,t?bk.initialDelay:bk.trackClickRepeatFreq);t=false},q=function(){r&&clearTimeout(r);r=null;d(document).unbind("mouseup.jsp",q)};k();d(document).bind("mouseup.jsp",q);return false}})}}function aJ(){if(bl){bl.unbind("mousedown.jsp")}if(bz){bz.unbind("mousedown.jsp")}}function bo(){d("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");if(bs){bs.removeClass("jspActive")}if(aX){aX.removeClass("jspActive")}}function a4(h,k){if(!bi){return}if(h<0){h=0}else{if(h>aW){h=aW}}if(k===g){k=bk.animateScroll}if(k){a9.animate(bs,"top",h,bL)}else{bs.css("top",h);bL(h)}}function bL(o){if(o===g){o=bs.position().top}bD.scrollTop(0);bh=o;var k=bh===0,m=bh==aW,l=o/aW,h=-l*(a0-aK);if(bG!=k||bQ!=m){bG=k;bQ=m;br.trigger("jsp-arrow-change",[bG,bQ,ba,aU])}aL(k,m);a1.css("top",h);br.trigger("jsp-scroll-y",[-h,k,m]).trigger("scroll")}function a3(k,h){if(!bS){return}if(k<0){k=0}else{if(k>aV){k=aV}}if(h===g){h=bk.animateScroll}if(h){a9.animate(aX,"left",k,bK)}else{aX.css("left",k);bK(k)}}function bK(o){if(o===g){o=aX.position().left}bD.scrollTop(0);bO=o;var k=bO===0,l=bO==aV,m=o/aV,h=-m*(a6-bF);if(ba!=k||aU!=l){ba=k;aU=l;br.trigger("jsp-arrow-change",[bG,bQ,ba,aU])}aN(k,l);a1.css("left",h);br.trigger("jsp-scroll-x",[-h,k,l]).trigger("scroll")}function aL(k,h){if(bk.showArrows){by[k?"addClass":"removeClass"]("jspDisabled");bJ[h?"addClass":"removeClass"]("jspDisabled")}}function aN(k,h){if(bk.showArrows){bm[k?"addClass":"removeClass"]("jspDisabled");aI[h?"addClass":"removeClass"]("jspDisabled")}}function bd(h,l){var k=h/(a0-aK);a4(k*aW,l)}function bc(l,h){var k=l/(a6-bF);a3(k*aV,h)}function bN(l,t,h){var w,z,y,A=0,m=0,k,u,v,q,r,o;try{w=d(l)}catch(x){return}z=w.outerHeight();y=w.outerWidth();bD.scrollTop(0);bD.scrollLeft(0);while(!w.is(".jspPane")){A+=w.position().top;m+=w.position().left;w=w.offsetParent();if(/^body|html$/i.test(w[0].nodeName)){return}}k=bW();v=k+aK;if(A<k||t){r=A-bk.verticalGutter}else{if(A+z>v){r=A-aK+z+bk.verticalGutter}}if(r){bd(r,h)}u=bU();q=u+bF;if(m<u||t){o=m-bk.horizontalGutter}else{if(m+y>q){o=m-bF+y+bk.horizontalGutter}}if(o){bc(o,h)}}function bU(){return -a1.position().left}function bW(){return -a1.position().top}function bf(){var h=a0-aK;return(h>20)&&(h-bW()<10)}function bv(){var h=a6-bF;return(h>20)&&(h-bU()<10)}function bI(){bD.unbind(bM).bind(bM,function(l,k,m,q){var o=bO,h=bh;a9.scrollBy(m*bk.mouseWheelSpeed,-q*bk.mouseWheelSpeed,false);return o==bO&&h==bh})}function aR(){bD.unbind(bM)}function bV(){return false}function bg(){a1.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(h){bN(h.target,false)})}function bp(){a1.find(":input,a").unbind("focus.jsp")}function a7(){var h,m,k=[];bS&&k.push(bC[0]);bi&&k.push(a5[0]);a1.focus(function(){br.focus()});br.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(o){if(o.target!==this&&!(k.length&&d(o.target).closest(k).length)){return}var q=bO,r=bh;switch(o.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:h=o.keyCode;l();break;case 35:bd(a0-aK);h=null;break;case 36:bd(0);h=null;break}m=o.keyCode==h&&q!=bO||r!=bh;return !m}).bind("keypress.jsp",function(o){if(o.keyCode==h){l()}return !m});if(bk.hideFocus){br.css("outline","none");if("hideFocus" in bD[0]){br.attr("hideFocus",true)}}else{br.css("outline","");if("hideFocus" in bD[0]){br.attr("hideFocus",false)}}function l(){var o=bO,q=bh;switch(h){case 40:a9.scrollByY(bk.keyboardSpeed,false);break;case 38:a9.scrollByY(-bk.keyboardSpeed,false);break;case 34:case 32:a9.scrollByY(aK*bk.scrollPagePercent,false);break;case 33:a9.scrollByY(-aK*bk.scrollPagePercent,false);break;case 39:a9.scrollByX(bk.keyboardSpeed,false);break;case 37:a9.scrollByX(-bk.keyboardSpeed,false);break}m=o!=bO||q!=bh;return m}}function a8(){br.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function bt(){if(location.hash&&location.hash.length>1){var k,m,l=escape(location.hash.substr(1));try{k=d("#"+l+', a[name="'+l+'"]')}catch(h){return}if(k.length&&a1.find(l)){if(bD.scrollTop()===0){m=setInterval(function(){if(bD.scrollTop()>0){bN(k,true);d(document).scrollTop(bD.position().top);clearInterval(m)}},50)}else{bN(k,true);d(document).scrollTop(bD.position().top)}}}}function aS(){if(d(document.body).data("jspHijack")){return}d(document.body).data("jspHijack",true);d(document.body).delegate("a[href*=#]","click",function(v){var k=this.href.substr(0,this.href.indexOf("#")),u=location.href,o,m,h,r,t,q;if(location.href.indexOf("#")!==-1){u=location.href.substr(0,location.href.indexOf("#"))}if(k!==u){return}o=escape(this.href.substr(this.href.indexOf("#")+1));m;try{m=d("#"+o+', a[name="'+o+'"]')}catch(l){return}if(!m.length){return}h=m.closest(".jspScrollable");r=h.data("jsp");r.scrollToElement(m,true);if(h[0].scrollIntoView){t=d(f).scrollTop();q=m.offset().top;if(q<t||q>t+d(f).height()){h[0].scrollIntoView()}}v.preventDefault()})}function bB(){var o,q,l,m,k,h=false;bD.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(t){var r=t.originalEvent.touches[0];o=bU();q=bW();l=r.pageX;m=r.pageY;k=false;h=true}).bind("touchmove.jsp",function(r){if(!h){return}var t=r.originalEvent.touches[0],u=bO,v=bh;a9.scrollTo(o+l-t.pageX,q+m-t.pageY);k=k||Math.abs(l-t.pageX)>5||Math.abs(m-t.pageY)>5;return u==bO&&v==bh}).bind("touchend.jsp",function(r){h=false}).bind("click.jsp-touchclick",function(r){if(k){k=false;return false}})}function aY(){var h=bW(),k=bU();br.removeClass("jspScrollable").unbind(".jsp");br.replaceWith(bA.append(a1.children()));bA.scrollTop(h);bA.scrollLeft(k);if(bq){clearInterval(bq)}}d.extend(a9,{reinitialise:function(h){h=d.extend({},bk,h);bx(h)},scrollToElement:function(k,l,h){bN(k,l,h)},scrollTo:function(k,h,l){bc(k,l);bd(h,l)},scrollToX:function(k,h){bc(k,h)},scrollToY:function(h,k){bd(h,k)},scrollToPercentX:function(k,h){bc(k*(a6-bF),h)},scrollToPercentY:function(k,h){bd(k*(a0-aK),h)},scrollBy:function(l,h,k){a9.scrollByX(l,k);a9.scrollByY(h,k)},scrollByX:function(h,l){var m=bU()+Math[h<0?"floor":"ceil"](h),k=m/(a6-bF);a3(k*aV,l)},scrollByY:function(h,l){var m=bW()+Math[h<0?"floor":"ceil"](h),k=m/(a0-aK);a4(k*aW,l)},positionDragX:function(h,k){a3(h,k)},positionDragY:function(k,h){a4(k,h)},animate:function(o,k,h,l){var m={};m[k]=h;o.animate(m,{duration:bk.animateDuration,easing:bk.animateEase,queue:false,step:l})},getContentPositionX:function(){return bU()},getContentPositionY:function(){return bW()},getContentWidth:function(){return a6},getContentHeight:function(){return a0},getPercentScrolledX:function(){return bU()/(a6-bF)},getPercentScrolledY:function(){return bW()/(a0-aK)},getIsScrollableH:function(){return bS},getIsScrollableV:function(){return bi},getContentPane:function(){return a1},scrollToBottom:function(h){a4(aW,h)},hijackInternalLinks:d.noop,destroy:function(){aY()}});bx(bb)}a=d.extend({},d.fn.jScrollPane.defaults,a);d.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){a[this]=a[this]||a.speed});return this.each(function(){var h=d(this),c=h.data("jsp");if(c){c.reinitialise(a)}else{c=new b(h,a);h.data("jsp",c)}})};d.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,stickToBottom:false,stickToRight:false,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:g,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:0.8}})(jQuery,this);var EMPTY="";var PARAM_SPLITTER_SYMBOL_FROM_TO="@!";var PARAM_SPLITTER_SYMBOL=";@";function saveMultiplier(c,a){var b="saveMultiplierChanges("+c+")";getAccountRisk(a,"mainRisk",b)}function saveMultiplierChanges(c){var a=$PT("multiplier"+c);if(a!=null){var b=(parseFloat(a.value)).toFixed(2);fxAjax.sendRequest(fxVars.updateMultiplier+ +c+"&multiplier="+b,{params:{id:c,multiplier:b},loader:false,callback:"updateMultiplierResponse"})}}function restoreMultiplierChanges(g,f){var b=$PT("multiplier"+g);if(b!=null){var c=b.getAttribute("firstMultiplier");b.value=c;var a=Number($PT("drawdown"+g).getAttribute("drawdown"));updateRisks(c,a,"mainRisk",g,false);var d=$PT("monthly"+g).getAttribute("balance");updateMasterData(g,c,f,d,false);updateSlaveRecommendedBalance(d,false);updateTotal(false)}}function getRisk(h,a,g,f,c){if(c){return getMaxRisk(h,a,g,f,c)}var b=$J("#multiplier"+f);var d=Number(Number(parseFloat(b.val())).toFixed(2));return d*Number($J("#drawdown"+f).attr("drawdown"))}function getMaxRisk(g,a,f,d){var c=0;var b;$J("[firstmultiplier]").each(function(m){var k=this.getAttribute("elementId");var h=Number($J("#drawdown"+k).attr("drawdown"));var l=$J("#multiplier"+k);var o=Number(Number(parseFloat(l.val())).toFixed(2));if(k!=d){b=o*h}else{b=g*h}if(b>c){c=b}});return c}function getOldRisk(g,a,f,d){var c=0;var b;$$PT("[firstmultiplier]").each(function(l){var k=l.getAttribute("elementId");var h=Number($PT("drawdown"+k).getAttribute("drawdown"));var o=$PT("multiplier"+k).getAttribute("firstMultiplier");var m=Number(Number(parseFloat(o)).toFixed(1));if(k!=d){b=m*h}else{b=g*h}if(b>c){c=b}});return c}var lastMultiplier=0;function updateMultiplier(u,h,w,s,x,l,d,y,r){var v=false;var k=Number($PT("drawdown"+u).getAttribute("drawdown"));var q="multiplier"+u;var c=$PT(q);var g=c.value;var o=parseFloat((parseFloat(c.value)+h).toFixed(2));if(isNaN(c.value)){v=true}var a=(s!=null)?s:$PT("monthly"+u).getAttribute("balance");var b=$PT("save"+u);var t=c.getAttribute("firstMultiplier");var m=h;if(r==undefined){r=false}var z=(k*o).toFixed(2);if(z>=100){if(z>100){Tipped.create("#"+q,$T("tYouCannotSetRiskOfMoreThan")).show();window.setTimeout(function(){Tipped.remove("#"+q)},3000)}o=(99.9/k).toFixed(2);z=(k*o).toFixed(2);c.value=o}if(!v&&o>=0&&z>0&&z<=100){lastMultiplier=o;c.style.borderColor="";var f=(/^\d+(\.\d+)*$/).exec(g);c.value=(f==null&&!l)?g:o;updateRisks(o,k,x,u,r);if(b!=null&&d){$PT("row"+u).className="promote";showElement(b.id);showElement("saveB"+u)}else{if($J("#agreeAutoTradeTerms")[0]!=undefined){jQuery("#agreeAutoTradeTerms").button("option","disabled",!$PT("AutoTradeConfermTermsCheckbox").checked)}}updateMasterData(u,o,w,a,false);if(x=="mainRisk"){updateSlaveRecommendedBalance(a,false);updateTotal(false)}}else{if(v||lastMultiplier!=parseFloat(c.value)&&m>=0){c.style.borderColor="red";$PT("row"+u).className="promoteLimit";if(b!=null&&d){hideElement("saveB"+u)}else{if($J("#agreeAutoTradeTerms")[0]!=undefined){jQuery("#agreeAutoTradeTerms").button("option","disabled",true)}}}else{if(o>0&&m<0){updateMasterData(u,o,w,a,false);c.value=o}}}}function getMarginOrRiskColor(b,c){var a="";if(c<33){a="absolute darkGreen"}else{if(c<66){a="absolute darkYellow"}else{a="absolute darkRed"}}b.style.width=c+"%";b.className=a}function updateRisks(h,a,g,f,b){var d=$PT(g);var c=getRisk(h,a,g,f,b);if(d!=null&&c<=100){getMarginOrRiskColor(d,c)}}function updateMasterData(a,k,f,d,h){var c=$PT("drawdown"+a).getAttribute("drawdown")*k;var l=$PT("daily"+a).getAttribute("daily")*k;var b=$PT("monthly"+a).getAttribute("monthly")*k;$PT("drawdown"+a).innerHTML=roundNumUp(c,2)+"% <br/>"+f+roundNumUp((c*d/100),2);$PT("daily"+a).innerHTML=roundNumUp(l,2)+"% <br/>"+f+roundNumUp((l*d/100),2);$PT("monthly"+a).innerHTML=roundNumUp(b,2)+"% <br/>"+f+roundNumUp((b*d/100),2);if(h){$PT("monthly"+a).setAttribute("balance",d)}var g=$PT("minBalance"+a);g.innerHTML=f+calculateMinBalance(g,k,h)}function calculateMinBalance(d,f,a){if(d!=null){var b=Number(d.getAttribute("slaveMinBalance"));var c=roundNumUp((b/f),2);if(c<1000){c=1000}return c}}function updateMultiplierResponse(f,c){var a=c.id;var h=$PT("multiplier"+a);$PT("row"+a).className="";hideElement("save"+a);if(!f.error){if(h!=null){var d=$PT("mainRisk");var k=Number(h.getAttribute("firstMultiplier"));var b=Number($PT("drawdown"+a).getAttribute("drawdown"));h.setAttribute("firstMultiplier",c.multiplier);var g=getOldRisk(c.multiplier,b,"mainRisk",a);d.setAttribute("risk",g)}}else{if(h!=null){h.value=h.getAttribute("firstMultiplier")}var l=f.message;if(l!=null){showJqueryMessage("autoTradeMsg",l)}}}function autoTradeopenDemo(c,f,h,a){var d=true;var g=["name=",encodeParameter(c),"&accountLeverage=",f,"&accountDeposit=",h,"&brokerOid=",a];showElement("openDemoAccountLoader");hideElement("openDemoAccountData");var b=staticServerPath+"images/circle1.gif";$PT("openDemoAccountLoader").innerHTML="Creating your demo account.<br/><br/><div class='loader4 inlineBlock'></div><br/><br/> This may take up to 30 seconds.";$("#openDemoAccountWindowCloseButton").hide();$("#openDemoAccountWindowCancelButton").attr("disabled",true);$("#openDemoAccountWindowOkButton").attr("disabled",true);fxAjax.sendRequest(fxVars.openDemo+g.join(""),{contentType:"text/xml",params:{},loader:false,callback:"autoTradeOpenDemoResponse"})}function autoTradeOpenDemoResponse(f,h){if(!f.error){var c=f.content.whiteLabelBrokerUrl;var d=f.content.redirectUrl;if(hasText(c)&&hasText(d)){navigateTo(d)}else{var g=function(){navigateTo(serverPath+"/autotrade/"+f.content.accountName+"/"+f.content.accountOid)};var a={message:"Account created!",okOnClickEvent:g};setInfoMessageToDialog(a)}}else{var b=f.message;showOpenDemoAccountLoader(b)}}function setInfoMessageToDialog(properties){$PT("openDemoAccountLoader").innerHTML=properties.message;var okButton=$("#openDemoAccountWindowOkButton");if(properties.okOnClickEvent!=undefined){okButton.attr("onclick","").unbind("click").click(function(e){if(isFunction(properties.okOnClickEvent)){properties.okOnClickEvent(e)}else{eval(properties.okOnClickEvent)}})}okButton.attr("disabled",false)}function isFunction(a){var b={};return a&&b.toString.call(a)==="[object Function]"}function showOpenDemoAccountLoader(a){showElement("openDemoAccountLoader");$PT("openDemoAccountLoader").innerHTML=a;var d=$("#openDemoAccountWindowOkButton");d.off("click").click(function(){$("#openDemoAccountWindow").modal("hide")});d.attr("disabled",false);var c=$("#openDemoAccountWindowCancelButton");c.hide();var b=$("#openDemoAccountWindow");b.off("hidden.bs.modal").on("hidden.bs.modal",function(){c.show();b.off("hidden.bs.modal")});b.modal("show")}function showOpenLiveAccountLoader(a){showElement("openLiveAccountLoader");$PT("openLiveAccountLoader").innerHTML=a;$("#openLiveAccountWindow").modal("show")}function autoTradeCheckMtLogin(c,b,a){fxAjax.sendRequest(fxVars.checkMtLogin+c+"&lastStatus="+b+"&autoTradeDemoAccount=true",{contentType:"text/xml",params:{id:c,newAccount:a},loader:false,callback:"autoTradeOpenDemoResponse"})}var confirmMasterOid=0;function addAutoTradeConfirm(f,d,b,c){$PT("AutoTradeConfermTermsCheckbox").checked=false;confirmMasterOid="master"+f;jQuery("#copyBuyTrades"+f).prop("checked",true);jQuery("#copySellTrades"+f).prop("checked",true);var a=$("#autoTradeConfirm");a.data("masterAccountOid",f);a.data("add",d);a.data("elementId",b.id);a.data("system",c);a.off("hidden.bs.modal").on("hidden.bs.modal",function(){if(!$(this).data("okButton")){$PT("autoTradeConfirmData").innerHTML=""}$(this).data("okButton",false);clearAutoTradeConfirmModalBody()});a.modal("show");getAutoTradeConfirmData(f,c,a)}function getAutoTradeConfirmData(k,f,b){initMasterSettings(k);var g=["masterOid=",k,"&systemPage=",f];var a=$J("#slaveAccounts");var d=a.length>0;var c=d?a.find(":selected"):null;var h=c?c.attr("whitelabel")=="true":null;if(c){g.push("&slaveOid=",c.val())}if(h){showWhiteLabelConfirmationModal(c)}else{$("#autoTradeConfirmLoader").show();fxAjax.sendRequest(fxVars.getAutoTradeConfirmData+g.join(""),{loader:false,callback:"getAutoTradeConfirmDataResponse"})}}function removeAutoTradeConfirm(h,k,g,c,f,b){var d="Are you sure you wish to remove "+b+"?<br/><br/><b>Important:</b> Any trades opened by this system will be no longer managed by it. In case you subscribe to the system again, it will resume managing the trades.";var a="addOrDeleteMasterToSlave("+h+","+k+","+g+","+c.id+","+f+")";showJqueryMessageWithOkAndCancel("removeAutoTrade",d,a,null,null)}function addOrDeleteMasterToSlave(q,v,o,h,c){var a=$PT(h);var k=new Element("img",{src:"/images/loader5.gif"});a.parentNode.appendChild(k);hideElement(a);var b=getMasterSymbolsData(v);var s=jQuery("#copyBuyTrades"+v).is(":checked");var x=jQuery("#copySellTrades"+v).is(":checked");var f=$PT("multipliermaster"+v);var g=(f!=null)?Number($F("multipliermaster"+v)):0;var t=$PT("balanceStop"+v).value;var r=$PT("drawdownStop"+v).value;var l=$PT("totalLots"+v).value;var u=$PT("totalOpenTrades"+v).value;var m=$PT("fixedLots"+v).value;var w=getTimeTableDate(v);var d=$J("#enableSlTp"+v).is(":checked");var y=["slaveAccountOid=",q,"&masterAccountOid=",v,"&add=",o,"&multiplier=",g,"&systemPage=",c,"&balanceStop=",t,"&drawdownStop=",r,"&totalLots=",l,"&totalOpenTrades=",u,"&fixedLots=",m,"&weekTimes=",encodeParameter(w),"&ignoreTradeSymbols=",encodeParameter(getIgnoreSymbolsFromTree(v)),"&mappingSymbols=",encodeParameter(b.join(PARAM_SPLITTER_SYMBOL)),"&enableSlTp=",d,"&copyBuyTrades=",s,"&copySellTrades=",x];fxAjax.sendRequest(fxVars.addOrDeleteMasterToSlave,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:y.join(""),method:"post",params:{add:o,element:a,system:c,masterAccountOid:v,imgElement:k},loader:false,callback:"addOrDeleteMasterToSlaveResponse"})}function addOrDeleteMasterToSlaveResponse(g,f){var b=f.system;var r=g.message;if(!g.error){var k=g.content.data;var l=f.element;$PT("autoTradeConfirmData").innerHTML="";if(hasText(k)&&!b){$PT("subscribedSystems").innerHTML=k;runAjaxScripts(k)}var o=l.getAttribute("masterAccountOid");var c=masters["openTrade"+o];var m=masters["openOrder"+o];if(f.add){if(!b){l.className="largeOff responseGreen radius3 border0 bold";l.value="Trading";l.disabled=true;if(c){c.setDefault()}if(m){m.setDefault()}}else{r="Autotrade account added successfully";if(g.content.allSlavesConnectedToMaster){l.className="radius3 font11 bold noUnderline pointer bg6 border2";l.innerHTML="Trading";$J("a#masterButton"+f.masterAccountOid).attr("onclick","").unbind("click")}initMasterSettings(f.masterAccountOid)}}else{var q=$PT("masterButton"+o);if(q!=null){q.className="largeOff";q.value="AutoTrade";q.disabled=false}if(c){c.setClassName("atUnsubscribed");c.addInfoUnsubscribed()}if(m){m.setClassName("atUnsubscribed");m.addInfoUnsubscribed()}initMasterSettings(o)}var d=$PT("mainRisk");var h=Number(g.content.risk);var a=h>100?100:h;if(d!=null&&h!=null){d.style.width=a+"%";d.setAttribute("risk",h);getMarginOrRiskColor(d,a)}}showElement(f.element);f.imgElement.remove();if(r!=null){showJqueryMessage("autoTradeMsg",r)}}function changeAutoTradeTermsCheckbox(b){var a=Number($PT("drawdown"+confirmMasterOid).getAttribute("drawdown"));var c=$PT("multiplier"+confirmMasterOid);var f=parseFloat(parseFloat(c.value).toFixed(2));var d=false;if(!isNaN(c.value)&&f>0&&getRisk(f,a,"confirmRisk",confirmMasterOid,false)<=100){d=true}jQuery("#agreeAutoTradeTerms").attr("disabled",!(d&&b.checked))}var ACCOUNT_LAST_DATA_EQUITY=0;var ACCOUNT_LAST_DATA_BALANCE=1;var ACCOUNT_POSITIONS=2;var ACCOUNT_ORDER_POSITION_CLOSE=11;var ACCOUNT_LAST_DATA_MARGIN=12;function SignalTradeMasterGroupingObject(){this.sumMap={};this.ownLiveFollower=eval($J("#ownLiveFollower").val());this.add=function(param){var el=$J(param);this.trade=el.attr("trade");if(this.trade==undefined){return}this.masterId=el.attr("master");this.key=this.masterId+this.trade;var obj=this.sumMap[this.key];if(obj==undefined){obj=new GroupParams(el,this.masterId,this.trade,this.key,this.ownLiveFollower)}if(this.ownLiveFollower){obj.lots=obj.lots+Number(el.attr("lots"))}obj.profit=obj.profit+Number(el.attr("profit"));obj.count++;this.sumMap[this.key]=obj};function GroupParams(el,id,trade,key,ownLiveFollower){this.profit=0;this.lots=0;this.count=0;this.id=id;this.trade=trade;this.key=key;this.ownLiveFollower=ownLiveFollower;var profit=$J("#profit"+key);var lots=$J("#lots"+key);var positions=$J("#positions"+key);this.update=function(value){profit.html(styleFigure(value.profit,"","",true,false,2));if(this.ownLiveFollower){if(!isNaN(value.lots)){lots.html(getLots(value.lots))}}positions.html(value.count)}}}function AutotradeTable(){var a={};this.addTr=function(d,k,c,b){var f=$J(d);var g=f.attr("master");this.idAppend=b?"openTrade":"openOrder";this.ticket=f.attr("t");var h=g+this.idAppend;if(a[h]==undefined){a[h]=[];if(!$J("#master"+g+this.idAppend).isExist()){a[h].push(new TrTradeElement(new MasterElement(g,k,c,b),k,b,c))}}a[h].push(new TrTradeElement(d,k,b,c))};this.appendAll=function(){var d=[];var c=$J("#myAccount").attr("accountOid");var b=undefined;$J.each(a,function(f,g){if(f.indexOf(c+"openTrade")>=0){b=f}else{d.push(f)}});d.sort();if(b!=undefined){d.push(b)}$J.each(d,function(f,g){var k=a[g].sort(function(m,l){return m.ticket-l.ticket});var h=undefined;$J.each(k,function(){this.appendElement();if(hasText(this.masterOid)){h=this.idAppend+this.masterOid}});if(hasText(h)){masters[h].addInfoUnsubscribed();masters[h].addInfoDisapprove()}})}}function TrTradeElement(element,tableElement,isOpenTrade,orderData){var f=this;this.idAppend=isOpenTrade?"openTrade":"openOrder";var el=$J(element);var te=$J(tableElement);this.isMaster=el.attr("isMaster")!=undefined;var className=EMPTY;this.masterOid=el.attr("master");var masterDisapproved=!hasText(availableMasters[this.masterOid]);var selectedMaster=hasText(selectedMasters[this.masterOid]);if(masterDisapproved){className="autotradeTrDisapprove"}else{if(!selectedMaster){className="atUnsubscribed"}}if(!this.isMaster){el.mouseout(function(){this.className=masters[f.idAppend+f.masterOid].getClassName()});el.mouseover(function(){this.className="normalActive"})}this.ticket=!this.isMaster?Number(orderData.t):0;function _resize(trade){if(trade){var c=$PT(tableElement.id+"Count");c.innerHTML=Number(c.innerHTML)+1}createScroller(tableElement.id+"Cont")}this.appendElement=function(){var master=el.attr("master");var masterElementsExist=$J("#master"+master+this.idAppend).isExist();if(!masterElementsExist){$J(tableElement).append(element);_resize(false)}else{var isOpen=eval($J("#expandButton"+master+this.idAppend).attr("isOpen"));var masterElements=$J(tableElement).find("tr[master="+master+"]");if(!masterElements.isExist()){te.find("tr[id=master"+master+this.idAppend+"]").after(el)}else{masterElements.last().after(el)}if(!isOpen){el.hide()}_resize(true)}}}var availableMasters={};var selectedMasters={};var masters={};function MasterElement(masterOid,tableElement,orderData,isOpenTrade){var f=this;var isDemo=eval($J("#isDemo").val());var trElement=$J("<tr>");this.master=true;var masterDisapproved=!hasText(availableMasters[masterOid]);var selectedMaster=hasText(selectedMasters[masterOid]);var className="";var masterInfoElement=undefined;if(masterDisapproved){className="autotradeTrDisapprove"}else{if(!selectedMaster){className="atUnsubscribed"}else{trElement.attr("class","autotradeTr")}}this.idAppend=isOpenTrade?"openTrade":"openOrder";var ip=this.idAppend;trElement.attr("trade",this.idAppend);trElement.attr("id","master"+masterOid+this.idAppend);trElement.attr("isMaster",true);var min=$J("<td>");min.attr("colSpan",1);min.attr("width","5%");this.systemLink=orderData.slk;var minButton=$J("<span isOpen='true' masterExpandButton='"+this.idAppend+"' id='expandButton"+masterOid+this.idAppend+"' class='expandButton radius2 floatLeft marginL10 lh14 pointer'>-</span>");minButton.click(function(){openCloseGroup(masterOid,f.idAppend,tableElement)});min.append(minButton);trElement.append(min);var mySlaveAccount=$J("#myAccount");var tdAvatar=$J("<td>");tdAvatar.attr("colSpan",1);tdAvatar.attr("width","10%");var defaultUser=false;var uid=orderData.u;if(uid==undefined){defaultUser=true}var imageType=!defaultUser?orderData.it:mySlaveAccount.attr("imageType");var imageId=!defaultUser?orderData.ii:mySlaveAccount.attr("imageId");if(!hasText(imageType)||!hasText(imageId)){imageId="";imageType="jpg"}var aAvatar=$J("<span class='inlineBlock' target='_blank'>");var aAvatarImg=$J("<img class='avatarFrame' width='30' height='30'>");this.img="/userimages."+imageType+"?uid="+uid+"&id="+imageId+"&w=30&h=30";aAvatarImg.attr("src",this.img);aAvatar.append(aAvatarImg);tdAvatar.append(aAvatar);trElement.append(tdAvatar);var masterAccount=$J("<td>");masterAccount.attr("colSpan",2);masterAccount.attr("width",isOpenTrade?"21%":"24%");masterAccount.attr("align","left");var linkToSystem=undefined;var slaveTicket=false;if(hasText(this.systemLink)){linkToSystem=$J("<a class='underline' target='_blank'>");linkToSystem.attr("href",this.systemLink);if(hasText(orderData.mn)){this.systemName=htmlDecode(orderData.mn)}linkToSystem.text(this.systemName)}else{slaveTicket=true;linkToSystem=$J("<label>");this.systemName="Manual Trades";linkToSystem.text(this.systemName)}masterAccount.append(linkToSystem);masterAccount.append(" (").append($J("<span id='positions"+masterOid+this.idAppend+"'>")).append(")");trElement.append(masterAccount);var lotsValue=$J("<td><li class='key'>");lotsValue.attr("id","lots"+masterOid+this.idAppend);lotsValue.attr("colSpan",1);trElement.append(lotsValue);var td=$J("<td>");if(isOpenTrade){td.attr("colSpan",7);td.attr("width","52%");trElement.append(td);var profitValue=$J("<td>");profitValue.attr("id","profit"+masterOid+this.idAppend);profitValue.attr("colSpan",1);profitValue.attr("class","bold");trElement.append(profitValue)}else{td.attr("colSpan",5);td.attr("width","54%");trElement.append(td)}var closeElement=$J("<td name='closer'><a name='aCloser' class='closer pointer'>").attr("colSpan",1);trElement.append(closeElement);closeElement.click(function(){closeMasterPositionsConfirm(masterOid,f.idAppend,isOpenTrade,f.systemName,slaveTicket)});if(masterInfoElement!=undefined){masterInfoElement.find("[name=imageSrc]").attr("src",this.img);masterInfoElement.find("[name=systemName]").html(this.systemName)}this.addInfoUnsubscribed=function(){if(className=="atUnsubscribed"){trElement.attr("class","atUnsubscribed");$J("[master="+masterOid+"][trade="+this.idAppend+"]").attr("class","atUnsubscribed");if(!$J("#unsubscribed"+masterOid).isExist()){masterInfoElement=$J("#unsubscribedSample").clone();masterInfoElement.show();masterInfoElement.attr("id","unsubscribed"+masterOid);$J("#masterUnsubscribed").append(masterInfoElement);if(masterInfoElement!=undefined){masterInfoElement.find("[name=imageSrc]").attr("src",this.img);masterInfoElement.find("[name=systemName]").html(this.systemName)}}}};this.addInfoDisapprove=function(){if(className=="autotradeTrDisapprove"){trElement.attr("class","autotradeTrDisapprove");$J("[master="+masterOid+"][trade="+this.idAppend+"]").attr("class","autotradeTrDisapprove");if(!$J("#disapproved"+masterOid).isExist()){masterInfoElement=$J("#disapprovedSample").clone();masterInfoElement.show();masterInfoElement.attr("id","disapproved"+masterOid);$J("#masterDisapproved").append(masterInfoElement);if(masterInfoElement!=undefined){masterInfoElement.find("[name=imageSrc]").attr("src",this.img);masterInfoElement.find("[name=systemName]").html(this.systemName)}}}};this.setDefault=function(){className="";trElement.attr("class","autotradeTr");$J("[master="+masterOid+"][trade="+this.idAppend+"]").attr("class","");if(masterInfoElement){masterInfoElement.remove()}};this.setClassName=function(cn){className=cn};this.getClassName=function(){return className};trElement.find("*:not([name=closer],a)").click(function(){openCloseGroup(masterOid,f.idAppend,tableElement)});masters[this.idAppend+masterOid]=this;return trElement}function openCloseGroup(masterOid,appendId,tableElement){var element=$J("#expandButton"+masterOid+appendId);var shown=eval(element.attr("isOpen"));var elements=$J("tr[master="+masterOid+"][trade="+appendId+"]");if(!shown){element.text("-");elements.show()}else{element.text("+");elements.hide()}element.attr("isOpen",!shown);createScroller(tableElement.id+"Cont")}var initAutotrade=false;var accountDisconnctedError=false;function accountLastDataUpdate(data,hideLoader){var slaveAccountOid=$J("#myAccount").attr("accountOid");if(data!=null&&(data.po==null||initAutotrade||data.init!=undefined)){initAutotrade=true;var equityElement=$PT("autoTradeEquity");var balanceElement=$PT("autoTradeBalance");var floatingPlElement=$PT("floatingPl");var accountOid=data.a;var equity=data.e;if(equityElement!=null&&equity!=null){equityElement.innerHTML=styleFigure(equity,equityElement.getAttribute("predecessor"),"",false,false,2);equityElement.setAttribute("value",equity);if(Number(balanceElement.innerHTML)!=null){var value=Number(equity)-Number(balanceElement.getAttribute("value"));floatingPlElement.innerHTML=styleFigure(value,balanceElement.getAttribute("predecessor"),"",true,true,2)}}var balance=data.b;if(balanceElement!=null&&balance!=null){balanceElement.innerHTML=styleFigure(balance,balanceElement.getAttribute("predecessor"),"",false,false,2);balanceElement.setAttribute("value",balance);jQuery("[monthly]").each(function(){this.setAttribute("balance",balance)});updateSlaveRecommendedBalance(balance,false);if(Number(equityElement.innerHTML)!=null){value=Number(equityElement.getAttribute("value"))-Number(balance);floatingPlElement.innerHTML=styleFigure(value,balanceElement.getAttribute("predecessor"),"",true,true,2)}}var positionClosed=data.pc;if(positionClosed!=null){var ticket=data.t;var positionType=data.ty;var positionTable;var ticketId;var isOpenTrade=positionType<=1;if(isOpenTrade){positionTable=$PT("openTrades");ticketId="openTrade"+ticket}else{positionTable=$PT("openOrders");ticketId="openOrder"+ticket}var deleteRow;if(positionTable!=null){var rowCount=positionTable.rows.length;if($PT(ticketId)!=undefined){var el=$J("#"+ticketId);var trade=el.attr("trade");var master=el.attr("master");$PT(ticketId).remove();if(!$J("[master="+master+"][trade="+trade+"]").isExist()&&$J("#master"+master+trade).isExist()){$J("#master"+master+trade).remove()}var noTradesExist=!$J("[master="+master+"][trade=openOrder]").isExist()&&!$J("[master="+master+"][trade=openTrade]").isExist();if(noTradesExist&&$J("#disapproved"+master).isExist()){$J("#disapproved"+master).remove()}if(noTradesExist&&$J("#unsubscribed"+master).isExist()){$J("#unsubscribed"+master).remove()}if(noTradesExist){masters["openTrade"+master]=null;masters["openOrder"+master]=null}counter=$PT(positionTable.id+"Count");counter.innerHTML=Number(counter.innerHTML)-1;createScroller(positionTable.id+"Cont")}if(positionTable.rows.length==1){(isOpenTrade)?showElement("noOpenTrades"):showElement("noOpenOrders")}}}var positions=data.po;if(positions!=null){var openOrdersTable;var trElement;var autotradeTable=new AutotradeTable();for(var position in positions){var isOpenTrade=false;var orderData=positions[position];var type=Number(orderData.ty);var tradeElement=$PT("openTrade"+position);var comment=orderData.com;if(type<=1||(tradeElement!=null)){openOrdersTable=$PT("openTrades");trElement=tradeElement;isOpenTrade=true}else{openOrdersTable=$PT("openOrders");trElement=$PT("openOrder"+position)}var masterOid=orderData.mo;if(trElement==null){var timeKey=new Element("li",{className:"key"});var lotsKey=new Element("li",{className:"key"});var openPriceKey=new Element("li",{className:"key"});var SLKey=new Element("li",{className:"key"});var TKKey=new Element("li",{className:"key"});(isOpenTrade)?hideElement("noOpenTrades"):hideElement("noOpenOrders");trElement=new Element("tr");if(!hasText(masterOid)){masterOid=slaveAccountOid}var idAppend=(isOpenTrade)?"openTrade":"openOrder";trElement.id=idAppend+position;$J(trElement).attr("master",masterOid);if(orderData.lo!=undefined){$J(trElement).attr("lots",orderData.lo)}$J(trElement).attr("profit",orderData.p);$J(trElement).attr("trade",idAppend);$J(trElement).attr("ticket",position);if(comment!=null){trElement.setAttribute("comment",comment)}var tdAvatar=trElement.insertCell(trElement.cells.length);tdAvatar.width="5%";var tdTicket=trElement.insertCell(trElement.cells.length);tdTicket.setAttribute("name","t");tdTicket.width=(isOpenTrade)?"9%":"10%";var tdTime=trElement.insertCell(trElement.cells.length);tdTime.setAttribute("name","ti");tdTime.width=(isOpenTrade)?"12%":"11%";tdTime.appendChild(timeKey);var tdType=trElement.insertCell(trElement.cells.length);tdType.setAttribute("name","ty");tdType.width=(isOpenTrade)?"8%":"10%";var tdLots=trElement.insertCell(trElement.cells.length);tdLots.setAttribute("name","lo");tdLots.width=(isOpenTrade)?"7%":"10%";tdLots.appendChild(lotsKey);var tdSymbol=trElement.insertCell(trElement.cells.length);tdSymbol.setAttribute("name","s");tdSymbol.width=(isOpenTrade)?"7%":"9%";var tdOpenPrice=trElement.insertCell(trElement.cells.length);tdOpenPrice.setAttribute("name","op");tdOpenPrice.width=(isOpenTrade)?"8%":"10%";tdOpenPrice.appendChild(openPriceKey);var tdStopLoss=trElement.insertCell(trElement.cells.length);tdStopLoss.setAttribute("name","sl");tdStopLoss.width=(isOpenTrade)?"8%":"11%";tdStopLoss.appendChild(SLKey);var tdTakeProfit=trElement.insertCell(trElement.cells.length);tdTakeProfit.setAttribute("name","tp");tdTakeProfit.width=(isOpenTrade)?"7%":"11%";tdTakeProfit.appendChild(TKKey);var tdClosePrice=trElement.insertCell(trElement.cells.length);tdClosePrice.setAttribute("name","cp");tdClosePrice.width=(isOpenTrade)?"7%":"10%";if(isOpenTrade){var tdCommission=trElement.insertCell(trElement.cells.length);tdCommission.setAttribute("name","co");tdCommission.width="6%";var tdSwap=trElement.insertCell(trElement.cells.length);tdSwap.setAttribute("name","sw");tdSwap.width="6%";var tdProfit=trElement.insertCell(trElement.cells.length);tdProfit.setAttribute("name","p");tdProfit.width="6%";tdProfit.className="bold lh34"}var tdClosePosition=trElement.insertCell(trElement.cells.length);tdClosePosition.width="4%";var closeId=isOpenTrade?"closeOpenTrade"+position:"closeOpenOrder"+position;var aElement=new Element("a",{className:"closer pointer",id:closeId,ticket:position,ot:isOpenTrade.toString(),name:"aCloser"});aElement.onclick=function(){closePositionConfirm(this,accountOid,this.getAttribute("ticket"),eval(this.getAttribute("ot")))};tdClosePosition.appendChild(aElement);autotradeTable.addTr(trElement,openOrdersTable,orderData,isOpenTrade)}for(var id in orderData){updateOpenOrderValue(trElement,id,orderData[id])}}autotradeTable.appendAll()}insertAndUpdateElements();var margin=data.m;if(Number(margin)>100){margin=100}if(margin!=null){var marginElement=$$PT("[name=marginElement]").each(function(element){getMarginOrRiskColor(element,margin)})}if(hideLoader==undefined||hideLoader){var autoTradeMainloader=jQuery("#autoTradeloader");if(autoTradeMainloader.hasClass("in")){autoTradeMainloader.modal("hide")}}var connectionStatus=data.connectionStatus;if(hasText(connectionStatus)&&!accountDisconnctedError){showJqueryMessage("autoTradeMsg",connectionStatus);accountDisconnctedError=true}}}function insertAndUpdateElements(){var a=new SignalTradeMasterGroupingObject();$J("[master]").each(function(){a.add(this)});$J.each(a.sumMap,function(b,c){c.update(c)})}function updateOpenOrderValue(b,a,d){var c=$J(b).find("td[name="+a+"]");if(c!=null){c.html(filterPositionsValues(a,d))}if(a=="p"){$J(b).attr("profit",d)}else{if(a=="lo"){$J(b).attr("lots",d)}}}function filterPositionsValues(b,c){var a=c;if(b=="ty"){a=getPositionType(c)}else{if(b=="p"){a=styleFigure(c,"","",true,false,2)}else{if(b=="tp"||b=="sl"){a=(c==0)?"-":c}else{if(b=="lo"){a=getLots(c)}}}}return a}function getPositionType(a){switch(a){case 0:return"Buy";case 1:return"Sell";case 2:return"Buy Limit";case 3:return"Sell Limit";case 4:return"Buy Stop";case 5:return"Sell Stop"}}function createOpenDemoAccountConfirm(b,a){if($$PT("#autoTradeMenuUl li [demo=true]").length<Number($F("autoTradeAccountsLimit"))){hideElement("openDemoAccountLoader");showElement("openDemoAccountData");$("#openDemoAccountWindowCloseButton").show();$("#openDemoAccountWindowCancelButton").attr("disabled",false);$("#openDemoAccountWindowOkButton").off("click").click(function(){if(validate("accountName",VALID_SYSTEM_NAME)){var k=$F("accountDeposit");var f=$F("whiteLabelBrokers");var c=$F("leverage");var d=$F("accountName");var h=$($("#whiteLabelBrokers option:selected")[0]);var g=h.attr("whitelabel")=="true";if(g){$PT("openDemoAccountLoader").innerHTML=$T("tClickOkToCreateTheAccountAndContinueToBrokerAutotrade",[h.html()]);$("#openDemoAccountData").hide();$("#openDemoAccountLoader").show();$("#openDemoAccountWindowOkButton").off("click").click(function(){autoTradeopenDemo(d,hasText(c)?c:DEFAULT_LEVERAGE,k,f)})}else{autoTradeopenDemo(d,hasText(c)?c:DEFAULT_LEVERAGE,k,f)}}});$("#openDemoAccountWindow").modal("show")}else{showElement("openDemoAccountLoader");hideElement("openDemoAccountData");showOpenDemoAccountLoader("You already have a demo account. If you wish to open a new demo account, please delete the existing one.")}}function getAutoTradeConfirmDataResponse(d,b){if(!d.error){var f=d.content.data;if(hasText(f)){$J("#autoTradeConfirmData").html(f);runAjaxScripts(d.content.data);$J(".constantArea").show();$J(".autotradeArea").hide();var c=-1;var r=$J("#slaveAccounts");var k=r.find(":selected");var l=k?k.attr("whitelabel")=="true":null;var q=k?k.val()!=c:null;var a=$J("#agreeAutoTradeTerms");if(l){showWhiteLabelConfirmationModal(k)}else{if(q){$J(".autotradeArea").show();clearAutoTradeConfirmModalBody()}a.prop("onclick",null).off("click").on("click",function(){startAutoTrade()})}}}else{var o=d.message;var h=$PT("autoTradeMsg");if(o!=null&&h!=null){var m=jQuery(".modal.in");if(m.length>0){m.modal("hide")}var g={title:h.title,message:o,showCancelBtn:false,okOnClickEvent:"document.location.reload(true);",showCloseBtn:false};buildModalMessageDialog(g)}}$("#autoTradeConfirmLoader").hide()}function autoTradeProvidersCheck(a){hideElement(a.id);showElement("accountsCheckLoader");setTimeout("showElement('accountsCheckTable'); hideElement('accountsCheckLoader');",1000)}function autoTradeAddProviderResponse(a,c){if(!a.error){var b=a.content.message}else{b=a.message}showJqueryMessage("autoTradeFaqMsg",b)}function removeSlaveAccountConfirm(slaveAccountOid){var id="removeSlave"+slaveAccountOid;var okfunc="removeSlaveAccount("+slaveAccountOid+","+id+")";$("#removeSlaveAccounteMsgOkButton").off("click").click(function(){eval(okfunc)});$("#removeSlaveAccounteMsg").modal("show")}function removeSlaveAccount(c,a){var b=new Element("img",{src:"/images/loader5.gif"});a.parentNode.appendChild(b);hideElement(a);fxAjax.sendRequest(fxVars.removeSlaveAccount+c,{params:{slaveAccountOid:c,imgElement:b,removeElement:a},loader:false,callback:"removeSlaveAccountResponse"})}function removeSlaveAccountResponse(a,c){if(!a.error){removeElement("slaveAccount"+c.slaveAccountOid);removeElement("autoTradeMenu"+c.slaveAccountOid);if($PT("myAccountsTable").rows.length==1){showElement("myAccountsEmpty")}}else{showElement(c.removeElement);var b=a.message;if(hasText(b)){showJqueryMessage("removeSystemMsg",b)}}c.imgElement.remove()}function autoTradeConnectionStatusUpdate(b){if(b!=null){var a=b.connected;if(a!=null){if(a){hideElement("connStatusOff");showElement("connStatusOn")}else{hideElement("connStatusOn");showElement("connStatusOff")}}}}function autoTradeMainUpdate(b){if(!b.error){var c=b.accountOid;var g=b.equity;var h=b.balance;if(c!=null){var f=$PT("autoTradeAccountB"+c);var a=$PT("autoTradeAccountE"+c);if(f!=null&&h!=null){f.innerHTML=roundNumber(h,2)}if(a!=null&&g!=null){a.innerHTML=roundNumber(g,2)}}var d=jQuery("#autoTradeMainloader");if(d.hasClass("in")){d.modal("hide")}}}function updateMultiplierByKeyPress(d,h,g,f,b){var a=0;if(d.keyCode==38){a=0.1}else{if(d.keyCode==40){a=-0.1}}if(b==undefined){b=false}updateMultiplier(h,a,g,null,f,false,true,true,b)}function getAccountRisk(c,a,b){fxAjax.sendRequest(fxVars.getAccountRisk+c,{params:{riskElementId:a,func:b},loader:false,callback:"getAccountRiskeResponse"})}function getAccountRiskeResponse(response,params){if(!response.error){var riskElement=$PT(params.riskElementId);var currentRisk=parseInt(riskElement.getAttribute("risk"));var risk=parseInt(response.content.risk);if(risk!=currentRisk){var okfunc="document.location.reload(true);";showJqueryMessageWithOkAndCancel("autoTradeMsg","The data in this page is out of date. Press OK to refresh the page",okfunc,null,null)}else{eval(params.func)}}else{showJqueryMessage("autoTradeMsg",(hasText(response.message))?response.message:"General Error.")}}function closePositionConfirm(c,d,h,b){var a=c.parentNode.parentNode.getAttribute("master");var f=a==d;var g=(!b)?"none":"";var l="<div>Are you sure you want to close this order? </div><br/><div style='display:"+g+"'><div class='paddT5'>";if(!f){l+="<input type='checkbox' id='copyFromMaster'/><label for='copyFromMaster'>Re-enter the trade if possible</label></div><div class='gray1'>Tick the checkbox if you want to re-enter the trade again at a better or equal price (compared to original provider entry).</div></div>"}var k="closePosition('"+c.id+"',"+d+","+h+","+b+")";showJqueryMessageWithOkAndCancel("autoTradeMsg",l,k,null,null)}function closeMasterPositionsConfirm(c,a,b,h,d){var f=(!b)?"none":"";var g=b?"trades":"orders";if(h.indexOf("Manual Trades")>=0){g=""}var l="<div>Are you sure you wish to close all  <b>"+h+"</b> "+g+"? </div><br/><div style='display:"+f+"'><div class='paddT5'>";if(!d){l+="<input type='checkbox' id='copyFromMaster'/><label for='copyFromMaster'>Re-enter the trades if possible</label></div><div class='gray1'>Tick the checkbox if you want to re-enter the trade again at a better or equal price (compared to original provider entry).</div></div>"}var k="closeAllMasterPositions('"+c+"','"+a+"',"+b+")";showJqueryMessageWithOkAndCancel("autoTradeMsg",l,k,null,null)}function closeAllMasterPositions(c,k,h){var g=$J("[master="+c+"][trade="+k+"]").find("a[name=aCloser]");var a=$J("#myAccount").attr("accountOid");var b=$J("#master"+c+k).find("a[name=aCloser]");var d=$J("#copyFromMaster").is("checked");var f=$J("<img src='/images/loader5.gif'>");b.parent().append(f);b.hide();$J.each(g,function(){var l=$J(this);closePosition(l.attr("id"),a,l.attr("ticket"),h)})}function closePosition(a,b,h,g){var c=$PT(a);var d=($PT("copyFromMaster")!=null)?$PT("copyFromMaster").checked:false;var f=new Element("img",{src:"/images/loader5.gif"});c.parentNode.appendChild(f);hideElement(c);fxAjax.sendRequest(fxVars.closePosition+b+"&ticket="+h+"&openTrade="+g+"&resync="+d,{params:{imgElement:f,element:c},loader:false,callback:"closePositionResponse"})}function closePositionResponse(a,c){if(!a.error){}else{c.imgElement.remove();showElement(c.element);var b=a.message;if(hasText(b)){showJqueryMessage("autoTradeMsg",b)}}}function showLoader(b){var a=$PT(b);if(a!=null){$(document).ready(function(){$("#"+b).modal("show")})}}function saveAutoTradeQuestionnaire(h){$PT("responseMessage").innerHTML="";hideElement("responseMessage");if(validate("maxOpenTrades",VALID_INTEGER)&&validate("maxTradesPerDay",VALID_INTEGER)&&validate("maxBalanceRisked",VALID_PERCENT)){var k=false;var b=[];var o=false;$J("[name=risk]").each(function(q,r){if(r.checked){o=true;b.push(r.id+"=true")}});if(!o){showElement("riskErr");k=true}else{hideElement("riskErr")}var c=[];var g=true;$J("[name=confirm]").each(function(q,r){if(!r.checked){showElement(r.id+"Err");g=false}else{hideElement(r.id+"Err");c.push(r.id+"=true")}});if(!g){showElement("mainErr");k=true}else{hideElement("mainErr")}var d=getUrlVars();var m=[];var a=d.cTraderOauthError;var l=d.cTraderOAuthToken;if(d.length>0&&a!=undefined&&l!=undefined){m=["&cTraderOauthError=",a,"&cTraderOAuthToken=",l]}if(!k){var f=["&maxOpenTrades=",$F("maxOpenTrades"),"&maxTradesPerDay=",$F("maxTradesPerDay"),"&maxBalanceRisked=",$F("maxBalanceRisked"),"&systemDescription=",encodeParameter($PT("systemDescription").value)];fxAjax.sendRequest(fxVars.saveAutoTradeQuestionnaire+h+f.join("")+"&"+b.join("&")+"&"+c.join("&")+m.join(""),{contentType:"text/html",loader:true,callback:"saveAutoTradeQuestionnaireResponse"})}}}function saveAutoTradeQuestionnaireResponse(a,b){if(a.content.newProviderRequest){autoTradeAddProviderResponse(a,b)}else{$PT("responseMessage").innerHTML=a.message;showElement("responseMessage")}}function showHideAllTrades(el,trade,cont){var expandAllElement=$J(el);var shown=eval(expandAllElement.attr("isOpen"));var trElements=$J("[master][trade="+trade+"]");var expandElements=$J("[masterExpandButton="+trade+"]");if(!shown){expandAllElement.text("-");expandElements.text("-");trElements.show()}else{expandAllElement.text("+");expandElements.text("+");trElements.hide()}expandElements.attr("isOpen",!shown);expandAllElement.attr("isOpen",!shown);createScroller(cont)}function updateSignalTraderSettings(d,f,k,b,r,g,o,t,c,m,l,s,q,a){initSignalSettings=false;updateDefaultSettings(d,r,g,k,b,o,t,c);if(m){jQuery("#masterSettings"+d).modal("hide");saveSymbolMapping(d)}else{var h=["slaveAccountOid=",f,"&masterAccountOid=",d,"&totalLots=",k,"&totalOpenTrades=",b,"&balanceStop=",r,"&drawdownStop=",g,"&fixedLots=",o,"&weekTimes=",encodeParameter(t),"&ignoreTradeSymbols=",encodeParameter(c),"&mappingSymbols=",encodeParameter(l),"&enableSlTp=",s,"&copyBuyTrades=",q,"&copySellTrades=",a];fxAjax.sendRequest(fxVars.updateSignalTraderSettings,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:h.join(""),method:"post",params:{masterAccountOid:d},loader:false,callback:"updateSignalTraderSettingsResponse"})}}function checkBalanceAndDrawdownBeforeUpdateSignalTraderSettings(u,o,w){var s=$PT("balanceStop"+u);var h="";var l=null;if($PT("autoTradeBalance")!=null){l=parseFloat($PT("autoTradeBalance").getAttribute("value"))}else{if(jQuery("#slaveAccounts")!=null){l=parseFloat(jQuery("#slaveAccounts").find(":selected").attr("balance"))}}var r=jQuery("#copyBuyTrades"+u).is(":checked");var x=jQuery("#copySellTrades"+u).is(":checked");var q=$PT("drawdownStop"+u);var v=getTimeTableDate(u);var k=$PT("totalLots"+u);var t=$PT("totalOpenTrades"+u);var m=$PT("fixedLots"+u);var c=$J("#enableSlTp"+u).is(":checked");var d=[];var f=getIgnoreSymbolsFromTree(u);if((!hasText(k.value)||validate(k.id,VALID_DOUBLE_POSITIVE_WITHOUT_ZERO))&&(!hasText(t.value)||validate(t.id,VALID_INTEGER_POSITIVE_WITHOUT_ZERO))&&(!hasText(s.value)||validate(s.id,VALID_INTEGER_POSITIVE_WITHOUT_ZERO))&&(!hasText(q.value)||validate(q.id,VALID_PERCENT_WITHOUT_ZERO))&&(!hasText(m.value)||validate(m.id,VALID_DOUBLE_POSITIVE_WITHOUT_ZERO))){var b=getMasterSymbolsData(u);if(!isNaN(l)&&(parseFloat(s.value)>(l*0.9))){h+="Balance"}if(parseFloat(q.value)<10){h+=hasText(h)?",Drawdown":"Drawdown"}if(hasText(h)){var a="updateSignalTraderSettings("+u+","+o+',"'+k.value+'","'+t.value+'","'+s.value+'","'+q.value+'","'+m.value+'","'+v+'","'+f+'",'+w+',"'+b.join(PARAM_SPLITTER_SYMBOL)+'",'+c+","+r+","+x+")";var g="The <b>"+h+"</b> level you've set is less than 10% from current value. Are you sure you wish to set it at that level? (Setting the limit too close may result in many missing trades).";showJqueryMessageWithOkAndCancel("autoTradeMsg",g,a,"",400)}else{updateSignalTraderSettings(u,o,k.value,t.value,s.value,q.value,m.value,v,f,w,b.join(PARAM_SPLITTER_SYMBOL),c,r,x)}}}function updateSignalTraderSettingsResponse(a,b){if(!a.error){showJqueryMessage("autoTradeMsg","Settings Updated");saveSymbolMapping(b.masterAccountOid)}else{showJqueryMessage("autoTradeMsg",(hasText(a.message))?a.message:"Cant Update Settings")}jQuery("#masterSettings"+b.masterAccountOid).modal("hide")}function pauseMasterForSlave(element,masterAccountOid,slaveAccountOid){var paused=!eval(element.getAttribute("paused"));var data=["slaveAccountOid=",slaveAccountOid,"&masterAccountOid=",masterAccountOid,"&paused=",paused];fxAjax.sendRequest(fxVars.pauseMasterForSlave+data.join(""),{params:{element:element,paused:paused},loader:false,callback:"pauseMasterForSlaveResponse"})}function pauseMasterForSlaveResponse(a,b){if(!a.error){b.element.setAttribute("paused",b.paused);if(b.paused){b.element.childNodes[0].className="ATButtons play";$J(b.element).parent().parent().find("td")[0].childNodes[1].className="ATplay";showJqueryMessage("autoTradeMsg",$T("tPausingAutotradeSystem",[$J(b.element).parent().parent().find("td")[3].childNodes[1].text]))}else{b.element.childNodes[0].className="ATButtons pause";$J(b.element).parent().parent().find("td")[0].childNodes[1].className="ATpaused"}}else{showJqueryMessage("autoTradeMsg",(hasText(a.message))?a.message:"Failed To Pause System")}}function getTimeTableDate(h){var g="";var b=0;var a=$$PT("#timeTable"+h+" tr[class=day]");for(var f=0;f<a.length;f++){var d=a[f].childNodes;g+=f+"#";for(var c=0;c<d.length;c++){b=d[c].getAttribute("status");if(b==1){g+=c-1+","}}g+="@"}return g}function addOrDeleteSimulator(element,masterOid,simulate,isSlaveSystem){var multiplierElement=$PT("multiplier"+masterOid);var add=(simulate!=null)?simulate:eval(element.getAttribute("simulate"));if(add){element.className="largeOff responseGray radius3 border0 bold";element.value="Simulating";if($PT("timeTable"+masterOid)==null){jQuery("#mainTimeTableDiv"+masterOid).timeTable("")}showElement("row"+masterOid)}else{var masterButton=$PT("masterButton"+masterOid);if(masterButton!=null){masterButton.className="largeOff";masterButton.value="Simulate";hideElement("row"+masterOid)}var timeTable=$PT("timeTable"+masterOid);if(timeTable!=null){timeTable.remove();updateDefaultSettings(masterOid,"","","","","","","")}}multiplierElement.setAttribute("show",add);updateSimulatorMultiplier(masterOid,0,"$",false,true);element.setAttribute("simulate",!add);var subscribedSystems=$$PT("#simulatorSubscribedSystemsTab [show=true]");if(subscribedSystems.length==0){showElement("simulatorSubscribedSystemsEmpty");hideElement("simulatorTotal")}else{hideElement("simulatorSubscribedSystemsEmpty");showElement("simulatorTotal")}if(isSlaveSystem!=undefined&&!isSlaveSystem){selectOrClearIgnoreSymbolsByMasterAccountOid(false,masterOid)}}function updateSimulatorMultiplier(a,h,g,l,f){var m=false;var b=Number($PT("drawdown"+a).getAttribute("drawdown"));var d=$PT("multiplier"+a);var k=d.value;var r=parseFloat((parseFloat(d.value)+h).toFixed(2));if(isNaN(d.value)){m=true}var q=$F("accountDeposit");if(f==undefined){f=false}var c=Number((b*r).toFixed(2));if(c>=100){r=(99.9/b).toFixed(2);c=(b*r).toFixed(2);d.value=r}if(!m&&r>=0&&c>=0&&c<=100){d.style.borderColor="";var o=(/^\d+(\.\d+)*$/).exec(k);updateSimulatorRisk(r,b,a,f);d.value=(o==null&&!l)?k:r;updateMasterData(a,r,g,q,true);updateSlaveRecommendedBalance(q,true);updateTotal(true)}else{if(r>0&&h<=0){updateMasterData(a,r,g,q,true);d.value=r}d.style.borderColor="red"}}function updateSimulatorMultiplierByKeyPress(d,h,g,f,b){var a=0;if(d.keyCode==38){a=0.1}else{if(d.keyCode==40){a=-0.1}}if(b==undefined){b=false}updateSimulatorMultiplier(h,a,g,false,b)}function updateSimulatorData(){var c=$$PT("#simulatorSubscribedSystemsTab [show=true]");if(c.length>0){for(var b=0;b<c.length;b<b++){var a=c[b];a.click()}}}var lastSimulationData=[];function startSimulation(x,h,y,k){var o=[];if(getSimulatorRisk(undefined,undefined,undefined,true)<=100){if(h||lastSimulationData.length>0){var g=y;if(g==null){g=0;if(isShown("balance")){g=1}}var c=$$PT("#simulatorSubscribedSystemsTab [show=true]");if(c.length>0){if(h){if(!isValidDate(userFormatToDefaultFormat($F("startDate"),x))){$PT("startDate").value=$PT("startDate").defaultValue}if(!isValidDate(userFormatToDefaultFormat($F("endDate"),x))){$PT("endDate").value=$PT("endDate").defaultValue}var f=userFormatToDefaultFormat($F("startDate"),x);var d=userFormatToDefaultFormat($F("endDate"),x);var B=["accountLeverage=",$F("accountLeverage"),"&accountDeposit=",$F("accountDeposit"),"&start=",getDbTimeFormat(f),"&end=",getDbTimeFormat(d)];var a="";var C=[];for(var w=0;w<c.length;w++){var b=c[w];var r=b.getAttribute("elementid");var v=$PT("balanceStop"+r).value;var s=$PT("drawdownStop"+r).value;var m=$PT("totalLots"+r).value;var u=$PT("totalOpenTrades"+r).value;var q=$PT("fixedLots"+r).value;var z=getTimeTableDate(r);var l=b.value;var t=jQuery("#copyBuyTrades"+r).is(":checked");var A=jQuery("#copySellTrades"+r).is(":checked");a+=r+"-"+l+"-"+v+"-"+s+"-"+m+"-"+u+"-"+q+"-"+z+"-"+getTradeSymbolsValues(r)+"-"+t+"-"+A+"!";C.push($PT("systemLink"+r).innerHTML)}B.push("&mastersMultiplier=",encodeParameter(a));if(!k){o=[$F("accountLeverage"),"%",$F("accountDeposit"),"%",f,"%",d,"%",a]}lastSimulationData=B.slice()}else{B=lastSimulationData.slice()}B.push("&chartType=",g);fxAjax.sendRequest(fxVars.getSimulatorChart,{params:{chartType:g,providers:c.length,settings:o.join(""),userTimeFormat:x,systemsNames:C,simulation:h,load:k},loader:false,postBody:B.join(""),method:"post",callback:"startSimulationResponse"})}else{showJqueryMessage("simulatorMsg","Please select at least 1 provider.")}}}else{showJqueryMessage("simulatorMsg",$T("tCannotRunSimulatorPleaseAdjuctSetting"))}}function startSimulationResponse(a,F){if(!a.error){var r=growthChartObject;var y="growth";if(F.chartType==1){r=balanceChartObject;y="balance"}var G=jQuery.parseJSON(a.content.chart);var t=a.content.trades;var h=Number(a.content.totalGain);var v=Number(a.content.totalProfit);var m=Number(a.content.totalPips);var b=Number(a.content.floatingPips);var w=Number(a.content.floatingProfit);var B=Number(a.content.openTrades);var g=a.content.drawdown;var k=a.content.marginCall;if(k){showElement("marginCall")}else{hideElement("marginCall")}$PT("totalTrades").innerHTML=t;$PT("totalGain").innerHTML=h+"%";$PT("totalProfit").innerHTML=styleFigure(v,"$","",false,true,2);$PT("totalPips").innerHTML=m;$PT("drawdown").innerHTML=g+"%";$J("#floatingPips").html(styleFigure(b,"","",false,true,2));$J("#openTrades").html(B);$J("#floatingProfit").html(styleFigure(w,"$","",false,true,2));r.setDataJson(G);if(F.simulation&&!F.load){Effect.ScrollTo("wrapper")}var C=F.settings;if(hasText(C)){var x=$PT("simulatorHistoryTable");var o=x.insertRow(x.rows.length);o.onmouseover=function(){this.className="normalActive"};o.onmouseout=function(){this.className=""};var f=o.insertCell(o.cells.length);var E=new Element("span",{className:"dotted"});E.innerHTML=F.providers;f.appendChild(E);var c=o.insertCell(o.cells.length);c.innerHTML=t;var s=o.insertCell(o.cells.length);s.innerHTML=styleFigure(h,"","%",true,false,2);s.className="bold";var d=o.insertCell(o.cells.length);d.innerHTML=styleFigure(v,"$","",true,true,2);d.className="bold";var u=o.insertCell(o.cells.length);u.innerHTML=styleFigure(m,"","",true,false,1);u.className="bold";var l=o.insertCell(o.cells.length);l.innerHTML=g+"%";var q=o.insertCell(o.cells.length);var z=new Element("a");z.onclick=function(){loadSimulatorUserSettings(C,F.userTimeFormat,false)};z.innerHTML="Load";z.className="underline pointer";q.appendChild(z);var D=o.insertCell(o.cells.length);var A=new Element("a",{className:"closer pointer"});A.onclick=function(){if(simulatorHistoryTable!=null){var I=simulatorHistoryTable.rows;var H=I.indexOf(o);I.splice(H,1)}o.remove();if(x.rows.length==1){showElement("simulatorHistoryEmpty")}};D.appendChild(A);hideElement("simulatorHistoryEmpty");new Tip(f,F.systemsNames.join("<br>"),{title:"Providers",hook:{target:"rightmiddle",tooltip:"leftmiddle"}});initSimulatorHistoryTable()}}}function saveSimulatorUserSettingsWindow(a){if($$PT("#simulatorSubscribedSystemsTab [show=true]").length>0){$("#saveSimulation").modal("show")}else{showJqueryMessage("simulatorMsg","Please select at least 1 provider.")}}function saveSimulatorUserSettings(c){var h=userFormatToDefaultFormat($F("startDate"),c);var b=userFormatToDefaultFormat($F("endDate"),c);var f=[$F("accountLeverage"),"%",$F("accountDeposit"),"%",h,"%",b,"%"];var a="";$$PT("#simulatorSubscribedSystemsTab [show=true]").each(function(q){var k=q.getAttribute("elementid");var s=$PT("balanceStop"+k).value;var m=$PT("drawdownStop"+k).value;var o=$PT("totalLots"+k).value;var l=$PT("totalOpenTrades"+k).value;var r=$PT("fixedLots"+k).value;var u=getTimeTableDate(k);var t=q.value;a+=k+"-"+t+"-"+s+"-"+m+"-"+o+"-"+l+"-"+r+"-"+u+"-"+getTradeSymbolsValues(k)+"!"});f.push(a);var d=f.join("");var g=escapeHtml($F("simulationTitle"));fxAjax.sendRequest(fxVars.saveSimulatorUserSettings,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:"title="+encodeParameter(g)+"&settings="+encodeParameter(d),method:"post",params:{settings:d,title:g,userTimeFormat:c},loader:false,callback:"saveSimulatorUserSettingsResponse"})}function saveSimulatorUserSettingsResponse(g,f){var c=g.content.oid;if(!g.error&&c!=null){var d=f.settings;var m=$PT("simulatorUserSettingsTable");var k=m.insertRow(m.rows.length);var a=new Element("a");var l=new Element("a");k.id="deleteSimulatorSettings"+c;a.innerHTML=f.title;a.onclick=function(){loadSimulatorUserSettings(d,f.userTimeFormat,true)};a.className="underline pointer";var b=k.insertCell(k.cells.length);b.appendChild(a);var h=k.insertCell(k.cells.length);h.align="right";l.className="closer pointer";l.onclick=function(){deleteSimulatorUserSettingsConfirmation(c)};h.appendChild(l);$PT("simulationTitle").value="";showElement("simulatorUserSettingsTable")}else{showJqueryMessage("simulatorMsg","General error.")}}function loadSimulatorUserSettings(x,w,y){$$PT("#mastersTable input[type=button]").each(function(C){C.value="Simulate";C.className="largeOff"});$$PT("#simulatorSubscribedSystemsTab [show=true]").each(function(C){C.setAttribute("firstmultiplier",0.5);C.value=0.5;C.setAttribute("show",false);var D=C.getAttribute("elementid");hideElement("row"+D)});var A=x.split("%");var k=A[0];var r=A[1];var d=A[2];var v=A[3];var b=A[4];var B=b.split("!");$PT("accountLeverage").value=k;$PT("accountDeposit").value=r;if(hasText(d)){$PT("startDate").value=defaultFormatTouserFormat(d,w)}if(hasText(v)){$PT("endDate").value=defaultFormatTouserFormat(v,w)}for(var u=0;u<B.length;u++){var a=B[u].split("-");if(a.length==9){var h=a[0];var g=a[1];var s=a[2];var o=a[3];var l=a[4];var q=a[5];var m=a[6];var z=a[7];var f=a[8];var c=$PT("masterButton"+h);var t=$PT("multiplier"+h);t.setAttribute("firstmultiplier",g);t.value=g;t.click();addOrDeleteSimulator(c,h,true,true);updateDefaultSettings(h,s,o,l,q,m,z,f);updateTimeTableData(h,z);updateTradeSymbols(h,f)}}if(y){hideElement("simulatorUserSettingsDiv")}}function deleteSimulatorUserSettingsConfirmation(b){var a="deleteSimulatorUserSettings("+b+")";showJqueryMessageWithOkAndCancel("simulatorMsg","Are you sure you wish to delete it?",a,null,300)}function deleteSimulatorUserSettings(a){fxAjax.sendRequest(fxVars.deleteSimulatorUserSettings+"oid="+a,{params:{oid:a},loader:false,callback:"deleteSimulatorUserSettingsResponse"})}function deleteSimulatorUserSettingsResponse(b,d){var a=b.content.deleted;if(!b.error&&a){var c=$PT("deleteSimulatorSettings"+d.oid);if(c!=null){c.remove()}}else{showJqueryMessage("simulatorMsg","General error.")}}var initSimulatorSettings=true;function showSimulatorSignalTraderSettingsWindow(b){initSimulatorSettings=true;var a=$("#masterSettings"+b);a.off("hidden.bs.modal").on("hidden.bs.modal",function(){if(initSimulatorSettings){initSimulatorSignalTraderSettings(b)}});a.modal("show")}function updateSimulatorSignalTraderSettings(c){var k=$PT("balanceStop"+c);var d=$PT("drawdownStop"+c);var f=$PT("totalLots"+c);var a=$PT("totalOpenTrades"+c);var h=$PT("fixedLots"+c);var l=getTimeTableDate(c);var b=getIgnoreSymbolsFromTree(c);if((!hasText(f.value)||validate(f.id,VALID_DOUBLE_POSITIVE_WITHOUT_ZERO))&&(!hasText(a.value)||validate(a.id,VALID_INTEGER_POSITIVE_WITHOUT_ZERO))&&(!hasText(k.value)||validate(k.id,VALID_INTEGER_POSITIVE_WITHOUT_ZERO))&&(!hasText(d.value)||validate(d.id,VALID_PERCENT_WITHOUT_ZERO))&&(!hasText(h.value)||validate(h.id,VALID_DOUBLE_POSITIVE_WITHOUT_ZERO))){initSimulatorSettings=false;var g=jQuery("#masterSettings"+c);g.modal("hide");updateDefaultSettings(c,k.value,d.value,f.value,a.value,h.value,l,b)}}function initSimulatorSignalTraderSettings(c){var q=$PT("masterSettings"+c);var r=q.getAttribute("balanceStop");var h=q.getAttribute("drawdownStop");var f=q.getAttribute("totalLots");var b=q.getAttribute("totalOpenTrades");var d=q.getAttribute("fixedLots");var m=q.getAttribute("weekTimes");var l=q.getAttribute("tradeSymbols");var s=$PT("balanceStop"+c);var g=$PT("drawdownStop"+c);var k=$PT("totalLots"+c);var a=$PT("totalOpenTrades"+c);var o=$PT("fixedLots"+c);s.value=r;g.value=h;k.value=f;a.value=b;o.value=d;updateTimeTableData(c,m);updateTradeSymbols(c,l);restoreSymbolMapping(c);initSimulatorSettings=true;initSignalSettings=true}function updateDefaultSettings(d,k,b,c,a,h,l,f){var g=jQuery("#masterSettings"+d);if(g!=null){g.attr("balanceStop",k);g.attr("drawdownStop",b);g.attr("totalLots",c);g.attr("totalOpenTrades",a);g.attr("fixedLots",h);g.attr("weekTimes",l);g.attr("tradeSymbols",f);$PT("balanceStop"+d).value=k;$PT("drawdownStop"+d).value=b;$PT("totalLots"+d).value=c;$PT("totalOpenTrades"+d).value=a;$PT("fixedLots"+d).value=h}}function updateSimulatorRisk(h,a,g,b){try{var f=$PT("mainRisk");var c=getSimulatorRisk(h,a,g,b);if(c<=100){f.setAttribute("risk",c);getMarginOrRiskColor(f,c);return true}}catch(d){}return false}function showSetSimulationAsAutoTradePortfolioWindow(){var a=$$PT("#simulatorSubscribedSystemsTab [show=true]");if(a.length>0){if(getSimulatorRisk(null,null,null,true)<=100){$("#showSetSimulationAsAutoTradePortfolioWindowOkButton").off("click").click(function(){setSimulationAsAutoTradePortfolio()});$("#showSetSimulationAsAutoTradePortfolioWindow").modal("show")}else{showJqueryMessage("simulatorMsg","Please reduce the risk to less than 100%.")}}else{showJqueryMessage("simulatorMsg","Please select at least 1 provider.")}}function setSimulationAsAutoTradePortfolio(){var a="";$$PT("#simulatorSubscribedSystemsTab [show=true]").each(function(g){var b=g.getAttribute("elementid");var k=$PT("balanceStop"+b).value;var d=$PT("drawdownStop"+b).value;var f=$PT("totalLots"+b).value;var c=$PT("totalOpenTrades"+b).value;var h=$PT("fixedLots"+b).value;var m=getTimeTableDate(b);var l=g.value;a+=b+"-"+l+"-"+k+"-"+d+"-"+f+"-"+c+"-"+h+"-"+m+"-"+getTradeSymbolsValues(b)+"!"});fxAjax.sendRequest(fxVars.setSimulationAsAutoTradePortfolio,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:"settings="+encodeParameter(a)+"&slaveAccountOid="+$F("userAutoTradeAccounts"),method:"post",params:{},loader:false,callback:"setSimulationAsAutoTradePortfolioResponse"})}function setSimulationAsAutoTradePortfolioResponse(a,c){if(!a.error){showJqueryMessage("simulatorMsg","Simulation Added to AutoTrade Portfolio")}else{var b=a.message;if(b!=null){showJqueryMessage("simulatorMsg",b)}}}function getSimulatorRisk(g,a,f,c){if(c){return getSimulatorMaxRisk(g,a,f)}var b=$J("#multiplier"+f);var d=Number(Number(parseFloat(b.val())).toFixed(2));return d*Number($J("#drawdown"+f).attr("drawdown"))}function getSimulatorMaxRisk(f,a,d){var c=0;var b;$$PT("#simulatorSubscribedSystemsTab [show=true]").each(function(l){var h=Number(l.getAttribute("elementId"));var g=Number($PT("drawdown"+h).getAttribute("drawdown"));var k=$PT("multiplier"+h);var m=Number(Number(parseFloat(k.value)).toFixed(2));if(h!=d){b=m*g}else{b=f*g}if(b>c){c=b}});return c}function initSimulatorHistoryTable(){if(simulatorHistorySortable){var a=$J("#simulatorHistoryTable tr").not(".skipSort");simulatorHistoryTable.rows=$A(a).map(function(b){return $PT(b)});simulatorHistoryTable.headerRow=simulatorHistoryTable.rows.shift();simulatorHistoryTable.headers=$J(simulatorHistoryTable.headerRow).find("th").toArray();simulatorHistoryTable.sortOnColumn(simulatorHistoryTh,simulatorHistorySpan,simulatorHistorySpan.order)}}function startSimulationFromAutoTrade(){var c=[50,"%",10000,"%","","%","","%"];var a="";try{$$PT("#subscribedSystems [firstmultiplier ]").each(function(h){var k=h.getAttribute("masterOid");var g=getIgnoreSymbolsFromTree(k);a+=h.getAttribute("masterOid")+"-"+h.value+"-"+$PT("balanceStop"+k).value+"-"+$PT("drawdownStop"+k).value+"-"+$PT("totalLots"+k).value+"-"+$PT("totalOpenTrades"+k).value+"-"+$PT("fixedLots"+k).value+"-"+getTimeTableDate(k)+"-"+g+"!"});c.push(a)}catch(d){}var b=httpServerPath;if(hasText(a)){var f=$J("#myAccount").attr("accountOid");b+="/simulator.html?settings="+encodeParameter(c.join(""))+"&slaveOid="+f}else{b+="/autotrade/simulator"}window.open(b,"_self")}function updateTradeSymbols(d,c){var a=null;if(c!=null){a=c.split(",")}else{a=[]}$J("#masterSettings"+d+" .tree").each(function(){var f=$J(this).jstree("get_selected",true);for(var h=0;h<f.length;h++){var g=f[h];if(g.children.length==0){$J(this).jstree("deselect_node",d+g.text)}}});for(var b=0;b<a.length;b++){$J("#masterSettings"+d+" .tree").each(function(){$J(this).jstree("select_node",d+a[b])})}}var initSignalSettings=true;function showMasterSettingsSubmitDialog(id,func,close,width,buttonText){initSignalSettings=true;if(func!=null){var okButton=$("#masterSettings"+id+"OkButton");okButton.html((buttonText!=null)?buttonText:"Submit");okButton.off("click").click(function(){eval(func);if(close){$("#masterSettings"+id).modal("hide")}})}var masterSettingsModal=jQuery("#masterSettings"+id);masterSettingsModal.off("hidden.bs.modal").on("hidden.bs.modal",function(){if(initSignalSettings){initSimulatorSignalTraderSettings(id)}});masterSettingsModal.modal("show")}function getTradeSymbolsValues(b){var a=getIgnoreSymbolsFromTree(b);return hasText(a)?a:" "}function initMasterSettings(a){updateDefaultSettings(a,"","","","","","","");updateTimeTableData(a,"");selectOrClearIgnoreSymbolsByMasterAccountOid(false,a);clearSymbolMapping(a)}function updateSlaveRecommendedBalance(c,a){try{var b=0;var g;if(a){g=jQuery("[firstmultiplier][show=true]")}else{g=jQuery("[firstmultiplier]")}g.each(function(k){var h=this.getAttribute("elementid");var l=$PT("minBalance"+h);b+=calculateMinBalance(l,this.value,a)});var f=parseInt((c/b)*100);slaveRecommendedBalance.refresh((f<=100)?f:100)}catch(d){}}function updateTotal(o){try{var f=0;var g=0;var m=0;var b=0;var h=0;var d=0;var q=0;var l;if(o){l=jQuery("#subscribedSystemsTable [elementid][show=true]")}else{l=jQuery("#subscribedSystemsTable [elid]")}l.each(function(){var y=o?this.getAttribute("elementid"):this.getAttribute("elid");var x=$PT("multiplier"+y).value;var u=$PT("monthly"+y).getAttribute("balance");var v=$PT("minBalance"+y);var r=$PT("drawdown"+y).getAttribute("drawdown")*x;var t=$PT("daily"+y).getAttribute("daily")*x;var s=$PT("monthly"+y).getAttribute("monthly")*x;var w=$PT("mouse"+y).getAttribute("elc");f+=roundNumUp((t*u/100),2);g+=roundNumUp((s*u/100),2);m+=roundNumUp((r*u/100),2);b+=roundNumUp(t,2);h+=roundNumUp(s,2);d+=roundNumUp(r,2);q+=calculateMinBalance(v,x,o)});var a=$PT("totalMinBalance");var c=a.getAttribute("elc");$PT("hypotheticalTotalDaily").innerHTML=roundNumUp(b,2)+"%<br/>"+c+roundNumUp(f,2);$PT("hypotheticalTotalMonthly").innerHTML=roundNumUp(h,2)+"%<br/>"+c+roundNumUp(g,2);a.innerHTML=c+roundNumUp(q,2)}catch(k){}}function simulationGetDaysBetweenFirstStartDates(){var a=0;try{jQuery("#subscribedSystemsTable tr[style=''][date]").each(function(){var c=Number(this.getAttribute("date"));if(c!=null){var d=Math.floor((new Date().getTime()-c)/day)+1;if(d>a){a=d}}})}catch(b){}return a}function getLots(b){var a;if(b>=100000000){a=(b/100000000)+"m"}else{if(b>=100000){a=(b/100000)+"k"}else{if(b>=1000){a=(b/100)}else{a=b.toFixed(2)}}}return a}function selectOrClearIgnoreSymbolsByMasterAccountOid(a,b){$J("#masterSettings"+b+" .tree").each(function(){if(a){$J(this).jstree(true).select_all()}else{$J(this).jstree(true).deselect_all();$J(this).jstree("close_all")}})}function getIgnoreSymbolsFromTree(b){var a=[];$J("#masterSettings"+b+" .tree").each(function(){var c=$J(this).jstree("get_selected",true);for(var f=0;f<c.length;f++){var d=c[f];if(d.children.length==0){a.push(htmlDecode(d.text))}}});return a.join(",")}function restoreSymbolMapping(b){var a="slippage"+b;$("[id^="+a+"]").each(function(){$(this).val($(this).attr("savedSlippage"))})}function saveSymbolMapping(b){var a="slippage"+b;$("[id^="+a+"]").each(function(){$(this).attr("savedSlippage",$(this).val())})}function clearSymbolMapping(b){var a="slippage"+b;$("[id^="+a+"]").each(function(){$(this).val("");$(this).attr("savedSlippage","")})}function getMasterSymbolsData(d){var c=$("#mappingSettings"+d);var b=c.find("input[name='slave_symbols']");var a=[];b.each(function(){var h=$(this);var l=h.val().trim();var m=h.attr("masterSymbol");var f=document.getElementById("slippage"+d+m).value;if(hasText(l)||hasText(f)){a.push(m+PARAM_SPLITTER_SYMBOL_FROM_TO+l+PARAM_SPLITTER_SYMBOL_FROM_TO+f);var k=h.attr("tradeSymbol");var g=c.find("input[name='slave_symbols_hidden'][tradeSymbol='"+k+"']");g.each(function(){var q=$(this);var o=q.val().trim();var r=q.attr("masterSymbol");a.push(r+PARAM_SPLITTER_SYMBOL_FROM_TO+o+PARAM_SPLITTER_SYMBOL_FROM_TO+f)})}});return a}function showWhiteLabelConfirmationModal(d){if($(".whitelabelArea").length>0){$(".whitelabelArea").remove()}var b=hasText(d.attr("slaveBrokerName"))?d.attr("slaveBrokerName"):"Broker";var f=$T("tToSubscribeToTheSystemClickContinueToGoToBrokerAutotrade",[b]);var c=$J('<div id="autoTradeConfirmBodyPartThree" class="whitelabelArea" ></div>');var g=$J('<br/><br/><br/><div id="autoTradeConfirmGoToBroker" style="font-size:15px; text-align: center;"></div><br/><br/><br/>');g.html(f);c.append(g);$J("#autoTradeConfirm .modal-body").append(c);$J(".autotradeArea").hide();$J(".whitelabelArea").show();$J("#agreeAutoTradeTerms").html($T("tContinue"));$J("#agreeAutoTradeTerms").prop("disabled",false);var a=d.attr("loginredirect");$J("#agreeAutoTradeTerms").prop("onclick",null).off("click").on("click",{redirect:a},function(h){navigateTo(h.data.redirect)})}function clearAutoTradeConfirmModalBody(){if($(".whitelabelArea").length>0){$(".whitelabelArea").remove()}$J("#agreeAutoTradeTerms").html($T("tOk"));if($J("#agreeAutoTradeTerms").prop("disabled")==$J("#AutoTradeConfermTermsCheckbox").prop("checked")){$J("#agreeAutoTradeTerms").prop("disabled",true);$J("#AutoTradeConfermTermsCheckbox").prop("checked",false)}}function startAutoTrade(){var a=$("#autoTradeConfirm");a.data("okButton",true);a.modal("hide");var c=$F("slaveAccounts");var b="addOrDeleteMasterToSlave("+c+","+a.data("masterAccountOid")+","+a.data("add")+","+a.data("elementId")+","+a.data("system")+")";getAccountRisk(c,"confirmRisk",b)}(function(){var a=[].indexOf||function(f){for(var d=0,c=this.length;d<c;d++){if(d in this&&this[d]===f){return d}}return -1},b=[].slice;(function(c,d){if(typeof define==="function"&&define.amd){return define("waypoints",["jquery"],function(f){return d(f,c)})}else{return d(c.jQuery,c)}})(this,function(d,h){var u,s,v,x,m,f,g,o,l,y,k,r,w,t,c,q;u=d(h);o=a.call(h,"ontouchstart")>=0;x={horizontal:{},vertical:{}};m=1;g={};f="waypoints-context-id";k="resize.waypoints";r="scroll.waypoints";w=1;t="waypoints-waypoint-ids";c="waypoint";q="waypoints";s=(function(){function z(A){var B=this;this.$element=A;this.element=A[0];this.didResize=false;this.didScroll=false;this.id="context"+m++;this.oldScroll={x:A.scrollLeft(),y:A.scrollTop()};this.waypoints={horizontal:{},vertical:{}};A.data(f,this.id);g[this.id]=this;A.bind(r,function(){var C;if(!(B.didScroll||o)){B.didScroll=true;C=function(){B.doScroll();return B.didScroll=false};return h.setTimeout(C,d[q].settings.scrollThrottle)}});A.bind(k,function(){var C;if(!B.didResize){B.didResize=true;C=function(){d[q]("refresh");return B.didResize=false};return h.setTimeout(C,d[q].settings.resizeThrottle)}})}z.prototype.doScroll=function(){var A,B=this;A={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};if(o&&(!A.vertical.oldScroll||!A.vertical.newScroll)){d[q]("refresh")}d.each(A,function(E,D){var G,F,C;C=[];F=D.newScroll>D.oldScroll;G=F?D.forward:D.backward;d.each(B.waypoints[E],function(J,I){var K,H;if((D.oldScroll<(K=I.offset)&&K<=D.newScroll)){return C.push(I)}else{if((D.newScroll<(H=I.offset)&&H<=D.oldScroll)){return C.push(I)}}});C.sort(function(I,H){return I.offset-H.offset});if(!F){C.reverse()}return d.each(C,function(I,H){if(H.options.continuous||I===C.length-1){return H.trigger([G])}})});return this.oldScroll={x:A.horizontal.newScroll,y:A.vertical.newScroll}};z.prototype.refresh=function(){var C,A,B,D=this;B=d.isWindow(this.element);A=this.$element.offset();this.doScroll();C={horizontal:{contextOffset:B?0:A.left,contextScroll:B?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:B?0:A.top,contextScroll:B?0:this.oldScroll.y,contextDimension:B?d[q]("viewportHeight"):this.$element.height(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};return d.each(C,function(F,E){return d.each(D.waypoints[F],function(K,H){var J,I,M,L,G;J=H.options.offset;M=H.offset;I=d.isWindow(H.element)?0:H.$element.offset()[E.offsetProp];if(d.isFunction(J)){J=J.apply(H.element)}else{if(typeof J==="string"){J=parseFloat(J);if(H.options.offset.indexOf("%")>-1){J=Math.ceil(E.contextDimension*J/100)}}}H.offset=I-E.contextOffset+E.contextScroll-J;if((H.options.onlyOnScroll&&(M!=null))||!H.enabled){return}if(M!==null&&(M<(L=E.oldScroll)&&L<=H.offset)){return H.trigger([E.backward])}else{if(M!==null&&(M>(G=E.oldScroll)&&G>=H.offset)){return H.trigger([E.forward])}else{if(M===null&&E.oldScroll>=H.offset){return H.trigger([E.forward])}}}})})};z.prototype.checkEmpty=function(){if(d.isEmptyObject(this.waypoints.horizontal)&&d.isEmptyObject(this.waypoints.vertical)){this.$element.unbind([k,r].join(" "));return delete g[this.id]}};return z})();v=(function(){function z(A,C,B){var D,E;B=d.extend({},d.fn[c].defaults,B);if(B.offset==="bottom-in-view"){B.offset=function(){var F;F=d[q]("viewportHeight");if(!d.isWindow(C.element)){F=C.$element.height()}return F-d(this).outerHeight()}}this.$element=A;this.element=A[0];this.axis=B.horizontal?"horizontal":"vertical";this.callback=B.handler;this.context=C;this.enabled=B.enabled;this.id="waypoints"+w++;this.offset=null;this.options=B;C.waypoints[this.axis][this.id]=this;x[this.axis][this.id]=this;D=(E=A.data(t))!=null?E:[];D.push(this.id);A.data(t,D)}z.prototype.trigger=function(A){if(!this.enabled){return}if(this.callback!=null){this.callback.apply(this.element,A)}if(this.options.triggerOnce){return this.destroy()}};z.prototype.disable=function(){return this.enabled=false};z.prototype.enable=function(){this.context.refresh();return this.enabled=true};z.prototype.destroy=function(){delete x[this.axis][this.id];delete this.context.waypoints[this.axis][this.id];return this.context.checkEmpty()};z.getWaypointsByElement=function(A){var C,B;B=d(A).data(t);if(!B){return[]}C=d.extend({},x.horizontal,x.vertical);return d.map(B,function(D){return C[D]})};return z})();y={init:function(B,z){var A;if(z==null){z={}}if((A=z.handler)==null){z.handler=B}this.each(function(){var F,E,D,C;F=d(this);D=(C=z.context)!=null?C:d.fn[c].defaults.context;if(!d.isWindow(D)){D=F.closest(D)}D=d(D);E=g[D.data(f)];if(!E){E=new s(D)}return new v(F,E,z)});d[q]("refresh");return this},disable:function(){return y._invoke(this,"disable")},enable:function(){return y._invoke(this,"enable")},destroy:function(){return y._invoke(this,"destroy")},prev:function(A,z){return y._traverse.call(this,A,z,function(B,C,D){if(C>0){return B.push(D[C-1])}})},next:function(A,z){return y._traverse.call(this,A,z,function(B,C,D){if(C<D.length-1){return B.push(D[C+1])}})},_traverse:function(C,A,B){var z,D;if(C==null){C="vertical"}if(A==null){A=h}D=l.aggregate(A);z=[];this.each(function(){var E;E=d.inArray(this,D[C]);return B(z,E,D[C])});return this.pushStack(z)},_invoke:function(z,A){z.each(function(){var B;B=v.getWaypointsByElement(this);return d.each(B,function(D,C){C[A]();return true})});return this}};d.fn[c]=function(){var z,A;A=arguments[0],z=2<=arguments.length?b.call(arguments,1):[];if(y[A]){return y[A].apply(this,z)}else{if(d.isFunction(A)){return y.init.apply(this,arguments)}else{if(d.isPlainObject(A)){return y.init.apply(this,[null,A])}else{if(!A){return d.error("jQuery Waypoints needs a callback function or handler option.")}else{return d.error("The "+A+" method does not exist in jQuery Waypoints.")}}}}};d.fn[c].defaults={context:h,continuous:true,enabled:true,horizontal:false,offset:0,triggerOnce:false};l={refresh:function(){return d.each(g,function(A,z){return z.refresh()})},viewportHeight:function(){var z;return(z=h.innerHeight)!=null?z:u.height()},aggregate:function(C){var A,B,z;A=x;if(C){A=(z=g[d(C).data(f)])!=null?z.waypoints:void 0}if(!A){return[]}B={horizontal:[],vertical:[]};d.each(B,function(E,D){d.each(A[E],function(G,F){return D.push(F)});D.sort(function(G,F){return G.offset-F.offset});B[E]=d.map(D,function(F){return F.element});return B[E]=d.unique(B[E])});return B},above:function(z){if(z==null){z=h}return l._filter(z,"vertical",function(B,A){return A.offset<=B.oldScroll.y})},below:function(z){if(z==null){z=h}return l._filter(z,"vertical",function(B,A){return A.offset>B.oldScroll.y})},left:function(z){if(z==null){z=h}return l._filter(z,"horizontal",function(B,A){return A.offset<=B.oldScroll.x})},right:function(z){if(z==null){z=h}return l._filter(z,"horizontal",function(B,A){return A.offset>B.oldScroll.x})},enable:function(){return l._invoke("enable")},disable:function(){return l._invoke("disable")},destroy:function(){return l._invoke("destroy")},extendFn:function(z,A){return y[z]=A},_invoke:function(A){var z;z=d.extend({},x.vertical,x.horizontal);return d.each(z,function(C,B){B[A]();return true})},_filter:function(z,B,D){var A,C;A=g[d(z).data(f)];if(!A){return[]}C=[];d.each(A.waypoints[B],function(F,E){if(D(A,E)){return C.push(E)}});C.sort(function(F,E){return F.offset-E.offset});return d.map(C,function(E){return E.element})}};d[q]=function(){var z,A;A=arguments[0],z=2<=arguments.length?b.call(arguments,1):[];if(l[A]){return l[A].apply(null,z)}else{return l.aggregate.call(null,A)}};d[q].settings={resizeThrottle:100,scrollThrottle:30};return u.load(function(){return d[q]("refresh")})})}).call(this);(function(){(function(a,b){if(typeof define==="function"&&define.amd){return define(["jquery","waypoints"],b)}else{return b(a.jQuery)}})(this,function(b){var c,a;c={wrapper:'<div class="sticky-wrapper" />',stuckClass:"stuck"};a=function(f,d){f.wrap(d.wrapper);f.each(function(){var g;g=b(this);g.parent().height(g.outerHeight());return true});return f.parent()};return b.waypoints("extendFn","sticky",function(g){var f,d;g=b.extend({},b.fn.waypoint.defaults,c,g);f=a(this,g);d=g.handler;g.handler=function(l){var h,k;h=b(this).children(":first");k=l==="down"||l==="right";h.toggleClass(g.stuckClass,k);if(d!=null){return d.call(this,l)}};f.waypoint(g);return this})})}).call(this);var notificationDialogIsOpen=false;function getAccountNotification(c,a){if(notificationDialogIsOpen){$JD.close("#accountNotification");getAccountNotification(c,a)}else{if(hasText(a)&&hasText(c)){var b=["accountOid=",a,"&typeAccount=",c];fxAjax.sendRequest(fxVars.getAccountNotification+b.join(""),{loader:false,callback:"getAccountNotificationResponse"})}}}function getAccountNotificationResponse(a){if(!a.error){$PT("editNotification").innerHTML=a.content.edit;$PT("addNotification").innerHTML=a.content.data;var b={};b.width=600;b.height=300;b.top=535;b.resizable=false;b.close=function(c,d){clearAccountNotificationWindow();notificationDialogIsOpen=false;$JD.destroy("#accountNotification")};$JD.create("#accountNotification",b);notificationDialogIsOpen=true;showDisabledNotificationTip()}}function clearAccountNotificationWindow(){hideElement("accountNotification");hideElement("addNotification");showElement("addNewNotificationAccount")}function addAccountNotification(accountOid,typeAccount,oid){if(validate("notificationAddTargetInput",VALID_ABSOLUTE_NUMBER)){var target=$F("notificationAddTargetInput");var selectFieldType=$PT("notificationAddTypeSelect");var selectType=parseInt(selectFieldType.value);var isPercent=eval($AT(selectFieldType.options[selectFieldType.selectedIndex],"isPercent"));var onlyPositive=eval($AT(selectFieldType.options[selectFieldType.selectedIndex],"onlyPositive"));if(isPercent&&!onlyPositive&&(target<-100||target>100)){inlineMsg("notificationAddTargetInput","<strong>"+$T("tError")+"</strong><br />"+$T("tPleaseEnterNumberBetween",[-100,100]),3)}else{if(isPercent&&onlyPositive&&(target<0||target>100)){inlineMsg("notificationAddTargetInput","<strong>"+$T("tError")+"</strong><br />"+$T("tPleaseEnterNumberBetween",[0,100]),3)}else{if(!isPercent&&onlyPositive&&target<0){inlineMsg("notificationAddTargetInput","<strong>"+$T("tError")+"</strong><br />"+$T("tYouMustEnterValidPositiveNumber"),3)}else{showElement("addNewNotificationAccount");var relation=$F("notificationAddRelationSelect");var relationTime="";if(selectType==25){relationTime=$F("notificationAddRelationTimeSelect")}var data=["accountOid=",accountOid,"&typeAccount=",typeAccount,"&type=",selectType,"&relation=",relation,"&target=",target,"&relationTime=",relationTime];fxAjax.sendRequest(fxVars.addAccountNotification+data.join(""),{params:{oid:oid,typeAccount:typeAccount},loader:false,callback:"addAccountNotificationResponse"})}}}}}function addAccountNotificationResponse(a,b){if(!a.error){$PT("editNotification").innerHTML=a.content.edit;$PT("addNotification").innerHTML=a.content.data;hideElement("addNotification");$("#accountNotification").show();showElement("addAccountNotification");onOffAccountNotify(b.typeAccount,b.oid,"notifyOn")}else{inlineMsg("notificationAddTargetInput",a.message,3)}}function editRemoveAccountNotification(notificationOid,edit,accountOid,typeAccount){var data;var error=false;if(edit){if(validate("notificationEditTargetInput"+notificationOid,VALID_ABSOLUTE_NUMBER)){var selectFieldType=$PT("notificationEditTypeSelect"+notificationOid);var selectType=parseInt(selectFieldType.value);var isPercent=eval($AT(selectFieldType.options[selectFieldType.selectedIndex],"isPercent"));var onlyPositive=eval($AT(selectFieldType.options[selectFieldType.selectedIndex],"onlyPositive"));var selectRelationSelectType=$PT("notificationEditRelationSelect"+notificationOid);var relation=eval($AT(selectRelationSelectType.options[selectRelationSelectType.selectedIndex],"value"));var target=$F("notificationEditTargetInput"+notificationOid);if(isPercent&&!onlyPositive&&(target<-100||target>100)){inlineMsg("notificationEditTargetInput"+notificationOid,"<strong>"+$T("tError")+"</strong><br />"+$T("tPleaseEnterNumberBetween",[-100,100]),3);error=true}else{if(isPercent&&onlyPositive&&(target<0||target>100)){inlineMsg("notificationEditTargetInput"+notificationOid,"<strong>"+$T("tError")+"</strong><br />"+$T("tPleaseEnterNumberBetween",[0,100]),3);error=true}else{if(!isPercent&&onlyPositive&&target<0){inlineMsg("notificationEditTargetInput"+notificationOid,"<strong>"+$T("tError")+"</strong><br />"+$T("tYouMustEnterValidPositiveNumber"),3);error=true}}}var relationTime="";if(selectType==25){relationTime=$F("notificationEditRelationTimeSelect"+notificationOid)}data=["notificationOid=",notificationOid,"&edit=","true","&relation=",relation,"&target=",target,"&relationTime=",relationTime]}else{error=true}}else{data=["notificationOid=",notificationOid,"&edit=","false"];var notificationsCount=parseInt($F("notificationsCount"));$PT("notificationsCount").value=notificationsCount-1}if(!error){fxAjax.sendRequest(fxVars.editRemoveAccountNotification+data.join(""),{loader:false,params:{accountOid:accountOid,typeAccount:typeAccount,notificationOid:notificationOid,edit:edit},callback:"editRemoveAccountNotificationResponse"})}}function editRemoveAccountNotificationResponse(a,b){if(!a.error){if(!b.edit){removeElement("notificationEditRow"+b.notificationOid);var c=parseInt($F("notificationsCount"));if(c!=0){onOffAccountNotify(b.typeAccount,b.accountOid,"notifyOn")}else{onOffAccountNotify(b.typeAccount,b.accountOid,"notifyOff")}}hideElement("notificationSave"+b.notificationOid);hideElement("notificationCancel"+b.notificationOid)}else{inlineMsg("notificationEditRow"+b.notificationOid,a.message,3)}}function cancelAccountNotification(a){if(!hasText(a)){hideElement("addNotification");showElement("addNewNotificationAccount");$PT("notificationAddRelationSelect").selectedIndex=0;$PT("notificationAddTypeSelect").selectedIndex=0;$PT("notificationAddRelationTimeSelect").selectedIndex=0;$PT("notificationAddTargetInput").value=""}else{hideElement("notificationSave"+a);hideElement("notificationCancel"+a);$PT("notificationEditRelationSelect"+a).selectedIndex=$F("originalRelationOption"+a);$PT("notificationEditRelationTimeSelect"+a).selectedIndex=$F("originalRelationTimeOption"+a);$PT("notificationEditTargetInput"+a).value=$F("originalNotificationValue"+a)}}function onOffAccountNotify(a,b,c){$PT(((a==0)?"myAccount":"watched")+b).className=c}var drawDownType="4";var tradesType="13";var lotsType="21";var avgTradeLengthType="25";function showRelevantOption(d,f){var a=$J(".relationOptions"+f);var c=$J("#notificationAddRelationTimeSelect"+f)[0];var b=$J("#relationTimeOptions"+f)[0];switch(d.value){case drawDownType:case tradesType:case lotsType:if(d.value!=tradesType){a[1].disabled=true}a[0].selected=true;hideElement(c);hideElement(b);break;case avgTradeLengthType:a[1].disabled=false;showElement(c);showElement(b);break;default:a[1].disabled=false;hideElement(c);hideElement(b);break}}function showDisabledNotificationTip(){$J(".disabledNotification").each(function(){new Tip(this,$T("tAccountNotificationDisabled"))})}var AdScrollObject=function(b){var t=false;var k=$J("#"+b);var f=undefined;var u=k.offset().top;var g=k.height();var s=$J("#footerAds");var q;if(s.isExist()){q=s}else{q=$J("#wrap")}var c;if(b=="rightColumn"){c=k.find("[ads=true]")}else{c=k}function a(v){if(!t&&$J(window).scrollTop()>u){m();t=true}}var o=k.waypoint(function(v){if(!t&&$J(window).scrollTop()>u){m();t=true}});function m(){c.css("position","fixed");c.css("top","0")}function r(){var w=q.offset().top;var v=$J(window).scrollTop()+g;return w<=v+10}function l(){c.css("position","");c.css("top",0);if(b=="brokerOpenAccount"){k.css("top",45)}else{k.css("top",0)}t=false;$J.waypoints("refresh")}function d(){c.css("position","");k.css("top",q.offset().top-u-g-10)}function h(v){if(v){m()}f=$J(window).scrollTop()}this.doScroll=function(){if(t){var v=r();var x=$J(window).scrollTop();var w=f>=x;if((!v||w)&&x>u){h(w)}else{if(x<u){l()}else{if(v){d()}}}}}};var adsPopup={showPopup:function(){var c=$J("#adsblock");if(c.length===1){var a=null;var b=$J(document).keypress(function(d){d.preventDefault()});$J("html").css("overflow","hidden");$J("#closeAdsblock").click(function(d){d.preventDefault();if(a!==null){window.clearTimeout(a)}c.hide();$J("#panelHolder").show();$J("html").css("overflow","auto");$J(document).unbind("keypress")});a=window.setTimeout(function(){c.hide();$J("#panelHolder").show();$J("html").css("overflow","auto");$J(document).unbind("keypress")},30000)}}};jQuery.fn.center=function(){this.css("top",Math.max(0,(($J(window).height()-$J(this).outerHeight())/2)+$J(window).scrollTop())+"px");this.css("left",Math.max(0,(($J(window).width()-$J(this).outerWidth())/2)+$J(window).scrollLeft())+"px");return this};jQuery.fn.setBodyHeight=function(){this.css("height",$J(document).height()+"px")};function showPopup(){if(document.location.host.indexOf("myfxbook.qa")==-1){var a=((typeof(adBlockerDetect)=="undefined")&&$J("#checkAdsId").isExist());if(a&&!hasText(getCookie("lastAdBlockerMessageDisplayedDate"))&&$J("#adBlockerMessagePopUpBannerInsideDIV").isExist()&&!isMobile()){$J("#adBlockerMessagePopUpContainer").show();setCookie("lastAdBlockerMessageDisplayedDate","1",MINUTE*adblockerPopupEveryXMinutesKey)}else{if(!a&&!hasText(getCookie("lastVisitDate"))&&!isMobile()&&"undefined"!=typeof googletag){$J("#adPopUpContainer").show();setCookie("lastVisitDate","1",HOUR*roadBlockPopupEveryXhoursKey);googletag.display("div-gpt-ad-1369908521151-0")}}if(isShown("adBlockerMessagePopUpContainer")||isShown("adPopUpContainer")){$J("#mainLightBoxFilter").show()}}}function closeAdLightBox(){$J("#adPopUpContainer").hide();$J("#mainLightBoxFilter").hide()}function closeAdBlockerLightBox(){$J("#adBlockerMessagePopUpContainer").hide();$J("#mainLightBoxFilter").hide()}$J(document).keyup(function(a){if(a.keyCode==27){if(isShown("adPopUpContainer")){closeAdLightBox()}}});function addContactConfirmWindow(a){$("#addContactConfirmWindow").modal("show")}function addContact(a){var b=["toUser=",a,"&text=",encodeParameter($F("contactComment"))];fxAjax.sendRequest(fxVars.addContact,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:b.join(""),params:{},loader:false,callback:"addContactResponse"})}function addContactResponse(a,b){if(!a.error){jQuery("#addContact").removeAttr("onclick");showJqueryMessage("contactRequestSent","Contact request sent");hideElement("addContact")}else{showErrorMessage("contactRequestSent",a)}}function approveOrDisapproveContact(c,f,a,b){var d=["oid=",c,"&approve=",f];fxAjax.sendRequest(fxVars.approveOrDisapproveContact+d.join(""),{params:{approve:f,chatPage:a,oid:c,uid:b},loader:false,callback:"approveOrDisapproveContactResponse"})}function approveOrDisapproveContactResponse(a,f){var d=f.approve?"Approved":"Disapproved";if(!a.error){if(!f.approve){if(f.chatPage){hideElement("removeContact");jQuery("#addContact").attr("onclick","addContactConfirmWindow("+f.uid+");");showElement("addContact")}var c=$PT("chatUserRow"+f.oid);if(c!=null){c.remove()}var b=$PT("chatMain"+f.oid);if(b!=null){b.remove()}updateChatWindowsCookie();updateContactsOnlineStatus()}else{if(f.chatPage){jQuery("#addContact").removeAttr("onclick")}}}else{showErrorMessage("contactRequest",a)}}function showErrorMessage(c,a){var b=a.message;if(b!=null){showJqueryMessage(c,b)}}function sendChatMsg(b,d,a){var c=$F("chatText"+b);if(hasText(c)){createChatMsg(d,b,escapeHtml(c),false,true,Math.random(),false,new Date().getTime());fxWebsocket.sendWithInvite("chat",c,b,a);chatsLastMsgTimes[b]=0}}function chatReceiveMsg(b){var a=b.oid;var d=b.chatOid;var f=b.date;var c=jQuery("#chatMain"+d+" [msgOid]:last-child")[0];if((c!=null&&Number(c.getAttribute("msgOid")<a))||c==null){var h=b.fromUid;var g=b.text;var k=Number($F("userId"))!=h;createChatMsg(h,d,g,false,true,a,k,f);hideElement("chatTyping"+d);playNotificationSound()}}function createChatMsg(q,f,l,k,a,y,r,g){var z=jQuery("#chatAvatar"+q).attr("name");var h=jQuery("#chatAvatar"+q+" div").clone(true)[0];jQuery(h).children().eq(1).remove();var o=$PT("chatMain"+f);var w=$PT("chatText"+f);var s=$PT("chatTitle"+f);var v=jQuery("#chat"+f+" div[class=jspPane]")[0];var u="borderB padd3 floatLeft maxWidth1 relative";if(r){u+=" bg1"}var x=new Element("div",{id:"chatMsg"+y,className:u,msgoid:y,time:g});x.onmouseover=function(){showElement("chatMsgTime"+y)};x.onmouseout=function(){hideElement("chatMsgTime"+y)};var c=new Element("span",{className:"absolute gray1 font10 whiteBG",style:"right: 5px; bottom:-6px;display: none;z-index:1",id:"chatMsgTime"+y});c.innerHTML=getTime(g);var t=new Element("span",{});var m=null;t.innerHTML=createLineBreakes(makeImgAndUrlFromText((l),"display:block;max-width:207px;height:163px"));h.className="relative inlineBlock pointer marginR5 floatLeft";h.onclick=function(){window.open("/members/"+z)};if(!isShown(o.id)){var d=jQuery("#chatsFooter div[show=true]");if(d!=null&&d.size()>=4){var b=d[d.size()-1];hideElement(b);b.setAttribute("show",false)}o.setAttribute("show",true)}showElement(o);updateChatWindowsCookie();x.appendChild(h);x.appendChild(t);x.appendChild(c);if(v==null){v=jQuery("#chat"+f)[0]}if(k){v.insertBefore(x,v.firstChild)}else{v.appendChild(x)}if(a){createChatScroller("chat",f,a,true)}if(r){if(jQuery(w).is(":focus")){updateLastChatVisibleDate(f,w.getAttribute("lastElementId"))}else{s.className="padd5 bg9 whiteColor blink"}if(!windowIsInFocus){$J.titleAlert("New message",{requireBlur:true,stopOnFocus:true,duration:0,interval:1000})}}}var chatsLastMsgTimes={};function submitChatMsg(d,g,c,h,b){var a;if(window.event){a=window.event.keyCode}else{if(g){a=g.which}else{return true}}if(a==13&&!g.shiftKey){if(g.preventDefault){g.preventDefault()}else{g.returnValue=false}sendChatMsg(c,h,b);d.value="";d.style.height="16px"}else{var f=chatsLastMsgTimes[c];if(f==null){f=0;chatsLastMsgTimes[c]=f}if(new Date().getTime()-f>Number($F("chatTypingSendDelay"))){fxWebsocket.sendChatMsg("chat","",c,b,true);chatsLastMsgTimes[c]=new Date().getTime()}}}function removeContactConfirm(c,d,a){var f="Are you sure you want to remove "+d+" from your contact list?";var b="approveOrDisapproveContact("+c+","+false+","+true+","+a+")";showJqueryMessageWithOkAndCancel("removeContactMsg",f,b,null,null)}function contactsOnline(response){var uid=response.uid;var status=response.status;var chatAvatar=$PT("chatAvatar"+uid);jQuery("#contactsFooter [name=userOnlineStatus"+uid+"]").each(function(){this.className=(status==0)?"offline":"online"});jQuery("#chatsFooter [name=userTitleOnlineStatus"+uid+"]").each(function(){this.className=(status==0)?"offline1":"online1"});if(!eval(chatAvatar.getAttribute("pending"))){updateContactOnlineStatus(eval(chatAvatar.getAttribute("pending")),status,chatAvatar);updateContactsOnlineStatus()}}function updateContactOnlineStatus(c,a,b){if(a==1){jQuery("#onlineContact").after(b.parentNode.parentNode.parentNode)}else{jQuery("#offineContact").after(b.parentNode.parentNode.parentNode)}b.setAttribute("status",a)}function showOrHideContactChat(k,g,f,m,h){var a=$PT("chatMain"+k);var d=false;if(!h){hideElement(a);d=true}else{var b=$PT("chatsFooter");if(!isShown(a.id)){subscribeChatChannel(k,g,f);var l=jQuery("#chatsFooter div[show=true]");if(l!=null&&l.size()>=4){var c=l[l.size()-1];hideElement(c);c.setAttribute("show",false)}b.insertBefore(a,b.firstChild);d=true}showElement(a);if(m){$PT("chatText"+k).focus()}createChatScroller("chat",k,true,true)}a.setAttribute("show",h);if(d){updateChatWindowsCookie()}}function updateChatWindowsCookie(){var a=[];if(isShown("contactsFooter")){a.push(0)}jQuery("#chatsFooter div[show=true]").each(function(){a.push(this.getAttribute("chatOid"))});setCookie("chatWindows",a.join("-"),hasText(a)?YEAR:0)}function subscribeChatChannel(b,g,a){if(chatChannels.indexOf("chat"+b)==-1){var f=0;var d=g+"_"+a;var c=jQuery("#chatMain"+b+" [msgOid]:last-child")[0];if(c!=null){f=c.getAttribute("time")}fxWebsocket.subscribe("chat",b,f,d);chatChannels.push("chat"+b)}}function createChatScroller(a,h,b,g){var d=a+h;var f=jQuery("#"+d);var c=f.data("jsp");if(c!=null){f.unbind("jsp-scroll-y");c.reinitialise();if(g){bindToChatScroller(f,h)}}else{if(b){f.scrollTop(f.height())}f.jScrollPane({animateScroll:true,verticalGutter:0});if(g){bindToChatScroller(f,h)}f.hover(function(){jQuery(document).bind("mousewheel DOMMouseScroll",function(k){stopWheel(k)})},function(){jQuery(document).unbind("mousewheel DOMMouseScroll")});c=f.data("jsp")}if(b&&c!=null){c.scrollToBottom(false)}}function bindToChatScroller(pane,id){pane.bind("jsp-scroll-y",function(event,scrollPositionY,isAtTop,isAtBottom){var allowScrool=eval(this.getAttribute("scroll"));if(scrollPositionY<=10&&!scrollerLock&&(allowScrool==null||allowScrool)){scrollerLock=true;getChatHistory(id)}})}function getChatHistory(c){var d=jQuery("#chat"+c+" div[msgOid]");if(d!=null&&d.size()>0){var a=d[0].getAttribute("msgOid");var b=["chatOid=",c,"&contactHistoryOid=",a];fxAjax.sendRequest(fxVars.getChatHistory+b.join(""),{params:{chatOid:c},loader:false,callback:"getChatHistoryResponse"})}}var scrollerLock=false;function getChatHistoryResponse(g,f){if(!g.error){var k=g.content.history;var c=jQuery("#chat"+f.chatOid);var l=c.data("jsp");if(k!=null&&k.length>0){var a=jQuery("#chat"+f.chatOid+" div[class=jspPane]")[0];if(a!=null){var m=a.firstChild;for(var h=0;h<k.length;h++){var b=k[h];var d=(Number($PT("chatMain"+f.chatOid).getAttribute("lastChatVisibleDate"))<b.date&&b.uid!=Number($F("userId")));createChatMsg(b.uid,b.chatOid,escapeHtml(b.text),true,false,b.oid,d,b.date)}createChatScroller("chat",f.chatOid,false,true);if(l!=null){l.scrollToElement(m,false,false)}}}else{c.attr("scroll",false)}}scrollerLock=false}var startUpdateLastChatVisibleDate=false;function updateLastChatVisibleDate(b,a){var c=jQuery("#chatMain"+b+" [msgOid]:last-child");if(c!=null&&c.size()==1){var d=c[0].getAttribute("msgoid");if(d!=null&&d!=a){if(!startUpdateLastChatVisibleDate){startUpdateLastChatVisibleDate=true;fxAjax.sendRequest(fxVars.updateLastChatVisibleDate+"chatOid="+b,{params:{chatOid:b,newElementId:d},loader:false,callback:"updateLastChatVisibleDateResponse"})}}}}function updateLastChatVisibleDateResponse(a,c){if(!a.error){var b=a.content.lastDate;$PT("chatText"+c.chatOid).setAttribute("lastElementId",c.newElementId);if(b!=null){$PT("chatMain"+c.chatOid).setAttribute("lastChatVisibleDate",b)}}startUpdateLastChatVisibleDate=false}function stopPulsate(b){var a=jQuery("#chatTitle"+b);a.stop(true,true);a.css({opacity:1})}function chatTextOnFocus(b,c){borderChange(b);updateLastChatVisibleDate(c,b.getAttribute("lastElementId"));$PT("chatTitle"+c).className="padd5 bg9 whiteColor";var d=jQuery("#chat"+c+" div[msgOid]");for(var a=0;a<d.length;a++){d[a].className="borderB padd3 floatLeft maxWidth1 relative"}}var urlPattern=new RegExp(/(?![^<]\\\\S+>)(?:(?:https?|ftp|file):\/\/|www\\\\.|ftp\\\\.)[-A-Z0-9+&@#/%;=%~_|$?!:,.]*[A-Z0-9+&@#/%;=%~_|$]/ig);var imgPattern=new RegExp(/https?:\/\/[\S]+.jpg|png|gif|png/ig);function makeImgAndUrlFromText(txt,style){var imgMatches=txt.match(imgPattern);var urlMatches=txt.match(urlPattern);var https=eval($J("#https").val());var urlPath=$J("#urlPath").val();if(imgMatches!=null){for(var i=0;i<imgMatches.length;i++){var imgMatch=imgMatches[i];var index=urlMatches.indexOf(imgMatch);if(urlMatches!=null&&index>=0){urlMatches.splice(index,1)}if(hasText(imgMatch)){var imageHttp=imgMatch;if(https){imageHttp=urlPath+"/safe-image.html?path="+encodeUrl(imageHttp)}txt=txt.replace(imgMatch,"<a href="+imageHttp+' target="_blank"><img style='+style+" src="+imageHttp+"></a>")}}}if(urlMatches!=null){for(var i=0;i<urlMatches.length;i++){var match=urlMatches[i];if(hasText(match)&&match.length>4){txt=txt.replace(match,"<a href="+match+' target="_blank" class="underline">'+match+"</a>")}}}return txt}function chatAddNewContact(c){var d=c.data;var b=c.chatOid;var h=c.from;var g=c.to;var f=c.online;if(hasText(d)&&b!=null){var m=jQuery("div[userid='"+g+"']");var k=jQuery("tr[userid='"+g+"']");if(m!=null){m.remove()}if(k!=null){k.remove()}var a=jQuery("#contactsTable");var o=(f)?jQuery("#onlineContact"):jQuery("#offineContact");if(o!=null){o.after('<tr id="chatUserRow'+b+'" userid="'+g+'"><td>'+d+"</td></tr>")}$PT("chatsFooter").appendChild($PT("chatMain"+b));if(isShown("contactsFooter")){createChatScroller("contactsList","",false,false)}else{$PT("showChatFooter").setAttribute("sc",false)}hideElement("contactsListEmpty");subscribeChatChannel(b,h,g);var l=$PT("chatAvatar"+g);l.setAttribute("status",f?1:0);updateContactsOnlineStatus()}}function createContactsListScroller(element){updateChatWindowsCookie();var sc=eval(element.getAttribute("sc"));if(!sc){createChatScroller("contactsList","",false,false);element.setAttribute("sc",true)}}function contactNotificatinStatusUpdate(a,b){jQuery("[name=contactsNotificatinStatus"+a+"]").each(function(){this.innerHTML=b})}function updateContactsOnlineStatus(){var b=jQuery("#contactsList [status=0]");var c=jQuery("#contactsList [status=1]");var a=jQuery("#contactsList [status=2]");if(c.length>0){showElement("onlineContact")}else{hideElement("onlineContact")}if(b.length>0){showElement("offineContact")}else{hideElement("offineContact")}if(a.length>0){showElement("pendingContact")}else{hideElement("pendingContact")}if(c.length==0&&b.length==0&&a.length==0){showElement("contactsListEmpty")}}var chatsTimers={};function chatTyping(b){var c=b.chatOid;showElement("chatTyping"+c);var a="chatTyping"+c;if(chatsTimers[c]==null){chatsTimers[c]=setVariableInterval(function(){hideElement(a);chatsTimers[c]=null;this.stop()},Number($F("chatTypingReceiveDelay")))}else{var d=chatsTimers[c];d.timeCount=0}}window.setVariableInterval=function(a,b){var c={interval:b,callback:a,stopped:false,timeCount:0,runLoop:function(){c.timeCount+=1000;if(c.stopped){return}if(c.timeCount>c.interval){var d=c.callback.call(c)}else{c.loop()}},stop:function(){this.stopped=true;window.clearTimeout(this.timeout)},start:function(){this.stopped=false;return this.loop()},loop:function(){this.timeout=window.setTimeout(this.runLoop,1000);return this}};return c.start()};function encodeUrl(a){return encodeURIComponent(a).replace(/[!'()]/g,escape).replace(/\*/g,"%2A")}var isSearch=true;function initSearch(){var a=false;$J("#search").autocomplete({source:function(c,b){fxWebsocket.getToken().done(function(d){$J.ajax({url:fxVars.autoCompleteSearch,dataType:"json",data:{q:c.term,z:Math.random(),token:d},contentType:"application/json; charset=utf-8",success:function(f){try{b($J.map(f,function(k,h){return{id:k.id,name:k.name,label:k.label,icon:k.icon,link:k.link,value:k.value}}))}catch(g){}$J("#search").removeClass("ui-autocomplete-loading")}})})},minLength:1,select:function(b,c){a=true;window.location.href=c.item.link;return false},open:function(){$J(this).removeClass("ui-corner-all").addClass("ui-corner-top");$J(".ui-autocomplete").css("z-index",2000).css("width",170).css("top",110).css("margin-left",-2).css("background-color","#fff").css("background-image","none").addClass("boxShadow0");$J("#su0").removeClass("ui-menu-item").addClass("center bold padd5 bg6");$J("#ss0").removeClass("ui-menu-item").addClass("center bold padd5 bg6");$J("#sa0").removeClass("ui-menu-item").addClass("center bold padd5 bg6");$J("#sc0").removeClass("ui-menu-item").addClass("center bold padd5 bg6")},close:function(){$J(this).removeClass("ui-corner-top").addClass("ui-corner-all")},focus:function(b,c){return false}}).data("ui-autocomplete")._renderItem=function(d,h){var c=$J("<li style='float:none !important' id="+h.id+">");if(h.id!="su0"&&h.id!="ss0"&&h.id!="sa0"&&h.id!="sc0"){var b='target="_self" href="'+h.link+'"';var g=(h.icon!=null)?h.icon:"";var f=h.value!=null?"<span id='val"+h.id+"' style='margin-left:60px'>"+h.value+"</span>":"";c.append("<a class='pointer'  "+b+">"+g+" &nbsp;"+h.label+f+"</a>")}else{if(h.id=="sa0"){c.append("<a class='pointer' onclick=searchSiteFunc()>&nbsp;"+h.label+"</a>")}else{c.append(h.label)}}c.append("</li>").appendTo(d);return c};$J("#search").keypress(function(b){if(b.which==13){if(!a){searchSiteFunc()}return false}})}function autoCompleteUpdateSymbol(f){if(f.length==3){var l="sc"+f[1];var k=f[2];var d=$J("#val"+l);if(d.length){var h=parseFloat(k);var c=parseFloat($J("#val"+l).html());var g="";if(h>c){g="lightGreen radius3 padd3"}else{if(h<c){g="lightRed radius3 padd3"}}d.html(h);d.attr("class",g);var b=0}}}function createBrokerTableEl(g,f,c,a,h,l,k){var b=$J("#"+g);var q=$J("#"+f+b.val()).text();var o=g+b.val();if(b.val()!=0&&$J.inArray(q,h)==-1){var m=$J("#"+c);var r=m.find("tr:last");if(r.size()==0){m.append("<tr>")}r=m.find("tr:last");var d=(k)?"onchange='searchBrokerManage()'":"";if(r.find("td").size()<l){r.append("<td>");r.find("td:last").append('<input type="checkbox" id="'+o+'" name="'+a+'" value="'+b.val()+'" '+d+">").append('<label for="'+o+'"> '+q+"</label>")}else{m.append("<tr>");r=m.find("tr:last");r.append("<td>");r.find("td:last").append('<input type="checkbox" id="'+o+'" name="'+a+'" value="'+b.val()+'" '+d+">").append('<label for="'+o+'"> '+q+"</label>")}$J("#"+o).attr("checked","checked");if(k){searchBrokerManage()}h.push(q)}}function saveBrokerManage(){if(validate("brokerType",VALID_CHECKBOXES)&&validate("country",VALID_COUNTRY)&&validate("office",VALID_INTERNATIONAL_OFFICES)&&validate("regulation",VALID_CHECKBOXES)&&validate("operatingDate",VALID_YEAR)&&validate("address",VALID_ADDRESS)&&validate("numEmployees",VALID_INTEGER_POSITIVE_WITHOUT_ZERO)&&validate("brokerStatus",VALID_DROPDOWN)&&validate("currency",VALID_CHECKBOXES)&&validate("fundOrDepositMethod",VALID_CHECKBOXES)&&validate("email",VALID_EMAIL)&&validate("language",VALID_CHECKBOXES)&&validate("availability",VALID_CHECKBOXES)&&validate("platform",VALID_CHECKBOXES)&&(!$J("#demoExpiring").is(":checked")||validate("demoExpiringDays",VALID_NUMBER))&&validate("minDeposit",VALID_NUMBER)&&validate("maxLeverage",VALID_INTEGER_POSITIVE_WITHOUT_ZERO)&&validate("minLot",VALID_NUMBER)&&validate("maxLot",VALID_NUMBER)&&validate("commission",VALID_NUMBER)&&validate("demoUrl",VALID_URL)&&validate("liveUrl",VALID_URL)){var au=$J("#brokerOid").val();var az=getCheckBoxesValues("brokerType");var ac=$J("#country").val();var k=getCheckBoxesValues("officeCountry");var V=getCheckBoxesValues("regulation");var ak=$J("#operatingDate").val();var Q=$J("#brokerStatus").val();var K=getCheckBoxValue("status");var H=$J("#numEmployees").val();var q=getRadioValue("clients");var d=getCheckBoxesValues("currency");var O=getCheckBoxesValues("fundOrDepositMethod");var ao=getRadioValue("swapFreeAccounts");var x=getRadioValue("segregatedAccounts");var aw=getRadioValue("interestMargin");var G=getRadioValue("managed");var am=getRadioValue("mamPaam");var ah=$J("#phone").val();var L=$J("#fax").val();var s=$J("#email").val();var aA=$J("#address").val();var U=getCheckBoxesValues("language");var a=getCheckBoxesValues("availability");var M=getCheckBoxesValues("platform");var al=$J("#timeZone").val();var t=getRadioValue("demo");var v=getCheckBoxValue("demoExpiring");var X=$J("#demoExpiringDays").val();var E=getRadioValue("mobileTrading");var J=getRadioValue("webTrading");var z=getRadioValue("apiTrading");var aq=getRadioValue("ocoOrders");var Y=getRadioValue("phoneTrading");var Z=getRadioValue("hedging");var D=getRadioValue("trailingStops");var av=getRadioValue("oneClickTrading");var P=getRadioValue("bonuses");var F=getRadioValue("contests");var ag=getCheckBoxesValues("instruments");var I=$J("#minDeposit").val();var o=$J("#maxLeverage").val();var f=$J("#minLot").val();var ap=$J("#maxLot").val();var W=$J("#commission").val();var h=getCheckBoxesValues("ecnSpreads");var an=getRadioValue("centsDecimals");var at=getRadioValue("centsScalping");var R=$J("#generalInfo").val();var S=$J("#demoUrl").val();var af=$J("#liveUrl").val();var ai=$J("#logoUrl").val();var aa;if($J("#approveBroker").val()=="yes"){aa=true}else{if($J("#approveBroker").val()=="no"){aa=false}}var aB=$J("#minLotComment").val();var c=$J("#maxLotComment").val();var y=$J("#minDepositComment").val();var A=$J("#maxLeverageComment").val();var ad=$J("#commissionComment").val();var m=$J("#swapFreeAccountsComment").val();var r=$J("#segregatedAccountsComment").val();var C=$J("#interestMarginComment").val();var ay=$J("#managedComment").val();var u=$J("#mamPaamComment").val();var ab=$J("#mobileTradingComment").val();var aj=$J("#webTradingComment").val();var aC=$J("#apiTradingComment").val();var N=$J("#ocoOrdersComment").val();var g=$J("#phoneTradingComment").val();var l=$J("#hedgingComment").val();var w=$J("#trailingStopsComment").val();var b=$J("#oneClickTradingComment").val();var ax=$J("#bonusesComment").val();var ar=$J("#contestsComment").val();var ae=$J("#centsScalpingComment").val();var T=$J("#mobileAppUrl").val();var B=["brokerOid=",au,"&brokerType=",az,"&country=",ac,"&officeCountry=",k,"&regulation=",V,"&operatingDate=",ak,"&brokerStatus=",Q,"&status=",K,"&numEmployees=",H,"&clients=",q,"&currency=",d,"&fundOrDepositMethod=",O,"&swapFree=",ao,"&segregated=",x,"&marginInterest=",aw,"&managed=",G,"&managers=",am,"&phone=",encodeParameter(ah),"&fax=",encodeParameter(L),"&email=",s,"&language=",U,"&availability=",a,"&platforms=",M,"&address=",encodeParameter(aA),"&timeZone=",al,"&demo=",t,"&demoExpiring=",v,"&demoExpiringDays=",X,"&mobile=",E,"&web=",J,"&api=",z,"&oco=",aq,"&overPhone=",Y,"&hedge=",Z,"&trailing=",D,"&oneClickTrading=",av,"&bonuses=",P,"&contests=",F,"&instruments=",ag,"&minDeposit=",I,"&maxLeverage=",o,"&minLot=",f,"&maxLot=",ap,"&commission=",W,"&ecnSpreads=",h,"&centsDecimals=",an,"&centsScalping=",at,"&generalInfo=",encodeParameter(R),"&demoUrl=",encodeParameter(S),"&liveUrl=",encodeParameter(af),"&logoUrl=",encodeParameter(ai),"&approvedBroker=",aa,"&minLotComment=",encodeParameter(aB),"&maxLotComment=",encodeParameter(c),"&minDepositComment=",encodeParameter(y),"&maxLeverageComment=",encodeParameter(A),"&commissionComment=",encodeParameter(ad),"&swapFreeAccountsComment=",encodeParameter(m),"&segregatedAccountsComment=",encodeParameter(r),"&interestMarginComment=",encodeParameter(C),"&managedComment=",encodeParameter(ay),"&mamPaamComment=",encodeParameter(u),"&mobileTradingComment=",encodeParameter(ab),"&webTradingComment=",encodeParameter(aj),"&apiTradingComment=",encodeParameter(aC),"&ocoOrdersComment=",encodeParameter(N),"&phoneTradingComment=",encodeParameter(g),"&hedgingComment=",encodeParameter(l),"&trailingStopsComment=",encodeParameter(w),"&oneClickTradingComment=",encodeParameter(b),"&bonusesComment=",encodeParameter(ax),"&contestsComment=",encodeParameter(ar),"&centsScalpingComment=",encodeParameter(ae),"&mobileAppUrl=",encodeParameter(T)];fxAjax.sendRequest(fxVars.brokerManageSave+B.join(""),{method:"post",loader:true,callback:"brokerManageSaveResponse"})}}function brokerManageSaveResponse(a){$J("#brokerManageResponse").text(a.message);$J("#brokerManageResponse").show().delay(1500).fadeOut("slow")}function searchBrokerManage(){var C=false;var I=getCheckBoxesValues("brokerType");var M=getCheckBoxesValues("brokerCountry");var O=getCheckBoxesValues("officeCountry");var t=getCheckBoxesValues("regulation");var U=$J("#operatingDate").val();if(hasText(U)){if(!validate("operatingDate",VALID_YEAR)){C=true}}var w=$J("#numEmployees").val();if(hasText(w)){if(!validate("numEmployees",VALID_NUMBER)){C=true}}var B=getCheckBoxesValues("brokerStatus");var F=getCheckBoxIntValue("status");var Q=getCheckBoxIntValue("client");var N=getCheckBoxesValues("currency");var u=getCheckBoxesValues("fundOrDepositMethod");var o=getCheckBoxIntValue("swapFree");var D=getCheckBoxIntValue("segregated");var k=getCheckBoxIntValue("marginInterest");var f=getCheckBoxIntValue("managed");var l=getCheckBoxIntValue("managers");var z=getCheckBoxesValues("language");var r=getCheckBoxesValues("availability");var b=getCheckBoxesValues("platform");var d=getCheckBoxesValues("timezone");var G=getCheckBoxIntValue("demo");var v=getCheckBoxIntValue("demoExpiring");var H=getCheckBoxIntValue("mobile");var q=getCheckBoxIntValue("web");var g=getCheckBoxIntValue("api");var J=getCheckBoxIntValue("oco");var E=getCheckBoxIntValue("overPhone");var L=getCheckBoxIntValue("hedge");var P=getCheckBoxIntValue("trailing");var V=getCheckBoxIntValue("oneClickTrading");var W=getCheckBoxIntValue("bonuses");var h=getCheckBoxIntValue("contests");var s=getCheckBoxesValues("instruments");var x=$J("#minDeposit").val();if(hasText(x)){if(!validate("minDeposit",VALID_DOUBLE_POSITIVE)){C=true}}var m=$J("#maxLeverage").val();if(hasText(m)){if(!validate("maxLeverage",VALID_DOUBLE_POSITIVE)){C=true}}var A=$J("#minLot").val();if(hasText(A)){if(!validate("minLot",VALID_DOUBLE_POSITIVE)){C=true}}var K=$J("#maxLot").val();if(hasText(K)){if(!validate("maxLot",VALID_DOUBLE_POSITIVE)){C=true}}var c=$J("#commission").val();if(hasText(c)){if(!validate("commission",VALID_DOUBLE_POSITIVE)){C=true}}var T=getCheckBoxesValues("ecnSpreads");var R=getRadioValue("centsDecimals");var a=getCheckBoxIntValue("centsScalping");var y=$J("#withoutSponsorBrokerOid").val();var S=["brokerType=",I,"&country=",M,"&officeCountry=",O,"&regulation=",t,"&operatingDate=",U,"&numEmployees=",w,"&brokerStatus=",B,"&status=",F,"&clients=",Q,"&currency=",N,"&fundOrDepositMethod=",u,"&swapFree=",o,"&segregated=",D,"&marginInterest=",k,"&managed=",f,"&managers=",l,"&brokerLanguage=",z,"&availability=",r,"&platforms=",b,"&timeZone=",d,"&demo=",G,"&demoExpiring=",v,"&mobile=",H,"&web=",q,"&api=",g,"&oco=",J,"&overPhone=",E,"&hedge=",L,"&trailing=",P,"&oneClickTrading=",V,"&bonuses=",W,"&contests=",h,"&instruments=",s,"&minDeposit=",x,"&maxLeverage=",m,"&minLot=",A,"&maxLot=",K,"&commission=",c,"&centsScalping=",a,"&ecnSpreads=",T,"&withoutSponsorBrokerOid=",y];if(hasText(R)){S.push("&centsDecimals=");S.push(R)}if(!C){dhtmlHistory.add("#?pt=51&p=1&sb=85&"+S.join(""));fxAjax.sendRequest(fxVars.brokerManageSearch+S.join(""),{loader:true,callback:"brokerManageSearchResponse"})}}function brokerManageSearchResponse(a){if(!a.error){$J("#brokersCont").html(a.content.data)}}function demoExpiringSwitch(){if($J("#demoExpiring").is(":checked")){$J("#demoExpiringDays").prop("disabled",false)}else{$J("#demoExpiringDays").val("");$J("#demoExpiringDays").prop("disabled",true)}}document.createElement("canvas").getContext||function(){function L(){}function O(b){this.type_=b,this.r1_=this.y1_=this.x1_=this.r0_=this.y0_=this.x0_=0,this.colors_=[]}function Q(f,d,g){!D(d)||(f.m_=d,g&&(f.lineScale_=aa(ab(d[0][0]*d[1][1]-d[0][1]*d[1][0]))))}function D(f){var d=0;for(;d<3;d++){var g=0;for(;g<2;g++){if(!isFinite(f[d][g])||isNaN(f[d][g])){return !1}}}return !0}function E(g,f,k,h){g.currentPath_.push({type:"bezierCurveTo",cp1x:f.x,cp1y:f.y,cp2x:k.x,cp2y:k.y,x:h.x,y:h.y}),g.currentX_=h.x,g.currentY_=h.y}function G(d){this.m_=M(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.fillStyle=this.strokeStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=Z*1,this.globalAlpha=1,this.canvas=d;var c=d.ownerDocument.createElement("div");c.style.width=d.clientWidth+"px",c.style.height=d.clientHeight+"px",c.style.overflow="hidden",c.style.position="absolute",d.appendChild(c),this.element_=c,this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function H(b){switch(b){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function I(k){var h,r=1;k=String(k);if(k.substring(0,3)=="rgb"){var q=k.indexOf("(",3),o=k.indexOf(")",q+1),m=k.substring(q+1,o).split(",");h="#";var l=0;for(;l<3;l++){h+=R[Number(m[l])]}m.length==4&&k.substr(3,1)=="a"&&(r=m[3])}else{h=k}return{color:h,alpha:r}}function J(d,c){c.fillStyle=d.fillStyle,c.lineCap=d.lineCap,c.lineJoin=d.lineJoin,c.lineWidth=d.lineWidth,c.miterLimit=d.miterLimit,c.shadowBlur=d.shadowBlur,c.shadowColor=d.shadowColor,c.shadowOffsetX=d.shadowOffsetX,c.shadowOffsetY=d.shadowOffsetY,c.strokeStyle=d.strokeStyle,c.globalAlpha=d.globalAlpha,c.arcScaleX_=d.arcScaleX_,c.arcScaleY_=d.arcScaleY_,c.lineScale_=d.lineScale_}function K(k,h){var r=M(),q=0;for(;q<3;q++){var o=0;for(;o<3;o++){var m=0,l=0;for(;l<3;l++){m+=k[q][l]*h[l][o]}r[q][o]=m}}return r}function M(){return[[1,0,0],[0,1,0],[0,0,1]]}function S(d){var c=d.srcElement;c.firstChild&&(c.firstChild.style.width=c.clientWidth+"px",c.firstChild.style.height=c.clientHeight+"px")}function T(d){var c=d.srcElement;switch(d.propertyName){case"width":c.style.width=c.attributes.width.nodeValue+"px",c.getContext().clearRect();break;case"height":c.style.height=c.attributes.height.nodeValue+"px",c.getContext().clearRect()}}function V(f,d){var g=W.call(arguments,2);return function(){return f.apply(d,g.concat(W.call(arguments)))}}function X(){return this.context_||(this.context_=new G(this))}var af=Math,ae=af.round,ad=af.sin,ac=af.cos,ab=af.abs,aa=af.sqrt,Z=10,Y=Z/2,W=Array.prototype.slice,U={init:function(d){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var c=d||document;c.createElement("canvas"),c.attachEvent("onreadystatechange",V(this.init_,this,c))}},init_:function(g){g.namespaces.g_vml_||g.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML"),g.namespaces.g_o_||g.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML");if(!g.styleSheets.ex_canvas_){var f=g.createStyleSheet();f.owningElement.id="ex_canvas_",f.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}g_o_\\:*{behavior:url(#default#VML)}"}var k=g.getElementsByTagName("canvas"),h=0;for(;h<k.length;h++){this.initElement(k[h])}},initElement:function(d){if(!d.getContext){d.getContext=X,d.innerHTML="",d.attachEvent("onpropertychange",T),d.attachEvent("onresize",S);var c=d.attributes;c.width&&c.width.specified?d.style.width=c.width.nodeValue+"px":d.width=d.clientWidth,c.height&&c.height.specified?d.style.height=c.height.nodeValue+"px":d.height=d.clientHeight}return d}};U.init();var R=[],P=0;for(;P<16;P++){var N=0;for(;N<16;N++){R[P*16+N]=P.toString(16)+N.toString(16)}}var F=G.prototype;F.clearRect=function(){this.element_.innerHTML=""},F.beginPath=function(){this.currentPath_=[]},F.moveTo=function(f,d){var g=this.getCoords_(f,d);this.currentPath_.push({type:"moveTo",x:g.x,y:g.y}),this.currentX_=g.x,this.currentY_=g.y},F.lineTo=function(f,d){var g=this.getCoords_(f,d);this.currentPath_.push({type:"lineTo",x:g.x,y:g.y}),this.currentX_=g.x,this.currentY_=g.y},F.bezierCurveTo=function(u,t,s,r,q,o){var m=this.getCoords_(q,o),l=this.getCoords_(u,t),k=this.getCoords_(s,r);E(this,l,k,m)},F.quadraticCurveTo=function(k,h,r,q){var o=this.getCoords_(k,h),m=this.getCoords_(r,q),l={x:this.currentX_+0.6666666666666666*(o.x-this.currentX_),y:this.currentY_+0.6666666666666666*(o.y-this.currentY_)};E(this,l,{x:l.x+(m.x-this.currentX_)/3,y:l.y+(m.y-this.currentY_)/3},m)},F.arc=function(B,A,z,y,x,w){z*=Z;var v=w?"at":"wa",u=B+ac(y)*z-Y,t=A+ad(y)*z-Y,s=B+ac(x)*z-Y,h=A+ad(x)*z-Y;u==s&&!w&&(u+=0.125);var g=this.getCoords_(B,A),d=this.getCoords_(u,t),c=this.getCoords_(s,h);this.currentPath_.push({type:v,x:g.x,y:g.y,radius:z,xStart:d.x,yStart:d.y,xEnd:c.x,yEnd:c.y})},F.rect=function(g,f,k,h){this.moveTo(g,f),this.lineTo(g+k,f),this.lineTo(g+k,f+h),this.lineTo(g,f+h),this.closePath()},F.strokeRect=function(g,f,l,k){var h=this.currentPath_;this.beginPath(),this.moveTo(g,f),this.lineTo(g+l,f),this.lineTo(g+l,f+k),this.lineTo(g,f+k),this.closePath(),this.stroke(),this.currentPath_=h},F.fillRect=function(g,f,l,k){var h=this.currentPath_;this.beginPath(),this.moveTo(g,f),this.lineTo(g+l,f),this.lineTo(g+l,f+k),this.lineTo(g,f+k),this.closePath(),this.fill(),this.currentPath_=h},F.createLinearGradient=function(g,f,l,k){var h=new O("gradient");h.x0_=g,h.y0_=f,h.x1_=l,h.y1_=k;return h},F.createRadialGradient=function(k,h,r,q,o,m){var l=new O("gradientradial");l.x0_=k,l.y0_=h,l.r0_=r,l.x1_=q,l.y1_=o,l.r1_=m;return l},F.drawImage=function(aq){var ap,ao,an,am,al,ak,aj,ai,ah=aq.runtimeStyle.width,ag=aq.runtimeStyle.height;aq.runtimeStyle.width="auto",aq.runtimeStyle.height="auto";var C=aq.width,B=aq.height;aq.runtimeStyle.width=ah,aq.runtimeStyle.height=ag;if(arguments.length==3){ap=arguments[1],ao=arguments[2],al=ak=0,aj=an=C,ai=am=B}else{if(arguments.length==5){ap=arguments[1],ao=arguments[2],an=arguments[3],am=arguments[4],al=ak=0,aj=C,ai=B}else{if(arguments.length==9){al=arguments[1],ak=arguments[2],aj=arguments[3],ai=arguments[4],ap=arguments[5],ao=arguments[6],an=arguments[7],am=arguments[8]}else{throw Error("Invalid number of arguments")}}}var A=this.getCoords_(ap,ao),z=[];z.push(" <g_vml_:group",' coordsize="',Z*10,",",Z*10,'"',' coordorigin="0,0"',' style="width:',10,"px;height:",10,"px;position:absolute;");if(this.m_[0][0]!=1||this.m_[0][1]){var y=[];y.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",ae(A.x/Z),",","Dy=",ae(A.y/Z),"");var x=A,g=this.getCoords_(ap+an,ao),b=this.getCoords_(ap,ao+am),a=this.getCoords_(ap+an,ao+am);x.x=af.max(x.x,g.x,b.x,a.x),x.y=af.max(x.y,g.y,b.y,a.y),z.push("padding:0 ",ae(x.x/Z),"px ",ae(x.y/Z),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",y.join(""),", sizingmethod='clip');")}else{z.push("top:",ae(A.y/Z),"px;left:",ae(A.x/Z),"px;")}z.push(' ">','<g_vml_:image src="',aq.src,'"',' style="width:',Z*an,"px;"," height:",Z*am,'px;"',' cropleft="',al/C,'"',' croptop="',ak/B,'"',' cropright="',(C-al-aj)/C,'"',' cropbottom="',(B-ak-ai)/B,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",z.join(""))},F.stroke=function(aF){var aE=[],aD=I(aF?this.fillStyle:this.strokeStyle),aC=aD.color,aB=aD.alpha*this.globalAlpha;aE.push("<g_vml_:shape",' filled="',!!aF,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0 0" coordsize="',Z*10," ",Z*10,'"',' stroked="',!aF,'"',' path="');var aA={x:null,y:null},az={x:null,y:null},ay=0;for(;ay<this.currentPath_.length;ay++){var ax=this.currentPath_[ay];switch(ax.type){case"moveTo":aE.push(" m ",ae(ax.x),",",ae(ax.y));break;case"lineTo":aE.push(" l ",ae(ax.x),",",ae(ax.y));break;case"close":aE.push(" x "),ax=null;break;case"bezierCurveTo":aE.push(" c ",ae(ax.cp1x),",",ae(ax.cp1y),",",ae(ax.cp2x),",",ae(ax.cp2y),",",ae(ax.x),",",ae(ax.y));break;case"at":case"wa":aE.push(" ",ax.type," ",ae(ax.x-this.arcScaleX_*ax.radius),",",ae(ax.y-this.arcScaleY_*ax.radius)," ",ae(ax.x+this.arcScaleX_*ax.radius),",",ae(ax.y+this.arcScaleY_*ax.radius)," ",ae(ax.xStart),",",ae(ax.yStart)," ",ae(ax.xEnd),",",ae(ax.yEnd))}if(ax){if(aA.x==null||ax.x<aA.x){aA.x=ax.x}if(az.x==null||ax.x>az.x){az.x=ax.x}if(aA.y==null||ax.y<aA.y){aA.y=ax.y}if(az.y==null||ax.y>az.y){az.y=ax.y}}}aE.push(' ">');if(aF){if(typeof this.fillStyle=="object"){var aw=this.fillStyle,av=0,au={x:0,y:0},at=0,aq=1;if(aw.type_=="gradient"){var ao=aw.x1_/this.arcScaleX_,am=aw.y1_/this.arcScaleY_,ak=this.getCoords_(aw.x0_/this.arcScaleX_,aw.y0_/this.arcScaleY_),ag=this.getCoords_(ao,am);av=Math.atan2(ag.x-ak.x,ag.y-ak.y)*180/Math.PI,av<0&&(av+=360),av<0.000001&&(av=0)}else{var ak=this.getCoords_(aw.x0_,aw.y0_),u=az.x-aA.x,b=az.y-aA.y;au={x:(ak.x-aA.x)/u,y:(ak.y-aA.y)/b},u/=this.arcScaleX_*Z,b/=this.arcScaleY_*Z;var a=af.max(u,b);at=2*aw.r0_/a,aq=2*aw.r1_/a-at}var ar=aw.colors_;ar.sort(function(d,c){return d.offset-c.offset});var ap=ar.length,an=ar[0].color,al=ar[ap-1].color,aj=ar[0].alpha*this.globalAlpha,ai=ar[ap-1].alpha*this.globalAlpha,ah=[],ay=0;for(;ay<ap;ay++){var v=ar[ay];ah.push(v.offset*aq+at+" "+v.color)}aE.push('<g_vml_:fill type="',aw.type_,'"',' method="none" focus="100%"',' color="',an,'"',' color2="',al,'"',' colors="',ah.join(","),'"',' opacity="',ai,'"',' g_o_:opacity2="',aj,'"',' angle="',av,'"',' focusposition="',au.x,",",au.y,'" />')}else{aE.push('<g_vml_:fill color="',aC,'" opacity="',aB,'" />')}}else{var g=this.lineScale_*this.lineWidth;g<1&&(aB*=g),aE.push("<g_vml_:stroke",' opacity="',aB,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',H(this.lineCap),'"',' weight="',g,'px"',' color="',aC,'" />')}aE.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",aE.join(""))},F.fill=function(){this.stroke(!0)},F.closePath=function(){this.currentPath_.push({type:"close"})},F.getCoords_=function(f,d){var g=this.m_;return{x:Z*(f*g[0][0]+d*g[1][0]+g[2][0])-Y,y:Z*(f*g[0][1]+d*g[1][1]+g[2][1])-Y}},F.save=function(){var b={};J(this,b),this.aStack_.push(b),this.mStack_.push(this.m_),this.m_=K(M(),this.m_)},F.restore=function(){J(this.aStack_.pop(),this),this.m_=this.mStack_.pop()},F.translate=function(d,c){Q(this,K([[1,0,0],[0,1,0],[d,c,1]],this.m_),!1)},F.rotate=function(d){var c=ac(d),f=ad(d);Q(this,K([[c,f,0],[-f,c,0],[0,0,1]],this.m_),!1)},F.scale=function(d,c){this.arcScaleX_*=d,this.arcScaleY_*=c,Q(this,K([[d,0,0],[0,c,0],[0,0,1]],this.m_),!0)},F.transform=function(h,g,o,m,l,k){Q(this,K([[h,g,0],[o,m,0],[l,k,1]],this.m_),!0)},F.setTransform=function(h,g,o,m,l,k){Q(this,[[h,g,0],[o,m,0],[l,k,1]],!0)},F.clip=function(){},F.arcTo=function(){},F.createPattern=function(){return new L},O.prototype.addColorStop=function(d,c){c=I(c),this.colors_.push({offset:d,color:c.color,alpha:c.alpha})},G_vmlCanvasManager=U,CanvasRenderingContext2D=G,CanvasGradient=O,CanvasPattern=L}();
/*
 * Spinners 3.0.0
 * (c) 2010-2012 Nick Stakenburg - http://www.nickstakenburg.com
 *
 * Spinners is freely distributable under the terms of an MIT-style license.
 *
 * GitHub: http://github.com/staaky/spinners
 */
var Spinners={version:"3.0.0"};(function(l){function k(b){return b*Math.PI/180}function t(b){this.element=b}function s(a,d){a&&(this.element=a,m.remove(a),m.removeDetached(),this._position=0,this._state="stopped",this.setOptions(l.extend({color:"#000",dashes:12,radius:5,height:5,width:1.8,opacity:1,padding:3,rotation:700},d||{})),this.drawPosition(0),m.add(this))}var r={scroll:function(f,d){if(!d){return f}var g=f.slice(0,d);return f.slice(d,f.length).concat(g)},isElement:function(b){return b&&1==b.nodeType},element:{isAttached:function(){return function(b){for(;b&&b.parentNode;){b=b.parentNode}return !!b&&!!b.body}}()}},q={drawRoundedRectangle:function(y,x){var w=l.extend({top:0,left:0,width:0,height:0,radius:0},x||{}),v=w.left,u=w.top,b=w.width,a=w.height,w=w.radius;y.beginPath(),y.moveTo(v+w,u),y.arc(v+b-w,u+w,w,k(-90),k(0),!1),y.arc(v+b-w,u+a-w,w,k(0),k(90),!1),y.arc(v+w,u+a-w,w,k(90),k(180),!1),y.arc(v+w,u+w,w,k(-180),k(-90),!1),y.closePath(),y.fill()}},o=function(){function f(b){var h=[];0==b.indexOf("#")&&(b=b.substring(1)),b=b.toLowerCase();if(""!=b.replace(d,"")){return null}3==b.length?(h[0]=b.charAt(0)+b.charAt(0),h[1]=b.charAt(1)+b.charAt(1),h[2]=b.charAt(2)+b.charAt(2)):(h[0]=b.substring(0,2),h[1]=b.substring(2,4),h[2]=b.substring(4));for(b=0;b<h.length;b++){h[b]=parseInt(h[b],16)}return h.red=h[0],h.green=h[1],h.blue=h[2],h}var d=RegExp("[0123456789abcdef]","g"),g=function(){function b(u,h,v){return u=u.toString(v||10),Array(h-u.length).join("0")+u}return function(a,u,h){return"#"+b(a,2,16)+b(u,2,16)+b(h,2,16)}}();return{hex2rgb:f,hex2fill:function(a,v){"undefined"==typeof v&&(v=1);var u=v,h=f(a);return h[3]=u,h.opacity=u,"rgba("+h.join()+")"},rgb2hex:g}}();l.extend(Spinners,{enabled:!1,support:{canvas:function(){var a=l("<canvas>")[0];return !!a.getContext&&!!a.getContext("2d")}()},init:function(){if(this.support.canvas||window.G_vmlCanvasManager&&window.attachEvent&&-1===navigator.userAgent.indexOf("Opera")){window.G_vmlCanvasManager&&window.G_vmlCanvasManager.init_(document),this.enabled=!0}},create:function(d,c){return t.create(d,c),this.get(d)},get:function(b){return new t(b)},play:function(b){return this.get(b).play(),this},pause:function(b){return this.get(b).pause(),this},toggle:function(b){return this.get(b).toggle(),this},stop:function(b){return this.get(b).stop(),this},remove:function(b){return this.get(b).remove(),this},removeDetached:function(){return m.removeDetached(),this},center:function(b){return this.get(b).center(),this},setOptions:function(d,c){return this.get(d).setOptions(c),this},getDimensions:function(b){return b=2*m.get(b)[0].getLayout().workspace.radius,{width:b,height:b}}});var m={spinners:[],get:function(a){if(a){var d=[];return l.each(this.spinners,function(c,b){b&&(r.isElement(a)?b.element==a:l(b.element).is(a))&&d.push(b)}),d}},add:function(b){this.spinners.push(b)},remove:function(a){l(l.map(this.spinners,function(b){if(r.isElement(a)?b.element==a:l(b.element).is(a)){return b.element}})).each(l.proxy(function(d,c){this.removeByElement(c)},this))},removeByElement:function(a){var d=this.get(a)[0];d&&(d.remove(),this.spinners=l.grep(this.spinners,function(b){return b.element!=a}))},removeDetached:function(){l.each(this.spinners,l.proxy(function(d,c){c&&c.element&&!r.element.isAttached(c.element)&&this.remove(c.element)},this))}};l.extend(t,{create:function(a,u){if(a){var h=u||{},d=[];return r.isElement(a)?d.push(new s(a,h)):l(a).each(function(f,c){d.push(new s(c,h))}),d}}}),l.extend(t.prototype,{items:function(){return m.get(this.element)},play:function(){return l.each(this.items(),function(d,c){c.play()}),this},stop:function(){return l.each(this.items(),function(d,c){c.stop()}),this},pause:function(){return l.each(this.items(),function(d,c){c.pause()}),this},toggle:function(){return l.each(this.items(),function(d,c){c.toggle()}),this},center:function(){return l.each(this.items(),function(d,c){c.center()}),this},setOptions:function(a){return l.each(this.items(),function(b,d){d.setOptions(a)}),this},remove:function(){return m.remove(this.element),this}}),l.extend(s.prototype,{setOptions:function(a){this.options=l.extend({},this.options,a||{}),this.options.radii&&(a=this.options.radii,this.options.radius=Math.min(a[0],a[1]),this.options.height=Math.max(a[0],a[1])-this.options.radius),this.options.dashWidth&&(this.options.width=this.options.dashWidth),this.options.speed&&(this.options.duration=1000*this.options.speed);var a=this._state,d=this._position;this._layout=null,this.build(),d&&d>=this.options.dashes-1&&(this._position=this.options.dashes-1);switch(a){case"playing":this.play();break;case"paused":case"stopped":this.drawPosition(this._position)}this._centered&&this.center()},remove:function(){this.canvas&&(this.pause(),l(this.canvas).remove(),this.ctx=this.canvas=null)},build:function(){this.remove();var a=this.getLayout().workspace.radius;return l(document.body).append(this.canvas=l("<canvas>").attr({width:2*a,height:2*a}).css({zoom:1})),window.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.canvas[0]),this.ctx=this.canvas[0].getContext("2d"),this.ctx.globalAlpha=this.options.opacity,l(this.element).append(this.canvas),this.ctx.translate(a,a),this},drawPosition:function(b){var u=this.getLayout().workspace,b=r.scroll(u.opacities,-1*b),h=u.radius,u=this.options.dashes,g=k(360/u);this.ctx.clearRect(-1*h,-1*h,2*h,2*h);for(h=0;h<u;h++){this.drawDash(b[h],this.options.color),this.ctx.rotate(g)}},drawDash:function(g,f){this.ctx.fillStyle=o.hex2fill(f,g);var v=this.getLayout(),u=v.workspace.radius,h=v.dash.position,v=v.dash.dimensions;q.drawRoundedRectangle(this.ctx,{top:h.top-u,left:h.left-u,width:v.width,height:v.height,radius:Math.min(v.height,v.width)/2})},_nextPosition:function(){var a=this.options.rotation/this.options.dashes;this.nextPosition(),this._playTimer=window.setTimeout(l.proxy(this._nextPosition,this),a)},nextPosition:function(){this._position==this.options.dashes-1&&(this._position=-1),this._position++,this.drawPosition(this._position)},play:function(){if("playing"!=this._state){this._state="playing";var a=this.options.rotation/this.options.dashes;return this._playTimer=window.setTimeout(l.proxy(this._nextPosition,this),a),this}},pause:function(){if("paused"!=this._state){return this._pause(),this._state="paused",this}},_pause:function(){this._playTimer&&(window.clearTimeout(this._playTimer),this._playTimer=null)},stop:function(){if("stopped"!=this._state){return this._pause(),this._position=0,this.drawPosition(0),this._state="stopped",this}},toggle:function(){return this["playing"==this._state?"pause":"play"](),this},getLayout:function(){if(this._layout){return this._layout}for(var C=this.options,B=C.dashes,A=C.width,z=C.radius,y=C.radius+C.height,x=Math.max(A,y),x=Math.ceil(Math.max(x,Math.sqrt(y*y+A/2*(A/2)))),C=x+=C.padding,w=1/B,v=[],u=0;u<B;u++){v.push((u+1)*w)}return this._layout=B={workspace:{radius:C,opacities:v},dash:{position:{top:x-y,left:x-A/2},dimensions:{width:A,height:y-z}}}},center:function(){var a=2*this.getLayout().workspace.radius;l(this.element.parentNode).css({position:"relative"}),l(this.element).css({position:"absolute",height:a+"px",width:a+"px",top:"50%",left:"50%",marginLeft:-0.5*a+"px",marginTop:-0.5*a+"px"}),this._centered=!0}}),Spinners.init(),Spinners.enabled||(t.create=function(){return[]})})(jQuery);
/*
 * Tipped - The jQuery Tooltip - v3.2.0.1
 * (c) 2010-2014 Nick Stakenburg
 *
 * http://projects.nickstakenburg.com/tipped
 *
 * License: http://projects.nickstakenburg.com/tipped/license
 */
var Tipped={version:"3.2.0.1"};Tipped.Skins={base:{afterUpdate:false,ajax:{cache:true,type:"get"},background:{color:"#f2f2f2",opacity:1},border:{size:1,color:"#000",opacity:1},closeButtonSkin:"default",containment:{selector:"viewport"},fadeIn:180,fadeOut:220,showDelay:75,hideDelay:25,radius:{size:5,position:"background"},hideAfter:false,hideOn:{element:"self",event:"mouseleave"},hideOthers:false,hook:"topleft",inline:false,offset:{x:0,y:0},onHide:false,onShow:false,shadow:{blur:2,color:"#000",offset:{x:0,y:0},opacity:0.12},showOn:"mousemove",spinner:true,stem:{height:9,width:18,offset:{x:9,y:9},spacing:2},target:"self"},reset:{ajax:false,closeButton:false,hideOn:[{element:"self",event:"mouseleave"},{element:"tooltip",event:"mouseleave"}],hook:"topmiddle",stem:true},dark:{border:{color:"#fff",size:5,opacity:0.3},background:{color:"#363636"},shadow:{opacity:0.2},fadeIn:0,fadeOut:0},light:{background:{color:"#fff"},border:{color:"#646464",opacity:0.4,size:1},shadow:{opacity:0.04}},gray:{background:{color:[{position:0,color:"#8f8f8f"},{position:1,color:"#808080"}]},border:{color:"#131313",size:1,opacity:0.6}},tiny:{background:{color:"#161616"},border:{color:"#969696",opacity:0.35,size:1},fadeIn:0,fadeOut:0,radius:4,stem:{width:11,height:6,offset:{x:6,y:6}},shadow:false,spinner:{color:"#fff"}},yellow:{background:"#ffffaa",border:{size:1,color:"#6d5208",opacity:0.4}},red:{background:{color:[{position:0,color:"#e13c37"},{position:1,color:"#e13c37"}]},border:{size:1,color:"#150201",opacity:0.6},spinner:{color:"#fff"}},green:{background:{color:[{position:0,color:"#4bb638"},{position:1,color:"#4aab3a"}]},border:{size:1,color:"#122703",opacity:0.6},spinner:{color:"#fff"}},blue:{background:{color:[{position:0,color:"#4588c8"},{position:1,color:"#3d7cb9"}]},border:{color:"#020b17",opacity:0.6},spinner:{color:"#fff"}}};(function(a){a.extend(Tipped.Skins,{black:a.extend(true,{},Tipped.Skins.dark,{radius:0}),white:a.extend(true,{},Tipped.Skins.light,{radius:0})})})(jQuery);Tipped.Skins.CloseButtons={base:{diameter:17,border:2,x:{diameter:10,size:2,opacity:1},states:{"default":{background:{color:[{position:0,color:"#1a1a1a"},{position:0.46,color:"#171717"},{position:0.53,color:"#121212"},{position:0.54,color:"#101010"},{position:1,color:"#000"}],opacity:1},x:{color:"#fafafa",opacity:1},border:{color:"#fff",opacity:1}},hover:{background:{color:"#333",opacity:1},x:{color:"#e6e6e6",opacity:1},border:{color:"#fff",opacity:1}}},shadow:{blur:1,color:"#000",offset:{x:0,y:0},opacity:0.5}},reset:{},"default":{},light:{diameter:17,border:2,x:{diameter:10,size:2,opacity:1},states:{"default":{background:{color:[{position:0,color:"#797979"},{position:0.48,color:"#717171"},{position:0.52,color:"#666"},{position:1,color:"#666"}],opacity:1},x:{color:"#fff",opacity:0.95},border:{color:"#676767",opacity:1}},hover:{background:{color:[{position:0,color:"#868686"},{position:0.48,color:"#7f7f7f"},{position:0.52,color:"#757575"},{position:1,color:"#757575"}],opacity:1},x:{color:"#fff",opacity:1},border:{color:"#767676",opacity:1}}}}};eval(function(h,b,l,d,g,f){g=function(a){return(a<b?"":g(parseInt(a/b)))+((a=a%b)>35?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){while(l--){f[g(l)]=d[l]||g(l)}d=[function(a){return f[a]}];g=function(){return"\\w+"};l=1}while(l--){if(d[l]){h=h.replace(new RegExp("\\b"+g(l)+"\\b","g"),d[l])}}return h}('!13(12){13 ad(e,d){14 f=[e,d];1b f.17=e,f.18=d,f}13 aa(b){1P.5M&&5M[5M.6V?"6V":"8A"](b)}13 W(b){11.1h=b}13 V(e){14 d={};2h(14 f 5N e){d[f]=e[f]+"2G"}1b d}13 U(d,c){1b 1c.8B(d*d+c*c)}13 T(b){1b 2N*b/1c.38}13 S(b){1b b*1c.38/2N}13 R(b){1b 1/1c.4R(b)}13 H(a){1g(a){11.1h=a,I.1D(a);14 d=11.2m();11.1a=12.1n({},d.1a),11.2H=1,11.1r={},11.23=12(a).26("2A-23"),I.39(11),11.2i=11.1a.1z.1I,11.6W=11.1a.1o&&11.2i,11.3l={x:0,y:0},11.3v={18:0,17:0},11.1X()}}13 F(a,d){11.1h=a,11.1h&&d&&(11.1a=12.1n({3a:3,1F:{x:0,y:0},1Y:"#4S",1S:0.5,2U:1},29[2]||{}),11.2H=11.1a.2U,11.1r={},11.23=12(a).26("2A-23"),G.39(11),11.1X())}13 D(a){11.1h=a,11.1h&&(11.1a=12.1n({3a:5,1F:{x:0,y:0},1Y:"#4S",1S:0.5,2U:1},29[1]||{}),11.2H=11.1a.2U,11.23=12(a).26("2A-23"),E.39(11),11.1X())}13 Q(a,f){2h(14 e 5N f){f[e]&&f[e].3Q&&f[e].3Q===5O?(a[e]=12.1n({},a[e])||{},Q(a[e],f[e])):a[e]=f[e]}1b a}13 M(a,n){1g(11.1h=a,11.1h){14 m=12(a).26("2A-23");m&&N.1D(a),m=Y(),12(a).26("2A-23",m),11.23=m;14 l;"8C"!=12.1s(n)||ac.2s(n)?l=29[2]||{}:(l=n,n=1w),11.1a=N.6X(l);14 k=a.6Y("5P");1g(!n){14 h=a.6Y("26-2A");h?n=h:k&&(n=k)}k&&(12(a).26("5Q",k),a.8D("5P","")),11.2O=n,11.2t=11.1a.2t||+N.1a.4T,11.1r={2P:{15:1,19:1},5R:[],3m:[],2B:{4U:!1,2u:!1,1T:!1,3n:!1,1X:!1,4V:!1,5S:!1,3R:!1},5T:""};14 d=11.1a.1H;11.1H="2V"==d?"2V":"4W"!=d&&d?ac.2s(d)?d:d&&1C.6Z(d)||11.1h:11.1h,11.70(),N.39(11)}}14 4X=71.3S.8E,ac={8F:13(f,b){14 a=f;1b 13(){14 d=[12.1A(a,11)].72(4X.5U(29));1b b.5V(11,d)}},2s:13(b){1b b&&1==b.8G},4Y:13(b,f){14 e=4X.5U(29,2);1b 8H(13(){1b b.5V(b,e)},f)},4h:13(b){1b ac.4Y.5V(11,[b,1].72(4X.5U(29,1)))},5W:13(b){1b{x:b.5X,y:b.73}},1h:{4Z:13(e){14 c=0,f=0;8I{c+=e.51||0,f+=e.52||0,e=e.53}8J(e);1b ad(f,c)},54:13(a){14 h=12(a).1F(),d=ac.1h.4Z(a),c={18:12(1P).51(),17:12(1P).52()};1b h.17+=d.17-c.17,h.18+=d.18-c.18,ad(h.17,h.18)},56:13(){13 b(d){2h(14 c=d;c&&c.53;){c=c.53}1b c}1b 13(a){14 d=b(a);1b!(!d||!d.3b)}}()}},ab=13(d){13 c(a){14 e=2Q 5Y(a+"([\\\\d.]+)").8K(d);1b e?5Z(e[1]):!0}1b{3w:!(!1P.8L||-1!==d.3x("60"))&&c("8M "),60:d.3x("60")>-1&&(!!1P.61&&61.74&&5Z(61.74())||7.55),62:d.3x("75/")>-1&&c("75/"),57:d.3x("57")>-1&&-1===d.3x("8N")&&c("8O:"),76:!!d.3o(/8P.*8Q.*8R/),58:d.3x("58")>-1&&c("58/")}}(8S.8T),Z={3c:{4i:{63:"1.4.4",64:1P.4i&&4i.8U.8V}},77:13(){13 c(a){2h(14 l=a.3o(d),k=l&&l[1]&&l[1].2W(".")||[],j=0,i=0,h=k.2j;h>i;i++){j+=2X(k[i]*1c.78(10,6-2*i))}1b l&&l[3]?j-1:j}14 d=/^(\\d+(\\.?\\d+){0,3})([A-79-8W-]+[A-79-8X-9]+)?/;1b 13(b){11.3c[b].7a||(11.3c[b].7a=!0,(!11.3c[b].64||c(11.3c[b].64)<c(11.3c[b].63)&&!11.3c[b].7b)&&(11.3c[b].7b=!0,aa("1Z 8Y "+b+" >= "+11.3c[b].63)))}}()},Y=13(){14 d=0,c="8Z";1b 13(a){2h(a=a||c,d++;1C.6Z(a+d);){d++}1b a+d}}(),X=13(){14 a=[];1b{1y:13(g){2h(14 f=1w,b=0;b<a.2j;b++){a[b]&&a[b].4j==g.4j&&a[b].1s.7c()==g.1s.7c()&&12.7d(a[b].26||{})==12.7d(g.26||{})&&(f=a[b].59)}1b f},5a:13(e,b){11.1D(e.4j),a.2v(12.1n({},e,{59:b}))},1D:13(b){2h(14 d=0;d<a.2j;d++){a[d]&&a[d].4j==b&&3T a[d]}},7e:13(){a=[]}}}();12.1n(1Z,13(){1b{2I:{3p:13(){14 b=1C.2b("3p");1b!(!b.3y||!b.3y("2d"))}(),3z:13(){7f{1b!!("91"5N 1P||1P.7g&&1C 92 7g)}7h(b){1b!1}}(),4k:13(){14 a=["93","7i","94"],d=!!1P.7i;1b 12.1B(a,13(e,c){7f{1C.95(c),d=!0}7h(f){}}),d}()},3A:13(){(11.2I.3p||ab.3w)&&(Z.77("4i"),N.3B.1k&&(12(N.3B.1k).1D(),N.3B.1k=1w),12(1C).96(13(){N.7j(),N.7k()}))},5b:13(e,d,f){1b W.5b(e,d,f),11.1y(e)},1y:13(b){1b 2Q W(b)},65:13(b){1b N.65(b)},25:13(b){1b 11.1y(b).25(),11},1Q:13(b){1b 11.1y(b).1Q(),11},3d:13(b){1b 11.1y(b).3d(),11},2Y:13(b){1b 11.1y(b).2Y(),11},1D:13(b){1b 11.1y(b).1D(),11},5c:13(){1b N.5c(),11},66:13(b){1b N.66(b),11},67:13(b){1b N.67(b),11},1T:13(a){1g(ac.2s(a)){1b N.68(a)}1g("69"!=12.1s(a)){14 f=12(a),d=0;1b 12.1B(f,13(e,c){N.68(c)&&d++}),d}1b N.3U().2j},6a:13(){1b N.6a(),11}}}()),12.1n(W,{5b:13(a,h){1g(a){14 g=29[2]||{},d=[];1b N.7l(),ac.2s(a)?d.2v(2Q M(a,h,g)):12(a).1B(13(e,c){d.2v(2Q M(c,h,g))}),d}}}),12.1n(W.3S,{4l:13(){1b N.2n.5d={x:0,y:0},N.1y(11.1h)},25:13(){1b 12.1B(11.4l(),13(d,c){c.25()}),11},1Q:13(){1b 12.1B(11.4l(),13(d,c){c.1Q()}),11},3d:13(){1b 12.1B(11.4l(),13(d,c){c.3d()}),11},2Y:13(){1b 12.1B(11.4l(),13(d,c){c.2Y()}),11},1D:13(){1b N.1D(11.1h),11}});14 P={5e:13(){14 a;1b a=ab.76?{15:1P.6b,19:1P.6c}:{19:12(1P).19(),15:12(1P).15()}}},O={3C:1c.1K(1c.5f(1P.3C?5Z(1P.3C)||1:1,2)),3A:13(){13 b(d){14 c=d.3y("2d");c.97(O.3C,O.3C)}1b 1P.5g&&!1Z.2I.3p&&ab.3w?13(a){5g.98(a),b(a)}:13(a){b(a)}}(),3D:13(a,d){12(a).3q({15:d.15*11.3C,19:d.19*11.3C}).1t(V(d))},7m:13(a){14 p=12.1n({18:0,17:0,15:0,19:0,1q:0},29[1]||{}),o=p,n=o.17,m=o.18,l=o.15,k=o.19,j=o.1q;1b j?(a.2o(),a.3E(n+j,m),a.2f(n+l-j,m+j,j,S(-90),S(0),!1),a.2f(n+l-j,m+k-j,j,S(0),S(90),!1),a.2f(n+j,m+k-j,j,S(90),S(2N),!1),a.2f(n+j,m+j,j,S(-2N),S(-90),!1),a.2p(),a.3e(),3F 0):(a.7n(n,m,l,k),3F 0)},99:13(a,p){2h(14 o=12.1n({x:0,y:0,1Y:"#4S"},29[2]||{}),n=0,m=p.2j;m>n;n++){2h(14 l=0,k=p[n].2j;k>l;l++){14 j=2X(p[n].3G(l))*(1/9);a.2Z=J.30(o.1Y,j),j&&a.7n(o.x+l,o.y+n,1,1)}}},4m:13(a,h){14 g;1g("2C"==12.1s(h)){g=J.30(h)}1N{1g("2C"==12.1s(h.1Y)){g=J.30(h.1Y,"2J"==12.1s(h.1S)?h.1S:1)}1N{1g(12.7o(h.1Y)){14 f=12.1n({3V:0,3W:0,3X:0,3Y:0},29[2]||{});g=O.7p.7q(a.9a(f.3V,f.3W,f.3X,f.3Y),h.1Y,h.1S)}}}1b g}};O.7p={7q:13(a,l){2h(14 k="2J"==12.1s(29[2])?29[2]:1,j=0,i=l.2j;i>j;j++){14 h=l[j];("69"==12.1s(h.1S)||"2J"!=12.1s(h.1S))&&(h.1S=1),a.9b(h.1f,J.30(h.1Y,h.1S*k))}1b a}};14 L={7r:["3Z","4n","40","41","4o","4p","4q","4r","4s","4t","4u","42"],4v:{7s:/^(18|17|20|1V)(18|17|20|1V|2D|31)$/,1R:/^(18|20)/,3f:/(2D|31)/,7t:/^(18|20|17|1V)/},7u:13(){14 b={18:"19",17:"15",20:"19",1V:"15"};1b 13(a){1b b[a]}}(),3f:13(b){1b!!b.3H().3o(11.4v.3f)},7v:13(b){1b!11.3f(b)},2R:13(b){1b b.3H().3o(11.4v.1R)?"1R":"2k"},6d:13(e){14 d=1w,f=e.3H().3o(11.4v.7t);1b f&&f[1]&&(d=f[1]),d},2W:13(b){1b b.3H().3o(11.4v.7s)}},K={6e:13(d){14 c=d.1a.1o;1b{15:c.15,19:c.19}},4w:13(a,n){14 m=12.1n({43:"1K"},29[2]||{}),l=a.1a.1o,k=l.15,j=l.19,i=11.5h(k,j,n);1b m.43&&(i.15=1c[m.43](i.15),i.19=1c[m.43](i.19)),{15:i.15,19:i.19}},5h:13(j,i,p){14 o=T(1c.7w(0.5*(i/j))),n=2N-o,m=1c.4R(S(n-90))*p,l=j+2*m,k=l*i/j;1b{15:l,19:k}},44:13(g,e){14 j=11.4w(g,e),i=11.6e(g),h=(L.3f(g.2i),1c.1K(j.19+e));1b g.1a.1o.1F||0,g.1a.1q&&g.1a.1q.2E||0,{2K:{1d:{15:1c.1K(j.15),19:1c.1K(h)}},1l:{1d:j},1o:{1d:{15:i.15,19:i.19}}}},6f:13(b,c,d){14 f=b.1a,at={18:0,17:0},ar={18:0,17:0},aq=12.1n({},c),ap=b.1l,ao=ao||11.44(b,b.1l),an=ao.2K.1d;d&&(an.19=d,ap=0);14 g=L.2W(b.2i),al=L.2R(b.2i);1g(b.1a.1o){14 h=L.6d(b.2i);1g("18"==h?at.18=an.19-ap:"17"==h&&(at.17=an.19-ap),"1R"==al){21(g[2]){1i"2D":1i"31":ar.17=0.5*aq.15;1G;1i"1V":ar.17=aq.15}"20"==g[1]&&(ar.18=aq.19-ap+an.19)}1N{21(g[2]){1i"2D":1i"31":ar.18=0.5*aq.19;1G;1i"20":ar.18=aq.19}"1V"==g[1]&&(ar.17=aq.15-ap+an.19)}aq[L.7u(h)]+=an.19-ap}1N{1g("1R"==al){21(g[2]){1i"2D":1i"31":ar.17=0.5*aq.15;1G;1i"1V":ar.17=aq.15}"20"==g[1]&&(ar.18=aq.19)}1N{21(g[2]){1i"2D":1i"31":ar.18=0.5*aq.19;1G;1i"20":ar.18=aq.19}"1V"==g[1]&&(ar.17=aq.15)}}14 i=f.1q&&f.1q.2E||0,ai=f.1l&&f.1l.2E||0;1g(b.1a.1o){14 j=i&&"1p"==f.1q.1f?i:0,C=i&&"1l"==f.1q.1f?i:i+ai,A=ai+j+0.5*ao.1o.1d.15-0.5*ao.1l.1d.15,s=C>A?C-A:0,r=1c.1K(ai+j+0.5*ao.1o.1d.15+s);1g("1R"==al){21(g[2]){1i"17":ar.17+=r;1G;1i"1V":ar.17-=r}}1N{21(g[2]){1i"18":ar.18+=r;1G;1i"20":ar.18-=r}}}14 e;1g(f.1o&&(e=f.1o.1F)){14 a=K.6g(e,b.6W,c,ao.1l.1d,ai,i);1g(e=a.1F,a.4x,"1R"==al){21(g[2]){1i"17":ar.17+=e.x;1G;1i"1V":ar.17-=e.x}}1N{21(g[2]){1i"18":ar.18+=e.y;1G;1i"20":ar.18-=e.y}}}14 k;1g(f.1o&&(k=f.1o.9c)){1g("1R"==al){21(g[1]){1i"18":ar.18-=k;1G;1i"20":ar.18+=k}}1N{21(g[1]){1i"17":ar.17-=k;1G;1i"1V":ar.17+=k}}}1b{1d:aq,1f:{18:0,17:0},1p:{1f:at,1d:c},1o:{1d:an},2S:ar}},6g:13(t,s,r,q,p,o){14 n=L.2R(s),m=12.1n({},t),l={x:0,y:0},a=0;1b"1R"==n&&(a=r.15-q.15-2*p-2*o)<2*t.x&&(l.x=m.x,/(1V)$/.3r(s)&&(l.x*=-1),m.x=0),"2k"==n&&(a=r.19-q.19-2*p-2*o)<2*t.y&&(l.y=m.y,/(20)$/.3r(s)&&(l.y*=-1),m.y=0),{1F:m,4x:l}}},J=13(){13 r(d){14 c=d;1b c.7x=d[0],c.7y=d[1],c.7z=d[2],c}13 q(b){1b 2X(b,16)}13 p(d){14 c=2Q 71(3);1g(0==d.3x("#")&&(d=d.5i(1)),d=d.3H(),""!=d.6h(s,"")){1b 1w}3==d.2j?(c[0]=d.3G(0)+d.3G(0),c[1]=d.3G(1)+d.3G(1),c[2]=d.3G(2)+d.3G(2)):(c[0]=d.5i(0,2),c[1]=d.5i(2,4),c[2]=d.5i(4));2h(14 e=0;e<c.2j;e++){c[e]=q(c[e])}1b r(c)}13 o(e,d){14 f=p(e);1b f[3]=d,f.1S=d,f}13 n(d,e){1b"69"==12.1s(e)&&(e=1),"9d("+o(d,e).9e()+")"}13 m(b){1b"#"+(l(b)[2]>50?"4S":"9f")}13 l(b){1b a(p(b))}13 a(b){14 B,A,z,b=r(b),ah=b.7x,ag=b.7y,C=b.7z,y=ah>ag?ah:ag;C>y&&(y=C);14 x=ag>ah?ah:ag;1g(x>C&&(x=C),z=y/9g,A=0!=y?(y-x)/y:0,0==A){B=0}1N{14 w=(y-ah)/(y-x),v=(y-ag)/(y-x),u=(y-C)/(y-x);B=ah==y?u-v:ag==y?2+w-u:4+v-w,B/=6,0>B&&(B+=1)}B=1c.2c(7A*B),A=1c.2c(6i*A),z=1c.2c(6i*z);14 d=[];1b d[0]=B,d[1]=A,d[2]=z,d.9h=B,d.9i=A,d.9j=z,d}14 t="9k",s=2Q 5Y("["+t+"]","g");1b{9l:p,30:n,9m:m}}(),I={5j:{},1y:13(a){1g(!a){1b 1w}14 f=1w,e=12(a).26("2A-23");1b e&&(f=11.5j[e]),f},39:13(b){11.5j[b.23]=b},1D:13(d){14 c=11.1y(d);c&&(3T 11.5j[c.23],c.1D())}};12.1n(H.3S,13(){13 ap(){11.1r.1z={};14 c=11.2i;12.1B(L.7r,12.1A(13(a,b){14 C,A=11.1r.1z[b]={};11.2i=b;14 v=11.2x();C=v,A.2S=C.2S;14 u=C.1O.1d,p={18:C.1O.1f.18,17:C.1O.1f.17};1g(A.1O={1d:u,1f:p},A.1I={1d:C.2a.1d},11.1x){14 o=11.1x.2x(),m=o.2a.1f,l=A.1O.1f;12.1n(!0,A,{2S:o.2S,1O:{1f:{18:l.18+m.18,17:l.17+m.17}},1I:{1d:o.1I.1d}})}},11)),11.2i=c}13 ao(){11.3g(),11.1a.1x&&(G.1D(11.1h),11.1a.1E&&11.1a.1E.1x&&E.1D(11.1h)),11.32&&(11.32.1D(),11.32=1w),11.1k&&(12(11.1k).1D(),11.1k=1w)}13 an(){11.1O&&(11.1E&&(12(11.1E).1D(),11.1E=1w,11.6j=1w,11.6k=1w),12(11.1O).1D(),11.1o=1w,11.1p=1w,11.1O=1w,11.1r={})}13 am(){14 f=11.2m();11.2P=f.1r.2P;14 d=f.1a;11.1q=d.1q&&d.1q.2E||0,11.1l=d.1l&&d.1l.2E||0,11.2w=d.2w;14 g=1c.5f(11.2P.19,11.2P.15);11.1q>g/2&&(11.1q=1c.6l(g/2)),"1l"==11.1a.1q.1f&&11.1q>11.1l&&(11.1l=11.1q),11.1r={1a:{1q:11.1q,1l:11.1l,2w:11.2w}}}13 al(){11.3g(),1P.5g&&1P.5g.9n(1C);14 d=11.2m(),f=11.1a;11.1O=12("<2q>").27("9o")[0],12(d.5k).28(11.1O),11.5l(),11.7B(d),f.1E&&(11.7C(d),f.1E.1x&&(11.33?(11.33.1a=f.1E.1x,11.33.1X()):11.33=2Q D(11.1h,12.1n({2U:11.2H},f.1E.1x)))),ab.3w&&ab.3w<7&&12(d.1k).6m(11.32=12("<9p>").27("9q").3q({9r:0,4y:"9s:\'\';"})),11.5m(),f.1x&&(11.1x?(11.1x.1a=f.1x,11.1x.1X()):11.1x=2Q F(11.1h,11,12.1n({2U:11.2H},f.1x))),11.7D()}13 ak(){14 i=11.2m(),u=12(i.1k),p=12(i.1k).6n(".7E").7F()[0];1g(p){12(p).1t({15:"6o",19:"6o"});14 o=2X(u.1t("18")),m=2X(u.1t("17")),l=2X(u.1t("15"));u.1t({17:"-7G",18:"-7G",15:"9t",19:"6o"}),i.1L("1T")||12(i.1k).25();14 j=N.3B.6p(p);i.1a.3s&&"2J"==12.1s(i.1a.3s)&&j.15>i.1a.3s&&(12(p).1t({15:i.1a.3s+"2G"}),j=N.3B.6p(p)),i.1L("1T")||12(i.1k).1Q(),i.1r.2P=j,u.1t({17:m+"2G",18:o+"2G",15:l+"2G"}),11.1X()}}13 aj(g,f,i){14 h=!1;11.4z(g)&&(h=!0),11.7H(f)&&(h=!0),i&&11.7I(i)&&(h=!0),h&&11.1X()}13 ai(d){14 c=!1;1b(11.3v.17!=d.17||11.3v.18!=d.18)&&(c=!0,11.3v=d),c}13 ah(d){14 c=!1;1b(11.3l.x!=d.x||11.3l.y!=d.y)&&(c=!0,11.3l=d),c}13 ag(b){14 d=!1;1b 11.2i!=b&&(d=!0,11.2i=b),d}13 B(){1b N.1y(11.1h)[0]}13 z(){1b K.44(11,11.1l)}13 s(){14 d=11.2m().1a.1E,f=d.3I+2*d.1l;12(11.6j).1t({17:-1*f+"2G"}),12(11.6k).1t({17:0})}13 q(){14 d=11.2m().1a.1E,f=d.3I+2*d.1l;12(11.6j).1t({17:0}),12(11.6k).1t({17:f+"2G"})}13 y(f){14 h=f.1a.1E,g={15:h.3I+2*h.1l,19:h.3I+2*h.1l};12(f.1k).28(12(11.1E=1C.2b("2q")).27("6q").1t(V(g)).28(12(11.7J=1C.2b("2q")).27("9u").1t(V(g)))),11.6r(f,"6s"),11.6r(f,"6t"),1Z.2I.3z||ab.58||12(11.1E).46("4A",12.1A(11.7K,11)).46("5n",12.1A(11.7L,11))}13 x(a,b){14 c=a.1a.1E,aw=c.3I,av=c.1l||0,au=c.x.3I,at=c.x.2E,ar=(c.x.9v,c.2B[b||"6s"]),aq={15:aw+2*av,19:aw+2*av};au>=aw&&(au=aw-2);14 C;12(11.7J).28(12(11[b+"7M"]=1C.2b("2q")).27("9w").1t(12.1n(V(aq),{17:("6t"==b?aq.15:0)+"2G"}))),12(1C.3b).28(12(C=1C.2b("3p"))),O.3D(C,aq),O.3A(C);14 A=C.3y("2d");A.2U=11.2H,12(11[b+"7M"]).28(C),A.9x(aq.15/2,aq.19/2),A.2Z=O.4m(A,ar.1p,{3V:0,3W:0-aw/2,3X:0,3Y:0+aw/2}),A.2o(),A.2f(0,0,aw/2,0,2*1c.38,!0),A.2p(),A.3e(),av&&(A.2Z=O.4m(A,ar.1l,{3V:0,3W:0-aw/2-av,3X:0,3Y:0+aw/2+av}),A.2o(),A.2f(0,0,aw/2,1c.38,0,!1),A.1e((aw+av)/2,0),A.2f(0,0,aw/2+av,0,1c.38,!0),A.2f(0,0,aw/2+av,1c.38,0,!0),A.1e(aw/2,0),A.2f(0,0,aw/2,0,1c.38,!1),A.2p(),A.3e());14 v=au/2,i=at/2;1g(i>v){14 d=i;i=v,v=d}A.2Z=J.30(ar.x.1Y||ar.x,ar.x.1S||1),A.5o(S(45)),A.2o(),A.3E(0,0),A.1e(0,v);2h(14 e=0;4>e;e++){A.1e(0,v),A.1e(i,v),A.1e(i,v-(v-i)),A.1e(v,i),A.1e(v,0),A.5o(S(90))}A.2p(),A.3e()}13 w(a){14 b,aB,aA,az,ax,1W=12.1n({1o:!1,3J:1w,9y:1w,2o:!1,2p:!1,3K:1w,3L:1w,1q:0,1l:0,5p:0,3h:{x:0,y:0}},29[1]||{}),3M=1W.3K,1J=1W.3L,1u=1W.3h,1v=1W.1l,1j=1W.1q,1M=1W.3J,1m=3M.1p.1f,aD=3M.1p.1d,aw={x:1c.34(11.3l.x),y:1c.34(11.3l.y)},av={x:0,y:0},au={x:0,y:0};1g(1J){b=1J.1o.1d,aB=1J.2K.1f,aA=1J.2K.1d,az=aA.15-b.15;14 e=1W.5p,ar=1v+1j+0.5*b.15-0.5*1J.1l.1d.15;ax=1c.1K(e>ar?e-ar:0);14 h=K.6g(1u,1M,aD,1J.1l.1d,1v,1j);1u=h.1F,au=h.4x,av={x:1c.22(aD.15-2*1c.22(ax,1u.x||0)-1J.1l.1d.15-(2*1j||0),0),y:1c.22(aD.19-2*1c.22(ax,1u.y||0)-1J.1l.1d.19-(2*1j||0),0)},L.3f(1M)&&(av.x*=0.5,av.y*=0.5),aw.x=1c.5f(aw.x,av.x),aw.y=1c.5f(aw.y,av.y),L.3f(1M)&&(11.3l.x<0&&aw.x>0&&(aw.x*=-1),11.3l.y<0&&aw.y>0&&(aw.y*=-1)),11.3v&&11.3v.3N&&12.1B(11.3v.3N,13(d,f){12.1B("18 1V 20 17".2W(" "),13(g,c){f==c&&2Q 5Y("("+c+")$").3r(1M)&&(aw[/^(17|1V)$/.3r(c)?"x":"y"]=0)})})}14 C,ay;1g(1j?(C=1m.17+1v+1j,ay=1m.18+1v):(C=1m.17+1v,ay=1m.18+1v),1u&&1u.x&&/^(3Z|42)$/.3r(1M)&&(C+=1u.x),1W.2o&&a.2o(),a.3E(C,ay),1W.1o){21(1M){1i"3Z":C=1m.17+1v,1j&&(C+=1j),C+=1c.22(ax,1u.x||0),C+=aw.x,a.1e(C,ay),ay-=b.19,C+=0.5*b.15,a.1e(C,ay),ay+=b.19,C+=0.5*b.15,a.1e(C,ay);1G;1i"4n":1i"5q":C=1m.17+0.5*aD.15-0.5*b.15,C+=aw.x,a.1e(C,ay),ay-=b.19,C+=0.5*b.15,a.1e(C,ay),ay+=b.19,C+=0.5*b.15,a.1e(C,ay),C=1m.17+0.5*aD.15-0.5*aA.15,a.1e(C,ay);1G;1i"40":C=1m.17+aD.15-1v-b.15,1j&&(C-=1j),C-=1c.22(ax,1u.x||0),C-=aw.x,a.1e(C,ay),ay-=b.19,C+=0.5*b.15,a.1e(C,ay),ay+=b.19,C+=0.5*b.15,a.1e(C,ay)}}1g(1j?1j&&(a.2f(1m.17+aD.15-1v-1j,1m.18+1v+1j,1j,S(-90),S(0),!1),C=1m.17+aD.15-1v,ay=1m.18+1v+1j):(C=1m.17+aD.15-1v,ay=1m.18+1v,a.1e(C,ay)),1W.1o){21(1M){1i"41":ay=1m.18+1v,1j&&(ay+=1j),ay+=1c.22(ax,1u.y||0),ay+=aw.y,a.1e(C,ay),C+=b.19,ay+=0.5*b.15,a.1e(C,ay),C-=b.19,ay+=0.5*b.15,a.1e(C,ay);1G;1i"4o":1i"5r":ay=1m.18+0.5*aD.19-0.5*b.15,ay+=aw.y,a.1e(C,ay),C+=b.19,ay+=0.5*b.15,a.1e(C,ay),C-=b.19,ay+=0.5*b.15,a.1e(C,ay);1G;1i"4p":ay=1m.18+aD.19-1v,1j&&(ay-=1j),ay-=b.15,ay-=1c.22(ax,1u.y||0),ay-=aw.y,a.1e(C,ay),C+=b.19,ay+=0.5*b.15,a.1e(C,ay),C-=b.19,ay+=0.5*b.15,a.1e(C,ay)}}1g(1j?1j&&(a.2f(1m.17+aD.15-1v-1j,1m.18+aD.19-1v-1j,1j,S(0),S(90),!1),C=1m.17+aD.15-1v-1j,ay=1m.18+aD.19-1v):(C=1m.17+aD.15-1v,ay=1m.18+aD.19-1v,a.1e(C,ay)),1W.1o){21(1M){1i"4q":C=1m.17+aD.15-1v,1j&&(C-=1j),C-=1c.22(ax,1u.x||0),C-=aw.x,a.1e(C,ay),C-=0.5*b.15,ay+=b.19,a.1e(C,ay),C-=0.5*b.15,ay-=b.19,a.1e(C,ay);1G;1i"4r":1i"5s":C=1m.17+0.5*aD.15+0.5*b.15,C+=aw.x,a.1e(C,ay),C-=0.5*b.15,ay+=b.19,a.1e(C,ay),C-=0.5*b.15,ay-=b.19,a.1e(C,ay);1G;1i"4s":C=1m.17+1v+b.15,1j&&(C+=1j),C+=1c.22(ax,1u.x||0),C+=aw.x,a.1e(C,ay),C-=0.5*b.15,ay+=b.19,a.1e(C,ay),C-=0.5*b.15,ay-=b.19,a.1e(C,ay)}}1g(1j?1j&&(a.2f(1m.17+1v+1j,1m.18+aD.19-1v-1j,1j,S(90),S(2N),!1),C=1m.17+1v,ay=1m.18+aD.19-1v-1j):(C=1m.17+1v,ay=1m.18+aD.19-1v,a.1e(C,ay)),1W.1o){21(1M){1i"4t":ay=1m.18+aD.19-1v,1j&&(ay-=1j),ay-=1c.22(ax,1u.y||0),ay-=aw.y,a.1e(C,ay),C-=b.19,ay-=0.5*b.15,a.1e(C,ay),C+=b.19,ay-=0.5*b.15,a.1e(C,ay);1G;1i"4u":1i"5t":ay=1m.18+0.5*aD.19+0.5*b.15,ay+=aw.y,a.1e(C,ay),C-=b.19,ay-=0.5*b.15,a.1e(C,ay),C+=b.19,ay-=0.5*b.15,a.1e(C,ay);1G;1i"42":ay=1m.18+1v+b.15,1j&&(ay+=1j),ay+=1c.22(ax,1u.y||0),ay+=aw.y,a.1e(C,ay),C-=b.19,ay-=0.5*b.15,a.1e(C,ay),C+=b.19,ay-=0.5*b.15,a.1e(C,ay)}}1b 1j?1j&&(a.2f(1m.17+1v+1j,1m.18+1v+1j,1j,S(-2N),S(-90),!1),C=1m.17+1v+1j,ay=1m.18+1v,C+=1,a.1e(C,ay)):(C=1m.17+1v,ay=1m.18+1v,a.1e(C,ay)),1W.2p&&a.2p(),{x:C,y:ay,1o:aw,5u:au,3h:1u}}13 t(a){14 b,ax,aw,av,au,at,1u=12.1n({1o:!1,3J:1w,2o:!1,2p:!1,3K:1w,3L:1w,1q:0,1l:0,7N:0,3h:{x:0,y:0},5v:1w},29[1]||{}),1v=1u.3K,1j=1u.3L,1M=(1u.7N,1u.3h),1m=1u.1l,aD=1u.1q&&1u.1q.2E||0,aC=1u.7O,aB=1u.3J,aA=1v.1p.1f,az=1v.1p.1d,ar=1u.5v&&1u.5v.1o||{x:0,y:0};1g(1j){b=1j.1o.1d,ax=1j.2K.1f,aw=1j.2K.1d,av=1j.1l.1d,au=aw.15-b.15;14 c=1m+aC+0.5*b.15-0.5*av.15;at=1c.1K(aD>c?aD-c:0)}14 C=aA.17+1m+aC,A=aA.18+1m;aC&&(C+=1),12.1n({},{x:C,y:A}),1u.2o&&a.2o();14 f=12.1n({},{x:C,y:A});1g(A-=1m,a.1e(C,A),aD?aD&&(a.2f(aA.17+aD,aA.18+aD,aD,S(-90),S(-2N),!0),C=aA.17,A=aA.18+aD):(C=aA.17,A=aA.18,a.1e(C,A)),1u.1o){21(aB){1i"42":A=aA.18+1m,aC&&(A+=aC),A-=0.5*av.15,A+=0.5*b.15,A+=1c.22(at,1M.y||0),A+=ar.y,a.1e(C,A),C-=av.19,A+=0.5*av.15,a.1e(C,A),C+=av.19,A+=0.5*av.15,a.1e(C,A);1G;1i"4u":1i"5t":A=aA.18+0.5*az.19-0.5*av.15,A+=ar.y,a.1e(C,A),C-=av.19,A+=0.5*av.15,a.1e(C,A),C+=av.19,A+=0.5*av.15,a.1e(C,A);1G;1i"4t":A=aA.18+az.19-1m-av.15,aC&&(A-=aC),A+=0.5*av.15,A-=0.5*b.15,A-=1c.22(at,1M.y||0),A-=ar.y,a.1e(C,A),C-=av.19,A+=0.5*av.15,a.1e(C,A),C+=av.19,A+=0.5*av.15,a.1e(C,A)}}1g(aD?aD&&(a.2f(aA.17+aD,aA.18+az.19-aD,aD,S(-2N),S(-9z),!0),C=aA.17+aD,A=aA.18+az.19):(C=aA.17,A=aA.18+az.19,a.1e(C,A)),1u.1o){21(aB){1i"4s":C=aA.17+1m,aC&&(C+=aC),C-=0.5*av.15,C+=0.5*b.15,C+=1c.22(at,1M.x||0),C+=ar.x,a.1e(C,A),A+=av.19,C+=0.5*av.15,a.1e(C,A),A-=av.19,C+=0.5*av.15,a.1e(C,A);1G;1i"4r":1i"5s":C=aA.17+0.5*az.15-0.5*av.15,C+=ar.x,a.1e(C,A),A+=av.19,C+=0.5*av.15,a.1e(C,A),A-=av.19,C+=0.5*av.15,a.1e(C,A),C=aA.17+0.5*az.15+av.15,a.1e(C,A);1G;1i"4q":C=aA.17+az.15-1m-av.15,aC&&(C-=aC),C+=0.5*av.15,C-=0.5*b.15,C-=1c.22(at,1M.x||0),C-=ar.x,a.1e(C,A),A+=av.19,C+=0.5*av.15,a.1e(C,A),A-=av.19,C+=0.5*av.15,a.1e(C,A)}}1g(aD?aD&&(a.2f(aA.17+az.15-aD,aA.18+az.19-aD,aD,S(90),S(0),!0),C=aA.17+az.15,A=aA.18+az.15+aD):(C=aA.17+az.15,A=aA.18+az.19,a.1e(C,A)),1u.1o){21(aB){1i"4p":A=aA.18+az.19-1m,A+=0.5*av.15,A-=0.5*b.15,aC&&(A-=aC),A-=1c.22(at,1M.y||0),A-=ar.y,a.1e(C,A),C+=av.19,A-=0.5*av.15,a.1e(C,A),C-=av.19,A-=0.5*av.15,a.1e(C,A);1G;1i"4o":1i"5r":A=aA.18+0.5*az.19+0.5*av.15,A+=ar.y,a.1e(C,A),C+=av.19,A-=0.5*av.15,a.1e(C,A),C-=av.19,A-=0.5*av.15,a.1e(C,A);1G;1i"41":A=aA.18+1m,aC&&(A+=aC),A+=av.15,A-=0.5*av.15-0.5*b.15,A+=1c.22(at,1M.y||0),A+=ar.y,a.1e(C,A),C+=av.19,A-=0.5*av.15,a.1e(C,A),C-=av.19,A-=0.5*av.15,a.1e(C,A)}}1g(aD?aD&&(a.2f(aA.17+az.15-aD,aA.18+aD,aD,S(0),S(-90),!0),C=aA.17+az.15-aD,A=aA.18):(C=aA.17+az.15,A=aA.18,a.1e(C,A)),1u.1o){21(aB){1i"40":C=aA.17+az.15-1m,C+=0.5*av.15-0.5*b.15,aC&&(C-=aC),C-=1c.22(at,1M.x||0),C-=ar.x,a.1e(C,A),A-=av.19,C-=0.5*av.15,a.1e(C,A),A+=av.19,C-=0.5*av.15,a.1e(C,A);1G;1i"4n":1i"5q":C=aA.17+0.5*az.15+0.5*av.15,C+=ar.x,a.1e(C,A),A-=av.19,C-=0.5*av.15,a.1e(C,A),A+=av.19,C-=0.5*av.15,a.1e(C,A),C=aA.17+0.5*az.15-av.15,a.1e(C,A),a.1e(C,A);1G;1i"3Z":C=aA.17+1m+av.15,C-=0.5*av.15,C+=0.5*b.15,aC&&(C+=aC),C+=1c.22(at,1M.x||0),C+=ar.x,a.1e(C,A),A-=av.19,C-=0.5*av.15,a.1e(C,A),A+=av.19,C-=0.5*av.15,a.1e(C,A)}}a.1e(f.x,f.y-1m),a.1e(f.x,f.y),1u.2p&&a.2p()}13 r(a){14 b=11.2x(),av=11.1a.1o&&11.4B(),au=11.2i&&11.2i.3H(),at=11.1q,ar=11.1l,aq=11.2w,C=({15:2*ar+2*aq+11.2P.15,19:2*ar+2*aq+11.2P.19},a.1a.1o&&a.1a.1o.1F||{x:0,y:0}),A=0,v=0;at&&(A="1p"==11.1a.1q.1f?at:0,v="1l"==11.1a.1q.1f?at:A+ar),12(1C.3b).28(11.35=1C.2b("3p")),O.3D(11.35,b.1O.1d),O.3A(11.35);14 u=11.35.3y("2d");u.2U=11.2H,12(11.1O).28(11.35),u.2Z=O.4m(u,11.1a.1p,{3V:0,3W:b.1p.1f.18+ar,3X:0,3Y:b.1p.1f.18+b.1p.1d.19-ar}),u.9A=0;14 j;1g(j=11.6u(u,{2o:!0,2p:!0,1l:ar,1q:A,5p:v,3K:b,3L:av,1o:11.1a.1o,3J:au,3h:C}),u.3e(),ar){14 g=O.4m(u,11.1a.1l,{3V:0,3W:b.1p.1f.18,3X:0,3Y:b.1p.1f.18+b.1p.1d.19});u.2Z=g,j=11.6u(u,{2o:!0,2p:!1,1l:ar,1q:A,5p:v,3K:b,3L:av,1o:11.1a.1o,3J:au,3h:C}),11.7P(u,{2o:!1,2p:!0,1l:ar,7O:A,1q:{2E:v,1f:11.1a.1q.1f},3K:b,3L:av,1o:11.1a.1o,3J:au,3h:j.3h,5v:j}),u.3e()}11.3O=j}13 n(){14 a,7Q=11.2m(),6v=11.2P,3P=7Q.1a,7R=11.1q,5w=11.1l,6w=11.2w,47={15:2*5w+2*6w+6v.15,19:2*5w+2*6w+6v.19};1g(11.1a.1o){14 b=11.4B();a=b.2K.1d}14 c=K.6f(11,47),3M=c.1d,1J=c.1f,47=c.1p.1d,1u=c.1p.1f;c.1o.1d;14 d,aB,az,1j={18:0,17:0},ax={15:3M.15,19:3M.19};1g(3P.1E){14 e=7R;"1p"==3P.1q.1f&&(e+=5w);14 f=e-1c.9B(S(45))*e,aq="1V";11.2i.3H().3o(/^(40|41)$/)&&(aq="17");14 p=3P.1E.3I+2*3P.1E.1l,d={15:p,19:p};1g(1j.17=1u.17-p/2+("17"==aq?f:47.15-f),1j.18=1u.18-p/2+f,"17"==aq){1g(1j.17<0){14 g=1c.34(1j.17);ax.15+=g,1J.17+=g,1j.17=0}}1N{14 h=1j.17+p-ax.15;h>0&&(ax.15+=h)}1g(1j.18<0){14 i=1c.34(1j.18);ax.19+=i,1J.18+=i,1j.18=0}1g(11.1a.1E.1x){14 j=11.1a.1E.1x,aA=j.3a,ay=j.1F;1g(aB={15:d.15+2*aA,19:d.19+2*aA},az={18:1j.18-aA+ay.y,17:1j.17-aA+ay.x},"17"==aq){1g(az.17<0){14 g=1c.34(az.17);ax.15+=g,1J.17+=g,1j.17+=g,az.17=0}}1N{14 h=az.17+aB.15-ax.15;h>0&&(ax.15+=h)}1g(az.18<0){14 i=1c.34(az.18);ax.19+=i,1J.18+=i,1j.18+=i,az.18=0}}}14 k=c.2S;k.18+=1J.18,k.17+=1J.17;14 l={17:1c.1K(1J.17+1u.17+11.1l+11.1a.2w),18:1c.1K(1J.18+1u.18+11.1l+11.1a.2w)},ar={1I:{1d:{15:1c.1K(ax.15),19:1c.1K(ax.19)}},2a:{1d:{15:1c.1K(ax.15),19:1c.1K(ax.19)}},1O:{1d:3M,1f:{18:1c.2c(1J.18),17:1c.2c(1J.17)}},1p:{1d:{15:1c.1K(47.15),19:1c.1K(47.19)},1f:{18:1c.2c(1u.18),17:1c.2c(1u.17)}},2S:{18:1c.2c(k.18),17:1c.2c(k.17)},2O:{1f:l}};1b 11.1a.1E&&(ar.1E={1d:{15:1c.1K(d.15),19:1c.1K(d.19)},1f:{18:1c.2c(1j.18),17:1c.2c(1j.17)}},11.1a.1E.1x&&(ar.33={1d:{15:1c.1K(aB.15),19:1c.1K(aB.19)},1f:{18:1c.2c(az.18),17:1c.2c(az.17)}})),ar}13 k(){14 d=11.2x(),f=11.2m();12(f.1k).1t(V(d.1I.1d)),12(f.5k).1t(V(d.2a.1d)),11.32&&11.32.1t(V(d.1I.1d)),12(11.1O).1t(12.1n(V(d.1O.1d),V(d.1O.1f))),11.1E&&(12(11.1E).1t(V(d.1E.1f)),d.33&&12(11.33.1k).1t(V(d.33.1f))),12(f.3i).1t(V(d.2O.1f))}13 e(b){11.2H=b||0,11.1x&&(11.1x.2H=11.2H)}13 a(b){11.7S(b),11.1X()}1b{5l:am,7D:ap,1X:al,1D:ao,3g:an,2m:B,2Y:ak,5x:aj,7I:ai,7H:ah,4z:ag,7C:y,6r:x,7B:r,6u:w,7P:t,7K:s,7L:q,4B:z,2x:n,5m:k,7S:e,9C:a}}());14 G={3t:{},1y:13(a){1g(!a){1b 1w}14 f=1w,e=12(a).26("2A-23");1b e&&(f=11.3t[e]),f},39:13(b){11.3t[b.23]=b},1D:13(d){14 c=11.1y(d);c&&(3T 11.3t[c.23],c.1D())},4C:13(b){1b 1c.38/2-1c.78(b,1c.4R(b)*1c.38)}};G.4D={4w:13(g,f){14 j=I.1y(g.1h),i=j.4B().1l.1d,h=11.5h(i.15,i.19,f,{43:!1});1b{15:h.15,19:h.19}},9D:13(r,q,p){14 o=0.5*r,n=T(1c.9E(o/U(o,q))),m=2N-n-90,l=R(S(m))*p,k=2*(o+l),j=k/r*q;1b{15:k,19:j}},5h:13(j,i,p){14 o=T(1c.7w(0.5*(i/j))),n=2N-o,m=1c.4R(S(n-90))*p,l=j+2*m,k=l*i/j;1b{15:l,19:k}},44:13(r){14 q=I.1y(r.1h),p=r.1a.3a,o=L.7v(q.2i),n=(L.2R(q.2i),G.4D.4w(r,p)),m={2K:{1d:{15:1c.1K(n.15),19:1c.1K(n.19)},1f:{18:0,17:0}}};1g(p){m.36=[];2h(14 l=0;p>=l;l++){14 f=G.4D.4w(r,l,{43:!1}),a={1f:{18:m.2K.1d.19-f.19,17:o?p-l:(m.2K.1d.15-f.15)/2},1d:f};m.36.2v(a)}}1N{m.36=[12.1n({},m.2K)]}1b m},5o:13(e,d,f){K.5o(e,d.3u(),f)}},12.1n(F.3S,13(){13 t(){1b N.1y(11.1h)[0]}13 s(){1b I.1y(11.1h)}13 r(){11.3g()}13 q(){11.1k&&(12(11.1k).1D(),11.1o=1w,11.1p=1w,11.1O=1w,11.1k=1w,11.1r={})}13 p(){}13 o(){11.3g(),11.5l();14 d=11.2m(),e=11.3u();11.1k=12("<2q>").27("9F")[0],12(d.1k).6m(11.1k),e.32&&12(d.1k).6m(e.32),e.2x(),12(11.1k).1t({18:0,17:0}),11.7T(),11.5m()}13 n(){1b 11.1a.1S/(11.1a.3a+1)}13 m(){14 a=11.3u(),1M=a.2x(),1m=11.2m(),aD=11.2x(),k=11.1a.3a,aB=G.4D.44(11),aA=a.2i,az=L.6d(aA),ay={18:k,17:k};1g(1m.1a.1o){14 b=aB.36[aB.36.2j-1];"17"==az&&(ay.17+=1c.1K(b.1d.19)),"18"==az&&(ay.18+=1c.1K(b.1d.19))}14 c=a.1r.1a,av=c.1q,au=c.1l;"1p"==1m.1a.1q.1f&&av&&(av+=au);14 d=aD.1O.1d;12(11.1k).28(12(11.1O=1C.2b("2q")).27("9G").1t(V(d))).1t(V(d)),12(1C.3b).28(12(11.35=1C.2b("3p"))),O.3D(11.35,aD.1O.1d),O.3A(11.35);14 e=11.35.3y("2d");e.2U=11.2H,12(11.1O).28(11.35);2h(14 f=k+1,j=0;k>=j;j++){e.2Z=J.30(11.1a.1Y,G.4C(j*(1/f))*(11.1a.1S/f)),O.7m(e,{15:1M.1p.1d.15+2*j,19:1M.1p.1d.19+2*j,18:ay.18-j,17:ay.17-j,1q:av+j})}1g(a.1a.1o){14 g={x:ay.17,y:ay.18},ag=aB.36[0].1d,w=a.1a.1o,ar=au;ar+=0.5*w.15;14 h=a.1a.1q&&"1p"==a.1a.1q.1f?a.1a.1q.2E||0:0;h&&(ar+=h);14 i=au+h+0.5*w.15-0.5*ag.15,an=1c.1K(av>i?av-i:0),am=a.3O&&a.3O.1o||{x:0,y:0},ak=a.3O&&a.3O.5u||{x:0,y:0};1g(ar+=1c.22(an,a.1a.1o.1F&&a.1a.1o.1F[az&&/^(17|1V)$/.3r(az)?"y":"x"]||0),"18"==az||"20"==az){21(aA){1i"3Z":1i"4s":g.x+=ar+am.x-ak.x;1G;1i"4n":1i"5q":1i"4r":1i"5s":g.x+=0.5*1M.1p.1d.15+am.x;1G;1i"40":1i"4q":g.x+=1M.1p.1d.15-(ar-am.x+ak.x)}"20"==az&&(g.y+=1M.1p.1d.19);2h(14 j=0,ai=aB.36.2j;ai>j;j++){e.2Z=J.30(11.1a.1Y,G.4C(j*(1/f))*(11.1a.1S/f));14 k=aB.36[j];e.2o(),"18"==az?(e.3E(g.x,g.y-j),e.1e(g.x-0.5*k.1d.15,g.y-j),e.1e(g.x,g.y-j-k.1d.19),e.1e(g.x+0.5*k.1d.15,g.y-j)):(e.3E(g.x,g.y+j),e.1e(g.x-0.5*k.1d.15,g.y+j),e.1e(g.x,g.y+j+k.1d.19),e.1e(g.x+0.5*k.1d.15,g.y+j)),e.2p(),e.3e()}}1N{21(aA){1i"42":1i"41":g.y+=ar+am.y-ak.y;1G;1i"4u":1i"5t":1i"4o":1i"5r":g.y+=0.5*1M.1p.1d.19+am.y;1G;1i"4t":1i"4p":g.y+=1M.1p.1d.19-(ar-am.y+ak.y)}"1V"==az&&(g.x+=1M.1p.1d.15);2h(14 j=0,ai=aB.36.2j;ai>j;j++){e.2Z=J.30(11.1a.1Y,G.4C(j*(1/f))*(11.1a.1S/f));14 k=aB.36[j];e.2o(),"17"==az?(e.3E(g.x-j,g.y),e.1e(g.x-j,g.y-0.5*k.1d.15),e.1e(g.x-j-k.1d.19,g.y),e.1e(g.x-j,g.y+0.5*k.1d.15)):(e.3E(g.x+j,g.y),e.1e(g.x+j,g.y-0.5*k.1d.15),e.1e(g.x+j+k.1d.19,g.y),e.1e(g.x+j,g.y+0.5*k.1d.15)),e.2p(),e.3e()}}}}13 k(){14 a=11.3u();a.2P,a.1q;14 b=a.2x(),av=(11.2m(),11.1a.3a),au=12.1n({},b.1p.1d);au.15+=2*av,au.19+=2*av;14 e,ar;1g(a.1a.1o){14 g=G.4D.44(11);e=g.2K.1d,ar=e.19}14 h=K.6f(a,au,ar),ao=h.1d,an=h.1f,au=h.1p.1d,am=h.1p.1f,aj=b.1O.1f,ag=b.1p.1f,w={18:aj.18+ag.18-(am.18+av)+11.1a.1F.y,17:aj.17+ag.17-(am.17+av)+11.1a.1F.x},j=b.2S,f=b.2a.1d,d={18:0,17:0};1g(w.18<0){14 c=1c.34(w.18);d.18+=c,w.18=0,j.18+=c}1g(w.17<0){14 i=1c.34(w.17);d.17+=i,w.17=0,j.17+=i}14 l={19:1c.22(ao.19+w.18,f.19+d.18),15:1c.22(ao.15+w.17,f.15+d.17)},ai={17:1c.1K(d.17+b.1O.1f.17+b.1p.1f.17+a.1l+a.2w),18:1c.1K(d.18+b.1O.1f.18+b.1p.1f.18+a.1l+a.2w)},ah={1I:{1d:l},2a:{1d:f,1f:d},1k:{1d:ao,1f:w},1O:{1d:ao,1f:{18:1c.2c(an.18),17:1c.2c(an.17)}},1p:{1d:{15:1c.1K(au.15),19:1c.1K(au.19)},1f:{18:1c.2c(am.18),17:1c.2c(am.17)}},2S:j,2O:{1f:ai}};1b ah}13 a(){14 i=11.2x(),x=11.3u(),w=11.2m();1g(12(w.1k).1t(V(i.1I.1d)),12(w.5k).1t(12.1n(V(i.2a.1f),V(i.2a.1d))),x.32&&x.32.1t(V(i.1I.1d)),w.1a.1E){14 v=x.2x(),u=i.2a.1f,l=v.1E.1f;1g(12(x.1E).1t(V({18:u.18+l.18,17:u.17+l.17})),w.1a.1E.1x){14 j=v.33.1f;12(x.33.1k).1t(V({18:u.18+j.18,17:u.17+j.17}))}}12(11.1k).1t(12.1n(V(i.1k.1d),V(i.1k.1f))),12(11.1O).1t(V(i.1O.1d)),12(w.3i).1t(V(i.2O.1f))}1b{5l:p,1D:r,3g:q,1X:o,2m:t,3u:s,2x:k,7U:n,7T:m,5m:a}}());14 E={3t:{},1y:13(a){1g(!a){1b 1w}14 d=12(a).26("2A-23");1b d?11.3t[d]:1w},39:13(b){11.3t[b.23]=b},1D:13(d){14 c=11.1y(d);c&&(3T 11.3t[c.23],c.1D())}};12.1n(D.3S,13(){13 a(){1b N.1y(11.1h)[0]}13 l(){1b I.1y(11.1h)}13 k(){1b 11.1a.1S/(11.1a.3a+1)}13 j(){11.3g()}13 i(){11.1k&&(12(11.1k).1D(),11.1k=1w)}13 h(){11.3g();14 u=(11.2m(),11.3u()),t=u.2x().1E.1d,s=12.1n({},t),r=11.1a.3a;s.15+=2*r,s.19+=2*r,12(u.1E).6x(12(11.1k=1C.2b("2q")).27("9H")),12(1C.3b).28(12(11.4E=1C.2b("3p"))),O.3D(11.4E,s),O.3A(11.4E);14 q=11.4E.3y("2d");q.2U=11.2H,12(11.1k).28(11.4E);2h(14 p=s.15/2,o=s.19/2,n=t.19/2,m=r+1,b=0;r>=b;b++){q.2Z=J.30(11.1a.1Y,G.4C(b*(1/m))*(11.1a.1S/m)),q.2o(),q.2f(p,o,n+b,S(0),S(7A),!0),q.2p(),q.3e()}}1b{1X:h,1D:j,3g:i,2m:a,3u:l,7U:k}}());14 N={2y:{},1a:{48:"6y",4T:9I},7V:13(){14 a=["2z"];1Z.2I.3z&&(a.2v("7W"),11.4F&&12(1C.3b).4G("2z",11.4F),11.4F=1w),12.1B(a,13(d,e){12(1C.6z).9J(".3j .6q, .3j .7X-1I",e)}),11.4H&&(12(1P).4G("3D",11.4H),11.4H=1w),12(1C).4G("4I",N.2n.6A)},7k:13(){13 a(){11.7V();14 c=["2z"];1Z.2I.3z&&(c.2v("7W"),11.4F=13(){1b 3F 0},12(1C.3b).46("2z",11.4F)),12.1B(c,13(d,e){12(1C.6z).9K(".3j .6q, .3j .7X-1I",e,13(f){f.9L(),f.9M(),N.6B(12(f.1H).5y(".3j")[0]).1Q()})}),11.4H=12.1A(11.7Y,11),12(1P).46("3D",11.4H),12(1C).46("4I",N.2n.6A)}1b a}(),7Y:13(){11.5z&&(1P.6C(11.5z),11.5z=1w),11.5z=ac.4Y(12.1A(13(){14 a=11.3U();12.1B(a,13(d,c){c.1f()})},11),9N)},5A:13(a){14 g,h=12(a).26("2A-23");1g(!h){14 f=11.6B(12(a).5y(".3j")[0]);f&&f.1h&&(h=12(f.1h).26("2A-23"))}1b h&&(g=11.2y[h])?g:3F 0},65:13(d){14 c;1b ac.2s(d)&&(c=11.5A(d)),c&&c.1h},1y:13(a){14 f=[];1g(ac.2s(a)){14 d=11.5A(a);d&&(f=[d])}1N{12.1B(11.2y,13(c,b){b.1h&&12(b.1h).7Z(a)&&f.2v(b)})}1b f},6B:13(a){1g(!a){1b 1w}14 d=1w;1b 12.1B(11.2y,13(b,c){c.1L("1X")&&c.1k===a&&(d=c)}),d},9O:13(a){14 d=[];1b 12.1B(11.2y,13(c,b){b.1h&&12(b.1h).7Z(a)&&d.2v(b)}),d},25:13(a){1g(ac.2s(a)){14 f=a,d=11.1y(f)[0];d&&d.25()}1N{12(a).1B(12.1A(13(g,e){14 h=11.1y(e)[0];h&&h.25()},11))}},1Q:13(a){1g(ac.2s(a)){14 d=11.1y(a)[0];d&&d.1Q()}1N{12(a).1B(12.1A(13(f,e){14 g=11.1y(e)[0];g&&g.1Q()},11))}},3d:13(a){1g(ac.2s(a)){14 f=a,d=11.1y(f)[0];d&&d.3d()}1N{12(a).1B(12.1A(13(g,e){14 h=11.1y(e)[0];h&&h.3d()},11))}},5c:13(){12.1B(11.3U(),13(d,c){c.1Q()})},2Y:13(a){1g(ac.2s(a)){14 f=a,d=11.1y(f)[0];d&&d.2Y()}1N{12(a).1B(12.1A(13(g,e){14 h=11.1y(e)[0];h&&h.2Y()},11))}},3U:13(){14 a=[];1b 12.1B(11.2y,13(b,d){d.1T()&&a.2v(d)}),a},68:13(a){14 d=!1;1b ac.2s(a)&&12.1B(11.3U()||[],13(b,c){1b c.1h==a?(d=!0,!1):3F 0}),d},80:13(){14 d,a=0;1b 12.1B(11.2y,13(b,c){c.2t>a&&(a=c.2t,d=c)}),d},81:13(){11.3U().2j<=1&&12.1B(11.2y,13(a,d){d.1L("1X")&&!d.1a.2t&&12(d.1k).1t({2t:d.2t=+N.1a.4T})})},39:13(b){11.2y[b.23]=b},4J:13(a){14 f=11.5A(a);1g(f){14 e=12(f.1h).26("2A-23");3T 11.2y[e],f.1Q(),f.1D()}},1D:13(a){ac.2s(a)?11.4J(a):12(a).1B(12.1A(13(d,c){11.4J(c)},11))},7l:13(){12.1B(11.2y,12.1A(13(d,c){c.1h&&!ac.1h.56(c.1h)&&11.4J(c.1h)},11))},7j:13(){12.1B(11.2y,12.1A(13(d,c){c.1h&&11.4J(c.1h)},11)),11.2y={}},66:13(b){11.1a.48=b||"6y"},67:13(b){11.1a.4T=b||0},6a:13(){12.1B(11.2y,12.1A(13(d,c){c.1r&&c.1r.2u&&(c.1r.2u.6D(),c.1r.2u=1w),c.2g("3n",!1)},11)),X.7e()},6X:13(){13 k(c){14 b;1b b="2C"==12.1s(c)?{1h:n.2e&&n.2e.1h||a.2e.1h,2F:c}:Q(12.1n({},a.2e),c)}13 j(b){1b a=1Z.2L.82,n=Q(12.1n({},a),1Z.2L.6E),m=1Z.2L.6F.82,l=Q(12.1n({},m),1Z.2L.6F.6E),j=i,i(b)}13 i(j){j.2a=j.2a&&1Z.2L[j.2a]?j.2a:1Z.2L[N.1a.48]?N.1a.48:"6y";14 w=j.2a?12.1n({},1Z.2L[j.2a]||1Z.2L[N.1a.48]):{},ap=Q(12.1n({},n),w),ao=Q(12.1n({},ap),j);1g(ao.2l){14 x=n.2l||{},am=a.2l;"4K"==12.1s(ao.2l)&&(ao.2l={49:x.49||am.49,1s:x.1s||am.1s}),ao.2l=Q(12.1n({},am),ao.2l)}1g(ao.1p&&"2C"==12.1s(ao.1p)&&(ao.1p={1Y:ao.1p,1S:1}),ao.1l){14 z,ak=n.1l||{},aj=a.1l;z="2J"==12.1s(ao.1l)?{2E:ao.1l,1Y:ak.1Y||aj.1Y,1S:ak.1S||aj.1S}:Q(12.1n({},aj),ao.1l),ao.1l=0===z.2E?!1:z}1g(ao.1q){14 C;C="2J"==12.1s(ao.1q)?{2E:ao.1q,1f:n.1q&&n.1q.1f||a.1q.1f}:Q(12.1n({},a.1q),ao.1q),ao.1q=0===C.2E?!1:C}14 D,B=B=ao.1z&&ao.1z.1H||"2C"==12.1s(ao.1z)&&ao.1z||n.1z&&n.1z.1H||"2C"==12.1s(n.1z)&&n.1z||a.1z&&a.1z.1H||a.1z,y=ao.1z&&ao.1z.1I||n.1z&&n.1z.1I||a.1z&&a.1z.1I||N.2n.6G(B);1g(ao.1z?"2C"==12.1s(ao.1z)?D={1H:ao.1z,1I:N.2n.83(ao.1z)}:(D={1I:y,1H:B},ao.1z.1I&&(D.1I=ao.1z.1I),ao.1z.1H&&(D.1H=ao.1z.1H)):D={1I:y,1H:B},"2V"==ao.1H){14 f=L.2R(D.1H);D.1H="1R"==f?D.1H.6h(/(17|1V)/,"2D"):D.1H.6h(/(18|20)/,"2D")}ao.1z=D;14 e;1g("2V"==ao.1H?(e=12.1n({},a.1F),12.1n(e,1Z.2L.6E.1F||{}),j.2a&&12.1n(e,(1Z.2L[j.2a]||1Z.2L[N.1a.48]).1F||{}),e=N.2n.84(a.1F,a.1z,D.1H,!0),j.1F&&(e=12.1n(e,j.1F||{})),ao.4a=0):e={x:ao.1F.x,y:ao.1F.y},ao.1F=e,ao.1E&&ao.85){14 d=12.1n({},1Z.2L.6F[ao.85]),c=Q(12.1n({},l),d);1g(c.2B&&12.1B(["6s","6t"],13(o,v){14 u=c.2B[v],t=l.2B&&l.2B[v];1g(u.1p){14 s=t&&t.1p;1g("2J"==12.1s(u.1p)){u.1p={1Y:s&&s.1Y||m.2B[v].1p.1Y,1S:u.1p}}1N{1g("2C"==12.1s(u.1p)){14 q=s&&"2J"==12.1s(s.1S)&&s.1S||m.2B[v].1p.1S;u.1p={1Y:u.1p,1S:q}}1N{u.1p=Q(12.1n({},m.2B[v].1p),u.1p)}}}1g(u.1l){14 p=t&&t.1l;u.1l="2J"==12.1s(u.1l)?{1Y:p&&p.1Y||m.2B[v].1l.1Y,1S:u.1l}:Q(12.1n({},m.2B[v].1l),u.1l)}}),c.1x){14 b=l.1x&&l.1x.3Q&&l.1x.3Q==5O?l.1x:m.1x;c.1x.3Q&&c.1x.3Q==5O&&(b=Q(b,c.1x)),c.1x=b}ao.1E=c}1g(ao.1x){14 E;E="4K"==12.1s(ao.1x)?n.1x&&"4K"==12.1s(n.1x)?a.1x:n.1x?n.1x:a.1x:Q(12.1n({},a.1x),ao.1x||{}),"2J"==12.1s(E.1F)&&(E.1F={x:E.1F,y:E.1F}),ao.1x=E}1g(ao.1o){14 A={};A="4K"==12.1s(ao.1o)?Q({},a.1o):Q(Q({},a.1o),12.1n({},ao.1o)),"2J"==12.1s(A.1F)&&(A.1F={x:A.1F,y:A.1F}),ao.1o=A}1g(ao.37&&("2C"==12.1s(ao.37)?ao.37={5B:ao.37,86:!0}:"4K"==12.1s(ao.37)&&(ao.37=ao.37?{5B:"5e",86:!0}:!1)),ao.2e&&"2z-9P"==ao.2e&&(ao.87=!0,ao.2e=!1),ao.2e){1g(12.7o(ao.2e)){14 r=[];12.1B(ao.2e,13(h,g){r.2v(k(g))}),ao.2e=r}1N{ao.2e=[k(ao.2e)]}}1b ao.2T&&"2C"==12.1s(ao.2T)&&(ao.2T=[""+ao.2T]),ao.2w=0,ao.1U&&(1P.6H||(ao.1U=!1)),ao}14 a,n,m,l;1b j}()};N.2n=13(){13 B(n){14 m=L.2W(n),l=m[1],k=m[2],j=L.2R(n),b=12.1n({1R:!0,2k:!0},29[1]||{});1b"1R"==j?(b.2k&&(l=C[l]),b.1R&&(k=C[k])):(b.2k&&(k=C[k]),b.1R&&(l=C[l])),l+k}13 w(b){14 c=L.2W(b);1b B(c[1]+C[c[2]])}13 u(f,h){12(f.1k).1t({18:h.18+"2G",17:h.17+"2G"})}13 r(z,y,x,v){14 t=ag(z,y,x,v),s=x&&"2C"==88 x.1s?x.1s:"";1g(/9Q$/.3r(s),1===t.4b.4c){1b i(z,t),t}14 l=y,k=v,j={1R:!t.4b.1R,2k:!t.4b.2k},f={1R:!1,2k:!1},c=L.2R(y);1b((f.2k="1R"==c&&j.2k)||(f.1R="2k"==c&&j.1R))&&(l=B(y,f),k=B(v,f),t=ag(z,l,x,k),1===t.4b.4c)?(i(z,t),t):(t=p(t,z),i(z,t),t)}13 p(k,j){14 s=A(j),q=s.1d,o=s.1f,n=I.1y(j.1h).1r.1z[k.1z.1I].1I.1d,m=k.1f,l={18:0,17:0,3N:[]};1b o.17>m.17&&(l.17=o.17-m.17,l.3N.2v("17"),k.1f.17=o.17),o.18>m.18&&(l.18=m.18-o.18,l.3N.2v("18"),k.1f.18=o.18),o.17+q.15<m.17+n.15&&(l.17=o.17+q.15-(m.17+n.15),l.3N.2v("1V"),k.1f.17=o.17+q.15-n.15),o.18+q.19<m.18+n.19&&(l.18=o.18+q.19-(m.18+n.19),l.3N.2v("20"),k.1f.18=o.18+q.19-n.19),k.89=l,k}13 i(f,c){f.5x(c.1z.1I,c.4b.4x,c.89),u(f,c.1f)}13 g(b){1b b&&(/^2V|2z|3z$/.3r("2C"==88 b.1s&&b.1s||"")||b.5X>=0)}13 e(h,f,j){1b h>=f&&j>=h}13 d(k,j,s,q){14 o=e(k,s,q),n=e(j,s,q);1g(o&&n){1b j-k}1g(o&&!n){1b q-k}1g(!o&&n){1b j-s}14 m=e(s,k,j),l=e(q,k,j);1b m&&l?q-s:m&&!l?j-s:!m&&l?q-k:0}13 a(f,c){1b d(f.1f.17,f.1f.17+f.1d.15,c.1f.17,c.1f.17+c.1d.15)*d(f.1f.18,f.1f.18+f.1d.19,c.1f.18,c.1f.18+c.1d.19)}13 ak(h,f){14 j=h.1d.15*h.1d.19;1b j?a(h,f)/j:0}13 aj(h,f){14 l=L.2W(f),k=L.2R(f),j={17:0,18:0};1g("1R"==k){21(l[2]){1i"2D":1i"31":j.17=0.5*h.15;1G;1i"1V":j.17=h.15}"20"==l[1]&&(j.18=h.19)}1N{21(l[2]){1i"2D":1i"31":j.18=0.5*h.19;1G;1i"20":j.18=h.19}"1V"==l[1]&&(j.17=h.15)}1b j}13 ai(h){14 l=ac.1h.54(h),k=ac.1h.4Z(h),j={18:12(1P).51(),17:12(1P).52()};1b l.17+=-1*(k.17-j.17),l.18+=-1*(k.18-j.18),l}13 ag(a,b,d,e){14 f,6I,1W,n=I.1y(a.1h),1J=n.1a,1u=1J.1F,1v=g(d);1g(1v||!d){1g(1W={15:24,19:24},1v){14 h=ac.5W(d);f={18:h.y-0.5*1W.19+6,17:h.x-0.5*1W.15+6}}1N{14 i=a.1r.2F;f={18:(i?i.y:0)-0.5*1W.19+6,17:(i?i.x:0)-0.5*1W.15+6}}a.1r.2F={x:f.17,y:f.18}}1N{f=ai(d),1W={15:12(d).8a(),19:12(d).8b()}}1g(1J.1o&&"2V"!=1J.1H){14 j=L.2W(e),aC=L.2W(b),o=L.2R(e),aA=n.1r.1a,az=n.4B().1l.1d,ay=aA.1q,ax=aA.1l,aw=ay&&"1p"==1J.1q.1f?ay:0,av=ay&&"1l"==1J.1q.1f?ay:ay+ax,au=ax+aw+0.5*1J.1o.15-0.5*az.15,at=av>au?av-au:0;4L=1c.1K(ax+aw+0.5*1J.1o.15+at+1J.1o.1F["1R"==o?"x":"y"]),"1R"==o&&"17"==j[2]&&"17"==aC[2]||"1V"==j[2]&&"1V"==aC[2]?(1W.15-=2*4L,f.17+=4L):("2k"==o&&"18"==j[2]&&"18"==aC[2]||"20"==j[2]&&"20"==aC[2])&&(1W.19-=2*4L,f.18+=4L)}6I=12.1n({},f);14 k=1v?B(1J.1z.1I):1J.1z.1H,aq=aj(1W,k),ap=aj(1W,e);({18:f.18+aq.18+1u.y,17:f.17+aq.17+1u.x}),f={17:f.17+ap.17,18:f.18+ap.18};14 l=12.1n({},1u);l=D(l,k,e,"2V"==n.1a.1H),f.18+=l.y,f.17+=l.x;14 n=I.1y(a.1h),an=n.1r.1z,am=12.1n({},an[b]),al={x:0,y:0},j=L.2W(e);1g("2D"!=j[2]){14 o=o=L.2R(e),z=N.2n.6G(e,"2k"==o?{1R:!0,2k:!1}:{1R:!1,2k:!0});b==z&&(al.y=n.3O.5u.y,al.x=n.3O.5u.x)}14 x={18:f.18-am.2S.18-al.y,17:f.17-am.2S.17-al.x};am.1I.1f=x;14 v={1R:!0,2k:!0},t={x:0,y:0};1g(a.1a.37){14 s=A(a),m=a.1a.1x?G.1y(a.1h):n,c=m.2x().1I.1d;v.4c=ak({1d:c,1f:x},s),v.4c<1&&((x.17<s.1f.17||x.17+c.15>s.1f.17+s.1d.15)&&(v.1R=!1,t.x=x.17<s.1f.17?x.17-s.1f.17:x.17+c.15-(s.1f.17+s.1d.15)),(x.18<s.1f.18||x.18+c.19>s.1f.18+s.1d.19)&&(v.2k=!1,t.y=x.18<s.1f.18?x.18-s.1f.18:x.18+c.19-(s.1f.18+s.1d.19)))}1N{v.4c=1}v.4x=t;14 p=an[b].1O,3P=ak({1d:1W,1f:6I},{1d:p.1d,1f:{18:x.18+p.1f.18,17:x.17+p.1f.17}});1b{1f:x,4c:{1H:3P},4b:v,1z:{1I:b,1H:e}}}13 A(j){14 q={18:12(1P).51(),17:12(1P).52()},o=j.1a,n=o.1H;("2V"==n||"4W"==n)&&(n=j.1h);14 m=12(n).5y(o.37.5B).7F()[0];1g(!m||"5e"==o.37.5B){1b{1d:P.5e(),1f:q}}14 l=ac.1h.54(m),k=ac.1h.4Z(m);1b l.17+=-1*(k.17-q.17),l.18+=-1*(k.18-q.18),{1d:{15:12(m).6b(),19:12(m).6c()},1f:l}}14 C={17:"1V",1V:"17",18:"20",20:"18",2D:"2D",31:"31"};ab.3w&&ab.3w<9||ab.57&&ab.57<2||ab.62&&ab.62<9R;14 D=13(){14 f=[[-1,-1],[0,-1],[1,-1],[-1,0],[0,0],[1,0],[-1,1],[0,1],[1,1]],c={42:0,3Z:0,4n:1,5q:1,40:2,41:2,4o:5,5r:5,4p:8,4q:8,4r:7,5s:7,4s:6,4t:6,4u:3,5t:3};1b 13(o,n,m,l){14 k=f[c[n]],j=f[c[m]],b=[1c.6l(0.5*1c.34(k[0]-j[0]))?-1:1,1c.6l(0.5*1c.34(k[1]-j[1]))?-1:1];1b L.3f(n)||!L.3f(m)||l||("1R"==L.2R(m)?b[0]=0:b[1]=0),{x:b[0]*o.x,y:b[1]*o.y}}}();1b{1y:ag,5a:r,6G:B,83:w,8c:ai,84:D,6J:g}}(),N.2n.5d={x:0,y:0},N.2n.6A=13(b){N.2n.5d={x:b.5X,y:b.73}},N.3B=13(){13 a(){12(1C.3b).28(12(1C.2b("2q")).27("9S").28(12(1C.2b("2q")).27("3j").28(12(11.1k=1C.2b("2q")).27("8d"))))}13 j(c){1b{15:12(c).6b(),19:12(c).6c()}}13 i(c){14 g=j(c),f=c.53;1b f&&12(f).1t({15:g.15+"2G"})&&j(c).19>g.19&&g.15++,12(f).1t({15:"6i%"}),g}13 h(t,s,r){(!11.1k||11.1k&&!ac.1h.56(11.1k))&&11.1X();14 q=t.1a,p=12.1n({1U:!1},29[3]||{});!q.8e&&!ac.2s(s)||12(s).26("8f")||(q.8e&&"2C"==12.1s(s)&&(t.3k=12("#"+s)[0],s=t.3k),!t.4d&&s&&ac.1h.56(s)&&(12(t.3k).26("8g",12(t.3k).1t("8h")),t.4d=1C.2b("2q"),12(t.3k).6x(12(t.4d).1Q())));14 o=1C.2b("2q");12(11.1k).28(12(o).27("7E 9T").28(s)),ac.2s(s)&&12(s).25(),q.2a&&12(o).27("9U"+t.1a.2a);14 n=12(o).6n("8i[4y]").9V(13(){1b!(12(11).3q("19")&&12(11).3q("15"))});1g(n.2j>0&&!t.1L("3R")){t.2g("3R",!0),q.1U&&(p.1U||t.1U||(t.1U=t.6K(q.1U)),t.1L("1T")&&(t.1f(),12(t.1k).25()),t.1U.6L());14 m=0,l=1c.22(9W,9X*(n.2j||0));t.2r("3R"),t.4e("3R",12.1A(13(){n.1B(13(){11.6M=13(){}}),m>=n.2j||(11.5C(t,o),r&&r())},11),l),12.1B(n,12.1A(13(g,e){14 b=2Q 9Y;b.6M=12.1A(13(){b.6M=13(){};14 w=b.15,v=b.19,u=12(e).3q("15"),f=12(e).3q("19");u&&f||(!u&&f?(w=1c.2c(f*w/v),v=f):!f&&u&&(v=1c.2c(u*v/w),w=u),12(e).3q({15:w,19:v}),m++),m==n.2j&&(t.2r("3R"),t.1U&&(t.1U.1D(),t.1U=1w),t.1L("1T")&&12(t.1k).1Q(),11.5C(t,o),r&&r())},11),b.4y=e.4y},11))}1N{11.5C(t,o),r&&r()}}13 d(e,l){14 k=i(l),g={15:k.15-(2X(12(l).1t("2w-17"))||0)-(2X(12(l).1t("2w-1V"))||0),19:k.19-(2X(12(l).1t("2w-18"))||0)-(2X(12(l).1t("2w-20"))||0)};e.1a.3s&&"2J"==12.1s(e.1a.3s)&&g.15>e.1a.3s&&(12(l).1t({15:e.1a.3s+"2G"}),k=i(l)),e.1r.2P=k,12(e.3i).8j(l)}1b{1X:a,4f:h,5C:d,6p:i}}(),12.1n(M.3S,13(){13 1u(f,e,g){11.1r.3m[f]=ac.4Y(e,g)}13 1v(b){1b 11.1r.3m[b]}13 1j(b){11.1r.3m[b]&&(1P.6C(11.1r.3m[b]),3T 11.1r.3m[b])}13 1M(){12.1B(11.1r.3m,13(e,c){1P.6C(c)}),11.1r.3m=[]}13 1m(g,m,l,j){m=m;14 h=12.1A(l,j||11);11.1r.5R.2v({1h:g,8k:m,8l:h}),12(g).46(m,h)}13 aD(){12.1B(11.1r.5R,13(e,f){12(f.1h).4G(f.8k,f.8l)})}13 aC(e,c){11.1r.2B[e]=c}13 aB(b){1b 11.1r.2B[b]}13 aA(){11.2M(11.1h,"4A",11.5D),11.2M(11.1h,"5n",12.1A(13(b){11.6N(b)},11)),11.1a.2T&&12.1B(11.1a.2T,12.1A(13(e,g){14 f=!1;"2z"==g&&(11.1a.2e&&12.1B(11.1a.2e,13(j,h){1b"4W"==h.1h&&"2z"==h.2F?(f=!0,!1):3F 0}),11.2g("5S",f)),11.2M(11.1h,g,"2z"==g?f?11.3d:11.25:12.1A(13(){11.8m()},11))},11)),11.1a.2e?12.1B(11.1a.2e,12.1A(13(e,g){14 f;21(g.1h){1i"4W":1g(11.1L("5S")&&"2z"==g.2F){1b}f=11.1h;1G;1i"1H":f=11.1H}f&&11.2M(f,g.2F,"2z"==g.2F?11.1Q:12.1A(13(){11.6O()},11))},11)):11.1a.8n&&11.1a.2T&&!12.6P("2z",11.1a.2T)>-1&&11.2M(11.1h,"5n",12.1A(13(){11.2r("25")},11));14 c=!1;!11.1a.9Z&&11.1a.2T&&((c=12.6P("4I",11.1a.2T)>-1)||12.6P("5E",11.1a.2T)>-1)&&"2V"==11.1H&&11.2M(11.1h,c?"4I":"5E",13(b){11.1L("4V")&&11.1f(b)})}13 az(){11.2M(11.1k,1Z.2I.3z?"5E":"4A",11.5D),11.2M(11.1k,"5n",11.6N),11.2M(11.1k,1Z.2I.3z?"5E":"4A",12.1A(13(){11.5F("4M")||11.25()},11)),11.1a.2e&&12.1B(11.1a.2e,12.1A(13(e,g){14 f;21(g.1h){1i"1I":f=11.1k}f&&11.2M(f,g.2F,g.2F.3o(/^(2z|4I|4A)$/)?11.1Q:12.1A(13(){11.6O()},11))},11))}13 ay(f,e,h){14 g=I.1y(11.1h);g&&g.5x(f,e,h)}13 ax(e){14 c=I.1y(11.1h);c&&c.4z(e)}13 av(){11.4z(11.1a.1z.1I)}13 au(){12(11.1k=1C.2b("2q")).27("3j"),11.8o()}13 ar(){11.1X();14 b=I.1y(11.1h);b?b.1X():(2Q H(11.1h),11.2g("4V",!0))}13 ap(){11.1L("1X")||(12(1C.3b).28(12(11.1k).1t({17:"-5G",18:"-5G",2t:11.2t}).28(12(11.5k=1C.2b("2q")).27("a0")).28(12(11.3i=1C.2b("2q")).27("8d"))),12(11.1k).27("a1"+11.1a.2a),11.1a.87&&(12(11.1h).27("8p"),11.2M(1C.6z,"2z",12.1A(13(e){1g(11.1T()){14 f=12(e.1H).5y(".3j, .8p")[0];(!f||f&&f!=11.1k&&f!=11.1h)&&11.1Q()}},11))),1Z.2I.4k&&(11.1a.4N||11.1a.4a)&&(11.5H(11.1a.4N),12(11.1k).27("6Q")),11.8q(),11.2g("1X",!0),N.39(11))}13 al(){14 b;11.2O,11.4d&&11.3k&&((b=12(11.3k).26("8g"))&&12(11.3k).1t({8h:b}),12(11.4d).6x(11.3k).1D(),11.4d=1w)}13 aj(){ac.4h(12.1A(13(){11.8r()},11)),11.8s(),11.6R(),ac.4h(12.1A(13(){12(11.1k).6n("8i[4y]").4G("a2")},11)),I.1D(11.1h),11.1L("1X")&&11.1k&&(12(11.1k).1D(),11.1k=1w);14 f,e="5Q";(f=12(11.1h).26(e))&&12(11.1h).3q("5P",f).8t("5Q"),12(11.1h).8t("2A-23")}13 ah(e){14 f=12.1n({4O:11.1a.4O,1U:!1},29[1]||{});11.1X(),11.1L("1T")&&12(11.1k).1Q(),N.3B.4f(11,e,12.1A(13(){14 c=11.1L("1T");c||11.2g("1T",!0),11.8u(),c||11.2g("1T",!1),11.1L("1T")&&(12(11.1k).1Q(),11.1f(),11.5I(),12(11.1k).25()),11.2g("3n",!0),f.4O&&f.4O(11.3i.4P,11.1h),f.4Q&&f.4Q()},11),{1U:f.1U})}13 B(e){14 g,f={4j:11.2O,1s:11.1a.2l.1s,26:11.1a.2l.26||{},8v:11.1a.2l.8v||"8j"};1g(!(11.1L("2u")||11.1a.2l.49&&11.1L("3n"))){1g(11.1a.2l.49&&(g=X.1y(f))){1b 11.6S(g,{4Q:12.1A(13(){11.1L("1T")&&11.1a.4g&&11.1a.4g(11.3i.4P,11.1h)},11)}),3F 0}11.2g("2u",!0),11.1a.1U&&(11.1U?11.1U.6L():(11.1U=11.6K(11.1a.1U),11.2g("3n",!1)),11.1f(e)),11.1r.2u&&(11.1r.2u.6D(),11.1r.2u=1w),11.1r.2u=12.2l(12.1n({},f,{a3:12.1A(13(h,l,j){0!==j.a4&&(X.5a(f,j.59),11.6S(j.59,{4Q:12.1A(13(){11.2g("2u",!1),11.1L("1T")&&11.1a.4g&&11.1a.4g(11.3i.4P,11.1h),11.1U&&(11.1U.1D(),11.1U=1w)},11)}))},11)}))}}13 aw(e){14 f=12.1n({1U:11.1a.1U&&11.1U},29[1]||{});11.4f(e,f)}13 at(){14 e=1C.2b("2q");12(e).26("8f",!0);14 g=6H.5b(e,12.1n({},29[0]||{})),f=6H.6e(e);1b 12(e).1t(V(f)),11.4f(e,{4O:!1,4Q:13(){g.6L()}}),g}13 ao(){1g(11.1L("1X")&&!11.1a.2t){14 c=N.80();c&&c!=11&&11.2t<=c.2t&&12(11.1k).1t({2t:11.2t=c.2t+1})}}13 an(){14 b=I.1y(11.1h);b&&(b.2Y(),11.1T()&&11.1f())}13 am(e){1g(1Z.2I.4k){e=e||0;14 c=11.1k.a5;c.a6=e+"5J",c.a7=e+"5J",c.a8=e+"5J",c.a9=e+"5J"}}13 ak(c){11.2r("1Q"),11.2r("4M"),11.1L("1T")||11.5F("25")||11.4e("25",12.1A(13(){11.2r("25"),11.25(c)},11),11.1a.8n||1)}13 ai(e){1g(11.2r("1Q"),11.2r("4M"),!11.1T()){1g("13"==12.1s(11.2O)||"13"==12.1s(11.1r.5K)){"13"!=12.1s(11.1r.5K)&&(11.1r.5K=11.2O);14 f=11.1r.5K(11.1h)||!1;1g(f!=11.1r.5T&&(11.1r.5T=f,11.2g("3n",!1),11.6R()),11.2O=f,!f){1b}}11.1a.ae&&N.5c(),11.2g("1T",!0),11.1a.2l?11.8w(e):11.1L("3n")||11.4f(11.2O),11.1L("4V")&&11.1f(e),11.5I(),11.1a.5L&&ac.4h(12.1A(13(){11.5D()},11)),"13"==12.1s(11.1a.4g)&&(!11.1a.2l||11.1a.2l&&11.1a.2l.49&&11.1L("3n"))&&11.1a.4g(11.3i.4P,11.1h),1Z.2I.4k&&(11.1a.4N||11.1a.4a)&&(11.5H(11.1a.4N),12(11.1k).27("8x").8y("6Q")),12(11.1k).25()}}13 ag(){11.2r("25"),11.1L("1T")&&(11.2g("1T",!1),1Z.2I.4k&&(11.1a.4N||11.1a.4a)?(11.5H(11.1a.4a),12(11.1k).8y("8x").27("6Q"),11.4e("4M",12.1A(11.6T,11),11.1a.4a)):11.6T(),11.1r.2u&&(11.1r.2u.6D(),11.1r.2u=1w,11.2g("2u",!1)))}13 v(){11.1L("1X")&&(12(11.1k).1t({17:"-5G",18:"-5G"}),N.81(),"13"!=12.1s(11.1a.8z)||11.1U||11.1a.8z(11.3i.4P,11.1h))}13 u(){11.2r("25"),!11.5F("1Q")&&11.1L("1T")&&11.4e("1Q",12.1A(13(){11.2r("1Q"),11.2r("4M"),11.1Q()},11),11.1a.af||1)}13 k(b){11[11.1T()?"1Q":"25"](b)}13 i(){1b 11.1L("1T")}13 d(){11.2g("4U",!0),11.1L("1T")&&11.5I(),11.1a.5L&&11.2r("6U")}13 a(){11.2g("4U",!1),11.1a.5L&&11.4e("6U",12.1A(13(){11.2r("6U"),11.1L("4U")||11.1Q()},11),11.1a.5L)}14 r=13(j){1g(11.1T()){14 q;1g("2V"==11.1a.1H){14 p=N.2n.6J(j),o=N.2n.5d;1g(p){o.x||o.y?(11.1r.2F={x:o.x,y:o.y},q=1w):q=j}1N{1g(o.x||o.y){11.1r.2F={x:o.x,y:o.y}}1N{1g(!11.1r.2F){14 n=N.2n.8c(11.1h);11.1r.2F={x:n.17,y:n.18}}}q=1w}}1N{q=11.1H}1g(N.2n.5a(11,11.1a.1z.1I,q,11.1a.1z.1H),j&&N.2n.6J(j)){14 m={15:12(11.1k).8a(),19:12(11.1k).8b()},l=ac.5W(j),n=ac.1h.54(11.1k);l.x>=n.17&&l.x<=n.17+m.15&&l.y>=n.18&&l.y<=n.18+m.19&&ac.4h(12.1A(13(){11.2r("1Q")},11))}}};1b{1X:ap,70:au,8u:ar,8o:aA,8q:az,25:ai,1Q:ag,6T:v,3d:k,1T:i,8m:ak,6O:u,5H:am,2g:aC,1L:aB,5D:d,6N:a,5F:1v,4e:1u,2r:1j,8s:1M,2M:1m,8r:aD,5x:ay,4z:ax,as:av,2Y:an,4f:ah,8w:B,6S:aw,6K:at,1f:r,5I:ao,6R:al,1D:aj}}()),1Z.3A()}(4i);',62,660,"|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||this|ba|function|var|width||left|top|height|options|return|Math|dimensions|lineTo|position|if|element|case|aG|container|border|aE|extend|stem|background|radius|_cache|type|css|aI|aH|null|shadow|get|hook|proxy|each|document|remove|closeButton|offset|break|target|tooltip|aJ|ceil|getState|aF|else|bubble|window|hide|horizontal|opacity|visible|spinner|right|aL|build|color|Tipped|bottom|switch|max|uid||show|data|addClass|append|arguments|skin|createElement|round||hideOn|arc|setState|for|_hookPosition|length|vertical|ajax|getTooltip|Position|beginPath|closePath|div|clearTimer|isElement|zIndex|xhr|push|padding|getOrderLayout|tooltips|click|tipped|states|string|middle|size|event|px|_globalAlpha|support|number|box|Skins|setEvent|180|content|contentDimensions|new|getOrientation|anchor|showOn|globalAlpha|mouse|split|parseInt|refresh|fillStyle|hex2fill|center|iframeShim|closeButtonShadow|abs|bubbleCanvas|blurs|containment|PI|add|blur|body|scripts|toggle|fill|isCenter|cleanup|cornerOffset|contentElement|t_Tooltip|inlineContent|_stemCorrection|timers|updated|match|canvas|attr|test|maxWidth|shadows|getSkin|_adjustment|IE|indexOf|getContext|touch|init|UpdateQueue|devicePixelRatio|resize|moveTo|void|charAt|toLowerCase|diameter|hookPosition|layout|stemLayout|aK|sides|_corrections|aS|constructor|preloading_images|prototype|delete|getVisible|x1|y1|x2|y2|topleft|topright|righttop|lefttop|math|getLayout||bind|aO|defaultSkin|cache|fadeOut|contained|overlap|inlineMarker|setTimer|update|onShow|defer|jQuery|url|cssTransitions|items|createFillStyle|topmiddle|rightmiddle|rightbottom|bottomright|bottommiddle|bottomleft|leftbottom|leftmiddle|regex|getBorderDimensions|correction|src|setHookPosition|mouseenter|getStemLayout|transition|Stem|closeButtonCanvas|_void|unbind|_onWindowResizeHandler|mousemove|_remove|boolean|sideOffset|fadeTransition|fadeIn|afterUpdate|firstChild|callback|cos|000|startingZIndex|active|skinned|self|bb|delay|cumulativeScrollOffset||scrollTop|scrollLeft|parentNode|cumulativeOffset||isAttached|Gecko|Chrome|responseText|set|create|hideAll|mouseBuffer|viewport|min|G_vmlCanvasManager|getCenterBorderDimensions|substring|skins|skinElement|prepare|order|mouseleave|rotate|borderRadius|topcenter|rightcenter|bottomcenter|leftcenter|corner|corrections|aQ|setHookPositionAndStemCorrection|closest|_resizeTimer|_getTooltip|selector|_updateTooltip|setActive|touchmove|getTimer|10000px|setFadeDuration|raise|ms|contentFunction|hideAfter|console|in|Object|title|tipped_restore_title|events|toggles|fnCallContent|call|apply|pointer|pageX|RegExp|parseFloat|Opera|opera|WebKit|required|available|findElement|setDefaultSkin|setStartingZIndex|isVisibleByElement|undefined|clearAjaxCache|innerWidth|innerHeight|getSide|getDimensions|getBubbleLayout|nullifyCornerOffset|replace|100|defaultCloseButton|hoverCloseButton|floor|prepend|find|auto|getMeasureElementDimensions|t_Close|drawCloseButtonState|default|hover|_drawBackgroundPath|aT|aP|before|dark|documentElement|_mouseBufferHandler|getByTooltipElement|clearTimeout|abort|reset|CloseButtons|getInversedPosition|Spinners|aM|isPointerEvent|insertSpinner|play|onload|setIdle|hideDelayed|inArray|t_hidden|_restoreInlineContent|afterAjaxUpdate|_hide|idle|warn|_stemPosition|createOptions|getAttribute|getElementById|_preBuild|Array|concat|pageY|version|AppleWebKit|MobileSafari|check|pow|Za|checked|notified|toUpperCase|param|clear|try|DocumentTouch|catch|TransitionEvent|removeAll|startDelegating|removeDetached|drawRoundedRectangle|fillRect|isArray|Gradient|addColorStops|positions|toOrientation|side|toDimension|isCorner|atan|red|green|blue|360|drawBubble|drawCloseButton|createHookCache|t_ContentContainer|first|25000px|setStemCorrection|setAdjustment|closeButtonShift|closeButtonMouseover|closeButtonMouseout|CloseButton|stemOffset|backgroundRadius|_drawBorderPath|aU|aR|setGlobalAlpha|drawBackground|getBlurOpacity|stopDelegating|touchstart|close|onWindowResize|is|getHighestTooltip|resetZ|base|getTooltipPositionFromTarget|adjustOffsetBasedOnHooks|closeButtonSkin|flip|hideOnClickOutside|typeof|adjustment|outerWidth|outerHeight|getAbsoluteOffset|t_Content|inline|isSpinner|tipped_restore_inline_display|display|img|html|eventName|handler|showDelayed|showDelay|createPreBuildObservers|t_hideOnClickOutside|createPostBuildObservers|clearEvents|clearTimers|removeData|_buildSkin|dataType|ajaxUpdate|t_visible|removeClass|onHide|log|sqrt|object|setAttribute|slice|wrap|nodeType|setTimeout|do|while|exec|attachEvent|MSIE|KHTML|rv|Apple|Mobile|Safari|navigator|userAgent|fn|jquery|z_|z0|requires|_t_uid_||ontouchstart|instanceof|WebKitTransitionEvent|OTransitionEvent|createEvent|ready|scale|initElement|drawPixelArray|createLinearGradient|addColorStop|spacing|rgba|join|fff|255|hue|saturation|brightness|0123456789abcdef|hex2rgb|getSaturatedBW|init_|t_Bubble|iframe|t_iframeShim|frameBorder|javascript|15000px|t_CloseButtonShift|lineCap|t_CloseState|translate|stemCorrection|270|lineWidth|sin|setOpacity|getCenterBorderDimensions2|acos|t_Shadow|t_ShadowBubble|t_CloseButtonShadow|999999|undelegate|delegate|preventDefault|stopPropagation|200|getBySelector|outside|move|530|t_UpdateQueue|t_clearfix|t_Content_|filter|8000|750|Image|fixed|t_Skin|t_Tooltip_|load|success|status|style|MozTransitionDuration|webkitTransitionDuration|OTransitionDuration|transitionDuration|||||hideOthers|hideDelay|||||||||||||resetHookPosition|||||||||||".split("|"),0,{}));var newsChannel="newsFeed";var newsDialogOidIsOpen=0;var WALL_POST_TYPE_NEWS=3;var PARAM_NEWS_ACTION_INITIAL_LOAD=0;var PARAM_NEWS_ACTION_GET_OLD_HISTORY=1;var PARAM_NEWS_ACTION_GET_NEW_HISTORY=2;var PARAM_NEWS_ACTION_SAVE_NEW_FILTERS=3;var PARAM_NEWS_PAGE_LOCATION_DASHBOARD=0;var PARAM_NEWS_PAGE_LOCATION_FOREX_NEWS=1;var showMoreClicked=false;function newsDiscuss(d,c,a,b){if(newsDialogOidIsOpen!=d||b){if(newsDialogOidIsOpen!=0){closenewsDiscuss(d)}if(d!=undefined){fxAjax.sendRequest(fxVars.newsRedirect+"id="+d+"&discuss=true",{params:{oid:d,scrollElementId:c,postOid:a},loader:false,callback:"newsDiscussResponse"})}}else{if(c!=null){goToNewsNotification(c,"newsDiscussion",a)}}}function closenewsDiscuss(a){newsDialogOidIsOpen=0;$JD.destroy("#newsDialog");fxWebsocket.unsubscribe(newsChannel,a)}function updateNewsSubscribeCheckboxElement(a,b,c){if(c){a.checked="checked";a.onchange=function(){feedUnsubscribe(0,WALL_POST_TYPE_NEWS,b)}}else{a.checked="";a.onchange=function(){feedSubscribe(0,WALL_POST_TYPE_NEWS,b)}}}function hideMainScroller(){jQuery("body").css({overflow:"hidden"})}function showMainScroller(){jQuery("body").css({overflow:"inherit"});Tipped.hideAll()}function newsDiscussResponse(a,f){if(!a.error&&(!newsDialogOidIsOpen||!$J("#newsDialog").hasClass("in"))){var g=a.content.subscribedToNewsFeed;var c=new Element("input",{type:"checkbox",id:"subscribeToNews",checked:g});updateNewsSubscribeCheckboxElement(c,f.oid,g);$J("#newsDialogBody").html(a.content.data);var b={};b.width=$J(window).width()-100;b.height=$J(window).height()-100;b.resizable=false;b.title=a.content.title+" <a target='_blank' href='"+a.content.url+"'>("+$T("tLink")+")</a>";b.modal=true;b.close=function(h,k){closenewsDiscuss(f.oid);Tipped.hideAll()};b.open=function(h,k){newsDialogOidIsOpen=f.oid;$J(this).parent().css("z-index",1100).css("position","fixed").css("top",50).css("left",50);$J(".ui-widget-overlay").css("z-index",1050).bind("click",function(){closenewsDiscuss(f.oid);showMainScroller()});if(hasText($F("userId"))){$J(this).parent().children(".ui-dialog-titlebar").append(jQuery("<span id='subscribeToNewsSpan' style='float: right;padding-right:182px'></span>").append(c).append(" <label for='subscribeToNews'>"+$T("tFeedSubscribe")+"</label>"))}};b.create=function(h,k){hideMainScroller()};b.beforeClose=function(h,k){showMainScroller()};$J("#newsIframeData").append($J("#newsIframe").attr("src",a.content.url).css("width",b.width-350).css("height",b.height-50)).css("scrolling","yes");var d=$J("#newsDiscussTable");$J("#newsDialogBody").append(d);$JD.create("#newsDialog",b);$J("#newsDiscussion").height(b.height-50);newsChannelSubscribe(f.oid);createNewsFeedScroller(f.oid);if(f.scrollElementId!=null){goToNewsNotification(f.scrollElementId,"newsDiscussion",f.postOid)}}}function newsChannelSubscribe(f){var c=0;var d=$$PT("#newsUserMessages [time]");for(var a=0;a<d.length;a++){var b=Number(d[a].getAttribute("time"));c=(b>c)?b:c}if(c==0){c=getMetaContent("server-timestamp")}if(atmosphereIsConnected){fxWebsocket.subscribe(newsChannel,f,c,null)}else{onOpenArray.push("fxWebsocket.subscribe('"+newsChannel+"','"+f+"','"+c+"','"+null+"')")}}function newsCallBack(data){try{var type=data.type;var uid=Number($F("userId"));switch(type){case"comment":var commnet=data.data;var postOid=data.post;var commentOid=Number(data.oid);var commentObject=$PT("newsComment"+commentOid);var pending=data.pending;var from=Number(data.from);var objectId=data.objectId;var commentText=$PT("newsCommentText"+postOid);if(commentText!=null){commentText.style.height="15px"}if(pending&&from==uid){break}if(commentObject==null){updateCommentsCount(objectId);if(postOid!=null){var post=$PT("newsPost"+postOid);if(post!=null){addNewsComment(postOid,commnet)}if(uid!=from){goToNotification("newsComment"+commentOid,false,false,"newsDiscussion")}else{if(eval($F("userFeedAutoSubscribe"))){updateNewsSubscribeCheckboxElement($PT("subscribeToNews"),data.objectId,true)}}}}break;case"post":post=data.post;post=changeAvatar(post);var lastOid=Number(data.lastOid);from=Number(data.from);objectId=data.objectId;if($PT("newsPost"+lastOid)==null){updateCommentsCount(objectId);createNewsPost(lastOid,post,lastChartId);if(uid!=from){goToNotification("newsPost"+commentOid,false,false,"newsDiscussion")}else{if(eval($F("userFeedAutoSubscribe"))){updateNewsSubscribeCheckboxElement($PT("subscribeToNews"),data.objectId,true)}}}break;case"removePost":var oid=data.oid;post=$PT("newsPost"+oid);var postText=$PT("newsPostText"+oid);if(postText!=null){postText.remove()}if(post!=null){post.remove();updateFeedScrooler("newsDiscussion",false)}break;case"removeComment":var oid=data.oid;var postId=data.postId;var comment=$PT("newsComment"+oid);if(comment!=null){comment.remove();updateFeedScrooler("newsDiscussion",false)}break}}catch(e){}}function createNewsPost(a,f,c){if($PT("newsPost"+a)==null){var b=new Element("div",{style:"display:none"});var d=new Element("div",{});b.innerHTML=f;d.innerHTML=f;$PT("newsUserMessages").insertBefore(b,$PT("newsUserMessages").firstChild);feedSlideDown(b,"newsDiscussion");runAjaxScripts(f)}}function createNewsFeedScroller(a){jQuery("#newsDiscussion").jScrollPane({hijackInternalLinks:true,animateScroll:true,verticalGutter:0}).bind("jsp-scroll-y",function(d,c,f,b){if(b){showMoreWallPost(null,WALL_POST_TYPE_NEWS,a,"")}});jQuery("#newsDiscussion").hover(function(){jQuery(document).bind("mousewheel DOMMouseScroll",function(b){stopWheel(b)})},function(){if(!isShown("newsFeedLoader")){jQuery(document).unbind("mousewheel DOMMouseScroll")}})}function changeNewsPostChoice(b){var a=$F("userId");if(hasText(a)&&a!=0){if($PT("newsPostText"+b).style.display=="none"){showElement("newsPostText"+b);$PT("newsCommentText"+b).focus()}else{hideElement("newsPostText"+b);$PT("newsCommentText"+b).blur()}showElement("userCommentNews");updateFeedScrooler("newsDiscussion",false)}}function addNewsComment(a,f){var b=$PT("newsPost"+a);if(b!=null){var c=new Element("div",{style:"display:none"});var d=new Element("div",{});c.innerHTML=f;d.innerHTML=f;b.appendChild(c);feedSlideDown(c,"newsDiscussion")}}function goToNewsNotification(a,c,b){var g;if($PT(a)!=null){goToChartNotification(a,false,true,c)}else{if(showMoreBloack){if($PT("newsPost"+b)==null){var d=$$PT("#newsUserMessages [postId]");g=d[d.length-1].getAttribute("postId")}if(Number(g)>b){var f=["firstPostOid=",b];if(g!=null){f.push("&lastPostOid="+g)}showMoreBloack=false;fxAjax.sendRequest(fxVars.getWallPosts+f.join(""),{params:{lastPostOid:g,firstPostOid:b,objectId:a},loader:false,callback:"loadNewsNotificationResponse"})}else{jQuery("#newsUserMessages [lastOid]").each(function(k){var l=Number(this.getAttribute("firstOid"));var h=Number(this.getAttribute("lastOid"));if(b<h&&b>l){getWallPostsBetweenOids(l,h,this,"",a)}})}}}}function loadNewsNotificationResponse(a,f){try{if(!a.error){var g=new Element("div",{style:"height: 100%; border-left: 3px solid orange; left: 0px; top: 0px;z-index:1",className:"absolute"});var b=a.content.post;if(f.lastPostOid==null){$PT("newsPost"+f.firstPostOid).innerHTML=b}else{var c=new Element("span",{});c.innerHTML=b;$PT("newsUserMessages").appendChild(c)}if(a.content.lastTime!=null){$PT("newsShowMoreWallPost").setAttribute("lastTime",a.content.lastTime)}$PT(f.objectId).insertBefore(g,$PT(f.objectId).firstChild);$(g).fadeOut(3000);updateFeedScrooler("newsDiscussion");moveScroller("newsDiscussion",f.objectId)}}catch(d){}showMoreBloack=true}jQuery(window).resize(function(){if(newsDialogOidIsOpen!=0){newsDiscuss(newsDialogOidIsOpen,null,null,true)}});function updateCommentsCount(a){var c=jQuery("#newsCommentsCount"+a);if(c!=null){var d=Number(c.attr("count"))+1;c.attr("count",d);var b=c.html();c.html(b.replace(/(\d+)/g,d))}}function initNewsFilter(a){jQuery(function(){jQuery(".treeRoot").jstree({checkbox:{keep_selected_style:false},plugins:["checkbox"]})});jQuery(".treeRoot").bind("changed.jstree",function(c,b){if(b.action=="deselect_node"||b.action=="select_node"||b.action=="select_all"||b.action=="deselect_all"){if(b.action=="select_all"||b.action=="deselect_all"){initTreeIcons()}if(!(b.action=="select_all"||b.action=="deselect_all")){saveNews(a)}}if(b.action=="ready"){initTreeIcons()}});jQuery(".treeRoot").bind("after_open.jstree after_close.jstree",function(d,c){var b=jQuery(this).find("i.fa");if(d.type=="after_close"){jQuery(b).switchClass("fa-minus-square-o","fa-plus-square-o")}else{if(d.type=="after_open"){jQuery(b).switchClass("fa-plus-square-o","fa-minus-square-o")}}});jQuery(".treeRoot").bind("ready.jstree",function(d,c){var b=jQuery(this).find("li[id^='languageNews']");if(jQuery(b).hasClass("jstree-closed")){jQuery(b).children("i").switchClass("jstree-icon","fa fa-plus-square-o fa-lg")}else{if(jQuery(b).hasClass("jstree-open")){jQuery(b).children("i").switchClass("jstree-icon","fa fa-minus-square-o fa-lg")}}})}function initTreeIcons(){jQuery("li[id^='languageNews']").each(function(a,b){if(jQuery(this).hasClass("jstree-closed")){jQuery(this).children("i").switchClass("jstree-icon","fa fa-plus-square-o fa-lg")}else{if(jQuery(this).hasClass("jstree-open")){jQuery(this).children("i").switchClass("jstree-icon","fa fa-minus-square-o fa-lg")}}})}function selectOrClearAllTreeNews(b,a,c){selectOrClearAllTree(b,a);saveNews(c)}function getUserCheckedProviderOids(){var f=jQuery(".treeRoot");var a={checkedProviderArr:[],checkedLanguageArr:[]};var d=[];for(var c=0;c<f.length;c++){d=jQuery(f[c]).jstree("get_selected");for(var b=0;b<d.length;b++){if(d[b].indexOf("rssNewsProvider")>=0){a.checkedProviderArr.push(d[b].replace("rssNewsProvider",""))}else{if(d[b].indexOf("languageNews")>=0){a.checkedLanguageArr.push(d[b].replace("languageNews",""))}}}}return a}function getNews(c){if(!busy){try{busy=true;var f=0;var a=document.getElementsByName("newsTimeItem");var b=["action=",c,"&tag=",$F("nTag")];switch(c){case PARAM_NEWS_ACTION_GET_OLD_HISTORY:if(a.length!=0){f=a[a.length-1].value}showElement("newsLoader");break;case PARAM_NEWS_ACTION_GET_NEW_HISTORY:if(a.length!=0){f=a[0].value}break}b.push("&lTime=",f);fxAjax.sendRequest(fxVars.forexNews,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:b.join(""),params:{action:c},returnJson:true,loader:false,callback:"getNewsResponse"})}catch(d){}}}var MAX_NEWS_ITEMS=50;function getNewsResponse(v,d){if(!v.error){try{var h=true;var b=JSON.parse(v.content);switch(d.action){case PARAM_NEWS_ACTION_GET_OLD_HISTORY:$PT("newsFeeds").innerHTML+=b.newsResponseText.trim();hideElement("newsLoader");showMoreClicked=true;break;case PARAM_NEWS_ACTION_GET_NEW_HISTORY:$PT("newsFeeds").innerHTML="<div id='newsFeeds"+(refresh)+"' style='display:none'>"+b.newsResponseText.trim()+"</div>"+$PT("newsFeeds").innerHTML;if(b.newsResponseText.trim()!=""){Effect.SlideDown($PT("newsFeeds"+refresh),{duration:0.5})}refresh++;var u=document.getElementsByClassName("newsBoxes");if(u.length>50&&!showMoreClicked){for(var r=u.length-1;r>MAX_NEWS_ITEMS;r--){$PT(u[r]).remove()}}break}toggleNewsBottomMessageButton(b.newsResponseSize,b.newsResponseIsLastPage,d.action);var g=document.getElementsByClassName("publishedNewsTime");for(var l=0;l<g.length;l++){var c=parseInt(g[l].getAttribute("data"));var k=dt.getTime()+MINUTE*dt.getTimezoneOffset()*-1;var t=k-c;var q="<span style='font-size:30px;'>";var o="</span><br/>";var f;if((t/MINUTE)<1){f=$T("tSecondsAgo",[q+Math.abs((t/SECOND).toFixed(0)).toString()+o])}else{if((t/HOUR)<1){f=$T("tMinutesAgo",[q+(t/MINUTE).toFixed(0)+o])}else{if((t/DAY)<1){f=$T("tHoursAgo",[q+(t/HOUR).toFixed(0)+o])}else{var a=new Date(c);f=q+(a.getDate())+o+" "+monthsArrayGetMonth(a.getMonth())}}}g[l].innerHTML=f}}catch(m){}}busy=false;if(saveNewsQueue.length>0){var s=saveNewsQueue.shift();s()}}function toggleNewsBottomMessageButton(d,a,c){var b=document.getElementsByClassName("publishedNewsTime").length>0;if(!b&&d==0){$J("#showMoreNews").hide();$J("#noScheduledEvents").show()}else{$J("#noScheduledEvents").hide();if((c==PARAM_NEWS_ACTION_GET_OLD_HISTORY||c==PARAM_NEWS_ACTION_SAVE_NEW_FILTERS)&&a){$J("#showMoreNews").hide()}else{if(c!=PARAM_NEWS_ACTION_GET_NEW_HISTORY){$J("#showMoreNews").show()}}}}var saveNewsQueue=[];function saveNews(g){if(!busy){busy=true;try{var d=[];var b=getUserCheckedProviderOids();d.push("&newsProviderFilter=",b.checkedProviderArr.join(","),"&newsLanguageFilter=",b.checkedLanguageArr.join(","),"&referrerPageId=",g);var a=$F("nTag");if(hasText(a)){d.push("&tag=",a)}fxAjax.sendRequest(fxVars.saveNews,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:d.join(""),params:{referrerPageId:g},returnJson:false,loader:false,callback:"saveNewsResponse"})}catch(f){}}else{var c=function(){saveNews(g)};saveNewsQueue.push(c)}}function saveNewsResponse(a,c){if(!a.error){try{switch(c.referrerPageId){case PARAM_NEWS_PAGE_LOCATION_DASHBOARD:jQuery("#scrollbar_content").html(a.content.newsList);break;case PARAM_NEWS_PAGE_LOCATION_FOREX_NEWS:jQuery("#newsFeeds").html(a.content.newsList);toggleNewsBottomMessageButton(a.content.newsSize,a.content.newsIsLastPage,PARAM_NEWS_ACTION_SAVE_NEW_FILTERS);break}jQuery("#newsTop").html(a.content.newsTop);jQuery("#newsToolbar").html(a.content.newsToolbar)}catch(b){}}busy=false}!function(q){function G(a,b){if(8==F){var c=k.width(),d=x.debounce(function(){var f=k.width();c!=f&&(c=f,b())},1);k.on(a,d)}else{k.on(a,x.debounce(b,1))}}function A(b){var c=b[0],d=c.parentElement;do{var a=window.getComputedStyle(d).getPropertyValue("overflow");if("visible"!=a){break}}while(d=d.parentElement);return q(d==document.body?[]:d)}function B(a){window&&window.console&&window.console.error&&window.console.error("jQuery.floatThead: "+a)}function y(a){var b=a.getBoundingClientRect();return b.width||b.right-b.left}function K(){var a=document.createElement("scrolltester");a.style.cssText="width:100px;height:100px;overflow:scroll!important;position:absolute;top:-9999px;display:block",document.body.appendChild(a);var b=a.offsetWidth-a.clientWidth;return document.body.removeChild(a),b}function D(a){if(a.dataTableSettings){for(var b=0;b<a.dataTableSettings.length;b++){var c=a.dataTableSettings[b].nTable;if(a[0]==c){return !0}}}return !1}function C(c,f,h){var l=h?"outerWidth":"width";if(z&&c.css("max-width")){var d=0;h&&(d+=parseInt(c.css("borderLeft"),10),d+=parseInt(c.css("borderRight"),10));for(var b=0;b<f.length;b++){d+=f.get(b).offsetWidth}return d}return c[l]()}q.floatThead=q.floatThead||{},q.floatThead.defaults={headerCellSelector:"tr:visible:first>*:visible",zIndex:1001,position:"auto",top:0,bottom:0,scrollContainer:function(){return q([])},responsiveContainer:function(){return q([])},getSizingRow:function(a){return a.find("tbody tr:visible:first>*:visible")},floatTableClass:"floatThead-table",floatWrapperClass:"floatThead-wrapper",floatContainerClass:"floatThead-container",copyTableClass:!0,autoReflow:!1,debug:!1,support:{bootstrap:!0,datatables:!0,jqueryUI:!0,perfectScrollbar:!0}};var x=window._||function(){var b={},c=Object.prototype.hasOwnProperty,d=["Arguments","Function","String","Number","Date","RegExp"];b.has=function(f,h){return c.call(f,h)},b.keys=Object.keys||function(f){if(f!==Object(f)){throw new TypeError("Invalid object")}var h=[];for(var l in f){b.has(f,l)&&h.push(l)}return h};var a=0;return b.uniqueId=function(f){var h=++a+"";return f?f+h:h},q.each(d,function(){var f=this;b["is"+f]=function(h){return Object.prototype.toString.call(h)=="[object "+f+"]"}}),b.debounce=function(u,w,L){var M,v,h,s,f;return function(){h=this,v=arguments,s=new Date;var l=function(){var r=new Date-s;w>r?M=setTimeout(l,w-r):(M=null,L||(f=u.apply(h,v)))},o=L&&!M;return M||(M=setTimeout(l,w)),o&&(f=u.apply(h,v)),f}},b}(),H="undefined"!=typeof MutationObserver,F=function(){for(var a=3,b=document.createElement("b"),c=b.all||[];a=1+a,b.innerHTML="<!--[if gt IE "+a+"]><i><![endif]-->",c[0];){}return a>4?a:document.documentMode}(),I=/Gecko\//.test(navigator.userAgent),m=/WebKit\//.test(navigator.userAgent);F||I||m||(F=11);var z=function(){if(m){var a=q("<div>").css("width",0).append(q("<table>").css("max-width","100%").append(q("<tr>").append(q("<th>").append(q("<div>").css("min-width",100).text("X")))));q("body").append(a);var b=0==a.find("table").width();return a.remove(),b}return !1},E=!I&&!F,k=q(window);if(!window.matchMedia){var J=window.onbeforeprint,g=window.onafterprint;window.onbeforeprint=function(){J&&J(),k.triggerHandler("beforeprint")},window.onafterprint=function(){g&&g(),k.triggerHandler("afterprint")}}q.fn.floatThead=function(r){if(r=r||{},8>F){return this}var d=null;if(x.isFunction(z)&&(z=z()),x.isString(r)){var f=r,l=Array.prototype.slice.call(arguments,1),a=this;return this.filter("table").each(function(){var c=q(this),s=c.data("floatThead-lazy");s&&c.floatThead(s);var t=c.data("floatThead-attached");if(t&&x.isFunction(t[f])){var b=t[f].apply(this,l);void 0!==b&&(a=b)}}),a}var o=q.extend({},q.floatThead.defaults||{},r);if(q.each(r,function(b){b in q.floatThead.defaults||!o.debug||B("Used ["+b+"] key to init plugin, but that param is not an option for the plugin. Valid options are: "+x.keys(q.floatThead.defaults).join(", "))}),o.debug){var h=q.fn.jquery.split(".");1==parseInt(h[0],10)&&parseInt(h[1],10)<=7&&B("jQuery version "+q.fn.jquery+" detected! This plugin supports 1.8 or better, or 1.7.x with jQuery UI 1.8.24 -> http://jqueryui.com/resources/download/jquery-ui-1.8.24.zip")}return this.filter(":not(."+o.floatTableClass+")").each(function(){function ar(c){return c+".fth-"+aJ+".floatTHead"}function am(){var c=0;if(ao.children("tr:visible").each(function(){c+=q(this).outerHeight(!0)}),"collapse"==aP.css("border-collapse")){var w=parseInt(aP.css("border-top-width"),10),L=parseInt(aP.find("thead tr:first").find(">*:first").css("border-top-width"),10);w>L&&(c-=w/2)}a6.outerHeight(c),v.outerHeight(c)}function ai(){var c=C(aP,ak,!0),L=aE?aL:aF,M=L.width()||c,N="hidden"!=L.css("overflow-y")?M-aO.vertical:M;if(a0.width(N),aV){var w=100*c/N;aH.css("width",w+"%")}else{aH.outerWidth(c)}}function aq(){aY=(x.isFunction(o.top)?o.top(aP):o.top)||0,aM=(x.isFunction(o.bottom)?o.bottom(aP):o.bottom)||0}function an(){var N,O=ao.find(o.headerCellSelector);if(aA?N=aj.find("col").length:(N=0,O.each(function(){N+=parseInt(q(this).attr("colspan")||1,10)})),N!=aK){aK=N;for(var P,M=[],w=[],L=[],c=0;N>c;c++){P=O.eq(c).text(),M.push('<th class="floatThead-col" aria-label="'+P+'"/>'),w.push("<col/>"),L.push(q("<fthtd>").css({display:"table-cell",height:0,width:"auto"}))}w=w.join(""),M=M.join(""),E&&(bc.empty(),bc.append(L),ak=bc.find("fthtd")),a6.html(M),v=a6.find("th"),aA||aj.html(w),ba=aj.find("col"),bg.html(w),ae=bg.find("col")}return N}function aG(){if(!aW){if(aW=!0,aB){var c=C(aP,ak,!0),w=aS.width();c>w&&aP.css("minWidth",c)}aP.css(ac),aH.css(ac),aH.append(ao),aX.before(bb),am()}}function aZ(){aW&&(aW=!1,aB&&aP.width(t),bb.detach(),aP.prepend(ao),aP.css(au),aH.css(au),aP.css("minWidth",a3),aP.css("minWidth",C(aP,ak)))}function ah(c){a4!=c&&(a4=c,aP.triggerHandler("floatThead",[c,a0]))}function ap(c){aB!=c&&(aB=c,a0.css({position:aB?"absolute":"fixed"}))}function aI(c,w,L,M){return E?L:M?o.getSizingRow(c,w,L):w}function ag(){var c,w=an();return function(){var M=a0.scrollLeft();ba=aj.find("col");var N=aI(aP,ba,ak,F);if(N.length==w&&w>0){if(!aA){for(c=0;w>c;c++){ba.eq(c).css("width","")}}aZ();var L=[];for(c=0;w>c;c++){L[c]=y(N.get(c))}for(c=0;w>c;c++){ae.eq(c).width(L[c]),ba.eq(c).width(L[c])}aG()}else{aH.append(ao),aP.css(au),aH.css(au),am()}a0.scrollLeft(M),aP.triggerHandler("reflowed",[a0])}}function aT(c){var w=aF.css("border-"+c+"-width"),L=0;return w&&~w.indexOf("px")&&(L=parseInt(w,10)),L}function aQ(){return"auto"==aL.css("overflow-x")}function aD(){var W,S=aF.scrollTop(),M=0,N=a1?az.outerHeight(!0):0,w=aR?N:-N,V=a0.height(),P=aP.offset(),O=0,X=0;if(aV){var T=aF.offset();M=P.top-T.top+S,a1&&aR&&(M+=N),O=aT("left"),X=aT("top"),M-=X}else{W=P.top-aY-V+aM+aO.horizontal}var R=k.scrollTop(),U=k.scrollLeft(),L=function(){return(aQ()?aL:aF).scrollLeft()||0},Q=L();return function(bh){aE=aQ();var Y=aP[0].offsetWidth<=0&&aP[0].offsetHeight<=0;if(!Y&&af){return af=!1,setTimeout(function(){aP.triggerHandler("reflow")},1),null}if(Y&&(af=!0,!aB)){return null}if("windowScroll"==bh){R=k.scrollTop(),U=k.scrollLeft()}else{if("containerScroll"==bh){if(aL.length){if(!aE){return}Q=aL.scrollLeft()}else{S=aF.scrollTop(),Q=aF.scrollLeft()}}else{"init"!=bh&&(R=k.scrollTop(),U=k.scrollLeft(),S=aF.scrollTop(),Q=L())}}if(!m||!(0>R||0>U)){if(ay){ap("windowScrollDone"==bh?!0:!1)}else{if("windowScrollDone"==bh){return null}}P=aP.offset(),a1&&aR&&(P.top+=N);var Z,at,c=aP.outerHeight();if(aV&&aB){if(M>=S){var bi=M-S+X;Z=bi>0?bi:0,ah(!1)}else{Z=av?X:S,ah(!0)}at=O}else{!aV&&aB?(R>W+c+w?Z=c-V+w:P.top>=R+aY?(Z=0,aZ(),ah(!1)):(Z=aY+R-P.top+M+(aR?N:0),aG(),ah(!0)),at=Q):aV&&!aB?(M>S||S-M>c?(Z=P.top-R,aZ(),ah(!1)):(Z=P.top+S-R-M,aG(),ah(!0)),at=P.left+Q-U):aV||aB||(R>W+c+w?Z=c+aY-R+W+w:P.top>R+aY?(Z=P.top-R,aG(),ah(!1)):(Z=aY,ah(!0)),at=P.left+Q-U)}return{top:Math.round(Z),left:Math.round(at)}}}}function aU(){var c=null,w=null,L=null;return function(Q,P,N){if(null!=Q&&(c!=Q.top||w!=Q.left)){if(8===F){a0.css({top:Q.top,left:Q.left})}else{var O="translateX("+Q.left+"px) translateY("+Q.top+"px)";a0.css({"-webkit-transform":O,"-moz-transform":O,"-ms-transform":O,"-o-transform":O,transform:O,top:0,left:0})}c=Q.top,w=Q.left}P&&ai(),N&&am();var M=(aE?aL:aF).scrollLeft();aB&&L==M||(a0.scrollLeft(M),L=M)}}function al(){if(aF.length){if(o.support&&o.support.perfectScrollbar&&aF.data().perfectScrollbar){aO={horizontal:0,vertical:0}}else{if("scroll"==aF.css("overflow-x")){aO.horizontal=a2}else{var w=aF.width(),M=C(aP,ak),N=L>O?a2:0;aO.horizontal=M>w-N?a2:0}if("scroll"==aF.css("overflow-y")){aO.vertical=a2}else{var O=aF.height(),L=aP.height(),c=M>w?a2:0;aO.vertical=L>O-c?a2:0}}}}var aJ=x.uniqueId(),aP=q(this);if(aP.data("floatThead-attached")){return !0}if(!aP.is("table")){throw new Error('jQuery.floatThead must be run on a table element. ex: $("table").floatThead();')}H=o.autoReflow&&H;var ao=aP.children("thead:first"),aX=aP.children("tbody:first");if(0==ao.length||0==aX.length){return o.debug&&B(0==ao.length?"The thead element is missing.":"The tbody element is missing."),aP.data("floatThead-lazy",o),void aP.unbind("reflow").one("reflow",function(){aP.floatThead(o)})}aP.data("floatThead-lazy")&&aP.unbind("reflow"),aP.data("floatThead-lazy",!1);var aY,aM,aW=!0,aO={vertical:0,horizontal:0},a2=K(),aK=0;o.scrollContainer===!0&&(o.scrollContainer=A);var aF=o.scrollContainer(aP)||q([]),aV=aF.length>0,aL=aV?q([]):o.responsiveContainer(aP)||q([]),aE=aQ(),aB=null;"auto"==o.position?aB=null:"fixed"==o.position?aB=!1:"absolute"==o.position?aB=!0:o.debug&&B('Invalid value given to "position" option, valid is "fixed", "absolute" and "auto". You passed: ',o.position),null==aB&&(aB=aV);var az=aP.find("caption"),a1=1==az.length;if(a1){var aR="top"===(az.css("caption-side")||az.attr("align")||"top")}var a9=q("<fthfoot>").css({display:"table-footer-group","border-spacing":0,height:0,"border-collapse":"collapse",visibility:"hidden"}),av=!1,aS=q([]),ay=9>=F&&!aV&&aB,aH=q("<table/>"),bg=q("<colgroup/>"),aj=aP.children("colgroup:first"),aA=!0;0==aj.length&&(aj=q("<colgroup/>"),aA=!1);var bc=q("<fthtr>").css({display:"table-row","border-spacing":0,height:0,"border-collapse":"collapse"}),a0=q("<div>").css("overflow","hidden").attr("aria-hidden","true"),af=!1,bb=q("<thead/>"),a6=q('<tr class="size-row" aria-hidden="true"/>'),v=q([]),ba=q([]),ae=q([]),ak=q([]);bb.append(a6),aP.prepend(aj),E&&(a9.append(bc),aP.append(a9)),aH.append(bg),a0.append(aH),o.copyTableClass&&aH.attr("class",aP.attr("class")),aH.attr({cellpadding:aP.attr("cellpadding"),cellspacing:aP.attr("cellspacing"),border:aP.attr("border")});var ab=aP.css("display");if(aH.css({borderCollapse:aP.css("borderCollapse"),border:aP.css("border"),display:ab}),aV||aH.css("width","auto"),"none"==ab&&(af=!0),aH.addClass(o.floatTableClass).css({margin:0,"border-bottom-width":0}),aB){var aw=function(M,N){var O=M.css("position"),L="relative"==O||"absolute"==O,c=M;if(!L||N){var w={paddingLeft:M.css("paddingLeft"),paddingRight:M.css("paddingRight")};a0.css(w),c=M.data("floatThead-containerWrap")||M.wrap(q("<div>").addClass(o.floatWrapperClass).css({position:"relative",clear:"both"})).parent(),M.data("floatThead-containerWrap",c),av=!0}return c};aV?(aS=aw(aF,!0),aS.prepend(a0)):(aS=aw(aP),aP.before(a0))}else{aP.before(a0)}a0.css({position:aB?"absolute":"fixed",marginTop:0,top:aB?0:"auto",zIndex:o.zIndex,willChange:"transform"}),a0.addClass(o.floatContainerClass),aq();var ac={"table-layout":"fixed"},au={"table-layout":aP.css("tableLayout")||"auto"},t=aP[0].style.width||"",a3=aP.css("minWidth")||"",a4=!1;al();var a7,a8=function(){(a7=ag())()};a8();var ax=aD(),be=aU();be(ax("init"),!0);var aa,bf=x.debounce(function(){be(ax("windowScrollDone"),!1)},1),aN=function(){be(ax("windowScroll"),!1),ay&&bf()},aC=function(){be(ax("containerScroll"),!1)},s=function(){aP.is(":hidden")||(aq(),al(),a8(),ax=aD(),(be=aU())(ax("resize"),!0,!0))},ad=x.debounce(function(){aP.is(":hidden")||(al(),aq(),a8(),ax=aD(),be(ax("reflow"),!0))},1),a5=function(){aZ()},b=function(){aG()},u=function(c){c.matches?a5():b()};if(window.matchMedia&&window.matchMedia("print").addListener?(aa=window.matchMedia("print"),aa.addListener(u)):(k.on("beforeprint",a5),k.on("afterprint",b)),aV?aB?aF.on(ar("scroll"),aC):(aF.on(ar("scroll"),aC),k.on(ar("scroll"),aN)):(aL.on(ar("scroll"),aC),k.on(ar("scroll"),aN)),k.on(ar("load"),ad),G(ar("resize"),s),aP.on("reflow",ad),o.support&&o.support.datatables&&D(aP)&&aP.on("filter",ad).on("sort",ad).on("page",ad),o.support&&o.support.bootstrap&&k.on(ar("shown.bs.tab"),ad),o.support&&o.support.jqueryUI&&k.on(ar("tabsactivate"),ad),H){var bd=null;x.isFunction(o.autoReflow)&&(bd=o.autoReflow(aP,aF)),bd||(bd=aF.length?aF[0]:aP[0]),d=new MutationObserver(function(c){for(var w=function(M){return M&&M[0]&&("THEAD"==M[0].nodeName||"TD"==M[0].nodeName||"TH"==M[0].nodeName)},L=0;L<c.length;L++){if(!w(c[L].addedNodes)&&!w(c[L].removedNodes)){ad();break}}}),d.observe(bd,{childList:!0,subtree:!0})}aP.data("floatThead-attached",{destroy:function(){var c=".fth-"+aJ;return aZ(),aP.css(au),aj.remove(),E&&a9.remove(),bb.parent().length&&bb.replaceWith(ao),ah(!1),H&&(d.disconnect(),d=null),aP.off("reflow reflowed"),aF.off(c),aL.off(c),av&&(aF.length?aF.unwrap():aP.unwrap()),aV?aF.data("floatThead-containerWrap",!1):aP.data("floatThead-containerWrap",!1),aP.css("minWidth",a3),a0.remove(),aP.data("floatThead-attached",!1),k.off(c),aa&&aa.removeListener(u),a5=b=function(){},function(){return aP.floatThead(o)}},reflow:function(){ad()},setHeaderHeight:function(){am()},getFloatContainer:function(){return a0},getRowGroups:function(){return aW?a0.find(">table>thead").add(aP.children("tbody,tfoot")):aP.children("thead,tbody,tfoot")}})}),this}}(function(){var a=window.jQuery;return"undefined"!=typeof module&&module.exports&&!a&&(a=require("jquery")),a}());var MobileEsp={initCompleted:false,isWebkit:false,isMobilePhone:false,isIphone:false,isAndroid:false,isAndroidPhone:false,isTierTablet:false,isTierIphone:false,isTierRichCss:false,isTierGenericMobile:false,engineWebKit:"webkit",deviceIphone:"iphone",deviceIpod:"ipod",deviceIpad:"ipad",deviceMacPpc:"macintosh",deviceAndroid:"android",deviceGoogleTV:"googletv",deviceWinPhone7:"windows phone os 7",deviceWinPhone8:"windows phone 8",deviceWinPhone10:"windows phone 10",deviceWinMob:"windows ce",deviceWindows:"windows",deviceIeMob:"iemobile",devicePpc:"ppc",enginePie:"wm5 pie",deviceBB:"blackberry",deviceBB10:"bb10",vndRIM:"vnd.rim",deviceBBStorm:"blackberry95",deviceBBBold:"blackberry97",deviceBBBoldTouch:"blackberry 99",deviceBBTour:"blackberry96",deviceBBCurve:"blackberry89",deviceBBCurveTouch:"blackberry 938",deviceBBTorch:"blackberry 98",deviceBBPlaybook:"playbook",deviceSymbian:"symbian",deviceSymbos:"symbos",deviceS60:"series60",deviceS70:"series70",deviceS80:"series80",deviceS90:"series90",devicePalm:"palm",deviceWebOS:"webos",deviceWebOStv:"web0s",deviceWebOShp:"hpwos",deviceNuvifone:"nuvifone",deviceBada:"bada",deviceTizen:"tizen",deviceMeego:"meego",deviceSailfish:"sailfish",deviceUbuntu:"ubuntu",deviceKindle:"kindle",engineSilk:"silk-accelerated",engineBlazer:"blazer",engineXiino:"xiino",vndwap:"vnd.wap",wml:"wml",deviceTablet:"tablet",deviceBrew:"brew",deviceDanger:"danger",deviceHiptop:"hiptop",devicePlaystation:"playstation",devicePlaystationVita:"vita",deviceNintendoDs:"nitro",deviceNintendo:"nintendo",deviceWii:"wii",deviceXbox:"xbox",deviceArchos:"archos",engineFirefox:"firefox",engineOpera:"opera",engineNetfront:"netfront",engineUpBrowser:"up.browser",deviceMidp:"midp",uplink:"up.link",engineTelecaQ:"teleca q",engineObigo:"obigo",devicePda:"pda",mini:"mini",mobile:"mobile",mobi:"mobi",smartTV1:"smart-tv",smartTV2:"smarttv",maemo:"maemo",linux:"linux",mylocom2:"sony/com",manuSonyEricsson:"sonyericsson",manuericsson:"ericsson",manuSamsung1:"sec-sgh",manuSony:"sony",manuHtc:"htc",svcDocomo:"docomo",svcKddi:"kddi",svcVodafone:"vodafone",disUpdate:"update",uagent:"",InitDeviceScan:function(){this.initCompleted=false;if(navigator&&navigator.userAgent){this.uagent=navigator.userAgent.toLowerCase()}this.isWebkit=this.DetectWebkit();this.isIphone=this.DetectIphone();this.isAndroid=this.DetectAndroid();this.isAndroidPhone=this.DetectAndroidPhone();this.isMobilePhone=this.DetectMobileQuick();this.isTierIphone=this.DetectTierIphone();this.isTierTablet=this.DetectTierTablet();this.isTierRichCss=this.DetectTierRichCss();this.isTierGenericMobile=this.DetectTierOtherPhones();this.initCompleted=true},DetectIphone:function(){if(this.initCompleted||this.isIphone){return this.isIphone}if(this.uagent.search(this.deviceIphone)>-1){if(this.DetectIpad()||this.DetectIpod()){return false}else{return true}}else{return false}},DetectIpod:function(){if(this.uagent.search(this.deviceIpod)>-1){return true}else{return false}},DetectIphoneOrIpod:function(){if(this.DetectIphone()||this.DetectIpod()){return true}else{return false}},DetectIpad:function(){if(this.uagent.search(this.deviceIpad)>-1&&this.DetectWebkit()){return true}else{return false}},DetectIos:function(){if(this.DetectIphoneOrIpod()||this.DetectIpad()){return true}else{return false}},DetectAndroid:function(){if(this.initCompleted||this.isAndroid){return this.isAndroid}if((this.uagent.search(this.deviceAndroid)>-1)||this.DetectGoogleTV()){return true}return false},DetectAndroidPhone:function(){if(this.initCompleted||this.isAndroidPhone){return this.isAndroidPhone}if(!this.DetectAndroid()){return false}if(this.uagent.search(this.mobile)>-1){return true}if(this.DetectOperaMobile()){return true}return false},DetectAndroidTablet:function(){if(!this.DetectAndroid()){return false}if(this.DetectOperaMobile()){return false}if(this.uagent.search(this.mobile)>-1){return false}else{return true}},DetectAndroidWebKit:function(){if(this.DetectAndroid()&&this.DetectWebkit()){return true}else{return false}},DetectGoogleTV:function(){if(this.uagent.search(this.deviceGoogleTV)>-1){return true}else{return false}},DetectWebkit:function(){if(this.initCompleted||this.isWebkit){return this.isWebkit}if(this.uagent.search(this.engineWebKit)>-1){return true}else{return false}},DetectWindowsPhone:function(){if(this.DetectWindowsPhone7()||this.DetectWindowsPhone8()||this.DetectWindowsPhone10()){return true}else{return false}},DetectWindowsPhone7:function(){if(this.uagent.search(this.deviceWinPhone7)>-1){return true}else{return false}},DetectWindowsPhone8:function(){if(this.uagent.search(this.deviceWinPhone8)>-1){return true}else{return false}},DetectWindowsPhone10:function(){if(this.uagent.search(this.deviceWinPhone10)>-1){return true}else{return false}},DetectWindowsMobile:function(){if(this.DetectWindowsPhone()){return false}if(this.uagent.search(this.deviceWinMob)>-1||this.uagent.search(this.deviceIeMob)>-1||this.uagent.search(this.enginePie)>-1){return true}if((this.uagent.search(this.devicePpc)>-1)&&!(this.uagent.search(this.deviceMacPpc)>-1)){return true}if(this.uagent.search(this.manuHtc)>-1&&this.uagent.search(this.deviceWindows)>-1){return true}else{return false}},DetectBlackBerry:function(){if((this.uagent.search(this.deviceBB)>-1)||(this.uagent.search(this.vndRIM)>-1)){return true}if(this.DetectBlackBerry10Phone()){return true}else{return false}},DetectBlackBerry10Phone:function(){if((this.uagent.search(this.deviceBB10)>-1)&&(this.uagent.search(this.mobile)>-1)){return true}else{return false}},DetectBlackBerryTablet:function(){if(this.uagent.search(this.deviceBBPlaybook)>-1){return true}else{return false}},DetectBlackBerryWebKit:function(){if(this.DetectBlackBerry()&&this.uagent.search(this.engineWebKit)>-1){return true}else{return false}},DetectBlackBerryTouch:function(){if(this.DetectBlackBerry()&&((this.uagent.search(this.deviceBBStorm)>-1)||(this.uagent.search(this.deviceBBTorch)>-1)||(this.uagent.search(this.deviceBBBoldTouch)>-1)||(this.uagent.search(this.deviceBBCurveTouch)>-1))){return true}else{return false}},DetectBlackBerryHigh:function(){if(this.DetectBlackBerryWebKit()){return false}if((this.DetectBlackBerry())&&(this.DetectBlackBerryTouch()||this.uagent.search(this.deviceBBBold)>-1||this.uagent.search(this.deviceBBTour)>-1||this.uagent.search(this.deviceBBCurve)>-1)){return true}else{return false}},DetectBlackBerryLow:function(){if(this.DetectBlackBerry()){if(this.DetectBlackBerryHigh()||this.DetectBlackBerryWebKit()){return false}else{return true}}else{return false}},DetectS60OssBrowser:function(){if(this.DetectWebkit()){if((this.uagent.search(this.deviceS60)>-1||this.uagent.search(this.deviceSymbian)>-1)){return true}else{return false}}else{return false}},DetectSymbianOS:function(){if(this.uagent.search(this.deviceSymbian)>-1||this.uagent.search(this.deviceS60)>-1||((this.uagent.search(this.deviceSymbos)>-1)&&(this.DetectOperaMobile))||this.uagent.search(this.deviceS70)>-1||this.uagent.search(this.deviceS80)>-1||this.uagent.search(this.deviceS90)>-1){return true}else{return false}},DetectPalmOS:function(){if(this.DetectPalmWebOS()){return false}if(this.uagent.search(this.devicePalm)>-1||this.uagent.search(this.engineBlazer)>-1||this.uagent.search(this.engineXiino)>-1){return true}else{return false}},DetectPalmWebOS:function(){if(this.uagent.search(this.deviceWebOS)>-1){return true}else{return false}},DetectWebOSTablet:function(){if(this.uagent.search(this.deviceWebOShp)>-1&&this.uagent.search(this.deviceTablet)>-1){return true}else{return false}},DetectWebOSTV:function(){if(this.uagent.search(this.deviceWebOStv)>-1&&this.uagent.search(this.smartTV2)>-1){return true}else{return false}},DetectOperaMobile:function(){if((this.uagent.search(this.engineOpera)>-1)&&((this.uagent.search(this.mini)>-1||this.uagent.search(this.mobi)>-1))){return true}else{return false}},DetectKindle:function(){if(this.uagent.search(this.deviceKindle)>-1&&!this.DetectAndroid()){return true}else{return false}},DetectAmazonSilk:function(){if(this.uagent.search(this.engineSilk)>-1){return true}else{return false}},DetectGarminNuvifone:function(){if(this.uagent.search(this.deviceNuvifone)>-1){return true}else{return false}},DetectBada:function(){if(this.uagent.search(this.deviceBada)>-1){return true}else{return false}},DetectTizen:function(){if(this.uagent.search(this.deviceTizen)>-1&&this.uagent.search(this.mobile)>-1){return true}else{return false}},DetectTizenTV:function(){if(this.uagent.search(this.deviceTizen)>-1&&this.uagent.search(this.smartTV1)>-1){return true}else{return false}},DetectMeego:function(){if(this.uagent.search(this.deviceMeego)>-1){return true}else{return false}},DetectMeegoPhone:function(){if(this.uagent.search(this.deviceMeego)>-1&&this.uagent.search(this.mobi)>-1){return true}else{return false}},DetectFirefoxOS:function(){if(this.DetectFirefoxOSPhone()||this.DetectFirefoxOSTablet()){return true}else{return false}},DetectFirefoxOSPhone:function(){if(this.DetectIos()||this.DetectAndroid()||this.DetectSailfish()){return false}if((this.uagent.search(this.engineFirefox)>-1)&&(this.uagent.search(this.mobile)>-1)){return true}return false},DetectFirefoxOSTablet:function(){if(this.DetectIos()||this.DetectAndroid()||this.DetectSailfish()){return false}if((this.uagent.search(this.engineFirefox)>-1)&&(this.uagent.search(this.deviceTablet)>-1)){return true}return false},DetectSailfish:function(){if(this.uagent.search(this.deviceSailfish)>-1){return true}else{return false}},DetectSailfishPhone:function(){if(this.DetectSailfish()&&(this.uagent.search(this.mobile)>-1)){return true}return false},DetectUbuntu:function(){if(this.DetectUbuntuPhone()||this.DetectUbuntuTablet()){return true}else{return false}},DetectUbuntuPhone:function(){if((this.uagent.search(this.deviceUbuntu)>-1)&&(this.uagent.search(this.mobile)>-1)){return true}return false},DetectUbuntuTablet:function(){if((this.uagent.search(this.deviceUbuntu)>-1)&&(this.uagent.search(this.deviceTablet)>-1)){return true}return false},DetectDangerHiptop:function(){if(this.uagent.search(this.deviceDanger)>-1||this.uagent.search(this.deviceHiptop)>-1){return true}else{return false}},DetectSonyMylo:function(){if((this.uagent.search(this.manuSony)>-1)&&((this.uagent.search(this.qtembedded)>-1)||(this.uagent.search(this.mylocom2)>-1))){return true}else{return false}},DetectMaemoTablet:function(){if(this.uagent.search(this.maemo)>-1){return true}if((this.uagent.search(this.linux)>-1)&&(this.uagent.search(this.deviceTablet)>-1)&&this.DetectWebOSTablet()&&!this.DetectAndroid()){return true}else{return false}},DetectArchos:function(){if(this.uagent.search(this.deviceArchos)>-1){return true}else{return false}},DetectGameConsole:function(){if(this.DetectSonyPlaystation()||this.DetectNintendo()||this.DetectXbox()){return true}else{return false}},DetectSonyPlaystation:function(){if(this.uagent.search(this.devicePlaystation)>-1){return true}else{return false}},DetectGamingHandheld:function(){if((this.uagent.search(this.devicePlaystation)>-1)&&(this.uagent.search(this.devicePlaystationVita)>-1)){return true}else{return false}},DetectNintendo:function(){if(this.uagent.search(this.deviceNintendo)>-1||this.uagent.search(this.deviceWii)>-1||this.uagent.search(this.deviceNintendoDs)>-1){return true}else{return false}},DetectXbox:function(){if(this.uagent.search(this.deviceXbox)>-1){return true}else{return false}},DetectBrewDevice:function(){if(this.uagent.search(this.deviceBrew)>-1){return true}else{return false}},DetectSmartphone:function(){if(this.DetectTierIphone()||this.DetectS60OssBrowser()||this.DetectSymbianOS()||this.DetectWindowsMobile()||this.DetectBlackBerry()||this.DetectMeegoPhone()||this.DetectPalmOS()){return true}return false},DetectMobileQuick:function(){if(this.initCompleted||this.isMobilePhone){return this.isMobilePhone}if(this.DetectTierTablet()){return false}if(this.DetectSmartphone()){return true}if(this.uagent.search(this.mobile)>-1){return true}if(this.DetectOperaMobile()){return true}if(this.DetectKindle()||this.DetectAmazonSilk()){return true}if(this.uagent.search(this.deviceMidp)>-1||this.DetectBrewDevice()){return true}if((this.uagent.search(this.engineObigo)>-1)||(this.uagent.search(this.engineNetfront)>-1)||(this.uagent.search(this.engineUpBrowser)>-1)){return true}return false},DetectMobileLong:function(){if(this.DetectMobileQuick()){return true}if(this.DetectGameConsole()){return true}if(this.DetectDangerHiptop()||this.DetectMaemoTablet()||this.DetectSonyMylo()||this.DetectArchos()){return true}if((this.uagent.search(this.devicePda)>-1)&&!(this.uagent.search(this.disUpdate)>-1)){return true}if((this.uagent.search(this.manuSamsung1)>-1)||(this.uagent.search(this.manuSonyEricsson)>-1)||(this.uagent.search(this.manuericsson)>-1)||(this.uagent.search(this.svcDocomo)>-1)||(this.uagent.search(this.svcKddi)>-1)||(this.uagent.search(this.svcVodafone)>-1)){return true}return false},DetectTierTablet:function(){if(this.initCompleted||this.isTierTablet){return this.isTierTablet}if(this.DetectIpad()||this.DetectAndroidTablet()||this.DetectBlackBerryTablet()||this.DetectFirefoxOSTablet()||this.DetectUbuntuTablet()||this.DetectWebOSTablet()){return true}else{return false}},DetectTierIphone:function(){if(this.initCompleted||this.isTierIphone){return this.isTierIphone}if(this.DetectIphoneOrIpod()||this.DetectAndroidPhone()||this.DetectWindowsPhone()||this.DetectBlackBerry10Phone()||this.DetectPalmWebOS()||this.DetectBada()||this.DetectTizen()||this.DetectFirefoxOSPhone()||this.DetectSailfishPhone()||this.DetectUbuntuPhone()||this.DetectGamingHandheld()){return true}if(this.DetectBlackBerryWebKit()&&this.DetectBlackBerryTouch()){return true}else{return false}},DetectTierRichCss:function(){if(this.initCompleted||this.isTierRichCss){return this.isTierRichCss}if(this.DetectTierIphone()||this.DetectKindle()||this.DetectTierTablet()){return false}if(!this.DetectMobileQuick()){return false}if(this.DetectWebkit()){return true}if(this.DetectS60OssBrowser()||this.DetectBlackBerryHigh()||this.DetectWindowsMobile()||(this.uagent.search(this.engineTelecaQ)>-1)){return true}else{return false}},DetectTierOtherPhones:function(){if(this.initCompleted||this.isTierGenericMobile){return this.isTierGenericMobile}if(this.DetectTierIphone()||this.DetectTierRichCss()||this.DetectTierTablet()){return false}if(this.DetectMobileLong()){return true}else{return false}}};MobileEsp.InitDeviceScan();